+ set -e
+ LABEL=glibc-default
+ MACHINE=i5
+ DBNAME=test
+ RUNS=1
+ DURATION=10
+ CLIENTS='1 4 16'
+ PARTITIONS='1000 100 1 0'
+ BUILDS=/mnt/data/builds
+ SOURCE=/mnt/data/postgres
+ PATH_OLD=/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
++ date +%Y%m%d-%H%M
+ DATE=20240730-1352
++ pwd
+ PATCHES=/mnt/data/lock-scalability-test/patches
++ pwd
+ LOGS=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs
++ pwd
+ RESULTS=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results
+ DATADIR=/mnt/pgdata/data-test
+ ulimit -n 35000
+ for files in 1000 32768
+ for p in $PARTITIONS
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-32-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-32-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-32-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-32-1000-1000
+ env
++ date
+ echo Tue Jul 30 01:52:10 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Tue Jul 30 01:52:10 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 716b2db8a9 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-1000-1000-1722340330
+ git checkout -b scalability-yes-32-1000-1000-1722340330
Switched to a new branch 'scalability-yes-32-1000-1000-1722340330'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-1000-1000-1722340330 9af1cea9d4] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-1000-1000-1722340330 6540a27b63] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 01:52:34 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 01:52:34 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-32-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-32-1000-1000-1722340330 1000 yes 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-32-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-0-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-0-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-0-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-0-1000-1000
+ env
++ date
+ echo Tue Jul 30 01:53:54 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Tue Jul 30 01:53:54 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 6540a27b63 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-1000-1000-1722340435
+ git checkout -b scalability-yes-0-1000-1000-1722340435
Switched to a new branch 'scalability-yes-0-1000-1000-1722340435'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-1000-1000-1722340435 7abe525a4d] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 01:54:18 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 01:54:18 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-0-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-0-1000-1000-1722340435 1000 yes 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-0-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-1-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-1-1000-1000
+ env
++ date
+ echo Tue Jul 30 01:55:39 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Tue Jul 30 01:55:39 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 7abe525a4d NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-1000-1000-1722340539
+ git checkout -b scalability-yes-1-1000-1000-1722340539
Switched to a new branch 'scalability-yes-1-1000-1000-1722340539'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-1000-1000-1722340539 7580729b3c] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-1000-1000-1722340539 eac5867d93] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 01:56:03 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 01:56:03 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-1-1000-1000-1722340539 1000 yes 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1024-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-1024-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1024-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-1024-1000-1000
+ env
++ date
+ echo Tue Jul 30 01:57:24 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Tue Jul 30 01:57:24 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at eac5867d93 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-1000-1000-1722340644
+ git checkout -b scalability-yes-1024-1000-1000-1722340644
Switched to a new branch 'scalability-yes-1024-1000-1000-1722340644'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-1000-1000-1722340644 058c1e5b71] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-1000-1000-1722340644 ddd3a911dd] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 01:57:48 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 01:57:48 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1024-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-1024-1000-1000-1722340644 1000 yes 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1024-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-8-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-8-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-8-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-8-1000-1000
+ env
++ date
+ echo Tue Jul 30 01:59:09 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Tue Jul 30 01:59:09 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at ddd3a911dd fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-1000-1000-1722340749
+ git checkout -b scalability-yes-8-1000-1000-1722340749
Switched to a new branch 'scalability-yes-8-1000-1000-1722340749'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-1000-1000-1722340749 3fab0f4369] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-1000-1000-1722340749 265a2e605d] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 01:59:33 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 01:59:33 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-8-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-8-1000-1000-1722340749 1000 yes 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-8-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-512-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-512-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-512-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-512-1000-1000
+ env
++ date
+ echo Tue Jul 30 02:00:53 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Tue Jul 30 02:00:53 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 265a2e605d fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-1000-1000-1722340853
+ git checkout -b scalability-yes-512-1000-1000-1722340853
Switched to a new branch 'scalability-yes-512-1000-1000-1722340853'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-1000-1000-1722340853 4379ad3f94] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-1000-1000-1722340853 657df471cc] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 02:01:17 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 02:01:17 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-512-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-512-1000-1000-1722340853 1000 yes 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-512-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-128-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-128-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-128-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-128-1000-1000
+ env
++ date
+ echo Tue Jul 30 02:02:38 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Tue Jul 30 02:02:38 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 657df471cc fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-1000-1000-1722340958
+ git checkout -b scalability-yes-128-1000-1000-1722340958
Switched to a new branch 'scalability-yes-128-1000-1000-1722340958'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-1000-1000-1722340958 af7aa97359] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-1000-1000-1722340958 d260836e95] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 02:03:02 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 02:03:02 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-128-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-128-1000-1000-1722340958 1000 yes 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-128-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-32-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-32-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-32-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-32-1000-1000
+ env
++ date
+ echo Tue Jul 30 02:04:23 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Tue Jul 30 02:04:23 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d260836e95 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-1000-1000-1722341063
+ git checkout -b scalability-no-32-1000-1000-1722341063
Switched to a new branch 'scalability-no-32-1000-1000-1722341063'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-1000-1000-1722341063 bb1fc937cf] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 02:04:47 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 02:04:47 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-32-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-32-1000-1000-1722341063 1000 no 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-32-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-0-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-0-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-0-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-0-1000-1000
+ env
++ date
+ echo Tue Jul 30 02:06:07 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Tue Jul 30 02:06:07 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at bb1fc937cf fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-1000-1000-1722341168
+ git checkout -b scalability-no-0-1000-1000-1722341168
Switched to a new branch 'scalability-no-0-1000-1000-1722341168'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 02:06:31 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 02:06:31 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-0-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-0-1000-1000-1722341168 1000 no 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-0-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-1-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-1-1000-1000
+ env
++ date
+ echo Tue Jul 30 02:07:52 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Tue Jul 30 02:07:52 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-1000-1000-1722341272
+ git checkout -b scalability-no-1-1000-1000-1722341272
Switched to a new branch 'scalability-no-1-1000-1000-1722341272'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/1/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-1000-1000-1722341272 4651fe22b5] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 02:08:16 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 02:08:16 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-1-1000-1000-1722341272 1000 no 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1024-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-1024-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1024-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-1024-1000-1000
+ env
++ date
+ echo Tue Jul 30 02:09:36 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Tue Jul 30 02:09:36 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 4651fe22b5 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-1000-1000-1722341377
+ git checkout -b scalability-no-1024-1000-1000-1722341377
Switched to a new branch 'scalability-no-1024-1000-1000-1722341377'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-1000-1000-1722341377 8ec71cef3c] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 02:10:00 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 02:10:00 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1024-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-1024-1000-1000-1722341377 1000 no 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1024-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-8-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-8-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-8-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-8-1000-1000
+ env
++ date
+ echo Tue Jul 30 02:11:21 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Tue Jul 30 02:11:21 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 8ec71cef3c fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-1000-1000-1722341481
+ git checkout -b scalability-no-8-1000-1000-1722341481
Switched to a new branch 'scalability-no-8-1000-1000-1722341481'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-1000-1000-1722341481 27f746ff89] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 02:11:45 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 02:11:45 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-8-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-8-1000-1000-1722341481 1000 no 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-8-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-512-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-512-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-512-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-512-1000-1000
+ env
++ date
+ echo Tue Jul 30 02:13:05 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Tue Jul 30 02:13:05 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 27f746ff89 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-1000-1000-1722341586
+ git checkout -b scalability-no-512-1000-1000-1722341586
Switched to a new branch 'scalability-no-512-1000-1000-1722341586'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-1000-1000-1722341586 757adf4987] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 02:13:29 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 02:13:29 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-512-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-512-1000-1000-1722341586 1000 no 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-512-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-128-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-128-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-128-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-128-1000-1000
+ env
++ date
+ echo Tue Jul 30 02:14:50 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Tue Jul 30 02:14:50 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 757adf4987 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-1000-1000-1722341690
+ git checkout -b scalability-no-128-1000-1000-1722341690
Switched to a new branch 'scalability-no-128-1000-1000-1722341690'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-1000-1000-1722341690 408529bc96] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 02:15:14 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 02:15:14 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-128-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-128-1000-1000-1722341690 1000 no 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-128-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-32-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-32-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-32-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-32-1000-1000
+ env
++ date
+ echo Tue Jul 30 02:16:35 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Tue Jul 30 02:16:35 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 408529bc96 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-1000-1000-1722341795
+ git checkout -b scalability-yes-32-1000-1000-1722341795
Switched to a new branch 'scalability-yes-32-1000-1000-1722341795'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-1000-1000-1722341795 16b246af40] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-1000-1000-1722341795 4e89896bbb] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 02:16:59 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 02:16:59 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-32-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-32-1000-1000-1722341795 1000 yes 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-32-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-0-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-0-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-0-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-0-1000-1000
+ env
++ date
+ echo Tue Jul 30 02:18:54 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Tue Jul 30 02:18:54 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 4e89896bbb fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-1000-1000-1722341934
+ git checkout -b scalability-yes-0-1000-1000-1722341934
Switched to a new branch 'scalability-yes-0-1000-1000-1722341934'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-1000-1000-1722341934 c26b10f370] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 02:19:18 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 02:19:18 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-0-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-0-1000-1000-1722341934 1000 yes 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-0-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-1-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-1-1000-1000
+ env
++ date
+ echo Tue Jul 30 02:21:13 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Tue Jul 30 02:21:13 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at c26b10f370 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-1000-1000-1722342073
+ git checkout -b scalability-yes-1-1000-1000-1722342073
Switched to a new branch 'scalability-yes-1-1000-1000-1722342073'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-1000-1000-1722342073 223c7f70f6] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-1000-1000-1722342073 0105b13675] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 02:21:37 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 02:21:37 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-1-1000-1000-1722342073 1000 yes 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1024-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-1024-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1024-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-1024-1000-1000
+ env
++ date
+ echo Tue Jul 30 02:23:33 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Tue Jul 30 02:23:33 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 0105b13675 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-1000-1000-1722342213
+ git checkout -b scalability-yes-1024-1000-1000-1722342213
Switched to a new branch 'scalability-yes-1024-1000-1000-1722342213'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-1000-1000-1722342213 9889f55b46] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-1000-1000-1722342213 b32ce9fc63] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 02:23:57 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 02:23:57 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1024-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-1024-1000-1000-1722342213 1000 yes 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1024-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-8-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-8-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-8-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-8-1000-1000
+ env
++ date
+ echo Tue Jul 30 02:25:54 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Tue Jul 30 02:25:54 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b32ce9fc63 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-1000-1000-1722342354
+ git checkout -b scalability-yes-8-1000-1000-1722342354
Switched to a new branch 'scalability-yes-8-1000-1000-1722342354'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-1000-1000-1722342354 5c68e5a2be] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-1000-1000-1722342354 998fd50189] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 02:26:18 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 02:26:18 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-8-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-8-1000-1000-1722342354 1000 yes 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-8-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-512-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-512-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-512-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-512-1000-1000
+ env
++ date
+ echo Tue Jul 30 02:28:14 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Tue Jul 30 02:28:14 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 998fd50189 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-1000-1000-1722342494
+ git checkout -b scalability-yes-512-1000-1000-1722342494
Switched to a new branch 'scalability-yes-512-1000-1000-1722342494'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-1000-1000-1722342494 8ea25c266f] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-1000-1000-1722342494 f25120b45b] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 02:28:38 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 02:28:38 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-512-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-512-1000-1000-1722342494 1000 yes 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-512-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-128-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-128-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-128-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-128-1000-1000
+ env
++ date
+ echo Tue Jul 30 02:30:35 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Tue Jul 30 02:30:35 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at f25120b45b fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-1000-1000-1722342635
+ git checkout -b scalability-yes-128-1000-1000-1722342635
Switched to a new branch 'scalability-yes-128-1000-1000-1722342635'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-1000-1000-1722342635 890d984328] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-1000-1000-1722342635 ca45886ae5] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 02:30:59 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 02:30:59 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-128-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-128-1000-1000-1722342635 1000 yes 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-128-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-32-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-32-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-32-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-32-1000-1000
+ env
++ date
+ echo Tue Jul 30 02:32:55 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Tue Jul 30 02:32:55 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at ca45886ae5 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-1000-1000-1722342775
+ git checkout -b scalability-no-32-1000-1000-1722342775
Switched to a new branch 'scalability-no-32-1000-1000-1722342775'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-1000-1000-1722342775 c6b8eb3384] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 02:33:18 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 02:33:18 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-32-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-32-1000-1000-1722342775 1000 no 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-32-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-0-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-0-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-0-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-0-1000-1000
+ env
++ date
+ echo Tue Jul 30 02:35:14 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Tue Jul 30 02:35:14 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at c6b8eb3384 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-1000-1000-1722342914
+ git checkout -b scalability-no-0-1000-1000-1722342914
Switched to a new branch 'scalability-no-0-1000-1000-1722342914'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 02:35:38 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 02:35:38 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-0-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-0-1000-1000-1722342914 1000 no 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-0-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-1-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-1-1000-1000
+ env
++ date
+ echo Tue Jul 30 02:37:33 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Tue Jul 30 02:37:33 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-1000-1000-1722343054
+ git checkout -b scalability-no-1-1000-1000-1722343054
Switched to a new branch 'scalability-no-1-1000-1000-1722343054'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-1000-1000-1722343054 def72bc8e0] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 02:37:57 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 02:37:57 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-1-1000-1000-1722343054 1000 no 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1024-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-1024-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1024-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-1024-1000-1000
+ env
++ date
+ echo Tue Jul 30 02:39:53 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Tue Jul 30 02:39:53 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at def72bc8e0 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-1000-1000-1722343193
+ git checkout -b scalability-no-1024-1000-1000-1722343193
Switched to a new branch 'scalability-no-1024-1000-1000-1722343193'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-1000-1000-1722343193 6618ab0097] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 02:40:17 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 02:40:17 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1024-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-1024-1000-1000-1722343193 1000 no 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1024-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-8-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-8-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-8-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-8-1000-1000
+ env
++ date
+ echo Tue Jul 30 02:42:14 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Tue Jul 30 02:42:14 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 6618ab0097 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-1000-1000-1722343334
+ git checkout -b scalability-no-8-1000-1000-1722343334
Switched to a new branch 'scalability-no-8-1000-1000-1722343334'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/8/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-1000-1000-1722343334 7c5126ada3] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 02:42:38 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 02:42:38 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-8-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-8-1000-1000-1722343334 1000 no 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-8-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-512-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-512-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-512-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-512-1000-1000
+ env
++ date
+ echo Tue Jul 30 02:44:34 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Tue Jul 30 02:44:34 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 7c5126ada3 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-1000-1000-1722343474
+ git checkout -b scalability-no-512-1000-1000-1722343474
Switched to a new branch 'scalability-no-512-1000-1000-1722343474'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/512/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-1000-1000-1722343474 a4189677d6] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 02:44:58 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 02:44:58 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-512-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-512-1000-1000-1722343474 1000 no 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-512-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-128-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-128-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-128-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-128-1000-1000
+ env
++ date
+ echo Tue Jul 30 02:46:54 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Tue Jul 30 02:46:54 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a4189677d6 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-1000-1000-1722343615
+ git checkout -b scalability-no-128-1000-1000-1722343615
Switched to a new branch 'scalability-no-128-1000-1000-1722343615'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-1000-1000-1722343615 245b09d24c] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 02:47:18 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 02:47:18 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-128-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-128-1000-1000-1722343615 1000 no 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-128-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-32-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-32-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-32-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-32-1000-1000
+ env
++ date
+ echo Tue Jul 30 02:49:14 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Tue Jul 30 02:49:14 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 245b09d24c fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-1000-1000-1722343754
+ git checkout -b scalability-yes-32-1000-1000-1722343754
Switched to a new branch 'scalability-yes-32-1000-1000-1722343754'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-1000-1000-1722343754 62d231722a] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-1000-1000-1722343754 0c13cf3cb4] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 02:49:38 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 02:49:38 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-32-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-32-1000-1000-1722343754 1000 yes 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-32-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-0-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-0-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-0-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-0-1000-1000
+ env
++ date
+ echo Tue Jul 30 02:51:01 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Tue Jul 30 02:51:01 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 0c13cf3cb4 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-1000-1000-1722343861
+ git checkout -b scalability-yes-0-1000-1000-1722343861
Switched to a new branch 'scalability-yes-0-1000-1000-1722343861'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-1000-1000-1722343861 ef96dcd87c] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 02:51:25 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 02:51:25 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-0-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-0-1000-1000-1722343861 1000 yes 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-0-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-1-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-1-1000-1000
+ env
++ date
+ echo Tue Jul 30 02:52:47 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Tue Jul 30 02:52:47 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at ef96dcd87c NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-1000-1000-1722343967
+ git checkout -b scalability-yes-1-1000-1000-1722343967
Switched to a new branch 'scalability-yes-1-1000-1000-1722343967'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-1000-1000-1722343967 8fb050fc7d] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-1000-1000-1722343967 4551fa1ff3] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 02:53:11 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 02:53:11 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-1-1000-1000-1722343967 1000 yes 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1024-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-1024-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1024-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-1024-1000-1000
+ env
++ date
+ echo Tue Jul 30 02:54:33 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Tue Jul 30 02:54:33 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 4551fa1ff3 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-1000-1000-1722344073
+ git checkout -b scalability-yes-1024-1000-1000-1722344073
Switched to a new branch 'scalability-yes-1024-1000-1000-1722344073'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-1000-1000-1722344073 33c80322db] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-1000-1000-1722344073 58d768e25a] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 02:54:57 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 02:54:57 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1024-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-1024-1000-1000-1722344073 1000 yes 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1024-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-8-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-8-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-8-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-8-1000-1000
+ env
++ date
+ echo Tue Jul 30 02:56:22 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Tue Jul 30 02:56:22 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 58d768e25a fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-1000-1000-1722344182
+ git checkout -b scalability-yes-8-1000-1000-1722344182
Switched to a new branch 'scalability-yes-8-1000-1000-1722344182'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-1000-1000-1722344182 fbcec0fcf3] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-1000-1000-1722344182 62afdd5231] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 02:56:46 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 02:56:46 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-8-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-8-1000-1000-1722344182 1000 yes 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-8-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-512-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-512-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-512-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-512-1000-1000
+ env
++ date
+ echo Tue Jul 30 02:58:08 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Tue Jul 30 02:58:08 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 62afdd5231 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-1000-1000-1722344288
+ git checkout -b scalability-yes-512-1000-1000-1722344288
Switched to a new branch 'scalability-yes-512-1000-1000-1722344288'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-1000-1000-1722344288 b6824adc6a] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-1000-1000-1722344288 81826b1555] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 02:58:32 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 02:58:32 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-512-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-512-1000-1000-1722344288 1000 yes 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-512-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-128-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-128-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-128-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-128-1000-1000
+ env
++ date
+ echo Tue Jul 30 02:59:55 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Tue Jul 30 02:59:55 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 81826b1555 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-1000-1000-1722344395
+ git checkout -b scalability-yes-128-1000-1000-1722344395
Switched to a new branch 'scalability-yes-128-1000-1000-1722344395'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-1000-1000-1722344395 4aa20b389e] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-1000-1000-1722344395 940f0de621] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 03:00:19 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 03:00:19 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-128-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-128-1000-1000-1722344395 1000 yes 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-128-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-32-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-32-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-32-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-32-1000-1000
+ env
++ date
+ echo Tue Jul 30 03:01:42 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Tue Jul 30 03:01:42 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 940f0de621 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-1000-1000-1722344502
+ git checkout -b scalability-no-32-1000-1000-1722344502
Switched to a new branch 'scalability-no-32-1000-1000-1722344502'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-1000-1000-1722344502 a21ab1c3ab] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 03:02:05 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 03:02:05 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-32-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-32-1000-1000-1722344502 1000 no 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-32-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-0-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-0-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-0-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-0-1000-1000
+ env
++ date
+ echo Tue Jul 30 03:03:27 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Tue Jul 30 03:03:27 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a21ab1c3ab fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-1000-1000-1722344608
+ git checkout -b scalability-no-0-1000-1000-1722344608
Switched to a new branch 'scalability-no-0-1000-1000-1722344608'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 03:03:51 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 03:03:51 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-0-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-0-1000-1000-1722344608 1000 no 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-0-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-1-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-1-1000-1000
+ env
++ date
+ echo Tue Jul 30 03:05:13 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Tue Jul 30 03:05:13 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-1000-1000-1722344714
+ git checkout -b scalability-no-1-1000-1000-1722344714
Switched to a new branch 'scalability-no-1-1000-1000-1722344714'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-1000-1000-1722344714 12d8e88c85] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 03:05:37 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 03:05:37 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-1-1000-1000-1722344714 1000 no 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1024-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-1024-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1024-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-1024-1000-1000
+ env
++ date
+ echo Tue Jul 30 03:06:59 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Tue Jul 30 03:06:59 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 12d8e88c85 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-1000-1000-1722344819
+ git checkout -b scalability-no-1024-1000-1000-1722344819
Switched to a new branch 'scalability-no-1024-1000-1000-1722344819'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/1024/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-1000-1000-1722344819 4872e73775] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 03:07:23 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 03:07:23 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1024-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-1024-1000-1000-1722344819 1000 no 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1024-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-8-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-8-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-8-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-8-1000-1000
+ env
++ date
+ echo Tue Jul 30 03:08:48 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Tue Jul 30 03:08:48 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 4872e73775 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-1000-1000-1722344928
+ git checkout -b scalability-no-8-1000-1000-1722344928
Switched to a new branch 'scalability-no-8-1000-1000-1722344928'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-1000-1000-1722344928 ac3fa749c2] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 03:09:12 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 03:09:12 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-8-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-8-1000-1000-1722344928 1000 no 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-8-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-512-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-512-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-512-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-512-1000-1000
+ env
++ date
+ echo Tue Jul 30 03:10:34 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Tue Jul 30 03:10:34 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at ac3fa749c2 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-1000-1000-1722345034
+ git checkout -b scalability-no-512-1000-1000-1722345034
Switched to a new branch 'scalability-no-512-1000-1000-1722345034'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-1000-1000-1722345034 d689616a2a] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 03:10:58 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 03:10:58 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-512-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-512-1000-1000-1722345034 1000 no 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-512-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-128-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-128-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-128-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-128-1000-1000
+ env
++ date
+ echo Tue Jul 30 03:12:21 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Tue Jul 30 03:12:21 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d689616a2a fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-1000-1000-1722345142
+ git checkout -b scalability-no-128-1000-1000-1722345142
Switched to a new branch 'scalability-no-128-1000-1000-1722345142'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-1000-1000-1722345142 baa0dea6c1] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 03:12:45 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 03:12:45 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-128-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-128-1000-1000-1722345142 1000 no 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-128-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-32-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-32-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-32-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-32-1000-1000
+ env
++ date
+ echo Tue Jul 30 03:14:08 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Tue Jul 30 03:14:08 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at baa0dea6c1 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-1000-1000-1722345248
+ git checkout -b scalability-yes-32-1000-1000-1722345248
Switched to a new branch 'scalability-yes-32-1000-1000-1722345248'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-1000-1000-1722345248 c7798b5c4d] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-1000-1000-1722345248 81b0192b25] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 03:14:31 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 03:14:31 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-32-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-32-1000-1000-1722345248 1000 yes 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-32-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-0-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-0-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-0-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-0-1000-1000
+ env
++ date
+ echo Tue Jul 30 03:16:04 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Tue Jul 30 03:16:04 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 81b0192b25 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-1000-1000-1722345364
+ git checkout -b scalability-yes-0-1000-1000-1722345364
Switched to a new branch 'scalability-yes-0-1000-1000-1722345364'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-1000-1000-1722345364 a99239256d] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 03:16:27 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 03:16:27 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-0-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-0-1000-1000-1722345364 1000 yes 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-0-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-1-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-1-1000-1000
+ env
++ date
+ echo Tue Jul 30 03:17:59 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Tue Jul 30 03:17:59 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a99239256d NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-1000-1000-1722345480
+ git checkout -b scalability-yes-1-1000-1000-1722345480
Switched to a new branch 'scalability-yes-1-1000-1000-1722345480'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-1000-1000-1722345480 d3e41759a7] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-1000-1000-1722345480 c5b801a110] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 03:18:23 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 03:18:23 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-1-1000-1000-1722345480 1000 yes 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1024-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-1024-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1024-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-1024-1000-1000
+ env
++ date
+ echo Tue Jul 30 03:19:56 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Tue Jul 30 03:19:56 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at c5b801a110 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-1000-1000-1722345596
+ git checkout -b scalability-yes-1024-1000-1000-1722345596
Switched to a new branch 'scalability-yes-1024-1000-1000-1722345596'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-1000-1000-1722345596 22422279c0] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-1000-1000-1722345596 4845457f69] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 03:20:20 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 03:20:20 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1024-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-1024-1000-1000-1722345596 1000 yes 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1024-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-8-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-8-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-8-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-8-1000-1000
+ env
++ date
+ echo Tue Jul 30 03:21:52 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Tue Jul 30 03:21:52 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 4845457f69 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-1000-1000-1722345712
+ git checkout -b scalability-yes-8-1000-1000-1722345712
Switched to a new branch 'scalability-yes-8-1000-1000-1722345712'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-1000-1000-1722345712 9bd2f55967] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-1000-1000-1722345712 5df22bb28a] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 03:22:16 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 03:22:16 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-8-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-8-1000-1000-1722345712 1000 yes 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-8-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-512-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-512-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-512-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-512-1000-1000
+ env
++ date
+ echo Tue Jul 30 03:23:48 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Tue Jul 30 03:23:48 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 5df22bb28a fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-1000-1000-1722345828
+ git checkout -b scalability-yes-512-1000-1000-1722345828
Switched to a new branch 'scalability-yes-512-1000-1000-1722345828'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-1000-1000-1722345828 0304c2e18b] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-1000-1000-1722345828 a91a4681c5] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 03:24:12 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 03:24:12 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-512-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-512-1000-1000-1722345828 1000 yes 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-512-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-128-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-128-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-128-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-128-1000-1000
+ env
++ date
+ echo Tue Jul 30 03:25:44 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Tue Jul 30 03:25:44 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a91a4681c5 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-1000-1000-1722345945
+ git checkout -b scalability-yes-128-1000-1000-1722345945
Switched to a new branch 'scalability-yes-128-1000-1000-1722345945'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-1000-1000-1722345945 ee2306562a] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-1000-1000-1722345945 ce0c0d1379] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 03:26:08 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 03:26:08 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-128-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-128-1000-1000-1722345945 1000 yes 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-128-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-32-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-32-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-32-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-32-1000-1000
+ env
++ date
+ echo Tue Jul 30 03:27:40 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Tue Jul 30 03:27:40 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at ce0c0d1379 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-1000-1000-1722346061
+ git checkout -b scalability-no-32-1000-1000-1722346061
Switched to a new branch 'scalability-no-32-1000-1000-1722346061'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-1000-1000-1722346061 bca12b2dc6] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 03:28:04 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 03:28:04 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-32-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-32-1000-1000-1722346061 1000 no 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-32-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-0-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-0-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-0-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-0-1000-1000
+ env
++ date
+ echo Tue Jul 30 03:29:36 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Tue Jul 30 03:29:36 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at bca12b2dc6 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-1000-1000-1722346177
+ git checkout -b scalability-no-0-1000-1000-1722346177
Switched to a new branch 'scalability-no-0-1000-1000-1722346177'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 03:30:00 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 03:30:00 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-0-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-0-1000-1000-1722346177 1000 no 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-0-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-1-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-1-1000-1000
+ env
++ date
+ echo Tue Jul 30 03:31:33 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Tue Jul 30 03:31:33 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-1000-1000-1722346293
+ git checkout -b scalability-no-1-1000-1000-1722346293
Switched to a new branch 'scalability-no-1-1000-1000-1722346293'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-1000-1000-1722346293 9bb2e5af5a] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 03:31:57 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 03:31:57 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-1-1000-1000-1722346293 1000 no 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1024-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-1024-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1024-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-1024-1000-1000
+ env
++ date
+ echo Tue Jul 30 03:33:29 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Tue Jul 30 03:33:29 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 9bb2e5af5a fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-1000-1000-1722346410
+ git checkout -b scalability-no-1024-1000-1000-1722346410
Switched to a new branch 'scalability-no-1024-1000-1000-1722346410'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-1000-1000-1722346410 dd6e0cc8da] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 03:33:53 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 03:33:53 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1024-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-1024-1000-1000-1722346410 1000 no 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1024-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-8-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-8-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-8-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-8-1000-1000
+ env
++ date
+ echo Tue Jul 30 03:35:26 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Tue Jul 30 03:35:26 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at dd6e0cc8da fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-1000-1000-1722346526
+ git checkout -b scalability-no-8-1000-1000-1722346526
Switched to a new branch 'scalability-no-8-1000-1000-1722346526'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-1000-1000-1722346526 d84fae3515] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 03:35:50 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 03:35:50 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-8-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-8-1000-1000-1722346526 1000 no 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-8-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-512-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-512-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-512-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-512-1000-1000
+ env
++ date
+ echo Tue Jul 30 03:37:21 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Tue Jul 30 03:37:21 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d84fae3515 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-1000-1000-1722346642
+ git checkout -b scalability-no-512-1000-1000-1722346642
Switched to a new branch 'scalability-no-512-1000-1000-1722346642'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-1000-1000-1722346642 5b77aa89e6] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 03:37:45 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 03:37:45 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-512-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-512-1000-1000-1722346642 1000 no 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-512-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-128-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-128-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-128-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-128-1000-1000
+ env
++ date
+ echo Tue Jul 30 03:39:18 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Tue Jul 30 03:39:18 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 5b77aa89e6 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-1000-1000-1722346758
+ git checkout -b scalability-no-128-1000-1000-1722346758
Switched to a new branch 'scalability-no-128-1000-1000-1722346758'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-1000-1000-1722346758 264334373d] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 03:39:41 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 03:39:41 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-128-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-128-1000-1000-1722346758 1000 no 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-128-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-32-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-32-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-32-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-32-1000-1000
+ env
++ date
+ echo Tue Jul 30 03:41:13 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Tue Jul 30 03:41:13 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 264334373d fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-1000-1000-1722346874
+ git checkout -b scalability-yes-32-1000-1000-1722346874
Switched to a new branch 'scalability-yes-32-1000-1000-1722346874'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-1000-1000-1722346874 2da9bcec89] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-1000-1000-1722346874 415d9fce3d] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 03:41:37 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 03:41:37 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-32-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-32-1000-1000-1722346874 1000 yes 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-32-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-0-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-0-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-0-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-0-1000-1000
+ env
++ date
+ echo Tue Jul 30 03:41:40 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Tue Jul 30 03:41:40 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 415d9fce3d fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-1000-1000-1722346900
+ git checkout -b scalability-yes-0-1000-1000-1722346900
Switched to a new branch 'scalability-yes-0-1000-1000-1722346900'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-1000-1000-1722346900 f9d9bf0a97] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 03:42:04 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 03:42:04 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-0-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-0-1000-1000-1722346900 1000 yes 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-0-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-1-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-1-1000-1000
+ env
++ date
+ echo Tue Jul 30 03:42:07 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Tue Jul 30 03:42:07 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at f9d9bf0a97 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-1000-1000-1722346927
+ git checkout -b scalability-yes-1-1000-1000-1722346927
Switched to a new branch 'scalability-yes-1-1000-1000-1722346927'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-1000-1000-1722346927 30667d7cb6] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-1000-1000-1722346927 615881a098] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 03:42:31 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 03:42:31 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-1-1000-1000-1722346927 1000 yes 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1024-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-1024-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1024-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-1024-1000-1000
+ env
++ date
+ echo Tue Jul 30 03:42:33 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Tue Jul 30 03:42:33 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 615881a098 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-1000-1000-1722346954
+ git checkout -b scalability-yes-1024-1000-1000-1722346954
Switched to a new branch 'scalability-yes-1024-1000-1000-1722346954'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-1000-1000-1722346954 41196325f5] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-1000-1000-1722346954 d3d6173c9a] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 03:42:58 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 03:42:58 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1024-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-1024-1000-1000-1722346954 1000 yes 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1024-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-8-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-8-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-8-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-8-1000-1000
+ env
++ date
+ echo Tue Jul 30 03:43:00 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Tue Jul 30 03:43:00 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d3d6173c9a fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-1000-1000-1722346981
+ git checkout -b scalability-yes-8-1000-1000-1722346981
Switched to a new branch 'scalability-yes-8-1000-1000-1722346981'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-1000-1000-1722346981 18d70441ce] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-1000-1000-1722346981 5ce46238d6] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 03:43:24 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 03:43:24 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-8-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-8-1000-1000-1722346981 1000 yes 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-8-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-512-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-512-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-512-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-512-1000-1000
+ env
++ date
+ echo Tue Jul 30 03:43:27 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Tue Jul 30 03:43:27 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 5ce46238d6 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-1000-1000-1722347007
+ git checkout -b scalability-yes-512-1000-1000-1722347007
Switched to a new branch 'scalability-yes-512-1000-1000-1722347007'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-1000-1000-1722347007 7d38f16903] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-1000-1000-1722347007 10abac66f5] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 03:43:51 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 03:43:51 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-512-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-512-1000-1000-1722347007 1000 yes 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-512-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-128-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-128-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-128-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-128-1000-1000
+ env
++ date
+ echo Tue Jul 30 03:43:54 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Tue Jul 30 03:43:54 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 10abac66f5 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-1000-1000-1722347034
+ git checkout -b scalability-yes-128-1000-1000-1722347034
Switched to a new branch 'scalability-yes-128-1000-1000-1722347034'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-1000-1000-1722347034 d6e8b6925e] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-1000-1000-1722347034 3a30ccac19] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 03:44:18 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 03:44:18 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-128-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-128-1000-1000-1722347034 1000 yes 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-128-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-32-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-32-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-32-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-32-1000-1000
+ env
++ date
+ echo Tue Jul 30 03:44:21 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Tue Jul 30 03:44:21 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 3a30ccac19 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-1000-1000-1722347061
+ git checkout -b scalability-no-32-1000-1000-1722347061
Switched to a new branch 'scalability-no-32-1000-1000-1722347061'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-1000-1000-1722347061 bb6f35e7cd] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 03:44:45 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 03:44:45 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-32-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-32-1000-1000-1722347061 1000 no 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-32-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-0-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-0-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-0-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-0-1000-1000
+ env
++ date
+ echo Tue Jul 30 03:44:47 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Tue Jul 30 03:44:47 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at bb6f35e7cd fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-1000-1000-1722347087
+ git checkout -b scalability-no-0-1000-1000-1722347087
Switched to a new branch 'scalability-no-0-1000-1000-1722347087'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 03:45:11 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 03:45:11 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-0-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-0-1000-1000-1722347087 1000 no 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-0-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-1-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-1-1000-1000
+ env
++ date
+ echo Tue Jul 30 03:45:14 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Tue Jul 30 03:45:14 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-1000-1000-1722347114
+ git checkout -b scalability-no-1-1000-1000-1722347114
Switched to a new branch 'scalability-no-1-1000-1000-1722347114'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-1000-1000-1722347114 540a8b9320] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 03:45:38 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 03:45:38 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-1-1000-1000-1722347114 1000 no 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1024-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-1024-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1024-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-1024-1000-1000
+ env
++ date
+ echo Tue Jul 30 03:45:40 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Tue Jul 30 03:45:40 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 540a8b9320 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-1000-1000-1722347141
+ git checkout -b scalability-no-1024-1000-1000-1722347141
Switched to a new branch 'scalability-no-1024-1000-1000-1722347141'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-1000-1000-1722347141 46e215e66d] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 03:46:04 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 03:46:04 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1024-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-1024-1000-1000-1722347141 1000 no 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1024-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-8-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-8-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-8-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-8-1000-1000
+ env
++ date
+ echo Tue Jul 30 03:46:07 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Tue Jul 30 03:46:07 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 46e215e66d fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-1000-1000-1722347167
+ git checkout -b scalability-no-8-1000-1000-1722347167
Switched to a new branch 'scalability-no-8-1000-1000-1722347167'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-1000-1000-1722347167 08597585a1] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 03:46:31 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 03:46:31 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-8-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-8-1000-1000-1722347167 1000 no 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-8-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-512-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-512-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-512-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-512-1000-1000
+ env
++ date
+ echo Tue Jul 30 03:46:34 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Tue Jul 30 03:46:34 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 08597585a1 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-1000-1000-1722347194
+ git checkout -b scalability-no-512-1000-1000-1722347194
Switched to a new branch 'scalability-no-512-1000-1000-1722347194'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-1000-1000-1722347194 e54bdb8299] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 03:46:58 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 03:46:58 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-512-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-512-1000-1000-1722347194 1000 no 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-512-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-128-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-128-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-128-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-128-1000-1000
+ env
++ date
+ echo Tue Jul 30 03:47:00 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Tue Jul 30 03:47:00 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e54bdb8299 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-1000-1000-1722347221
+ git checkout -b scalability-no-128-1000-1000-1722347221
Switched to a new branch 'scalability-no-128-1000-1000-1722347221'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-1000-1000-1722347221 c2e5150be7] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 03:47:24 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Tue Jul 30 03:47:24 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-128-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-128-1000-1000-1722347221 1000 no 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-128-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for p in $PARTITIONS
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-32-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-32-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-32-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-32-1000-100
+ env
++ date
+ echo Tue Jul 30 03:47:27 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Tue Jul 30 03:47:27 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at c2e5150be7 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-1000-100-1722347247
+ git checkout -b scalability-yes-32-1000-100-1722347247
Switched to a new branch 'scalability-yes-32-1000-100-1722347247'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-1000-100-1722347247 85143b454f] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-1000-100-1722347247 c9f886d604] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 03:47:51 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 03:47:51 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-32-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-32-1000-100-1722347247 1000 yes 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-32-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-0-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-0-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-0-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-0-1000-100
+ env
++ date
+ echo Tue Jul 30 03:49:06 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Tue Jul 30 03:49:06 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at c9f886d604 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-1000-100-1722347346
+ git checkout -b scalability-yes-0-1000-100-1722347346
Switched to a new branch 'scalability-yes-0-1000-100-1722347346'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-1000-100-1722347346 7890226563] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 03:49:30 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 03:49:30 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-0-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-0-1000-100-1722347346 1000 yes 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-0-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-1-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-1-1000-100
+ env
++ date
+ echo Tue Jul 30 03:50:45 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Tue Jul 30 03:50:45 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 7890226563 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-1000-100-1722347445
+ git checkout -b scalability-yes-1-1000-100-1722347445
Switched to a new branch 'scalability-yes-1-1000-100-1722347445'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-1000-100-1722347445 9728f9a620] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-1000-100-1722347445 5088f80247] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 03:51:09 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 03:51:09 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-1-1000-100-1722347445 1000 yes 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1024-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-1024-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1024-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-1024-1000-100
+ env
++ date
+ echo Tue Jul 30 03:52:24 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Tue Jul 30 03:52:24 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 5088f80247 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-1000-100-1722347544
+ git checkout -b scalability-yes-1024-1000-100-1722347544
Switched to a new branch 'scalability-yes-1024-1000-100-1722347544'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-1000-100-1722347544 ff5429200b] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-1000-100-1722347544 e3881fe64c] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 03:52:48 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 03:52:48 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1024-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-1024-1000-100-1722347544 1000 yes 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1024-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-8-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-8-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-8-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-8-1000-100
+ env
++ date
+ echo Tue Jul 30 03:54:03 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Tue Jul 30 03:54:03 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e3881fe64c fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-1000-100-1722347643
+ git checkout -b scalability-yes-8-1000-100-1722347643
Switched to a new branch 'scalability-yes-8-1000-100-1722347643'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-1000-100-1722347643 508715d3e5] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-1000-100-1722347643 1cfad1dace] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 03:54:27 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 03:54:27 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-8-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-8-1000-100-1722347643 1000 yes 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-8-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-512-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-512-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-512-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-512-1000-100
+ env
++ date
+ echo Tue Jul 30 03:55:42 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Tue Jul 30 03:55:42 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 1cfad1dace fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-1000-100-1722347742
+ git checkout -b scalability-yes-512-1000-100-1722347742
Switched to a new branch 'scalability-yes-512-1000-100-1722347742'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-1000-100-1722347742 fc80edd27c] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-1000-100-1722347742 23f9b62813] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 03:56:05 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 03:56:05 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-512-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-512-1000-100-1722347742 1000 yes 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-512-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-128-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-128-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-128-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-128-1000-100
+ env
++ date
+ echo Tue Jul 30 03:57:20 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Tue Jul 30 03:57:20 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 23f9b62813 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-1000-100-1722347841
+ git checkout -b scalability-yes-128-1000-100-1722347841
Switched to a new branch 'scalability-yes-128-1000-100-1722347841'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-1000-100-1722347841 f658afb287] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-1000-100-1722347841 e000cfc20f] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 03:57:44 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 03:57:44 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-128-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-128-1000-100-1722347841 1000 yes 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-128-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-32-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-32-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-32-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-32-1000-100
+ env
++ date
+ echo Tue Jul 30 03:58:59 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Tue Jul 30 03:58:59 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e000cfc20f fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-1000-100-1722347939
+ git checkout -b scalability-no-32-1000-100-1722347939
Switched to a new branch 'scalability-no-32-1000-100-1722347939'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/32/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-1000-100-1722347939 8f3886f62c] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 03:59:23 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 03:59:23 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-32-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-32-1000-100-1722347939 1000 no 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-32-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-0-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-0-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-0-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-0-1000-100
+ env
++ date
+ echo Tue Jul 30 04:00:38 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Tue Jul 30 04:00:38 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 8f3886f62c fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-1000-100-1722348038
+ git checkout -b scalability-no-0-1000-100-1722348038
Switched to a new branch 'scalability-no-0-1000-100-1722348038'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ head -n 1000
+ git log
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 04:01:02 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 04:01:02 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-0-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-0-1000-100-1722348038 1000 no 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-0-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-1-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-1-1000-100
+ env
++ date
+ echo Tue Jul 30 04:02:17 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Tue Jul 30 04:02:17 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-1000-100-1722348137
+ git checkout -b scalability-no-1-1000-100-1722348137
Switched to a new branch 'scalability-no-1-1000-100-1722348137'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-1000-100-1722348137 274b28087e] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 04:02:40 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 04:02:40 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-1-1000-100-1722348137 1000 no 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1024-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-1024-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1024-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-1024-1000-100
+ env
++ date
+ echo Tue Jul 30 04:03:55 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Tue Jul 30 04:03:55 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 274b28087e fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-1000-100-1722348235
+ git checkout -b scalability-no-1024-1000-100-1722348235
Switched to a new branch 'scalability-no-1024-1000-100-1722348235'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-1000-100-1722348235 05cfd62d30] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 04:04:19 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 04:04:19 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1024-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-1024-1000-100-1722348235 1000 no 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1024-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-8-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-8-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-8-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-8-1000-100
+ env
++ date
+ echo Tue Jul 30 04:05:34 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Tue Jul 30 04:05:34 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05cfd62d30 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-1000-100-1722348334
+ git checkout -b scalability-no-8-1000-100-1722348334
Switched to a new branch 'scalability-no-8-1000-100-1722348334'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-1000-100-1722348334 aeb898816a] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 04:05:58 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 04:05:58 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-8-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-8-1000-100-1722348334 1000 no 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-8-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-512-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-512-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-512-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-512-1000-100
+ env
++ date
+ echo Tue Jul 30 04:07:13 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Tue Jul 30 04:07:13 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at aeb898816a fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-1000-100-1722348433
+ git checkout -b scalability-no-512-1000-100-1722348433
Switched to a new branch 'scalability-no-512-1000-100-1722348433'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/512/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-1000-100-1722348433 56cfbfc2f7] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 04:07:37 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 04:07:37 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-512-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-512-1000-100-1722348433 1000 no 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-512-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-128-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-128-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-128-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-128-1000-100
+ env
++ date
+ echo Tue Jul 30 04:08:52 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Tue Jul 30 04:08:52 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 56cfbfc2f7 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-1000-100-1722348532
+ git checkout -b scalability-no-128-1000-100-1722348532
Switched to a new branch 'scalability-no-128-1000-100-1722348532'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-1000-100-1722348532 68831c38ea] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 04:09:16 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 04:09:16 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-128-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-128-1000-100-1722348532 1000 no 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-128-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-32-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-32-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-32-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-32-1000-100
+ env
++ date
+ echo Tue Jul 30 04:10:31 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Tue Jul 30 04:10:31 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 68831c38ea fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-1000-100-1722348631
+ git checkout -b scalability-yes-32-1000-100-1722348631
Switched to a new branch 'scalability-yes-32-1000-100-1722348631'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-1000-100-1722348631 cfe2712eb0] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-1000-100-1722348631 b14d107e5e] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 04:10:54 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 04:10:54 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-32-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-32-1000-100-1722348631 1000 yes 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-32-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-0-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-0-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-0-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-0-1000-100
+ env
++ date
+ echo Tue Jul 30 04:12:13 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Tue Jul 30 04:12:13 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b14d107e5e fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-1000-100-1722348733
+ git checkout -b scalability-yes-0-1000-100-1722348733
Switched to a new branch 'scalability-yes-0-1000-100-1722348733'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-1000-100-1722348733 da998a7aa1] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 04:12:37 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 04:12:37 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-0-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-0-1000-100-1722348733 1000 yes 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-0-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-1-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-1-1000-100
+ env
++ date
+ echo Tue Jul 30 04:13:56 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Tue Jul 30 04:13:56 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at da998a7aa1 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-1000-100-1722348836
+ git checkout -b scalability-yes-1-1000-100-1722348836
Switched to a new branch 'scalability-yes-1-1000-100-1722348836'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-1000-100-1722348836 e250389d7e] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-1000-100-1722348836 c4d796bf86] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 04:14:20 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 04:14:20 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-1-1000-100-1722348836 1000 yes 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1024-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-1024-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1024-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-1024-1000-100
+ env
++ date
+ echo Tue Jul 30 04:15:39 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Tue Jul 30 04:15:39 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at c4d796bf86 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-1000-100-1722348939
+ git checkout -b scalability-yes-1024-1000-100-1722348939
Switched to a new branch 'scalability-yes-1024-1000-100-1722348939'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-1000-100-1722348939 5027830a6f] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-1000-100-1722348939 184032fda4] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 04:16:03 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 04:16:03 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1024-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-1024-1000-100-1722348939 1000 yes 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1024-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-8-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-8-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-8-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-8-1000-100
+ env
++ date
+ echo Tue Jul 30 04:17:22 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Tue Jul 30 04:17:22 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 184032fda4 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-1000-100-1722349042
+ git checkout -b scalability-yes-8-1000-100-1722349042
Switched to a new branch 'scalability-yes-8-1000-100-1722349042'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-1000-100-1722349042 362df66bc3] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-1000-100-1722349042 27219d07e8] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 04:17:46 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 04:17:46 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-8-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-8-1000-100-1722349042 1000 yes 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-8-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-512-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-512-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-512-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-512-1000-100
+ env
++ date
+ echo Tue Jul 30 04:19:05 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Tue Jul 30 04:19:05 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 27219d07e8 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-1000-100-1722349145
+ git checkout -b scalability-yes-512-1000-100-1722349145
Switched to a new branch 'scalability-yes-512-1000-100-1722349145'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-1000-100-1722349145 a5aea2cbcd] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-1000-100-1722349145 52e41fcc26] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 04:19:28 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 04:19:28 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-512-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-512-1000-100-1722349145 1000 yes 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-512-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-128-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-128-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-128-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-128-1000-100
+ env
++ date
+ echo Tue Jul 30 04:20:47 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Tue Jul 30 04:20:47 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 52e41fcc26 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-1000-100-1722349247
+ git checkout -b scalability-yes-128-1000-100-1722349247
Switched to a new branch 'scalability-yes-128-1000-100-1722349247'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-1000-100-1722349247 057fe94fde] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-1000-100-1722349247 ad97006ab7] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 04:21:11 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 04:21:11 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-128-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-128-1000-100-1722349247 1000 yes 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-128-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-32-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-32-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-32-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-32-1000-100
+ env
++ date
+ echo Tue Jul 30 04:22:30 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Tue Jul 30 04:22:30 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at ad97006ab7 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-1000-100-1722349350
+ git checkout -b scalability-no-32-1000-100-1722349350
Switched to a new branch 'scalability-no-32-1000-100-1722349350'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/32/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-1000-100-1722349350 d99ee4a2e8] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 04:22:54 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 04:22:54 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-32-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-32-1000-100-1722349350 1000 no 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-32-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-0-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-0-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-0-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-0-1000-100
+ env
++ date
+ echo Tue Jul 30 04:24:13 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Tue Jul 30 04:24:13 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d99ee4a2e8 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-1000-100-1722349453
+ git checkout -b scalability-no-0-1000-100-1722349453
Switched to a new branch 'scalability-no-0-1000-100-1722349453'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 04:24:37 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 04:24:37 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-0-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-0-1000-100-1722349453 1000 no 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-0-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-1-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-1-1000-100
+ env
++ date
+ echo Tue Jul 30 04:25:55 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Tue Jul 30 04:25:55 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-1000-100-1722349555
+ git checkout -b scalability-no-1-1000-100-1722349555
Switched to a new branch 'scalability-no-1-1000-100-1722349555'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/1/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-1000-100-1722349555 2f0ad76757] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 04:26:19 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 04:26:19 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-1-1000-100-1722349555 1000 no 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1024-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-1024-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1024-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-1024-1000-100
+ env
++ date
+ echo Tue Jul 30 04:27:38 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Tue Jul 30 04:27:38 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 2f0ad76757 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-1000-100-1722349658
+ git checkout -b scalability-no-1024-1000-100-1722349658
Switched to a new branch 'scalability-no-1024-1000-100-1722349658'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-1000-100-1722349658 ededacac7d] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 04:28:02 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 04:28:02 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1024-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-1024-1000-100-1722349658 1000 no 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1024-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-8-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-8-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-8-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-8-1000-100
+ env
++ date
+ echo Tue Jul 30 04:29:21 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Tue Jul 30 04:29:21 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at ededacac7d fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-1000-100-1722349761
+ git checkout -b scalability-no-8-1000-100-1722349761
Switched to a new branch 'scalability-no-8-1000-100-1722349761'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-1000-100-1722349761 6c6a729401] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 04:29:45 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 04:29:45 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-8-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-8-1000-100-1722349761 1000 no 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-8-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-512-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-512-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-512-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-512-1000-100
+ env
++ date
+ echo Tue Jul 30 04:31:03 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Tue Jul 30 04:31:03 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 6c6a729401 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-1000-100-1722349864
+ git checkout -b scalability-no-512-1000-100-1722349864
Switched to a new branch 'scalability-no-512-1000-100-1722349864'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-1000-100-1722349864 10c23a0490] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 04:31:27 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 04:31:27 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-512-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-512-1000-100-1722349864 1000 no 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-512-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-128-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-128-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-128-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-128-1000-100
+ env
++ date
+ echo Tue Jul 30 04:32:46 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Tue Jul 30 04:32:46 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 10c23a0490 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-1000-100-1722349966
+ git checkout -b scalability-no-128-1000-100-1722349966
Switched to a new branch 'scalability-no-128-1000-100-1722349966'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-1000-100-1722349966 b7e93abc3a] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 04:33:10 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 04:33:10 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-128-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-128-1000-100-1722349966 1000 no 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-128-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-32-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-32-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-32-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-32-1000-100
+ env
++ date
+ echo Tue Jul 30 04:34:29 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Tue Jul 30 04:34:29 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b7e93abc3a fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-1000-100-1722350069
+ git checkout -b scalability-yes-32-1000-100-1722350069
Switched to a new branch 'scalability-yes-32-1000-100-1722350069'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-1000-100-1722350069 5a70fdd366] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-1000-100-1722350069 5a1e35a5b1] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 04:34:53 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 04:34:53 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-32-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-32-1000-100-1722350069 1000 yes 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-32-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-0-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-0-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-0-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-0-1000-100
+ env
++ date
+ echo Tue Jul 30 04:36:06 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Tue Jul 30 04:36:06 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 5a1e35a5b1 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-1000-100-1722350167
+ git checkout -b scalability-yes-0-1000-100-1722350167
Switched to a new branch 'scalability-yes-0-1000-100-1722350167'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-1000-100-1722350167 51da4ea79d] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 04:36:30 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 04:36:30 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-0-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-0-1000-100-1722350167 1000 yes 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-0-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-1-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-1-1000-100
+ env
++ date
+ echo Tue Jul 30 04:37:44 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Tue Jul 30 04:37:44 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 51da4ea79d NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-1000-100-1722350264
+ git checkout -b scalability-yes-1-1000-100-1722350264
Switched to a new branch 'scalability-yes-1-1000-100-1722350264'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-1000-100-1722350264 a51c55d7d0] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-1000-100-1722350264 5d97d09fd6] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 04:38:08 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 04:38:08 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-1-1000-100-1722350264 1000 yes 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1024-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-1024-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1024-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-1024-1000-100
+ env
++ date
+ echo Tue Jul 30 04:39:22 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Tue Jul 30 04:39:22 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 5d97d09fd6 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-1000-100-1722350362
+ git checkout -b scalability-yes-1024-1000-100-1722350362
Switched to a new branch 'scalability-yes-1024-1000-100-1722350362'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-1000-100-1722350362 344f3b7f45] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-1000-100-1722350362 3d3128a223] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 04:39:46 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 04:39:46 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1024-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-1024-1000-100-1722350362 1000 yes 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1024-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-8-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-8-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-8-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-8-1000-100
+ env
++ date
+ echo Tue Jul 30 04:41:00 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Tue Jul 30 04:41:00 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 3d3128a223 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-1000-100-1722350460
+ git checkout -b scalability-yes-8-1000-100-1722350460
Switched to a new branch 'scalability-yes-8-1000-100-1722350460'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-1000-100-1722350460 07e699e409] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-1000-100-1722350460 a158ac113c] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 04:41:24 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 04:41:24 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-8-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-8-1000-100-1722350460 1000 yes 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-8-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-512-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-512-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-512-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-512-1000-100
+ env
++ date
+ echo Tue Jul 30 04:42:37 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Tue Jul 30 04:42:37 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a158ac113c fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-1000-100-1722350558
+ git checkout -b scalability-yes-512-1000-100-1722350558
Switched to a new branch 'scalability-yes-512-1000-100-1722350558'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-1000-100-1722350558 0844c9258b] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-1000-100-1722350558 c7ed56be46] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 04:43:01 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 04:43:01 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-512-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-512-1000-100-1722350558 1000 yes 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-512-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-128-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-128-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-128-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-128-1000-100
+ env
++ date
+ echo Tue Jul 30 04:44:15 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Tue Jul 30 04:44:15 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at c7ed56be46 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-1000-100-1722350655
+ git checkout -b scalability-yes-128-1000-100-1722350655
Switched to a new branch 'scalability-yes-128-1000-100-1722350655'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-1000-100-1722350655 b77974b0dd] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-1000-100-1722350655 c72a75c132] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 04:44:39 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 04:44:39 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-128-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-128-1000-100-1722350655 1000 yes 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-128-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-32-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-32-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-32-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-32-1000-100
+ env
++ date
+ echo Tue Jul 30 04:45:53 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Tue Jul 30 04:45:53 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at c72a75c132 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-1000-100-1722350753
+ git checkout -b scalability-no-32-1000-100-1722350753
Switched to a new branch 'scalability-no-32-1000-100-1722350753'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/32/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-1000-100-1722350753 f5f450aa42] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 04:46:17 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 04:46:17 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-32-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-32-1000-100-1722350753 1000 no 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-32-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-0-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-0-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-0-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-0-1000-100
+ env
++ date
+ echo Tue Jul 30 04:47:31 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Tue Jul 30 04:47:31 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at f5f450aa42 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-1000-100-1722350851
+ git checkout -b scalability-no-0-1000-100-1722350851
Switched to a new branch 'scalability-no-0-1000-100-1722350851'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 04:47:55 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 04:47:55 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-0-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-0-1000-100-1722350851 1000 no 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-0-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-1-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-1-1000-100
+ env
++ date
+ echo Tue Jul 30 04:49:08 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Tue Jul 30 04:49:08 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-1000-100-1722350949
+ git checkout -b scalability-no-1-1000-100-1722350949
Switched to a new branch 'scalability-no-1-1000-100-1722350949'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-1000-100-1722350949 f0864c352e] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 04:49:32 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 04:49:32 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-1-1000-100-1722350949 1000 no 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1024-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-1024-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1024-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-1024-1000-100
+ env
++ date
+ echo Tue Jul 30 04:50:46 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Tue Jul 30 04:50:46 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at f0864c352e fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-1000-100-1722351046
+ git checkout -b scalability-no-1024-1000-100-1722351046
Switched to a new branch 'scalability-no-1024-1000-100-1722351046'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/1024/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-1000-100-1722351046 d4238beb7d] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 04:51:10 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 04:51:10 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1024-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-1024-1000-100-1722351046 1000 no 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1024-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-8-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-8-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-8-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-8-1000-100
+ env
++ date
+ echo Tue Jul 30 04:52:24 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Tue Jul 30 04:52:24 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d4238beb7d fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-1000-100-1722351144
+ git checkout -b scalability-no-8-1000-100-1722351144
Switched to a new branch 'scalability-no-8-1000-100-1722351144'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-1000-100-1722351144 73e9ac2a14] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 04:52:48 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 04:52:48 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-8-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-8-1000-100-1722351144 1000 no 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-8-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-512-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-512-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-512-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-512-1000-100
+ env
++ date
+ echo Tue Jul 30 04:54:02 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Tue Jul 30 04:54:02 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 73e9ac2a14 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-1000-100-1722351242
+ git checkout -b scalability-no-512-1000-100-1722351242
Switched to a new branch 'scalability-no-512-1000-100-1722351242'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-1000-100-1722351242 35626c0a24] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 04:54:25 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 04:54:25 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-512-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-512-1000-100-1722351242 1000 no 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-512-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-128-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-128-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-128-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-128-1000-100
+ env
++ date
+ echo Tue Jul 30 04:55:40 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Tue Jul 30 04:55:40 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 35626c0a24 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-1000-100-1722351340
+ git checkout -b scalability-no-128-1000-100-1722351340
Switched to a new branch 'scalability-no-128-1000-100-1722351340'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/128/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-1000-100-1722351340 4c52a13f0d] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 04:56:03 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 04:56:03 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-128-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-128-1000-100-1722351340 1000 no 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-128-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-32-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-32-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-32-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-32-1000-100
+ env
++ date
+ echo Tue Jul 30 04:57:17 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Tue Jul 30 04:57:17 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 4c52a13f0d fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-1000-100-1722351437
+ git checkout -b scalability-yes-32-1000-100-1722351437
Switched to a new branch 'scalability-yes-32-1000-100-1722351437'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-1000-100-1722351437 2e233e25fa] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-1000-100-1722351437 fc498a7dd7] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 04:57:41 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 04:57:41 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-32-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-32-1000-100-1722351437 1000 yes 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-32-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-0-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-0-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-0-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-0-1000-100
+ env
++ date
+ echo Tue Jul 30 04:59:01 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Tue Jul 30 04:59:01 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at fc498a7dd7 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-1000-100-1722351542
+ git checkout -b scalability-yes-0-1000-100-1722351542
Switched to a new branch 'scalability-yes-0-1000-100-1722351542'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-1000-100-1722351542 3d41c1d78c] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 04:59:25 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 04:59:25 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-0-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-0-1000-100-1722351542 1000 yes 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-0-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-1-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-1-1000-100
+ env
++ date
+ echo Tue Jul 30 05:00:46 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Tue Jul 30 05:00:46 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 3d41c1d78c NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-1000-100-1722351646
+ git checkout -b scalability-yes-1-1000-100-1722351646
Switched to a new branch 'scalability-yes-1-1000-100-1722351646'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-1000-100-1722351646 d2c2b0ea18] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-1000-100-1722351646 4be56e46cd] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 05:01:10 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 05:01:10 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-1-1000-100-1722351646 1000 yes 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1024-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-1024-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1024-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-1024-1000-100
+ env
++ date
+ echo Tue Jul 30 05:02:31 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Tue Jul 30 05:02:31 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 4be56e46cd fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-1000-100-1722351751
+ git checkout -b scalability-yes-1024-1000-100-1722351751
Switched to a new branch 'scalability-yes-1024-1000-100-1722351751'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-1000-100-1722351751 25ae6e1dfa] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-1000-100-1722351751 76ec7f8808] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 05:02:54 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 05:02:54 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1024-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-1024-1000-100-1722351751 1000 yes 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1024-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-8-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-8-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-8-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-8-1000-100
+ env
++ date
+ echo Tue Jul 30 05:04:15 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Tue Jul 30 05:04:15 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 76ec7f8808 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-1000-100-1722351855
+ git checkout -b scalability-yes-8-1000-100-1722351855
Switched to a new branch 'scalability-yes-8-1000-100-1722351855'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-1000-100-1722351855 7bf3616b3b] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-1000-100-1722351855 c88fa3d58e] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 05:04:39 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 05:04:39 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-8-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-8-1000-100-1722351855 1000 yes 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-8-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-512-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-512-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-512-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-512-1000-100
+ env
++ date
+ echo Tue Jul 30 05:05:59 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Tue Jul 30 05:05:59 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at c88fa3d58e fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-1000-100-1722351960
+ git checkout -b scalability-yes-512-1000-100-1722351960
Switched to a new branch 'scalability-yes-512-1000-100-1722351960'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-1000-100-1722351960 cb629462c9] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-1000-100-1722351960 b4a53d7c1c] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 05:06:23 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 05:06:23 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-512-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-512-1000-100-1722351960 1000 yes 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-512-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-128-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-128-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-128-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-128-1000-100
+ env
++ date
+ echo Tue Jul 30 05:07:44 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Tue Jul 30 05:07:44 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b4a53d7c1c fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-1000-100-1722352064
+ git checkout -b scalability-yes-128-1000-100-1722352064
Switched to a new branch 'scalability-yes-128-1000-100-1722352064'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-1000-100-1722352064 732ccc5a87] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-1000-100-1722352064 e81ed6670d] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 05:08:08 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 05:08:08 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-128-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-128-1000-100-1722352064 1000 yes 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-128-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-32-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-32-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-32-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-32-1000-100
+ env
++ date
+ echo Tue Jul 30 05:09:28 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Tue Jul 30 05:09:28 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e81ed6670d fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-1000-100-1722352169
+ git checkout -b scalability-no-32-1000-100-1722352169
Switched to a new branch 'scalability-no-32-1000-100-1722352169'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/32/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-1000-100-1722352169 7a322ce9b9] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 05:09:52 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 05:09:52 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-32-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-32-1000-100-1722352169 1000 no 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-32-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-0-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-0-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-0-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-0-1000-100
+ env
++ date
+ echo Tue Jul 30 05:11:13 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Tue Jul 30 05:11:13 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 7a322ce9b9 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-1000-100-1722352273
+ git checkout -b scalability-no-0-1000-100-1722352273
Switched to a new branch 'scalability-no-0-1000-100-1722352273'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 05:11:37 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 05:11:37 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-0-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-0-1000-100-1722352273 1000 no 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-0-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-1-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-1-1000-100
+ env
++ date
+ echo Tue Jul 30 05:12:57 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Tue Jul 30 05:12:57 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-1000-100-1722352378
+ git checkout -b scalability-no-1-1000-100-1722352378
Switched to a new branch 'scalability-no-1-1000-100-1722352378'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-1000-100-1722352378 4887f9159d] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 05:13:21 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 05:13:21 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-1-1000-100-1722352378 1000 no 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1024-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-1024-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1024-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-1024-1000-100
+ env
++ date
+ echo Tue Jul 30 05:14:42 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Tue Jul 30 05:14:42 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 4887f9159d fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-1000-100-1722352482
+ git checkout -b scalability-no-1024-1000-100-1722352482
Switched to a new branch 'scalability-no-1024-1000-100-1722352482'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-1000-100-1722352482 9a19153efa] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 05:15:06 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 05:15:06 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1024-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-1024-1000-100-1722352482 1000 no 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1024-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-8-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-8-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-8-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-8-1000-100
+ env
++ date
+ echo Tue Jul 30 05:16:27 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Tue Jul 30 05:16:27 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 9a19153efa fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-1000-100-1722352587
+ git checkout -b scalability-no-8-1000-100-1722352587
Switched to a new branch 'scalability-no-8-1000-100-1722352587'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/8/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-1000-100-1722352587 0298a53c48] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 05:16:50 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 05:16:50 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-8-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-8-1000-100-1722352587 1000 no 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-8-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-512-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-512-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-512-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-512-1000-100
+ env
++ date
+ echo Tue Jul 30 05:18:11 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Tue Jul 30 05:18:11 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 0298a53c48 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-1000-100-1722352691
+ git checkout -b scalability-no-512-1000-100-1722352691
Switched to a new branch 'scalability-no-512-1000-100-1722352691'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-1000-100-1722352691 7a6c777efe] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 05:18:35 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 05:18:35 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-512-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-512-1000-100-1722352691 1000 no 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-512-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-128-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-128-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-128-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-128-1000-100
+ env
++ date
+ echo Tue Jul 30 05:19:56 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Tue Jul 30 05:19:56 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 7a6c777efe fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-1000-100-1722352796
+ git checkout -b scalability-no-128-1000-100-1722352796
Switched to a new branch 'scalability-no-128-1000-100-1722352796'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-1000-100-1722352796 9028b3e81d] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 05:20:19 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 05:20:19 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-128-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-128-1000-100-1722352796 1000 no 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-128-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-32-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-32-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-32-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-32-1000-100
+ env
++ date
+ echo Tue Jul 30 05:21:40 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Tue Jul 30 05:21:40 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 9028b3e81d fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-1000-100-1722352900
+ git checkout -b scalability-yes-32-1000-100-1722352900
Switched to a new branch 'scalability-yes-32-1000-100-1722352900'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-1000-100-1722352900 b2d5c8776c] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-1000-100-1722352900 f9157d91ea] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 05:22:04 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 05:22:04 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-32-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-32-1000-100-1722352900 1000 yes 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-32-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-0-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-0-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-0-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-0-1000-100
+ env
++ date
+ echo Tue Jul 30 05:38:47 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Tue Jul 30 05:38:47 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at f9157d91ea fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-1000-100-1722353928
+ git checkout -b scalability-yes-0-1000-100-1722353928
Switched to a new branch 'scalability-yes-0-1000-100-1722353928'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-1000-100-1722353928 a2a030ee54] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 05:39:12 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 05:39:12 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-0-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-0-1000-100-1722353928 1000 yes 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-0-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-1-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-1-1000-100
+ env
++ date
+ echo Tue Jul 30 05:55:53 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Tue Jul 30 05:55:53 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a2a030ee54 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-1000-100-1722354953
+ git checkout -b scalability-yes-1-1000-100-1722354953
Switched to a new branch 'scalability-yes-1-1000-100-1722354953'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-1000-100-1722354953 4a95b361e8] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-1000-100-1722354953 5971880438] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 05:56:17 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 05:56:17 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-1-1000-100-1722354953 1000 yes 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1024-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-1024-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1024-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-1024-1000-100
+ env
++ date
+ echo Tue Jul 30 06:12:59 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Tue Jul 30 06:12:59 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 5971880438 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-1000-100-1722355979
+ git checkout -b scalability-yes-1024-1000-100-1722355979
Switched to a new branch 'scalability-yes-1024-1000-100-1722355979'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-1000-100-1722355979 7ce6271282] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-1000-100-1722355979 c31d7ddd4e] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 06:13:23 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 06:13:23 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1024-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-1024-1000-100-1722355979 1000 yes 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1024-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-8-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-8-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-8-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-8-1000-100
+ env
++ date
+ echo Tue Jul 30 06:30:14 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Tue Jul 30 06:30:14 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at c31d7ddd4e fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-1000-100-1722357014
+ git checkout -b scalability-yes-8-1000-100-1722357014
Switched to a new branch 'scalability-yes-8-1000-100-1722357014'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-1000-100-1722357014 e06b635a63] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-1000-100-1722357014 4f782aa078] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 06:30:38 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 06:30:38 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-8-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-8-1000-100-1722357014 1000 yes 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-8-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-512-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-512-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-512-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-512-1000-100
+ env
++ date
+ echo Tue Jul 30 06:47:18 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Tue Jul 30 06:47:18 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 4f782aa078 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-1000-100-1722358038
+ git checkout -b scalability-yes-512-1000-100-1722358038
Switched to a new branch 'scalability-yes-512-1000-100-1722358038'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-1000-100-1722358038 f19e6748eb] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-1000-100-1722358038 77ac3784ae] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 06:47:42 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 06:47:42 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-512-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-512-1000-100-1722358038 1000 yes 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-512-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-128-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-128-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-128-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-128-1000-100
+ env
++ date
+ echo Tue Jul 30 07:04:35 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Tue Jul 30 07:04:35 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 77ac3784ae fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-1000-100-1722359075
+ git checkout -b scalability-yes-128-1000-100-1722359075
Switched to a new branch 'scalability-yes-128-1000-100-1722359075'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-1000-100-1722359075 8b0c013da4] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-1000-100-1722359075 268f453862] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 07:04:59 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 07:04:59 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-128-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-128-1000-100-1722359075 1000 yes 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-128-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-32-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-32-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-32-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-32-1000-100
+ env
++ date
+ echo Tue Jul 30 07:21:47 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Tue Jul 30 07:21:47 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 268f453862 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-1000-100-1722360107
+ git checkout -b scalability-no-32-1000-100-1722360107
Switched to a new branch 'scalability-no-32-1000-100-1722360107'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-1000-100-1722360107 64b2785d89] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 07:22:11 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 07:22:11 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-32-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-32-1000-100-1722360107 1000 no 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-32-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-0-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-0-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-0-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-0-1000-100
+ env
++ date
+ echo Tue Jul 30 07:38:45 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Tue Jul 30 07:38:45 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 64b2785d89 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-1000-100-1722361126
+ git checkout -b scalability-no-0-1000-100-1722361126
Switched to a new branch 'scalability-no-0-1000-100-1722361126'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 07:39:10 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 07:39:10 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-0-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-0-1000-100-1722361126 1000 no 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-0-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-1-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-1-1000-100
+ env
++ date
+ echo Tue Jul 30 07:55:47 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Tue Jul 30 07:55:47 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-1000-100-1722362148
+ git checkout -b scalability-no-1-1000-100-1722362148
Switched to a new branch 'scalability-no-1-1000-100-1722362148'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/1/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-1000-100-1722362148 883c9a47d3] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 07:56:12 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 07:56:12 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-1-1000-100-1722362148 1000 no 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1024-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-1024-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1024-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-1024-1000-100
+ env
++ date
+ echo Tue Jul 30 08:12:56 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Tue Jul 30 08:12:56 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 883c9a47d3 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-1000-100-1722363176
+ git checkout -b scalability-no-1024-1000-100-1722363176
Switched to a new branch 'scalability-no-1024-1000-100-1722363176'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-1000-100-1722363176 7879b954e8] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 08:13:20 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 08:13:20 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1024-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-1024-1000-100-1722363176 1000 no 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1024-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-8-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-8-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-8-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-8-1000-100
+ env
++ date
+ echo Tue Jul 30 08:30:12 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Tue Jul 30 08:30:12 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 7879b954e8 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-1000-100-1722364212
+ git checkout -b scalability-no-8-1000-100-1722364212
Switched to a new branch 'scalability-no-8-1000-100-1722364212'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-1000-100-1722364212 54425cea04] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 08:30:36 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 08:30:36 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-8-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-8-1000-100-1722364212 1000 no 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-8-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-512-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-512-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-512-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-512-1000-100
+ env
++ date
+ echo Tue Jul 30 08:47:12 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Tue Jul 30 08:47:12 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 54425cea04 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-1000-100-1722365232
+ git checkout -b scalability-no-512-1000-100-1722365232
Switched to a new branch 'scalability-no-512-1000-100-1722365232'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-1000-100-1722365232 d2b7cb74f0] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 08:47:36 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 08:47:36 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-512-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-512-1000-100-1722365232 1000 no 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-512-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-128-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-128-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-128-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-128-1000-100
+ env
++ date
+ echo Tue Jul 30 09:04:26 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Tue Jul 30 09:04:26 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d2b7cb74f0 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-1000-100-1722366266
+ git checkout -b scalability-no-128-1000-100-1722366266
Switched to a new branch 'scalability-no-128-1000-100-1722366266'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-1000-100-1722366266 d0e7bcb0f7] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 09:04:50 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Tue Jul 30 09:04:50 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-128-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-128-1000-100-1722366266 1000 no 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-128-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for p in $PARTITIONS
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-32-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-32-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-32-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-32-1000-1
+ env
++ date
+ echo Tue Jul 30 09:21:37 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Tue Jul 30 09:21:37 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d0e7bcb0f7 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-1000-1-1722367297
+ git checkout -b scalability-yes-32-1000-1-1722367297
Switched to a new branch 'scalability-yes-32-1000-1-1722367297'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-1000-1-1722367297 4bc14270cb] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-1000-1-1722367297 aaab63c68d] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 09:22:24 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 09:22:24 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-32-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-32-1000-1-1722367297 1000 yes 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-32-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-0-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-0-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-0-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-0-1000-1
+ env
++ date
+ echo Tue Jul 30 09:23:39 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Tue Jul 30 09:23:39 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at aaab63c68d fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-1000-1-1722367419
+ git checkout -b scalability-yes-0-1000-1-1722367419
Switched to a new branch 'scalability-yes-0-1000-1-1722367419'
+ '[' yes == yes ']'
+ patch -p1
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-1000-1-1722367419 79cb55a989] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 09:24:26 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 09:24:26 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-0-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-0-1000-1-1722367419 1000 yes 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-0-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-1-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-1-1000-1
+ env
++ date
+ echo Tue Jul 30 09:25:40 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Tue Jul 30 09:25:40 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 79cb55a989 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-1000-1-1722367540
+ git checkout -b scalability-yes-1-1000-1-1722367540
Switched to a new branch 'scalability-yes-1-1000-1-1722367540'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-1000-1-1722367540 2db1bb7cc9] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-1000-1-1722367540 e96e133789] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 09:26:26 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 09:26:26 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-1-1000-1-1722367540 1000 yes 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1024-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-1024-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1024-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-1024-1000-1
+ env
++ date
+ echo Tue Jul 30 09:27:40 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Tue Jul 30 09:27:40 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e96e133789 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-1000-1-1722367661
+ git checkout -b scalability-yes-1024-1000-1-1722367661
Switched to a new branch 'scalability-yes-1024-1000-1-1722367661'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-1000-1-1722367661 0b74e876f9] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-1000-1-1722367661 58860a971a] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 09:28:27 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 09:28:27 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1024-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-1024-1000-1-1722367661 1000 yes 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1024-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-8-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-8-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-8-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-8-1000-1
+ env
++ date
+ echo Tue Jul 30 09:29:41 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Tue Jul 30 09:29:41 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 58860a971a fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-1000-1-1722367781
+ git checkout -b scalability-yes-8-1000-1-1722367781
Switched to a new branch 'scalability-yes-8-1000-1-1722367781'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-1000-1-1722367781 52a39c3923] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-1000-1-1722367781 08487ffc87] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 09:30:28 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 09:30:28 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-8-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-8-1000-1-1722367781 1000 yes 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-8-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-512-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-512-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-512-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-512-1000-1
+ env
++ date
+ echo Tue Jul 30 09:31:42 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Tue Jul 30 09:31:42 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 08487ffc87 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-1000-1-1722367902
+ git checkout -b scalability-yes-512-1000-1-1722367902
Switched to a new branch 'scalability-yes-512-1000-1-1722367902'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-1000-1-1722367902 0cf2c1fee8] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-1000-1-1722367902 2cae5d7748] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 09:32:29 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 09:32:29 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-512-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-512-1000-1-1722367902 1000 yes 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-512-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-128-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-128-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-128-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-128-1000-1
+ env
++ date
+ echo Tue Jul 30 09:33:43 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Tue Jul 30 09:33:43 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 2cae5d7748 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-1000-1-1722368023
+ git checkout -b scalability-yes-128-1000-1-1722368023
Switched to a new branch 'scalability-yes-128-1000-1-1722368023'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-1000-1-1722368023 adc4ab83e3] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-1000-1-1722368023 63e0635136] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 09:34:30 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 09:34:30 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-128-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-128-1000-1-1722368023 1000 yes 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-128-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-32-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-32-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-32-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-32-1000-1
+ env
++ date
+ echo Tue Jul 30 09:35:44 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Tue Jul 30 09:35:44 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 63e0635136 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-1000-1-1722368144
+ git checkout -b scalability-no-32-1000-1-1722368144
Switched to a new branch 'scalability-no-32-1000-1-1722368144'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-1000-1-1722368144 9d1b579c3d] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 09:36:30 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 09:36:30 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-32-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-32-1000-1-1722368144 1000 no 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-32-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-0-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-0-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-0-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-0-1000-1
+ env
++ date
+ echo Tue Jul 30 09:37:44 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Tue Jul 30 09:37:44 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 9d1b579c3d fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-1000-1-1722368265
+ git checkout -b scalability-no-0-1000-1-1722368265
Switched to a new branch 'scalability-no-0-1000-1-1722368265'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 09:38:31 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 09:38:31 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-0-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-0-1000-1-1722368265 1000 no 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-0-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-1-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-1-1000-1
+ env
++ date
+ echo Tue Jul 30 09:39:45 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Tue Jul 30 09:39:45 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-1000-1-1722368385
+ git checkout -b scalability-no-1-1000-1-1722368385
Switched to a new branch 'scalability-no-1-1000-1-1722368385'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-1000-1-1722368385 f387d64e7d] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 09:40:32 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 09:40:32 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-1-1000-1-1722368385 1000 no 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1024-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-1024-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1024-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-1024-1000-1
+ env
++ date
+ echo Tue Jul 30 09:41:46 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Tue Jul 30 09:41:46 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at f387d64e7d fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-1000-1-1722368506
+ git checkout -b scalability-no-1024-1000-1-1722368506
Switched to a new branch 'scalability-no-1024-1000-1-1722368506'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-1000-1-1722368506 0d7efd98b7] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 09:42:32 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 09:42:32 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1024-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-1024-1000-1-1722368506 1000 no 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1024-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-8-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-8-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-8-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-8-1000-1
+ env
++ date
+ echo Tue Jul 30 09:43:47 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Tue Jul 30 09:43:47 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 0d7efd98b7 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-1000-1-1722368627
+ git checkout -b scalability-no-8-1000-1-1722368627
Switched to a new branch 'scalability-no-8-1000-1-1722368627'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/8/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-1000-1-1722368627 c31884b9bb] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 09:44:33 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 09:44:33 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-8-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-8-1000-1-1722368627 1000 no 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-8-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-512-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-512-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-512-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-512-1000-1
+ env
++ date
+ echo Tue Jul 30 09:45:47 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Tue Jul 30 09:45:47 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at c31884b9bb fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-1000-1-1722368747
+ git checkout -b scalability-no-512-1000-1-1722368747
Switched to a new branch 'scalability-no-512-1000-1-1722368747'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-1000-1-1722368747 43933ab1cb] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 09:46:34 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 09:46:34 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-512-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-512-1000-1-1722368747 1000 no 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-512-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-128-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-128-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-128-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-128-1000-1
+ env
++ date
+ echo Tue Jul 30 09:47:48 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Tue Jul 30 09:47:48 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 43933ab1cb fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-1000-1-1722368868
+ git checkout -b scalability-no-128-1000-1-1722368868
Switched to a new branch 'scalability-no-128-1000-1-1722368868'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-1000-1-1722368868 4271daf3e6] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 09:48:35 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 09:48:35 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-128-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-128-1000-1-1722368868 1000 no 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-128-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-32-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-32-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-32-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-32-1000-1
+ env
++ date
+ echo Tue Jul 30 09:49:49 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Tue Jul 30 09:49:49 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 4271daf3e6 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-1000-1-1722368989
+ git checkout -b scalability-yes-32-1000-1-1722368989
Switched to a new branch 'scalability-yes-32-1000-1-1722368989'
+ '[' yes == yes ']'
+ patch -p1
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-1000-1-1722368989 0e10df3ed1] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-1000-1-1722368989 5bb6b6fd2c] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 09:50:13 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 09:50:13 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-32-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-32-1000-1-1722368989 1000 yes 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-32-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-0-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-0-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-0-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-0-1000-1
+ env
++ date
+ echo Tue Jul 30 09:51:27 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Tue Jul 30 09:51:27 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 5bb6b6fd2c fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-1000-1-1722369087
+ git checkout -b scalability-yes-0-1000-1-1722369087
Switched to a new branch 'scalability-yes-0-1000-1-1722369087'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-1000-1-1722369087 3f6466bd69] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 09:51:51 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 09:51:51 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-0-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-0-1000-1-1722369087 1000 yes 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-0-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-1-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-1-1000-1
+ env
++ date
+ echo Tue Jul 30 09:53:05 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Tue Jul 30 09:53:05 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 3f6466bd69 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-1000-1-1722369185
+ git checkout -b scalability-yes-1-1000-1-1722369185
Switched to a new branch 'scalability-yes-1-1000-1-1722369185'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-1000-1-1722369185 46866882c6] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-1000-1-1722369185 40add81e32] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 09:53:29 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 09:53:29 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-1-1000-1-1722369185 1000 yes 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1024-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-1024-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1024-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-1024-1000-1
+ env
++ date
+ echo Tue Jul 30 09:54:43 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Tue Jul 30 09:54:43 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 40add81e32 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-1000-1-1722369283
+ git checkout -b scalability-yes-1024-1000-1-1722369283
Switched to a new branch 'scalability-yes-1024-1000-1-1722369283'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-1000-1-1722369283 3af67176c3] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-1000-1-1722369283 955ba91c3b] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 09:55:07 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 09:55:07 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1024-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-1024-1000-1-1722369283 1000 yes 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1024-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-8-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-8-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-8-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-8-1000-1
+ env
++ date
+ echo Tue Jul 30 09:56:22 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Tue Jul 30 09:56:22 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 955ba91c3b fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-1000-1-1722369382
+ git checkout -b scalability-yes-8-1000-1-1722369382
Switched to a new branch 'scalability-yes-8-1000-1-1722369382'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-1000-1-1722369382 51782825b9] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-1000-1-1722369382 d0269c8b88] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 09:56:46 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 09:56:46 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-8-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-8-1000-1-1722369382 1000 yes 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-8-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-512-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-512-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-512-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-512-1000-1
+ env
++ date
+ echo Tue Jul 30 09:58:00 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Tue Jul 30 09:58:00 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d0269c8b88 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-1000-1-1722369480
+ git checkout -b scalability-yes-512-1000-1-1722369480
Switched to a new branch 'scalability-yes-512-1000-1-1722369480'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-1000-1-1722369480 2a322e82ec] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-1000-1-1722369480 571a76b8ac] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 09:58:24 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 09:58:24 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-512-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-512-1000-1-1722369480 1000 yes 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-512-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-128-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-128-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-128-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-128-1000-1
+ env
++ date
+ echo Tue Jul 30 09:59:38 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Tue Jul 30 09:59:38 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 571a76b8ac fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-1000-1-1722369578
+ git checkout -b scalability-yes-128-1000-1-1722369578
Switched to a new branch 'scalability-yes-128-1000-1-1722369578'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-1000-1-1722369578 5cdc19cd58] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-1000-1-1722369578 d0c4569487] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 10:00:02 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 10:00:02 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-128-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-128-1000-1-1722369578 1000 yes 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-128-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-32-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-32-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-32-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-32-1000-1
+ env
++ date
+ echo Tue Jul 30 10:01:17 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Tue Jul 30 10:01:17 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d0c4569487 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-1000-1-1722369677
+ git checkout -b scalability-no-32-1000-1-1722369677
Switched to a new branch 'scalability-no-32-1000-1-1722369677'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-1000-1-1722369677 0b9e009748] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 10:01:40 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 10:01:40 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-32-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-32-1000-1-1722369677 1000 no 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-32-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-0-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-0-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-0-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-0-1000-1
+ env
++ date
+ echo Tue Jul 30 10:02:55 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Tue Jul 30 10:02:55 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 0b9e009748 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-1000-1-1722369775
+ git checkout -b scalability-no-0-1000-1-1722369775
Switched to a new branch 'scalability-no-0-1000-1-1722369775'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 10:03:19 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 10:03:19 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-0-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-0-1000-1-1722369775 1000 no 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-0-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-1-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-1-1000-1
+ env
++ date
+ echo Tue Jul 30 10:04:33 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Tue Jul 30 10:04:33 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-1000-1-1722369873
+ git checkout -b scalability-no-1-1000-1-1722369873
Switched to a new branch 'scalability-no-1-1000-1-1722369873'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-1000-1-1722369873 e6b4c09914] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 10:04:57 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 10:04:57 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-1-1000-1-1722369873 1000 no 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1024-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-1024-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1024-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-1024-1000-1
+ env
++ date
+ echo Tue Jul 30 10:06:11 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Tue Jul 30 10:06:11 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e6b4c09914 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-1000-1-1722369971
+ git checkout -b scalability-no-1024-1000-1-1722369971
Switched to a new branch 'scalability-no-1024-1000-1-1722369971'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-1000-1-1722369971 77b0db9da3] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 10:06:35 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 10:06:35 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1024-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-1024-1000-1-1722369971 1000 no 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1024-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-8-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-8-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-8-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-8-1000-1
+ env
++ date
+ echo Tue Jul 30 10:07:49 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Tue Jul 30 10:07:49 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 77b0db9da3 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-1000-1-1722370070
+ git checkout -b scalability-no-8-1000-1-1722370070
Switched to a new branch 'scalability-no-8-1000-1-1722370070'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-1000-1-1722370070 b37156090b] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 10:08:13 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 10:08:13 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-8-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-8-1000-1-1722370070 1000 no 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-8-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-512-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-512-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-512-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-512-1000-1
+ env
++ date
+ echo Tue Jul 30 10:09:28 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Tue Jul 30 10:09:28 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b37156090b fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-1000-1-1722370168
+ git checkout -b scalability-no-512-1000-1-1722370168
Switched to a new branch 'scalability-no-512-1000-1-1722370168'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-1000-1-1722370168 2060819901] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 10:09:52 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 10:09:52 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-512-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-512-1000-1-1722370168 1000 no 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-512-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-128-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-128-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-128-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-128-1000-1
+ env
++ date
+ echo Tue Jul 30 10:11:06 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Tue Jul 30 10:11:06 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 2060819901 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-1000-1-1722370266
+ git checkout -b scalability-no-128-1000-1-1722370266
Switched to a new branch 'scalability-no-128-1000-1-1722370266'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-1000-1-1722370266 7a55978537] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 10:11:30 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 10:11:30 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-128-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-128-1000-1-1722370266 1000 no 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-128-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-32-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-32-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-32-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-32-1000-1
+ env
++ date
+ echo Tue Jul 30 10:12:44 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Tue Jul 30 10:12:44 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 7a55978537 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-1000-1-1722370364
+ git checkout -b scalability-yes-32-1000-1-1722370364
Switched to a new branch 'scalability-yes-32-1000-1-1722370364'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-1000-1-1722370364 fbe1c66182] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-1000-1-1722370364 62160387a3] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 10:13:08 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 10:13:08 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-32-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-32-1000-1-1722370364 1000 yes 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-32-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-0-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-0-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-0-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-0-1000-1
+ env
++ date
+ echo Tue Jul 30 10:14:21 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Tue Jul 30 10:14:21 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 62160387a3 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-1000-1-1722370461
+ git checkout -b scalability-yes-0-1000-1-1722370461
Switched to a new branch 'scalability-yes-0-1000-1-1722370461'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-1000-1-1722370461 f941165478] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 10:14:45 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 10:14:45 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-0-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-0-1000-1-1722370461 1000 yes 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-0-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-1-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-1-1000-1
+ env
++ date
+ echo Tue Jul 30 10:15:58 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Tue Jul 30 10:15:58 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at f941165478 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-1000-1-1722370559
+ git checkout -b scalability-yes-1-1000-1-1722370559
Switched to a new branch 'scalability-yes-1-1000-1-1722370559'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-1000-1-1722370559 ebe525c966] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/1/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-1000-1-1722370559 2b23bae521] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 10:16:22 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 10:16:22 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-1-1000-1-1722370559 1000 yes 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1024-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-1024-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1024-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-1024-1000-1
+ env
++ date
+ echo Tue Jul 30 10:17:35 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Tue Jul 30 10:17:35 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 2b23bae521 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-1000-1-1722370655
+ git checkout -b scalability-yes-1024-1000-1-1722370655
Switched to a new branch 'scalability-yes-1024-1000-1-1722370655'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-1000-1-1722370655 8c0f2667b4] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-1000-1-1722370655 3e7853fb84] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 10:17:59 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 10:17:59 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1024-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-1024-1000-1-1722370655 1000 yes 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1024-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-8-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-8-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-8-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-8-1000-1
+ env
++ date
+ echo Tue Jul 30 10:19:13 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Tue Jul 30 10:19:13 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 3e7853fb84 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-1000-1-1722370753
+ git checkout -b scalability-yes-8-1000-1-1722370753
Switched to a new branch 'scalability-yes-8-1000-1-1722370753'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-1000-1-1722370753 d66121af59] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-1000-1-1722370753 388a2d9215] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 10:19:37 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 10:19:37 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-8-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-8-1000-1-1722370753 1000 yes 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-8-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-512-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-512-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-512-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-512-1000-1
+ env
++ date
+ echo Tue Jul 30 10:20:50 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Tue Jul 30 10:20:50 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 388a2d9215 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-1000-1-1722370850
+ git checkout -b scalability-yes-512-1000-1-1722370850
Switched to a new branch 'scalability-yes-512-1000-1-1722370850'
+ '[' yes == yes ']'
+ patch -p1
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-1000-1-1722370850 b851e6c683] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-1000-1-1722370850 377c525e4a] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 10:21:14 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 10:21:14 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-512-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-512-1000-1-1722370850 1000 yes 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-512-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-128-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-128-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-128-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-128-1000-1
+ env
++ date
+ echo Tue Jul 30 10:22:27 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Tue Jul 30 10:22:27 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 377c525e4a fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-1000-1-1722370947
+ git checkout -b scalability-yes-128-1000-1-1722370947
Switched to a new branch 'scalability-yes-128-1000-1-1722370947'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-1000-1-1722370947 71f5d02930] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-1000-1-1722370947 4c8a0137e2] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 10:22:51 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 10:22:51 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-128-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-128-1000-1-1722370947 1000 yes 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-128-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-32-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-32-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-32-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-32-1000-1
+ env
++ date
+ echo Tue Jul 30 10:24:04 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Tue Jul 30 10:24:04 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 4c8a0137e2 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-1000-1-1722371044
+ git checkout -b scalability-no-32-1000-1-1722371044
Switched to a new branch 'scalability-no-32-1000-1-1722371044'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-1000-1-1722371044 c1223c8ee8] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 10:24:28 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 10:24:28 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-32-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-32-1000-1-1722371044 1000 no 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-32-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-0-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-0-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-0-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-0-1000-1
+ env
++ date
+ echo Tue Jul 30 10:25:41 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Tue Jul 30 10:25:41 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at c1223c8ee8 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-1000-1-1722371141
+ git checkout -b scalability-no-0-1000-1-1722371141
Switched to a new branch 'scalability-no-0-1000-1-1722371141'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 10:26:05 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 10:26:05 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-0-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-0-1000-1-1722371141 1000 no 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-0-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-1-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-1-1000-1
+ env
++ date
+ echo Tue Jul 30 10:27:18 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Tue Jul 30 10:27:18 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-1000-1-1722371238
+ git checkout -b scalability-no-1-1000-1-1722371238
Switched to a new branch 'scalability-no-1-1000-1-1722371238'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-1000-1-1722371238 6486703e23] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 10:27:42 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 10:27:42 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-1-1000-1-1722371238 1000 no 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1024-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-1024-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1024-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-1024-1000-1
+ env
++ date
+ echo Tue Jul 30 10:28:55 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Tue Jul 30 10:28:55 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 6486703e23 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-1000-1-1722371335
+ git checkout -b scalability-no-1024-1000-1-1722371335
Switched to a new branch 'scalability-no-1024-1000-1-1722371335'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-1000-1-1722371335 08317bd53c] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 10:29:19 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 10:29:19 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1024-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-1024-1000-1-1722371335 1000 no 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1024-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-8-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-8-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-8-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-8-1000-1
+ env
++ date
+ echo Tue Jul 30 10:30:32 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Tue Jul 30 10:30:32 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 08317bd53c fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-1000-1-1722371432
+ git checkout -b scalability-no-8-1000-1-1722371432
Switched to a new branch 'scalability-no-8-1000-1-1722371432'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-1000-1-1722371432 52783394d8] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 10:30:56 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 10:30:56 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-8-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-8-1000-1-1722371432 1000 no 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-8-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-512-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-512-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-512-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-512-1000-1
+ env
++ date
+ echo Tue Jul 30 10:32:09 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Tue Jul 30 10:32:09 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 52783394d8 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-1000-1-1722371529
+ git checkout -b scalability-no-512-1000-1-1722371529
Switched to a new branch 'scalability-no-512-1000-1-1722371529'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-1000-1-1722371529 1c07c551d1] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 10:32:33 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 10:32:33 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-512-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-512-1000-1-1722371529 1000 no 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-512-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-128-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-128-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-128-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-128-1000-1
+ env
++ date
+ echo Tue Jul 30 10:33:46 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Tue Jul 30 10:33:46 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 1c07c551d1 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-1000-1-1722371626
+ git checkout -b scalability-no-128-1000-1-1722371626
Switched to a new branch 'scalability-no-128-1000-1-1722371626'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-1000-1-1722371626 63c0785354] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 10:34:09 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 10:34:09 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-128-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-128-1000-1-1722371626 1000 no 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-128-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-32-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-32-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-32-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-32-1000-1
+ env
++ date
+ echo Tue Jul 30 10:35:23 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Tue Jul 30 10:35:23 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 63c0785354 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-1000-1-1722371723
+ git checkout -b scalability-yes-32-1000-1-1722371723
Switched to a new branch 'scalability-yes-32-1000-1-1722371723'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-1000-1-1722371723 8d3d6130f3] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-1000-1-1722371723 8c7bc4d350] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 10:35:47 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 10:35:47 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-32-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-32-1000-1-1722371723 1000 yes 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-32-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-0-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-0-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-0-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-0-1000-1
+ env
++ date
+ echo Tue Jul 30 10:37:05 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Tue Jul 30 10:37:05 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 8c7bc4d350 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-1000-1-1722371825
+ git checkout -b scalability-yes-0-1000-1-1722371825
Switched to a new branch 'scalability-yes-0-1000-1-1722371825'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-1000-1-1722371825 2d8acf4287] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 10:37:29 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 10:37:29 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-0-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-0-1000-1-1722371825 1000 yes 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-0-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-1-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-1-1000-1
+ env
++ date
+ echo Tue Jul 30 10:38:48 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Tue Jul 30 10:38:48 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 2d8acf4287 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-1000-1-1722371928
+ git checkout -b scalability-yes-1-1000-1-1722371928
Switched to a new branch 'scalability-yes-1-1000-1-1722371928'
+ '[' yes == yes ']'
+ patch -p1
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-1000-1-1722371928 138743a01c] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-1000-1-1722371928 a332cc9145] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 10:39:12 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 10:39:12 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-1-1000-1-1722371928 1000 yes 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1024-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-1024-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1024-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-1024-1000-1
+ env
++ date
+ echo Tue Jul 30 10:40:30 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Tue Jul 30 10:40:30 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a332cc9145 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-1000-1-1722372031
+ git checkout -b scalability-yes-1024-1000-1-1722372031
Switched to a new branch 'scalability-yes-1024-1000-1-1722372031'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-1000-1-1722372031 5eddb5762b] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-1000-1-1722372031 063cf44ddd] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 10:40:54 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 10:40:54 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1024-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-1024-1000-1-1722372031 1000 yes 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1024-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-8-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-8-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-8-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-8-1000-1
+ env
++ date
+ echo Tue Jul 30 10:42:13 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Tue Jul 30 10:42:13 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 063cf44ddd fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-1000-1-1722372133
+ git checkout -b scalability-yes-8-1000-1-1722372133
Switched to a new branch 'scalability-yes-8-1000-1-1722372133'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-1000-1-1722372133 7d85893e98] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-1000-1-1722372133 fffbcdac18] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 10:42:37 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 10:42:37 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-8-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-8-1000-1-1722372133 1000 yes 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-8-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-512-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-512-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-512-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-512-1000-1
+ env
++ date
+ echo Tue Jul 30 10:43:56 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Tue Jul 30 10:43:56 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at fffbcdac18 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-1000-1-1722372236
+ git checkout -b scalability-yes-512-1000-1-1722372236
Switched to a new branch 'scalability-yes-512-1000-1-1722372236'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-1000-1-1722372236 3ff3c7d68e] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-1000-1-1722372236 638e1fb4ff] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 10:44:20 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 10:44:20 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-512-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-512-1000-1-1722372236 1000 yes 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-512-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-128-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-128-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-128-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-128-1000-1
+ env
++ date
+ echo Tue Jul 30 10:45:39 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Tue Jul 30 10:45:39 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 638e1fb4ff fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-1000-1-1722372339
+ git checkout -b scalability-yes-128-1000-1-1722372339
Switched to a new branch 'scalability-yes-128-1000-1-1722372339'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-1000-1-1722372339 0d842c52d5] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-1000-1-1722372339 5055d9e14f] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 10:46:03 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 10:46:03 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-128-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-128-1000-1-1722372339 1000 yes 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-128-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-32-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-32-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-32-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-32-1000-1
+ env
++ date
+ echo Tue Jul 30 10:47:21 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Tue Jul 30 10:47:21 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 5055d9e14f fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-1000-1-1722372442
+ git checkout -b scalability-no-32-1000-1-1722372442
Switched to a new branch 'scalability-no-32-1000-1-1722372442'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/32/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-1000-1-1722372442 df19234c81] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 10:47:45 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 10:47:45 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-32-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-32-1000-1-1722372442 1000 no 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-32-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-0-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-0-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-0-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-0-1000-1
+ env
++ date
+ echo Tue Jul 30 10:49:04 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Tue Jul 30 10:49:04 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at df19234c81 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-1000-1-1722372544
+ git checkout -b scalability-no-0-1000-1-1722372544
Switched to a new branch 'scalability-no-0-1000-1-1722372544'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 10:49:28 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 10:49:28 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-0-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-0-1000-1-1722372544 1000 no 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-0-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-1-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-1-1000-1
+ env
++ date
+ echo Tue Jul 30 10:50:46 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Tue Jul 30 10:50:46 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-1000-1-1722372647
+ git checkout -b scalability-no-1-1000-1-1722372647
Switched to a new branch 'scalability-no-1-1000-1-1722372647'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-1000-1-1722372647 3dbed65040] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 10:51:10 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 10:51:10 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-1-1000-1-1722372647 1000 no 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1024-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-1024-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1024-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-1024-1000-1
+ env
++ date
+ echo Tue Jul 30 10:52:29 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Tue Jul 30 10:52:29 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 3dbed65040 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-1000-1-1722372749
+ git checkout -b scalability-no-1024-1000-1-1722372749
Switched to a new branch 'scalability-no-1024-1000-1-1722372749'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-1000-1-1722372749 19d0ed1815] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 10:52:53 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 10:52:53 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1024-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-1024-1000-1-1722372749 1000 no 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1024-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-8-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-8-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-8-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-8-1000-1
+ env
++ date
+ echo Tue Jul 30 10:54:12 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Tue Jul 30 10:54:12 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 19d0ed1815 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-1000-1-1722372852
+ git checkout -b scalability-no-8-1000-1-1722372852
Switched to a new branch 'scalability-no-8-1000-1-1722372852'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-1000-1-1722372852 9ac314938e] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 10:54:36 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 10:54:36 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-8-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-8-1000-1-1722372852 1000 no 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-8-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-512-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-512-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-512-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-512-1000-1
+ env
++ date
+ echo Tue Jul 30 10:55:54 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Tue Jul 30 10:55:54 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 9ac314938e fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-1000-1-1722372954
+ git checkout -b scalability-no-512-1000-1-1722372954
Switched to a new branch 'scalability-no-512-1000-1-1722372954'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-1000-1-1722372954 5ef0d2106c] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 10:56:18 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 10:56:18 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-512-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-512-1000-1-1722372954 1000 no 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-512-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-128-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-128-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-128-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-128-1000-1
+ env
++ date
+ echo Tue Jul 30 10:57:37 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Tue Jul 30 10:57:37 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 5ef0d2106c fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-1000-1-1722373057
+ git checkout -b scalability-no-128-1000-1-1722373057
Switched to a new branch 'scalability-no-128-1000-1-1722373057'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/128/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-1000-1-1722373057 0b3d1011a8] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 10:58:01 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 10:58:01 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-128-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-128-1000-1-1722373057 1000 no 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-128-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-32-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-32-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-32-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-32-1000-1
+ env
++ date
+ echo Tue Jul 30 10:59:20 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Tue Jul 30 10:59:20 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 0b3d1011a8 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-1000-1-1722373160
+ git checkout -b scalability-yes-32-1000-1-1722373160
Switched to a new branch 'scalability-yes-32-1000-1-1722373160'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-1000-1-1722373160 f47df5fb79] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-1000-1-1722373160 92824abc7b] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 10:59:44 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 10:59:44 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-32-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-32-1000-1-1722373160 1000 yes 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-32-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-0-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-0-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-0-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-0-1000-1
+ env
++ date
+ echo Tue Jul 30 11:01:34 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Tue Jul 30 11:01:34 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 92824abc7b fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-1000-1-1722373294
+ git checkout -b scalability-yes-0-1000-1-1722373294
Switched to a new branch 'scalability-yes-0-1000-1-1722373294'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-1000-1-1722373294 b4d831f0eb] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 11:01:58 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 11:01:58 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-0-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-0-1000-1-1722373294 1000 yes 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-0-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-1-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-1-1000-1
+ env
++ date
+ echo Tue Jul 30 11:03:49 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Tue Jul 30 11:03:49 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b4d831f0eb NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-1000-1-1722373429
+ git checkout -b scalability-yes-1-1000-1-1722373429
Switched to a new branch 'scalability-yes-1-1000-1-1722373429'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-1000-1-1722373429 1c6f47b9d5] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-1000-1-1722373429 6e6979fd73] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 11:04:13 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 11:04:13 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-1-1000-1-1722373429 1000 yes 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1024-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-1024-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1024-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-1024-1000-1
+ env
++ date
+ echo Tue Jul 30 11:06:05 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Tue Jul 30 11:06:05 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 6e6979fd73 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-1000-1-1722373565
+ git checkout -b scalability-yes-1024-1000-1-1722373565
Switched to a new branch 'scalability-yes-1024-1000-1-1722373565'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-1000-1-1722373565 d60861378d] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-1000-1-1722373565 feb610a9de] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 11:06:29 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 11:06:29 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1024-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-1024-1000-1-1722373565 1000 yes 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1024-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-8-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-8-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-8-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-8-1000-1
+ env
++ date
+ echo Tue Jul 30 11:08:19 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Tue Jul 30 11:08:19 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at feb610a9de fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-1000-1-1722373699
+ git checkout -b scalability-yes-8-1000-1-1722373699
Switched to a new branch 'scalability-yes-8-1000-1-1722373699'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-1000-1-1722373699 84bd52e38a] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-1000-1-1722373699 73a88e48c8] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 11:08:43 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 11:08:43 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-8-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-8-1000-1-1722373699 1000 yes 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-8-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-512-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-512-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-512-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-512-1000-1
+ env
++ date
+ echo Tue Jul 30 11:10:34 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Tue Jul 30 11:10:34 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 73a88e48c8 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-1000-1-1722373834
+ git checkout -b scalability-yes-512-1000-1-1722373834
Switched to a new branch 'scalability-yes-512-1000-1-1722373834'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-1000-1-1722373834 1103acbf13] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-1000-1-1722373834 a4100dcd3c] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 11:10:58 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 11:10:58 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-512-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-512-1000-1-1722373834 1000 yes 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-512-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-128-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-128-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-128-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-128-1000-1
+ env
++ date
+ echo Tue Jul 30 11:12:48 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Tue Jul 30 11:12:48 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a4100dcd3c fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-1000-1-1722373968
+ git checkout -b scalability-yes-128-1000-1-1722373968
Switched to a new branch 'scalability-yes-128-1000-1-1722373968'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-1000-1-1722373968 f69aea7157] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-1000-1-1722373968 0649280917] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 11:13:12 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 11:13:12 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-128-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-128-1000-1-1722373968 1000 yes 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-128-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-32-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-32-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-32-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-32-1000-1
+ env
++ date
+ echo Tue Jul 30 11:15:02 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Tue Jul 30 11:15:02 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 0649280917 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-1000-1-1722374103
+ git checkout -b scalability-no-32-1000-1-1722374103
Switched to a new branch 'scalability-no-32-1000-1-1722374103'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-1000-1-1722374103 aff87e33d6] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 11:15:27 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 11:15:27 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-32-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-32-1000-1-1722374103 1000 no 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-32-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-0-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-0-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-0-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-0-1000-1
+ env
++ date
+ echo Tue Jul 30 11:17:17 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Tue Jul 30 11:17:17 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at aff87e33d6 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-1000-1-1722374237
+ git checkout -b scalability-no-0-1000-1-1722374237
Switched to a new branch 'scalability-no-0-1000-1-1722374237'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 11:17:40 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 11:17:40 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-0-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-0-1000-1-1722374237 1000 no 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-0-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-1-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-1-1000-1
+ env
++ date
+ echo Tue Jul 30 11:19:32 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Tue Jul 30 11:19:32 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-1000-1-1722374372
+ git checkout -b scalability-no-1-1000-1-1722374372
Switched to a new branch 'scalability-no-1-1000-1-1722374372'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-1000-1-1722374372 a351b40d6e] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 11:19:56 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 11:19:56 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-1-1000-1-1722374372 1000 no 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1024-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-1024-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1024-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-1024-1000-1
+ env
++ date
+ echo Tue Jul 30 11:21:47 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Tue Jul 30 11:21:47 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a351b40d6e fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-1000-1-1722374507
+ git checkout -b scalability-no-1024-1000-1-1722374507
Switched to a new branch 'scalability-no-1024-1000-1-1722374507'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-1000-1-1722374507 3de8bae772] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 11:22:11 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 11:22:11 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1024-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-1024-1000-1-1722374507 1000 no 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1024-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-8-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-8-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-8-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-8-1000-1
+ env
++ date
+ echo Tue Jul 30 11:24:02 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Tue Jul 30 11:24:02 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 3de8bae772 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-1000-1-1722374642
+ git checkout -b scalability-no-8-1000-1-1722374642
Switched to a new branch 'scalability-no-8-1000-1-1722374642'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/8/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-1000-1-1722374642 eb6fc64936] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 11:24:26 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 11:24:26 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-8-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-8-1000-1-1722374642 1000 no 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-8-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-512-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-512-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-512-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-512-1000-1
+ env
++ date
+ echo Tue Jul 30 11:26:15 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Tue Jul 30 11:26:15 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at eb6fc64936 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-1000-1-1722374775
+ git checkout -b scalability-no-512-1000-1-1722374775
Switched to a new branch 'scalability-no-512-1000-1-1722374775'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-1000-1-1722374775 7c58625aee] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 11:26:39 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 11:26:39 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-512-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-512-1000-1-1722374775 1000 no 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-512-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-128-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-128-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-128-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-128-1000-1
+ env
++ date
+ echo Tue Jul 30 11:28:31 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Tue Jul 30 11:28:31 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 7c58625aee fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-1000-1-1722374911
+ git checkout -b scalability-no-128-1000-1-1722374911
Switched to a new branch 'scalability-no-128-1000-1-1722374911'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-1000-1-1722374911 e237119ba4] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 11:28:54 PM CEST 2024 'RUN   files: 1000  partitions: 1'
Tue Jul 30 11:28:54 PM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-128-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-128-1000-1-1722374911 1000 no 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-128-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for p in $PARTITIONS
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-32-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-32-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-32-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-32-1000-0
+ env
++ date
+ echo Tue Jul 30 11:30:45 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Tue Jul 30 11:30:45 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e237119ba4 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-1000-0-1722375045
+ git checkout -b scalability-yes-32-1000-0-1722375045
Switched to a new branch 'scalability-yes-32-1000-0-1722375045'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-1000-0-1722375045 7890ea0303] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-1000-0-1722375045 5ac134de50] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 11:31:31 PM CEST 2024 'RUN   files: 1000  partitions: 0'
Tue Jul 30 11:31:31 PM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-32-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-32-1000-0-1722375045 1000 yes 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-32-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-0-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-0-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-0-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-0-1000-0
+ env
++ date
+ echo Tue Jul 30 11:32:45 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Tue Jul 30 11:32:45 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 5ac134de50 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-1000-0-1722375166
+ git checkout -b scalability-yes-0-1000-0-1722375166
Switched to a new branch 'scalability-yes-0-1000-0-1722375166'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-1000-0-1722375166 1e169c6540] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 11:33:32 PM CEST 2024 'RUN   files: 1000  partitions: 0'
Tue Jul 30 11:33:32 PM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-0-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-0-1000-0-1722375166 1000 yes 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-0-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-1-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-1-1000-0
+ env
++ date
+ echo Tue Jul 30 11:34:46 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Tue Jul 30 11:34:46 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 1e169c6540 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-1000-0-1722375286
+ git checkout -b scalability-yes-1-1000-0-1722375286
Switched to a new branch 'scalability-yes-1-1000-0-1722375286'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-1000-0-1722375286 f5a522b746] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-1000-0-1722375286 fc3dee2236] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 11:35:33 PM CEST 2024 'RUN   files: 1000  partitions: 0'
Tue Jul 30 11:35:33 PM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-1-1000-0-1722375286 1000 yes 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1024-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-1024-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1024-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-1024-1000-0
+ env
++ date
+ echo Tue Jul 30 11:36:47 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Tue Jul 30 11:36:47 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at fc3dee2236 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-1000-0-1722375407
+ git checkout -b scalability-yes-1024-1000-0-1722375407
Switched to a new branch 'scalability-yes-1024-1000-0-1722375407'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-1000-0-1722375407 bbf3e38348] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-1000-0-1722375407 ad03f1fcaf] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 11:37:34 PM CEST 2024 'RUN   files: 1000  partitions: 0'
Tue Jul 30 11:37:34 PM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1024-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-1024-1000-0-1722375407 1000 yes 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1024-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-8-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-8-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-8-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-8-1000-0
+ env
++ date
+ echo Tue Jul 30 11:38:48 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Tue Jul 30 11:38:48 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at ad03f1fcaf fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-1000-0-1722375528
+ git checkout -b scalability-yes-8-1000-0-1722375528
Switched to a new branch 'scalability-yes-8-1000-0-1722375528'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-1000-0-1722375528 efffefcafd] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-1000-0-1722375528 7a99fb67eb] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 11:39:34 PM CEST 2024 'RUN   files: 1000  partitions: 0'
Tue Jul 30 11:39:34 PM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-8-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-8-1000-0-1722375528 1000 yes 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-8-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-512-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-512-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-512-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-512-1000-0
+ env
++ date
+ echo Tue Jul 30 11:40:48 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Tue Jul 30 11:40:48 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 7a99fb67eb fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-1000-0-1722375648
+ git checkout -b scalability-yes-512-1000-0-1722375648
Switched to a new branch 'scalability-yes-512-1000-0-1722375648'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-1000-0-1722375648 caa993e4be] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-1000-0-1722375648 524e5742b6] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 11:41:35 PM CEST 2024 'RUN   files: 1000  partitions: 0'
Tue Jul 30 11:41:35 PM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-512-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-512-1000-0-1722375648 1000 yes 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-512-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-128-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-128-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-128-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-128-1000-0
+ env
++ date
+ echo Tue Jul 30 11:42:49 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Tue Jul 30 11:42:49 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 524e5742b6 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-1000-0-1722375769
+ git checkout -b scalability-yes-128-1000-0-1722375769
Switched to a new branch 'scalability-yes-128-1000-0-1722375769'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-1000-0-1722375769 249780f655] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-1000-0-1722375769 8ccd4f8c1b] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 11:43:36 PM CEST 2024 'RUN   files: 1000  partitions: 0'
Tue Jul 30 11:43:36 PM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-128-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-128-1000-0-1722375769 1000 yes 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-128-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-32-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-32-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-32-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-32-1000-0
+ env
++ date
+ echo Tue Jul 30 11:44:49 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Tue Jul 30 11:44:49 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 8ccd4f8c1b fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-1000-0-1722375890
+ git checkout -b scalability-no-32-1000-0-1722375890
Switched to a new branch 'scalability-no-32-1000-0-1722375890'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-1000-0-1722375890 570ffc1f88] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 11:45:36 PM CEST 2024 'RUN   files: 1000  partitions: 0'
Tue Jul 30 11:45:36 PM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-32-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-32-1000-0-1722375890 1000 no 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-32-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-0-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-0-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-0-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-0-1000-0
+ env
++ date
+ echo Tue Jul 30 11:46:50 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Tue Jul 30 11:46:50 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 570ffc1f88 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-1000-0-1722376010
+ git checkout -b scalability-no-0-1000-0-1722376010
Switched to a new branch 'scalability-no-0-1000-0-1722376010'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 11:47:36 PM CEST 2024 'RUN   files: 1000  partitions: 0'
Tue Jul 30 11:47:36 PM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-0-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-0-1000-0-1722376010 1000 no 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-0-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-1-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-1-1000-0
+ env
++ date
+ echo Tue Jul 30 11:48:50 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Tue Jul 30 11:48:50 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-1000-0-1722376130
+ git checkout -b scalability-no-1-1000-0-1722376130
Switched to a new branch 'scalability-no-1-1000-0-1722376130'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-1000-0-1722376130 4e84b493dd] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 11:49:37 PM CEST 2024 'RUN   files: 1000  partitions: 0'
Tue Jul 30 11:49:37 PM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-1-1000-0-1722376130 1000 no 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1024-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-1024-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1024-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-1024-1000-0
+ env
++ date
+ echo Tue Jul 30 11:50:51 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Tue Jul 30 11:50:51 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 4e84b493dd fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-1000-0-1722376251
+ git checkout -b scalability-no-1024-1000-0-1722376251
Switched to a new branch 'scalability-no-1024-1000-0-1722376251'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-1000-0-1722376251 96029fc4b7] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 11:51:37 PM CEST 2024 'RUN   files: 1000  partitions: 0'
Tue Jul 30 11:51:37 PM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1024-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-1024-1000-0-1722376251 1000 no 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1024-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-8-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-8-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-8-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-8-1000-0
+ env
++ date
+ echo Tue Jul 30 11:52:51 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Tue Jul 30 11:52:51 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 96029fc4b7 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-1000-0-1722376372
+ git checkout -b scalability-no-8-1000-0-1722376372
Switched to a new branch 'scalability-no-8-1000-0-1722376372'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-1000-0-1722376372 68447e44d5] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 11:53:38 PM CEST 2024 'RUN   files: 1000  partitions: 0'
Tue Jul 30 11:53:38 PM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-8-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-8-1000-0-1722376372 1000 no 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-8-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-512-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-512-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-512-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-512-1000-0
+ env
++ date
+ echo Tue Jul 30 11:54:52 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Tue Jul 30 11:54:52 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 68447e44d5 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-1000-0-1722376492
+ git checkout -b scalability-no-512-1000-0-1722376492
Switched to a new branch 'scalability-no-512-1000-0-1722376492'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-1000-0-1722376492 d806d26bac] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 11:55:39 PM CEST 2024 'RUN   files: 1000  partitions: 0'
Tue Jul 30 11:55:39 PM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-512-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-512-1000-0-1722376492 1000 no 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-512-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-128-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-128-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-128-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-128-1000-0
+ env
++ date
+ echo Tue Jul 30 11:56:53 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Tue Jul 30 11:56:53 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d806d26bac fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-1000-0-1722376613
+ git checkout -b scalability-no-128-1000-0-1722376613
Switched to a new branch 'scalability-no-128-1000-0-1722376613'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-1000-0-1722376613 5be38ef21f] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 11:57:39 PM CEST 2024 'RUN   files: 1000  partitions: 0'
Tue Jul 30 11:57:39 PM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-128-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-128-1000-0-1722376613 1000 no 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-128-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-32-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-32-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-32-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-32-1000-0
+ env
++ date
+ echo Tue Jul 30 11:58:53 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Tue Jul 30 11:58:53 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 5be38ef21f fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-1000-0-1722376733
+ git checkout -b scalability-yes-32-1000-0-1722376733
Switched to a new branch 'scalability-yes-32-1000-0-1722376733'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-1000-0-1722376733 e1f8253795] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-1000-0-1722376733 1900bc7d5c] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Tue Jul 30 11:59:17 PM CEST 2024 'RUN   files: 1000  partitions: 0'
Tue Jul 30 11:59:17 PM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-32-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-32-1000-0-1722376733 1000 yes 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-32-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-0-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-0-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-0-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-0-1000-0
+ env
++ date
+ echo Wed Jul 31 12:00:31 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Wed Jul 31 12:00:31 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 1900bc7d5c fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-1000-0-1722376832
+ git checkout -b scalability-yes-0-1000-0-1722376832
Switched to a new branch 'scalability-yes-0-1000-0-1722376832'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-1000-0-1722376832 0a5666e2f2] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:00:56 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 12:00:56 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-0-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-0-1000-0-1722376832 1000 yes 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-0-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-1-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-1-1000-0
+ env
++ date
+ echo Wed Jul 31 12:02:10 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Wed Jul 31 12:02:10 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 0a5666e2f2 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-1000-0-1722376930
+ git checkout -b scalability-yes-1-1000-0-1722376930
Switched to a new branch 'scalability-yes-1-1000-0-1722376930'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-1000-0-1722376930 c773c0c6f6] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-1000-0-1722376930 020d995130] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:02:34 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 12:02:34 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-1-1000-0-1722376930 1000 yes 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1024-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-1024-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1024-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-1024-1000-0
+ env
++ date
+ echo Wed Jul 31 12:03:48 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Wed Jul 31 12:03:48 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 020d995130 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-1000-0-1722377028
+ git checkout -b scalability-yes-1024-1000-0-1722377028
Switched to a new branch 'scalability-yes-1024-1000-0-1722377028'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-1000-0-1722377028 c22b43b308] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-1000-0-1722377028 0529fa921c] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:04:12 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 12:04:12 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1024-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-1024-1000-0-1722377028 1000 yes 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1024-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-8-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-8-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-8-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-8-1000-0
+ env
++ date
+ echo Wed Jul 31 12:05:26 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Wed Jul 31 12:05:26 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 0529fa921c fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-1000-0-1722377126
+ git checkout -b scalability-yes-8-1000-0-1722377126
Switched to a new branch 'scalability-yes-8-1000-0-1722377126'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-1000-0-1722377126 59d87453f4] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-1000-0-1722377126 742f70e372] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:05:50 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 12:05:50 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-8-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-8-1000-0-1722377126 1000 yes 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-8-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-512-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-512-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-512-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-512-1000-0
+ env
++ date
+ echo Wed Jul 31 12:07:04 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Wed Jul 31 12:07:04 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 742f70e372 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-1000-0-1722377225
+ git checkout -b scalability-yes-512-1000-0-1722377225
Switched to a new branch 'scalability-yes-512-1000-0-1722377225'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-1000-0-1722377225 13d8920cce] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-1000-0-1722377225 51bf5bbcaa] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:07:29 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 12:07:29 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-512-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-512-1000-0-1722377225 1000 yes 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-512-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-128-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-128-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-128-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-128-1000-0
+ env
++ date
+ echo Wed Jul 31 12:08:43 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Wed Jul 31 12:08:43 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 51bf5bbcaa fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-1000-0-1722377323
+ git checkout -b scalability-yes-128-1000-0-1722377323
Switched to a new branch 'scalability-yes-128-1000-0-1722377323'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-1000-0-1722377323 2152a4b887] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-1000-0-1722377323 a0fa6aee85] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:09:07 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 12:09:07 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-128-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-128-1000-0-1722377323 1000 yes 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-128-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-32-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-32-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-32-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-32-1000-0
+ env
++ date
+ echo Wed Jul 31 12:10:21 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Wed Jul 31 12:10:21 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a0fa6aee85 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-1000-0-1722377421
+ git checkout -b scalability-no-32-1000-0-1722377421
Switched to a new branch 'scalability-no-32-1000-0-1722377421'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-1000-0-1722377421 d2dc45d11a] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:10:45 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 12:10:45 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-32-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-32-1000-0-1722377421 1000 no 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-32-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-0-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-0-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-0-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-0-1000-0
+ env
++ date
+ echo Wed Jul 31 12:11:59 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Wed Jul 31 12:11:59 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d2dc45d11a fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-1000-0-1722377519
+ git checkout -b scalability-no-0-1000-0-1722377519
Switched to a new branch 'scalability-no-0-1000-0-1722377519'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:12:23 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 12:12:23 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-0-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-0-1000-0-1722377519 1000 no 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-0-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-1-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-1-1000-0
+ env
++ date
+ echo Wed Jul 31 12:13:37 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Wed Jul 31 12:13:37 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-1000-0-1722377617
+ git checkout -b scalability-no-1-1000-0-1722377617
Switched to a new branch 'scalability-no-1-1000-0-1722377617'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-1000-0-1722377617 d0d0d82ce4] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:14:01 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 12:14:01 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-1-1000-0-1722377617 1000 no 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1024-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-1024-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1024-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-1024-1000-0
+ env
++ date
+ echo Wed Jul 31 12:15:15 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Wed Jul 31 12:15:15 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d0d0d82ce4 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-1000-0-1722377715
+ git checkout -b scalability-no-1024-1000-0-1722377715
Switched to a new branch 'scalability-no-1024-1000-0-1722377715'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-1000-0-1722377715 0d085078bf] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:15:39 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 12:15:39 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1024-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-1024-1000-0-1722377715 1000 no 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1024-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-8-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-8-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-8-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-8-1000-0
+ env
++ date
+ echo Wed Jul 31 12:16:53 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Wed Jul 31 12:16:53 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 0d085078bf fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-1000-0-1722377813
+ git checkout -b scalability-no-8-1000-0-1722377813
Switched to a new branch 'scalability-no-8-1000-0-1722377813'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/8/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-1000-0-1722377813 15260ff8c6] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:17:17 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 12:17:17 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-8-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-8-1000-0-1722377813 1000 no 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-8-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-512-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-512-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-512-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-512-1000-0
+ env
++ date
+ echo Wed Jul 31 12:18:31 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Wed Jul 31 12:18:31 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 15260ff8c6 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-1000-0-1722377912
+ git checkout -b scalability-no-512-1000-0-1722377912
Switched to a new branch 'scalability-no-512-1000-0-1722377912'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-1000-0-1722377912 6ff3eb6afb] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:18:55 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 12:18:55 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-512-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-512-1000-0-1722377912 1000 no 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-512-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-128-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-128-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-128-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-128-1000-0
+ env
++ date
+ echo Wed Jul 31 12:20:09 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Wed Jul 31 12:20:09 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 6ff3eb6afb fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-1000-0-1722378010
+ git checkout -b scalability-no-128-1000-0-1722378010
Switched to a new branch 'scalability-no-128-1000-0-1722378010'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-1000-0-1722378010 f1b402621f] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:20:34 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 12:20:34 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-128-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-128-1000-0-1722378010 1000 no 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-128-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-32-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-32-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-32-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-32-1000-0
+ env
++ date
+ echo Wed Jul 31 12:21:48 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Wed Jul 31 12:21:48 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at f1b402621f fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-1000-0-1722378108
+ git checkout -b scalability-yes-32-1000-0-1722378108
Switched to a new branch 'scalability-yes-32-1000-0-1722378108'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-1000-0-1722378108 ce931b25a3] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-1000-0-1722378108 79257d22da] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:22:12 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 12:22:12 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-32-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-32-1000-0-1722378108 1000 yes 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-32-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-0-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-0-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-0-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-0-1000-0
+ env
++ date
+ echo Wed Jul 31 12:23:25 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Wed Jul 31 12:23:25 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 79257d22da fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-1000-0-1722378205
+ git checkout -b scalability-yes-0-1000-0-1722378205
Switched to a new branch 'scalability-yes-0-1000-0-1722378205'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-1000-0-1722378205 b36c413a19] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:23:49 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 12:23:49 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-0-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-0-1000-0-1722378205 1000 yes 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-0-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-1-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-1-1000-0
+ env
++ date
+ echo Wed Jul 31 12:25:02 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Wed Jul 31 12:25:02 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b36c413a19 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-1000-0-1722378302
+ git checkout -b scalability-yes-1-1000-0-1722378302
Switched to a new branch 'scalability-yes-1-1000-0-1722378302'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-1000-0-1722378302 24b96c4dbd] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-1000-0-1722378302 23bfbdd16a] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:25:26 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 12:25:26 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-1-1000-0-1722378302 1000 yes 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1024-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-1024-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1024-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-1024-1000-0
+ env
++ date
+ echo Wed Jul 31 12:26:39 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Wed Jul 31 12:26:39 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 23bfbdd16a fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-1000-0-1722378399
+ git checkout -b scalability-yes-1024-1000-0-1722378399
Switched to a new branch 'scalability-yes-1024-1000-0-1722378399'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-1000-0-1722378399 4552f71e07] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-1000-0-1722378399 2bec6f6b14] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:27:03 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 12:27:03 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1024-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-1024-1000-0-1722378399 1000 yes 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1024-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-8-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-8-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-8-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-8-1000-0
+ env
++ date
+ echo Wed Jul 31 12:28:16 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Wed Jul 31 12:28:16 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 2bec6f6b14 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-1000-0-1722378496
+ git checkout -b scalability-yes-8-1000-0-1722378496
Switched to a new branch 'scalability-yes-8-1000-0-1722378496'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-1000-0-1722378496 c67f86bf58] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-1000-0-1722378496 2bffadc112] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:28:40 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 12:28:40 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-8-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-8-1000-0-1722378496 1000 yes 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-8-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-512-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-512-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-512-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-512-1000-0
+ env
++ date
+ echo Wed Jul 31 12:29:53 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Wed Jul 31 12:29:53 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 2bffadc112 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-1000-0-1722378593
+ git checkout -b scalability-yes-512-1000-0-1722378593
Switched to a new branch 'scalability-yes-512-1000-0-1722378593'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-1000-0-1722378593 2ceeda9638] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-1000-0-1722378593 a792306002] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:30:17 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 12:30:17 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-512-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-512-1000-0-1722378593 1000 yes 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-512-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-128-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-128-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-128-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-128-1000-0
+ env
++ date
+ echo Wed Jul 31 12:31:30 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Wed Jul 31 12:31:30 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a792306002 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-1000-0-1722378690
+ git checkout -b scalability-yes-128-1000-0-1722378690
Switched to a new branch 'scalability-yes-128-1000-0-1722378690'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-1000-0-1722378690 930c92a95a] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-1000-0-1722378690 720c2db0a2] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:31:54 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 12:31:54 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-128-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-128-1000-0-1722378690 1000 yes 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-128-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-32-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-32-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-32-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-32-1000-0
+ env
++ date
+ echo Wed Jul 31 12:33:07 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Wed Jul 31 12:33:07 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 720c2db0a2 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-1000-0-1722378787
+ git checkout -b scalability-no-32-1000-0-1722378787
Switched to a new branch 'scalability-no-32-1000-0-1722378787'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/32/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-1000-0-1722378787 8c7dde8922] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:33:31 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 12:33:31 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-32-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-32-1000-0-1722378787 1000 no 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-32-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-0-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-0-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-0-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-0-1000-0
+ env
++ date
+ echo Wed Jul 31 12:34:44 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Wed Jul 31 12:34:44 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 8c7dde8922 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-1000-0-1722378884
+ git checkout -b scalability-no-0-1000-0-1722378884
Switched to a new branch 'scalability-no-0-1000-0-1722378884'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:35:08 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 12:35:08 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-0-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-0-1000-0-1722378884 1000 no 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-0-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-1-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-1-1000-0
+ env
++ date
+ echo Wed Jul 31 12:36:21 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Wed Jul 31 12:36:21 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-1000-0-1722378981
+ git checkout -b scalability-no-1-1000-0-1722378981
Switched to a new branch 'scalability-no-1-1000-0-1722378981'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-1000-0-1722378981 da5c48a556] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:36:45 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 12:36:45 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-1-1000-0-1722378981 1000 no 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1024-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-1024-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1024-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-1024-1000-0
+ env
++ date
+ echo Wed Jul 31 12:37:58 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Wed Jul 31 12:37:58 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at da5c48a556 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-1000-0-1722379078
+ git checkout -b scalability-no-1024-1000-0-1722379078
Switched to a new branch 'scalability-no-1024-1000-0-1722379078'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-1000-0-1722379078 21adf7f3a5] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:38:21 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 12:38:21 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1024-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-1024-1000-0-1722379078 1000 no 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1024-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-8-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-8-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-8-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-8-1000-0
+ env
++ date
+ echo Wed Jul 31 12:39:35 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Wed Jul 31 12:39:35 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 21adf7f3a5 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-1000-0-1722379175
+ git checkout -b scalability-no-8-1000-0-1722379175
Switched to a new branch 'scalability-no-8-1000-0-1722379175'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-1000-0-1722379175 9daaecf2ca] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:39:59 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 12:39:59 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-8-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-8-1000-0-1722379175 1000 no 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-8-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-512-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-512-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-512-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-512-1000-0
+ env
++ date
+ echo Wed Jul 31 12:41:12 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Wed Jul 31 12:41:12 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 9daaecf2ca fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-1000-0-1722379272
+ git checkout -b scalability-no-512-1000-0-1722379272
Switched to a new branch 'scalability-no-512-1000-0-1722379272'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-1000-0-1722379272 3f9a1452cd] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:41:36 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 12:41:36 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-512-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-512-1000-0-1722379272 1000 no 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-512-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-128-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-128-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-128-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-128-1000-0
+ env
++ date
+ echo Wed Jul 31 12:42:49 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Wed Jul 31 12:42:49 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 3f9a1452cd fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-1000-0-1722379369
+ git checkout -b scalability-no-128-1000-0-1722379369
Switched to a new branch 'scalability-no-128-1000-0-1722379369'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-1000-0-1722379369 43f862ac13] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:43:13 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 12:43:13 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-128-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-128-1000-0-1722379369 1000 no 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-128-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-32-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-32-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-32-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-32-1000-0
+ env
++ date
+ echo Wed Jul 31 12:44:26 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Wed Jul 31 12:44:26 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 43f862ac13 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-1000-0-1722379466
+ git checkout -b scalability-yes-32-1000-0-1722379466
Switched to a new branch 'scalability-yes-32-1000-0-1722379466'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-1000-0-1722379466 584ba89260] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-1000-0-1722379466 9f8bc514d7] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:44:50 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 12:44:50 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-32-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-32-1000-0-1722379466 1000 yes 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-32-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-0-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-0-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-0-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-0-1000-0
+ env
++ date
+ echo Wed Jul 31 12:46:08 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Wed Jul 31 12:46:08 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 9f8bc514d7 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-1000-0-1722379568
+ git checkout -b scalability-yes-0-1000-0-1722379568
Switched to a new branch 'scalability-yes-0-1000-0-1722379568'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-1000-0-1722379568 bafecfa309] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:46:32 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 12:46:32 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-0-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-0-1000-0-1722379568 1000 yes 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-0-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-1-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-1-1000-0
+ env
++ date
+ echo Wed Jul 31 12:47:51 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Wed Jul 31 12:47:51 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at bafecfa309 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-1000-0-1722379671
+ git checkout -b scalability-yes-1-1000-0-1722379671
Switched to a new branch 'scalability-yes-1-1000-0-1722379671'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-1000-0-1722379671 da359a9043] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-1000-0-1722379671 dd79ea0132] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:48:15 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 12:48:15 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-1-1000-0-1722379671 1000 yes 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1024-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-1024-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1024-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-1024-1000-0
+ env
++ date
+ echo Wed Jul 31 12:49:33 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Wed Jul 31 12:49:33 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at dd79ea0132 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-1000-0-1722379773
+ git checkout -b scalability-yes-1024-1000-0-1722379773
Switched to a new branch 'scalability-yes-1024-1000-0-1722379773'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-1000-0-1722379773 cadb6e7b46] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-1000-0-1722379773 356c69730c] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:49:57 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 12:49:57 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1024-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-1024-1000-0-1722379773 1000 yes 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1024-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-8-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-8-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-8-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-8-1000-0
+ env
++ date
+ echo Wed Jul 31 12:51:15 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Wed Jul 31 12:51:15 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 356c69730c fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-1000-0-1722379875
+ git checkout -b scalability-yes-8-1000-0-1722379875
Switched to a new branch 'scalability-yes-8-1000-0-1722379875'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-1000-0-1722379875 b61c2d147a] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-1000-0-1722379875 69e8ca2ed3] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:51:39 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 12:51:39 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-8-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-8-1000-0-1722379875 1000 yes 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-8-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-512-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-512-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-512-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-512-1000-0
+ env
++ date
+ echo Wed Jul 31 12:52:58 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Wed Jul 31 12:52:58 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 69e8ca2ed3 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-1000-0-1722379978
+ git checkout -b scalability-yes-512-1000-0-1722379978
Switched to a new branch 'scalability-yes-512-1000-0-1722379978'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-1000-0-1722379978 c0155c6184] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-1000-0-1722379978 5f94087664] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:53:22 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 12:53:22 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-512-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-512-1000-0-1722379978 1000 yes 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-512-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-128-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-128-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-128-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-128-1000-0
+ env
++ date
+ echo Wed Jul 31 12:54:40 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Wed Jul 31 12:54:40 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 5f94087664 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-1000-0-1722380081
+ git checkout -b scalability-yes-128-1000-0-1722380081
Switched to a new branch 'scalability-yes-128-1000-0-1722380081'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-1000-0-1722380081 c86c1171b6] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-1000-0-1722380081 e070946005] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:55:04 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 12:55:04 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-128-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-128-1000-0-1722380081 1000 yes 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-128-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-32-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-32-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-32-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-32-1000-0
+ env
++ date
+ echo Wed Jul 31 12:56:23 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Wed Jul 31 12:56:23 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e070946005 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-1000-0-1722380183
+ git checkout -b scalability-no-32-1000-0-1722380183
Switched to a new branch 'scalability-no-32-1000-0-1722380183'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-1000-0-1722380183 437575d75c] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:56:47 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 12:56:47 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-32-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-32-1000-0-1722380183 1000 no 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-32-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-0-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-0-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-0-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-0-1000-0
+ env
++ date
+ echo Wed Jul 31 12:58:05 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Wed Jul 31 12:58:05 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 437575d75c fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-1000-0-1722380285
+ git checkout -b scalability-no-0-1000-0-1722380285
Switched to a new branch 'scalability-no-0-1000-0-1722380285'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:58:29 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 12:58:29 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-0-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-0-1000-0-1722380285 1000 no 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-0-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-1-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-1-1000-0
+ env
++ date
+ echo Wed Jul 31 12:59:48 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Wed Jul 31 12:59:48 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-1000-0-1722380388
+ git checkout -b scalability-no-1-1000-0-1722380388
Switched to a new branch 'scalability-no-1-1000-0-1722380388'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-1000-0-1722380388 e64d68fba1] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 01:00:12 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 01:00:12 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-1-1000-0-1722380388 1000 no 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1024-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-1024-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1024-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-1024-1000-0
+ env
++ date
+ echo Wed Jul 31 01:01:30 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Wed Jul 31 01:01:30 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e64d68fba1 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-1000-0-1722380490
+ git checkout -b scalability-no-1024-1000-0-1722380490
Switched to a new branch 'scalability-no-1024-1000-0-1722380490'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-1000-0-1722380490 13f17d9dfc] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 01:01:54 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 01:01:54 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1024-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-1024-1000-0-1722380490 1000 no 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1024-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-8-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-8-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-8-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-8-1000-0
+ env
++ date
+ echo Wed Jul 31 01:03:13 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Wed Jul 31 01:03:13 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 13f17d9dfc fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-1000-0-1722380593
+ git checkout -b scalability-no-8-1000-0-1722380593
Switched to a new branch 'scalability-no-8-1000-0-1722380593'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-1000-0-1722380593 e6431b3807] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 01:03:36 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 01:03:36 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-8-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-8-1000-0-1722380593 1000 no 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-8-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-512-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-512-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-512-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-512-1000-0
+ env
++ date
+ echo Wed Jul 31 01:04:55 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Wed Jul 31 01:04:55 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e6431b3807 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-1000-0-1722380695
+ git checkout -b scalability-no-512-1000-0-1722380695
Switched to a new branch 'scalability-no-512-1000-0-1722380695'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-1000-0-1722380695 459407f27c] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 01:05:19 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 01:05:19 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-512-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-512-1000-0-1722380695 1000 no 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-512-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-128-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-128-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-128-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-128-1000-0
+ env
++ date
+ echo Wed Jul 31 01:06:38 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Wed Jul 31 01:06:38 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 459407f27c fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-1000-0-1722380798
+ git checkout -b scalability-no-128-1000-0-1722380798
Switched to a new branch 'scalability-no-128-1000-0-1722380798'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-1000-0-1722380798 fc38b10f4d] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 01:07:01 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 01:07:01 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-128-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-128-1000-0-1722380798 1000 no 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-128-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-32-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-32-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-32-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-32-1000-0
+ env
++ date
+ echo Wed Jul 31 01:08:20 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Wed Jul 31 01:08:20 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at fc38b10f4d fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-1000-0-1722380900
+ git checkout -b scalability-yes-32-1000-0-1722380900
Switched to a new branch 'scalability-yes-32-1000-0-1722380900'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-1000-0-1722380900 b8dd2ff6b9] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-1000-0-1722380900 08d9670baa] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 01:08:44 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 01:08:44 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-32-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-32-1000-0-1722380900 1000 yes 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-32-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-0-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-0-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-0-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-0-1000-0
+ env
++ date
+ echo Wed Jul 31 01:08:47 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Wed Jul 31 01:08:47 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 08d9670baa fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-1000-0-1722380927
+ git checkout -b scalability-yes-0-1000-0-1722380927
Switched to a new branch 'scalability-yes-0-1000-0-1722380927'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-1000-0-1722380927 718708776f] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 01:09:11 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 01:09:11 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-0-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-0-1000-0-1722380927 1000 yes 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-0-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-1-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-1-1000-0
+ env
++ date
+ echo Wed Jul 31 01:09:14 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Wed Jul 31 01:09:14 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 718708776f NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-1000-0-1722380954
+ git checkout -b scalability-yes-1-1000-0-1722380954
Switched to a new branch 'scalability-yes-1-1000-0-1722380954'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-1000-0-1722380954 9ab17b7a0d] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-1000-0-1722380954 b92aca1103] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 01:09:38 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 01:09:38 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-1-1000-0-1722380954 1000 yes 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1024-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-1024-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1024-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-1024-1000-0
+ env
++ date
+ echo Wed Jul 31 01:09:40 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Wed Jul 31 01:09:40 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b92aca1103 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-1000-0-1722380980
+ git checkout -b scalability-yes-1024-1000-0-1722380980
Switched to a new branch 'scalability-yes-1024-1000-0-1722380980'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-1000-0-1722380980 1ec3735ccd] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-1000-0-1722380980 1837039bbe] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 01:10:04 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 01:10:04 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1024-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-1024-1000-0-1722380980 1000 yes 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1024-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-8-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-8-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-8-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-8-1000-0
+ env
++ date
+ echo Wed Jul 31 01:10:07 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Wed Jul 31 01:10:07 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 1837039bbe fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-1000-0-1722381007
+ git checkout -b scalability-yes-8-1000-0-1722381007
Switched to a new branch 'scalability-yes-8-1000-0-1722381007'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-1000-0-1722381007 9fd292f641] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-1000-0-1722381007 3be01222a9] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 01:10:31 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 01:10:31 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-8-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-8-1000-0-1722381007 1000 yes 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-8-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-512-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-512-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-512-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-512-1000-0
+ env
++ date
+ echo Wed Jul 31 01:10:34 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Wed Jul 31 01:10:34 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 3be01222a9 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-1000-0-1722381034
+ git checkout -b scalability-yes-512-1000-0-1722381034
Switched to a new branch 'scalability-yes-512-1000-0-1722381034'
+ '[' yes == yes ']'
+ patch -p1
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-1000-0-1722381034 4ae07d7d01] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-1000-0-1722381034 1f3fab1eea] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 01:10:58 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 01:10:58 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-512-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-512-1000-0-1722381034 1000 yes 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-512-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-128-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-128-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-128-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-128-1000-0
+ env
++ date
+ echo Wed Jul 31 01:11:01 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Wed Jul 31 01:11:01 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 1f3fab1eea fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-1000-0-1722381061
+ git checkout -b scalability-yes-128-1000-0-1722381061
Switched to a new branch 'scalability-yes-128-1000-0-1722381061'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-1000-0-1722381061 a41e355c8d] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-1000-0-1722381061 7509316b2d] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 01:11:25 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 01:11:25 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-128-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-128-1000-0-1722381061 1000 yes 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-128-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-32-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-32-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-32-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-32-1000-0
+ env
++ date
+ echo Wed Jul 31 01:11:28 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Wed Jul 31 01:11:28 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 7509316b2d fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-1000-0-1722381088
+ git checkout -b scalability-no-32-1000-0-1722381088
Switched to a new branch 'scalability-no-32-1000-0-1722381088'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-1000-0-1722381088 a88c12559c] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 01:11:52 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 01:11:52 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-32-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-32-1000-0-1722381088 1000 no 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-32-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-0-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-0-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-0-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-0-1000-0
+ env
++ date
+ echo Wed Jul 31 01:11:54 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Wed Jul 31 01:11:54 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a88c12559c fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-1000-0-1722381115
+ git checkout -b scalability-no-0-1000-0-1722381115
Switched to a new branch 'scalability-no-0-1000-0-1722381115'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 01:12:18 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 01:12:18 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-0-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-0-1000-0-1722381115 1000 no 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-0-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-1-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-1-1000-0
+ env
++ date
+ echo Wed Jul 31 01:12:21 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Wed Jul 31 01:12:21 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-1000-0-1722381141
+ git checkout -b scalability-no-1-1000-0-1722381141
Switched to a new branch 'scalability-no-1-1000-0-1722381141'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-1000-0-1722381141 eac809bf6e] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 01:12:45 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 01:12:45 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-1-1000-0-1722381141 1000 no 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1024-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-1024-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1024-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-1024-1000-0
+ env
++ date
+ echo Wed Jul 31 01:12:48 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Wed Jul 31 01:12:48 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at eac809bf6e fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-1000-0-1722381168
+ git checkout -b scalability-no-1024-1000-0-1722381168
Switched to a new branch 'scalability-no-1024-1000-0-1722381168'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/1024/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-1000-0-1722381168 a4e5fa3f92] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 01:13:12 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 01:13:12 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1024-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-1024-1000-0-1722381168 1000 no 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1024-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-8-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-8-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-8-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-8-1000-0
+ env
++ date
+ echo Wed Jul 31 01:13:15 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Wed Jul 31 01:13:15 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a4e5fa3f92 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-1000-0-1722381195
+ git checkout -b scalability-no-8-1000-0-1722381195
Switched to a new branch 'scalability-no-8-1000-0-1722381195'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-1000-0-1722381195 f961f79332] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 01:13:39 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 01:13:39 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-8-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-8-1000-0-1722381195 1000 no 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-8-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-512-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-512-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-512-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-512-1000-0
+ env
++ date
+ echo Wed Jul 31 01:13:41 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Wed Jul 31 01:13:41 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at f961f79332 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-1000-0-1722381222
+ git checkout -b scalability-no-512-1000-0-1722381222
Switched to a new branch 'scalability-no-512-1000-0-1722381222'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-1000-0-1722381222 24c5f45a52] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 01:14:05 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 01:14:05 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-512-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-512-1000-0-1722381222 1000 no 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-512-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-128-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-128-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-128-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-128-1000-0
+ env
++ date
+ echo Wed Jul 31 01:14:08 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Wed Jul 31 01:14:08 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 24c5f45a52 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-1000-0-1722381248
+ git checkout -b scalability-no-128-1000-0-1722381248
Switched to a new branch 'scalability-no-128-1000-0-1722381248'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-1000-0-1722381248 4c07b72cab] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 01:14:32 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Wed Jul 31 01:14:32 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-128-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-128-1000-0-1722381248 1000 no 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-128-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for files in 1000 32768
+ for p in $PARTITIONS
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-32-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-32-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-32-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-32-32768-1000
+ env
++ date
+ echo Wed Jul 31 01:14:34 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Wed Jul 31 01:14:34 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 4c07b72cab fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-32768-1000-1722381275
+ git checkout -b scalability-yes-32-32768-1000-1722381275
Switched to a new branch 'scalability-yes-32-32768-1000-1722381275'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-32768-1000-1722381275 2880754d67] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-32768-1000-1722381275 daa34569d2] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 01:15:21 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 01:15:21 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-32-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-32-32768-1000-1722381275 32768 yes 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-32-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-0-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-0-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-0-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-0-32768-1000
+ env
++ date
+ echo Wed Jul 31 01:16:42 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Wed Jul 31 01:16:42 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at daa34569d2 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-32768-1000-1722381402
+ git checkout -b scalability-yes-0-32768-1000-1722381402
Switched to a new branch 'scalability-yes-0-32768-1000-1722381402'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-32768-1000-1722381402 8262ba3460] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 01:17:29 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 01:17:29 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-0-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-0-32768-1000-1722381402 32768 yes 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-0-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-1-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-1-32768-1000
+ env
++ date
+ echo Wed Jul 31 01:18:49 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Wed Jul 31 01:18:49 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 8262ba3460 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-32768-1000-1722381529
+ git checkout -b scalability-yes-1-32768-1000-1722381529
Switched to a new branch 'scalability-yes-1-32768-1000-1722381529'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-32768-1000-1722381529 570baf482d] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-32768-1000-1722381529 cac01f9aae] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 01:19:36 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 01:19:36 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-1-32768-1000-1722381529 32768 yes 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1024-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-1024-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1024-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-1024-32768-1000
+ env
++ date
+ echo Wed Jul 31 01:20:56 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Wed Jul 31 01:20:56 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at cac01f9aae fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-32768-1000-1722381656
+ git checkout -b scalability-yes-1024-32768-1000-1722381656
Switched to a new branch 'scalability-yes-1024-32768-1000-1722381656'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-32768-1000-1722381656 00ca10250a] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-32768-1000-1722381656 8ccbe27c0a] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 01:21:43 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 01:21:43 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1024-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-1024-32768-1000-1722381656 32768 yes 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1024-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-8-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-8-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-8-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-8-32768-1000
+ env
++ date
+ echo Wed Jul 31 01:23:03 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Wed Jul 31 01:23:03 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 8ccbe27c0a fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-32768-1000-1722381783
+ git checkout -b scalability-yes-8-32768-1000-1722381783
Switched to a new branch 'scalability-yes-8-32768-1000-1722381783'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-32768-1000-1722381783 467c41bcab] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-32768-1000-1722381783 2df70fca2f] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 01:23:50 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 01:23:50 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-8-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-8-32768-1000-1722381783 32768 yes 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-8-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-512-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-512-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-512-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-512-32768-1000
+ env
++ date
+ echo Wed Jul 31 01:25:10 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Wed Jul 31 01:25:10 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 2df70fca2f fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-32768-1000-1722381910
+ git checkout -b scalability-yes-512-32768-1000-1722381910
Switched to a new branch 'scalability-yes-512-32768-1000-1722381910'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-32768-1000-1722381910 a3cde1844f] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/512/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-32768-1000-1722381910 12c8e9da92] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 01:25:57 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 01:25:57 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-512-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-512-32768-1000-1722381910 32768 yes 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-512-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-128-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-128-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-128-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-128-32768-1000
+ env
++ date
+ echo Wed Jul 31 01:27:17 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Wed Jul 31 01:27:17 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 12c8e9da92 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-32768-1000-1722382038
+ git checkout -b scalability-yes-128-32768-1000-1722382038
Switched to a new branch 'scalability-yes-128-32768-1000-1722382038'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-32768-1000-1722382038 6cdb68f666] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-32768-1000-1722382038 fefb4ac2b1] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 01:28:04 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 01:28:04 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-128-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-128-32768-1000-1722382038 32768 yes 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-128-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-32-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-32-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-32-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-32-32768-1000
+ env
++ date
+ echo Wed Jul 31 01:29:24 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Wed Jul 31 01:29:24 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at fefb4ac2b1 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-32768-1000-1722382165
+ git checkout -b scalability-no-32-32768-1000-1722382165
Switched to a new branch 'scalability-no-32-32768-1000-1722382165'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-32768-1000-1722382165 85ff2c5574] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 01:30:11 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 01:30:11 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-32-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-32-32768-1000-1722382165 32768 no 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-32-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-0-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-0-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-0-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-0-32768-1000
+ env
++ date
+ echo Wed Jul 31 01:31:31 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Wed Jul 31 01:31:31 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 85ff2c5574 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-32768-1000-1722382292
+ git checkout -b scalability-no-0-32768-1000-1722382292
Switched to a new branch 'scalability-no-0-32768-1000-1722382292'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 01:32:18 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 01:32:18 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-0-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-0-32768-1000-1722382292 32768 no 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-0-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-1-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-1-32768-1000
+ env
++ date
+ echo Wed Jul 31 01:33:39 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Wed Jul 31 01:33:39 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-32768-1000-1722382419
+ git checkout -b scalability-no-1-32768-1000-1722382419
Switched to a new branch 'scalability-no-1-32768-1000-1722382419'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-32768-1000-1722382419 bef3fc3971] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 01:34:26 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 01:34:26 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-1-32768-1000-1722382419 32768 no 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1024-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-1024-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1024-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-1024-32768-1000
+ env
++ date
+ echo Wed Jul 31 01:35:46 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Wed Jul 31 01:35:46 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at bef3fc3971 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-32768-1000-1722382546
+ git checkout -b scalability-no-1024-32768-1000-1722382546
Switched to a new branch 'scalability-no-1024-32768-1000-1722382546'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/1024/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-32768-1000-1722382546 2711cf2b7c] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 01:36:33 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 01:36:33 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1024-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-1024-32768-1000-1722382546 32768 no 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1024-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-8-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-8-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-8-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-8-32768-1000
+ env
++ date
+ echo Wed Jul 31 01:37:53 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Wed Jul 31 01:37:53 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 2711cf2b7c fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-32768-1000-1722382673
+ git checkout -b scalability-no-8-32768-1000-1722382673
Switched to a new branch 'scalability-no-8-32768-1000-1722382673'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-32768-1000-1722382673 e538acc193] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 01:38:40 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 01:38:40 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-8-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-8-32768-1000-1722382673 32768 no 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-8-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-512-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-512-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-512-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-512-32768-1000
+ env
++ date
+ echo Wed Jul 31 01:40:00 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Wed Jul 31 01:40:00 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e538acc193 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-32768-1000-1722382800
+ git checkout -b scalability-no-512-32768-1000-1722382800
Switched to a new branch 'scalability-no-512-32768-1000-1722382800'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-32768-1000-1722382800 59e7934ba9] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 01:40:47 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 01:40:47 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-512-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-512-32768-1000-1722382800 32768 no 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-512-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-128-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-128-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-128-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-128-32768-1000
+ env
++ date
+ echo Wed Jul 31 01:42:07 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Wed Jul 31 01:42:07 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 59e7934ba9 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-32768-1000-1722382927
+ git checkout -b scalability-no-128-32768-1000-1722382927
Switched to a new branch 'scalability-no-128-32768-1000-1722382927'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-32768-1000-1722382927 8f37438b97] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 01:42:54 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 01:42:54 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-128-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-128-32768-1000-1722382927 32768 no 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-128-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-32-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-32-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-32-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-32-32768-1000
+ env
++ date
+ echo Wed Jul 31 01:44:14 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Wed Jul 31 01:44:14 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 8f37438b97 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-32768-1000-1722383054
+ git checkout -b scalability-yes-32-32768-1000-1722383054
Switched to a new branch 'scalability-yes-32-32768-1000-1722383054'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-32768-1000-1722383054 9299c065ef] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-32768-1000-1722383054 7797d30d75] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 01:44:38 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 01:44:38 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-32-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-32-32768-1000-1722383054 32768 yes 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-32-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-0-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-0-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-0-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-0-32768-1000
+ env
++ date
+ echo Wed Jul 31 01:46:33 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Wed Jul 31 01:46:33 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 7797d30d75 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-32768-1000-1722383193
+ git checkout -b scalability-yes-0-32768-1000-1722383193
Switched to a new branch 'scalability-yes-0-32768-1000-1722383193'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-32768-1000-1722383193 ab54f23fed] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 01:46:57 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 01:46:57 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-0-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-0-32768-1000-1722383193 32768 yes 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-0-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-1-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-1-32768-1000
+ env
++ date
+ echo Wed Jul 31 01:48:53 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Wed Jul 31 01:48:53 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at ab54f23fed NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-32768-1000-1722383333
+ git checkout -b scalability-yes-1-32768-1000-1722383333
Switched to a new branch 'scalability-yes-1-32768-1000-1722383333'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-32768-1000-1722383333 576960c190] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-32768-1000-1722383333 dd27e61a66] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 01:49:17 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 01:49:17 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-1-32768-1000-1722383333 32768 yes 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1024-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-1024-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1024-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-1024-32768-1000
+ env
++ date
+ echo Wed Jul 31 01:51:13 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Wed Jul 31 01:51:13 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at dd27e61a66 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-32768-1000-1722383473
+ git checkout -b scalability-yes-1024-32768-1000-1722383473
Switched to a new branch 'scalability-yes-1024-32768-1000-1722383473'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-32768-1000-1722383473 e0154ef259] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-32768-1000-1722383473 a5a6afcd09] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 01:51:37 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 01:51:37 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1024-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-1024-32768-1000-1722383473 32768 yes 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1024-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-8-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-8-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-8-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-8-32768-1000
+ env
++ date
+ echo Wed Jul 31 01:53:34 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Wed Jul 31 01:53:34 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a5a6afcd09 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-32768-1000-1722383614
+ git checkout -b scalability-yes-8-32768-1000-1722383614
Switched to a new branch 'scalability-yes-8-32768-1000-1722383614'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-32768-1000-1722383614 4aaf2724f3] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-32768-1000-1722383614 8086aa047b] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 01:53:58 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 01:53:58 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-8-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-8-32768-1000-1722383614 32768 yes 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-8-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-512-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-512-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-512-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-512-32768-1000
+ env
++ date
+ echo Wed Jul 31 01:55:54 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Wed Jul 31 01:55:54 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 8086aa047b fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-32768-1000-1722383754
+ git checkout -b scalability-yes-512-32768-1000-1722383754
Switched to a new branch 'scalability-yes-512-32768-1000-1722383754'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-32768-1000-1722383754 2c9f13f9c5] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-32768-1000-1722383754 a93d6e7454] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 01:56:18 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 01:56:18 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-512-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-512-32768-1000-1722383754 32768 yes 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-512-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-128-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-128-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-128-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-128-32768-1000
+ env
++ date
+ echo Wed Jul 31 01:58:14 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Wed Jul 31 01:58:14 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a93d6e7454 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-32768-1000-1722383895
+ git checkout -b scalability-yes-128-32768-1000-1722383895
Switched to a new branch 'scalability-yes-128-32768-1000-1722383895'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-32768-1000-1722383895 3090fbb78f] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-32768-1000-1722383895 b6f3b846d8] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 01:58:39 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 01:58:39 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-128-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-128-32768-1000-1722383895 32768 yes 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-128-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-32-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-32-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-32-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-32-32768-1000
+ env
++ date
+ echo Wed Jul 31 02:00:34 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Wed Jul 31 02:00:34 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b6f3b846d8 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-32768-1000-1722384035
+ git checkout -b scalability-no-32-32768-1000-1722384035
Switched to a new branch 'scalability-no-32-32768-1000-1722384035'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-32768-1000-1722384035 ada975a3d4] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 02:00:58 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 02:00:58 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-32-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-32-32768-1000-1722384035 32768 no 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-32-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-0-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-0-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-0-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-0-32768-1000
+ env
++ date
+ echo Wed Jul 31 02:02:54 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Wed Jul 31 02:02:54 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at ada975a3d4 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-32768-1000-1722384174
+ git checkout -b scalability-no-0-32768-1000-1722384174
Switched to a new branch 'scalability-no-0-32768-1000-1722384174'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 02:03:18 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 02:03:18 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-0-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-0-32768-1000-1722384174 32768 no 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-0-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-1-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-1-32768-1000
+ env
++ date
+ echo Wed Jul 31 02:05:14 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Wed Jul 31 02:05:14 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-32768-1000-1722384314
+ git checkout -b scalability-no-1-32768-1000-1722384314
Switched to a new branch 'scalability-no-1-32768-1000-1722384314'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-32768-1000-1722384314 925cacc0a2] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 02:05:38 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 02:05:38 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-1-32768-1000-1722384314 32768 no 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1024-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-1024-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1024-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-1024-32768-1000
+ env
++ date
+ echo Wed Jul 31 02:07:34 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Wed Jul 31 02:07:34 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 925cacc0a2 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-32768-1000-1722384454
+ git checkout -b scalability-no-1024-32768-1000-1722384454
Switched to a new branch 'scalability-no-1024-32768-1000-1722384454'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-32768-1000-1722384454 e3e17bfa65] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 02:07:58 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 02:07:58 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1024-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-1024-32768-1000-1722384454 32768 no 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1024-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-8-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-8-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-8-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-8-32768-1000
+ env
++ date
+ echo Wed Jul 31 02:09:55 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Wed Jul 31 02:09:55 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e3e17bfa65 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-32768-1000-1722384595
+ git checkout -b scalability-no-8-32768-1000-1722384595
Switched to a new branch 'scalability-no-8-32768-1000-1722384595'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-32768-1000-1722384595 a79f993d21] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 02:10:19 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 02:10:19 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-8-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-8-32768-1000-1722384595 32768 no 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-8-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-512-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-512-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-512-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-512-32768-1000
+ env
++ date
+ echo Wed Jul 31 02:12:15 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Wed Jul 31 02:12:15 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a79f993d21 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-32768-1000-1722384735
+ git checkout -b scalability-no-512-32768-1000-1722384735
Switched to a new branch 'scalability-no-512-32768-1000-1722384735'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-32768-1000-1722384735 feef2566af] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 02:12:39 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 02:12:39 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-512-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-512-32768-1000-1722384735 32768 no 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-512-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-128-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-128-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-128-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-128-32768-1000
+ env
++ date
+ echo Wed Jul 31 02:14:35 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Wed Jul 31 02:14:35 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at feef2566af fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-32768-1000-1722384876
+ git checkout -b scalability-no-128-32768-1000-1722384876
Switched to a new branch 'scalability-no-128-32768-1000-1722384876'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/128/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-32768-1000-1722384876 57b9a6eefe] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 02:14:59 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 02:14:59 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-128-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-128-32768-1000-1722384876 32768 no 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-128-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-32-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-32-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-32-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-32-32768-1000
+ env
++ date
+ echo Wed Jul 31 02:16:55 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Wed Jul 31 02:16:55 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 57b9a6eefe fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-32768-1000-1722385015
+ git checkout -b scalability-yes-32-32768-1000-1722385015
Switched to a new branch 'scalability-yes-32-32768-1000-1722385015'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-32768-1000-1722385015 7043c01ba2] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-32768-1000-1722385015 13daef7dbf] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 02:17:19 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 02:17:19 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-32-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-32-32768-1000-1722385015 32768 yes 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-32-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-0-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-0-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-0-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-0-32768-1000
+ env
++ date
+ echo Wed Jul 31 02:18:41 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Wed Jul 31 02:18:41 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 13daef7dbf fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-32768-1000-1722385121
+ git checkout -b scalability-yes-0-32768-1000-1722385121
Switched to a new branch 'scalability-yes-0-32768-1000-1722385121'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-32768-1000-1722385121 7d8d0c0ad8] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 02:19:05 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 02:19:05 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-0-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-0-32768-1000-1722385121 32768 yes 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-0-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-1-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-1-32768-1000
+ env
++ date
+ echo Wed Jul 31 02:20:27 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Wed Jul 31 02:20:27 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 7d8d0c0ad8 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-32768-1000-1722385227
+ git checkout -b scalability-yes-1-32768-1000-1722385227
Switched to a new branch 'scalability-yes-1-32768-1000-1722385227'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-32768-1000-1722385227 50a17d8560] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-32768-1000-1722385227 b133d2d853] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 02:20:51 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 02:20:51 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-1-32768-1000-1722385227 32768 yes 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1024-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-1024-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1024-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-1024-32768-1000
+ env
++ date
+ echo Wed Jul 31 02:22:13 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Wed Jul 31 02:22:13 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b133d2d853 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-32768-1000-1722385333
+ git checkout -b scalability-yes-1024-32768-1000-1722385333
Switched to a new branch 'scalability-yes-1024-32768-1000-1722385333'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-32768-1000-1722385333 380156bd25] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-32768-1000-1722385333 dcdb8c9a82] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 02:22:37 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 02:22:37 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1024-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-1024-32768-1000-1722385333 32768 yes 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1024-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-8-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-8-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-8-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-8-32768-1000
+ env
++ date
+ echo Wed Jul 31 02:24:02 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Wed Jul 31 02:24:02 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at dcdb8c9a82 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-32768-1000-1722385443
+ git checkout -b scalability-yes-8-32768-1000-1722385443
Switched to a new branch 'scalability-yes-8-32768-1000-1722385443'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-32768-1000-1722385443 ca1d5667a8] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-32768-1000-1722385443 4393b5447c] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 02:24:26 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 02:24:26 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-8-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-8-32768-1000-1722385443 32768 yes 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-8-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-512-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-512-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-512-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-512-32768-1000
+ env
++ date
+ echo Wed Jul 31 02:25:48 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Wed Jul 31 02:25:48 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 4393b5447c fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-32768-1000-1722385548
+ git checkout -b scalability-yes-512-32768-1000-1722385548
Switched to a new branch 'scalability-yes-512-32768-1000-1722385548'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-32768-1000-1722385548 9d83e25699] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-32768-1000-1722385548 5290fee334] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 02:26:12 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 02:26:12 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-512-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-512-32768-1000-1722385548 32768 yes 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-512-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-128-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-128-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-128-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-128-32768-1000
+ env
++ date
+ echo Wed Jul 31 02:27:36 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Wed Jul 31 02:27:36 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 5290fee334 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-32768-1000-1722385656
+ git checkout -b scalability-yes-128-32768-1000-1722385656
Switched to a new branch 'scalability-yes-128-32768-1000-1722385656'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-32768-1000-1722385656 1f50d7b1b8] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-32768-1000-1722385656 8bd8af89bc] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 02:28:00 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 02:28:00 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-128-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-128-32768-1000-1722385656 32768 yes 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-128-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-32-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-32-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-32-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-32-32768-1000
+ env
++ date
+ echo Wed Jul 31 02:29:23 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Wed Jul 31 02:29:23 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 8bd8af89bc fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-32768-1000-1722385763
+ git checkout -b scalability-no-32-32768-1000-1722385763
Switched to a new branch 'scalability-no-32-32768-1000-1722385763'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-32768-1000-1722385763 308856b577] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 02:29:47 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 02:29:47 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-32-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-32-32768-1000-1722385763 32768 no 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-32-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-0-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-0-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-0-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-0-32768-1000
+ env
++ date
+ echo Wed Jul 31 02:31:09 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Wed Jul 31 02:31:09 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 308856b577 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-32768-1000-1722385869
+ git checkout -b scalability-no-0-32768-1000-1722385869
Switched to a new branch 'scalability-no-0-32768-1000-1722385869'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ head -n 1000
+ git log
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 02:31:33 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 02:31:33 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-0-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-0-32768-1000-1722385869 32768 no 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-0-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-1-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-1-32768-1000
+ env
++ date
+ echo Wed Jul 31 02:32:55 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Wed Jul 31 02:32:55 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-32768-1000-1722385976
+ git checkout -b scalability-no-1-32768-1000-1722385976
Switched to a new branch 'scalability-no-1-32768-1000-1722385976'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/1/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-32768-1000-1722385976 aaeba2e686] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 02:33:19 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 02:33:19 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-1-32768-1000-1722385976 32768 no 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1024-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-1024-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1024-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-1024-32768-1000
+ env
++ date
+ echo Wed Jul 31 02:34:41 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Wed Jul 31 02:34:41 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at aaeba2e686 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-32768-1000-1722386081
+ git checkout -b scalability-no-1024-32768-1000-1722386081
Switched to a new branch 'scalability-no-1024-32768-1000-1722386081'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-32768-1000-1722386081 aab8cd3d14] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 02:35:05 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 02:35:05 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1024-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-1024-32768-1000-1722386081 32768 no 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1024-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-8-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-8-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-8-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-8-32768-1000
+ env
++ date
+ echo Wed Jul 31 02:36:30 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Wed Jul 31 02:36:30 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at aab8cd3d14 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-32768-1000-1722386190
+ git checkout -b scalability-no-8-32768-1000-1722386190
Switched to a new branch 'scalability-no-8-32768-1000-1722386190'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-32768-1000-1722386190 84077ca704] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 02:36:54 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 02:36:54 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-8-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-8-32768-1000-1722386190 32768 no 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-8-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-512-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-512-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-512-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-512-32768-1000
+ env
++ date
+ echo Wed Jul 31 02:38:16 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Wed Jul 31 02:38:16 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 84077ca704 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-32768-1000-1722386297
+ git checkout -b scalability-no-512-32768-1000-1722386297
Switched to a new branch 'scalability-no-512-32768-1000-1722386297'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/512/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-32768-1000-1722386297 2e20c1c438] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 02:38:40 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 02:38:40 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-512-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-512-32768-1000-1722386297 32768 no 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-512-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-128-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-128-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-128-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-128-32768-1000
+ env
++ date
+ echo Wed Jul 31 02:40:04 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Wed Jul 31 02:40:04 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 2e20c1c438 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-32768-1000-1722386404
+ git checkout -b scalability-no-128-32768-1000-1722386404
Switched to a new branch 'scalability-no-128-32768-1000-1722386404'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-32768-1000-1722386404 e51818301c] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 02:40:28 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 02:40:28 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-128-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-128-32768-1000-1722386404 32768 no 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-128-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-32-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-32-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-32-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-32-32768-1000
+ env
++ date
+ echo Wed Jul 31 02:41:50 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Wed Jul 31 02:41:50 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e51818301c fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-32768-1000-1722386511
+ git checkout -b scalability-yes-32-32768-1000-1722386511
Switched to a new branch 'scalability-yes-32-32768-1000-1722386511'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-32768-1000-1722386511 82e675f84e] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-32768-1000-1722386511 1c97c58826] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 02:42:14 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 02:42:14 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-32-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-32-32768-1000-1722386511 32768 yes 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-32-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-0-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-0-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-0-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-0-32768-1000
+ env
++ date
+ echo Wed Jul 31 02:43:46 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Wed Jul 31 02:43:46 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 1c97c58826 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-32768-1000-1722386626
+ git checkout -b scalability-yes-0-32768-1000-1722386626
Switched to a new branch 'scalability-yes-0-32768-1000-1722386626'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-32768-1000-1722386626 aa988dd719] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 02:44:10 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 02:44:10 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-0-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-0-32768-1000-1722386626 32768 yes 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-0-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-1-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-1-32768-1000
+ env
++ date
+ echo Wed Jul 31 02:45:41 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Wed Jul 31 02:45:41 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at aa988dd719 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-32768-1000-1722386742
+ git checkout -b scalability-yes-1-32768-1000-1722386742
Switched to a new branch 'scalability-yes-1-32768-1000-1722386742'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-32768-1000-1722386742 8f191ceff9] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-32768-1000-1722386742 de886df048] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 02:46:05 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 02:46:05 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-1-32768-1000-1722386742 32768 yes 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1024-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-1024-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1024-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-1024-32768-1000
+ env
++ date
+ echo Wed Jul 31 02:47:37 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Wed Jul 31 02:47:37 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at de886df048 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-32768-1000-1722386857
+ git checkout -b scalability-yes-1024-32768-1000-1722386857
Switched to a new branch 'scalability-yes-1024-32768-1000-1722386857'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-32768-1000-1722386857 de95b50504] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-32768-1000-1722386857 623a05a8ee] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 02:48:01 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 02:48:01 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1024-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-1024-32768-1000-1722386857 32768 yes 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1024-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-8-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-8-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-8-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-8-32768-1000
+ env
++ date
+ echo Wed Jul 31 02:49:33 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Wed Jul 31 02:49:33 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 623a05a8ee fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-32768-1000-1722386973
+ git checkout -b scalability-yes-8-32768-1000-1722386973
Switched to a new branch 'scalability-yes-8-32768-1000-1722386973'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-32768-1000-1722386973 239771ec72] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-32768-1000-1722386973 f96e59a702] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 02:49:57 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 02:49:57 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-8-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-8-32768-1000-1722386973 32768 yes 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-8-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-512-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-512-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-512-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-512-32768-1000
+ env
++ date
+ echo Wed Jul 31 02:51:28 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Wed Jul 31 02:51:28 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at f96e59a702 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-32768-1000-1722387089
+ git checkout -b scalability-yes-512-32768-1000-1722387089
Switched to a new branch 'scalability-yes-512-32768-1000-1722387089'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-32768-1000-1722387089 3ded908fa7] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-32768-1000-1722387089 ad02bca7d3] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 02:51:52 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 02:51:52 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-512-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-512-32768-1000-1722387089 32768 yes 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-512-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-128-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-128-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-128-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-128-32768-1000
+ env
++ date
+ echo Wed Jul 31 02:53:24 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Wed Jul 31 02:53:24 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at ad02bca7d3 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-32768-1000-1722387204
+ git checkout -b scalability-yes-128-32768-1000-1722387204
Switched to a new branch 'scalability-yes-128-32768-1000-1722387204'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-32768-1000-1722387204 e2e03a6d1d] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-32768-1000-1722387204 447c476ad3] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 02:53:48 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 02:53:48 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-128-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-128-32768-1000-1722387204 32768 yes 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-128-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-32-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-32-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-32-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-32-32768-1000
+ env
++ date
+ echo Wed Jul 31 02:55:20 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Wed Jul 31 02:55:20 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 447c476ad3 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-32768-1000-1722387320
+ git checkout -b scalability-no-32-32768-1000-1722387320
Switched to a new branch 'scalability-no-32-32768-1000-1722387320'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-32768-1000-1722387320 172ec7f952] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 02:55:44 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 02:55:44 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-32-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-32-32768-1000-1722387320 32768 no 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-32-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-0-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-0-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-0-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-0-32768-1000
+ env
++ date
+ echo Wed Jul 31 02:57:15 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Wed Jul 31 02:57:15 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 172ec7f952 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-32768-1000-1722387435
+ git checkout -b scalability-no-0-32768-1000-1722387435
Switched to a new branch 'scalability-no-0-32768-1000-1722387435'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 02:57:39 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 02:57:39 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-0-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-0-32768-1000-1722387435 32768 no 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-0-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-1-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-1-32768-1000
+ env
++ date
+ echo Wed Jul 31 02:59:11 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Wed Jul 31 02:59:11 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-32768-1000-1722387551
+ git checkout -b scalability-no-1-32768-1000-1722387551
Switched to a new branch 'scalability-no-1-32768-1000-1722387551'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-32768-1000-1722387551 663ce034a8] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 02:59:35 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 02:59:35 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-1-32768-1000-1722387551 32768 no 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1024-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-1024-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1024-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-1024-32768-1000
+ env
++ date
+ echo Wed Jul 31 03:01:07 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Wed Jul 31 03:01:07 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 663ce034a8 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-32768-1000-1722387667
+ git checkout -b scalability-no-1024-32768-1000-1722387667
Switched to a new branch 'scalability-no-1024-32768-1000-1722387667'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-32768-1000-1722387667 5f83b4cc32] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 03:01:31 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 03:01:31 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1024-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-1024-32768-1000-1722387667 32768 no 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1024-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-8-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-8-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-8-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-8-32768-1000
+ env
++ date
+ echo Wed Jul 31 03:03:03 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Wed Jul 31 03:03:03 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 5f83b4cc32 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-32768-1000-1722387783
+ git checkout -b scalability-no-8-32768-1000-1722387783
Switched to a new branch 'scalability-no-8-32768-1000-1722387783'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/8/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-32768-1000-1722387783 f5fae87f98] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 03:03:27 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 03:03:27 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-8-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-8-32768-1000-1722387783 32768 no 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-8-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-512-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-512-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-512-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-512-32768-1000
+ env
++ date
+ echo Wed Jul 31 03:04:58 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Wed Jul 31 03:04:58 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at f5fae87f98 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-32768-1000-1722387898
+ git checkout -b scalability-no-512-32768-1000-1722387898
Switched to a new branch 'scalability-no-512-32768-1000-1722387898'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-32768-1000-1722387898 3bca183094] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 03:05:22 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 03:05:22 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-512-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-512-32768-1000-1722387898 32768 no 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-512-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-128-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-128-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-128-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-128-32768-1000
+ env
++ date
+ echo Wed Jul 31 03:06:54 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Wed Jul 31 03:06:54 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 3bca183094 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-32768-1000-1722388014
+ git checkout -b scalability-no-128-32768-1000-1722388014
Switched to a new branch 'scalability-no-128-32768-1000-1722388014'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-32768-1000-1722388014 3f9624a594] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 03:07:18 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 03:07:18 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-128-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-128-32768-1000-1722388014 32768 no 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-128-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-32-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-32-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-32-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-32-32768-1000
+ env
++ date
+ echo Wed Jul 31 03:08:49 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Wed Jul 31 03:08:49 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 3f9624a594 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-32768-1000-1722388130
+ git checkout -b scalability-yes-32-32768-1000-1722388130
Switched to a new branch 'scalability-yes-32-32768-1000-1722388130'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-32768-1000-1722388130 7f4bad09ff] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-32768-1000-1722388130 7b793f2377] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 03:09:13 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 03:09:13 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-32-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-32-32768-1000-1722388130 32768 yes 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-32-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-0-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-0-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-0-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-0-32768-1000
+ env
++ date
+ echo Wed Jul 31 03:09:16 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Wed Jul 31 03:09:16 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 7b793f2377 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-32768-1000-1722388157
+ git checkout -b scalability-yes-0-32768-1000-1722388157
Switched to a new branch 'scalability-yes-0-32768-1000-1722388157'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-32768-1000-1722388157 8d98a93f06] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 03:09:41 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 03:09:41 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-0-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-0-32768-1000-1722388157 32768 yes 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-0-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-1-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-1-32768-1000
+ env
++ date
+ echo Wed Jul 31 03:09:44 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Wed Jul 31 03:09:44 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 8d98a93f06 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-32768-1000-1722388184
+ git checkout -b scalability-yes-1-32768-1000-1722388184
Switched to a new branch 'scalability-yes-1-32768-1000-1722388184'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-32768-1000-1722388184 4801b993b1] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-32768-1000-1722388184 f00a7da79a] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 03:10:08 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 03:10:08 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-1-32768-1000-1722388184 32768 yes 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1024-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-1024-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1024-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-1024-32768-1000
+ env
++ date
+ echo Wed Jul 31 03:10:11 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Wed Jul 31 03:10:11 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at f00a7da79a fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-32768-1000-1722388211
+ git checkout -b scalability-yes-1024-32768-1000-1722388211
Switched to a new branch 'scalability-yes-1024-32768-1000-1722388211'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-32768-1000-1722388211 ba63fb4382] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-32768-1000-1722388211 31885f2998] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 03:10:35 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 03:10:35 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1024-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-1024-32768-1000-1722388211 32768 yes 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1024-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-8-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-8-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-8-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-8-32768-1000
+ env
++ date
+ echo Wed Jul 31 03:10:38 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Wed Jul 31 03:10:38 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 31885f2998 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-32768-1000-1722388238
+ git checkout -b scalability-yes-8-32768-1000-1722388238
Switched to a new branch 'scalability-yes-8-32768-1000-1722388238'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-32768-1000-1722388238 bc3698d99f] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-32768-1000-1722388238 c8c9e47d0f] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 03:11:02 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 03:11:02 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-8-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-8-32768-1000-1722388238 32768 yes 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-8-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-512-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-512-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-512-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-512-32768-1000
+ env
++ date
+ echo Wed Jul 31 03:11:05 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Wed Jul 31 03:11:05 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at c8c9e47d0f fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-32768-1000-1722388265
+ git checkout -b scalability-yes-512-32768-1000-1722388265
Switched to a new branch 'scalability-yes-512-32768-1000-1722388265'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-32768-1000-1722388265 7a8bf28595] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-32768-1000-1722388265 1545450113] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 03:11:29 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 03:11:29 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-512-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-512-32768-1000-1722388265 32768 yes 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-512-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-128-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-128-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-128-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-128-32768-1000
+ env
++ date
+ echo Wed Jul 31 03:11:31 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Wed Jul 31 03:11:31 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 1545450113 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-32768-1000-1722388292
+ git checkout -b scalability-yes-128-32768-1000-1722388292
Switched to a new branch 'scalability-yes-128-32768-1000-1722388292'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-32768-1000-1722388292 dbdd006d5f] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-32768-1000-1722388292 6ed4677e59] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 03:11:56 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 03:11:56 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-128-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-128-32768-1000-1722388292 32768 yes 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-128-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-32-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-32-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-32-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-32-32768-1000
+ env
++ date
+ echo Wed Jul 31 03:11:59 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Wed Jul 31 03:11:59 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 6ed4677e59 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-32768-1000-1722388319
+ git checkout -b scalability-no-32-32768-1000-1722388319
Switched to a new branch 'scalability-no-32-32768-1000-1722388319'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-32768-1000-1722388319 deaece3967] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 03:12:23 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 03:12:23 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-32-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-32-32768-1000-1722388319 32768 no 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-32-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-0-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-0-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-0-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-0-32768-1000
+ env
++ date
+ echo Wed Jul 31 03:12:26 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Wed Jul 31 03:12:26 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at deaece3967 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-32768-1000-1722388346
+ git checkout -b scalability-no-0-32768-1000-1722388346
Switched to a new branch 'scalability-no-0-32768-1000-1722388346'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 03:12:50 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 03:12:50 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-0-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-0-32768-1000-1722388346 32768 no 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-0-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-1-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-1-32768-1000
+ env
++ date
+ echo Wed Jul 31 03:12:52 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Wed Jul 31 03:12:52 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-32768-1000-1722388373
+ git checkout -b scalability-no-1-32768-1000-1722388373
Switched to a new branch 'scalability-no-1-32768-1000-1722388373'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-32768-1000-1722388373 5e6438d4de] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 03:13:16 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 03:13:16 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-1-32768-1000-1722388373 32768 no 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1024-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-1024-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1024-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-1024-32768-1000
+ env
++ date
+ echo Wed Jul 31 03:13:19 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Wed Jul 31 03:13:19 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 5e6438d4de fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-32768-1000-1722388399
+ git checkout -b scalability-no-1024-32768-1000-1722388399
Switched to a new branch 'scalability-no-1024-32768-1000-1722388399'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-32768-1000-1722388399 7afbbfcfff] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 03:13:43 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 03:13:43 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1024-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-1024-32768-1000-1722388399 32768 no 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1024-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-8-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-8-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-8-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-8-32768-1000
+ env
++ date
+ echo Wed Jul 31 03:13:46 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Wed Jul 31 03:13:46 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 7afbbfcfff fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-32768-1000-1722388426
+ git checkout -b scalability-no-8-32768-1000-1722388426
Switched to a new branch 'scalability-no-8-32768-1000-1722388426'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-32768-1000-1722388426 7cdb488b26] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 03:14:10 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 03:14:10 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-8-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-8-32768-1000-1722388426 32768 no 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-8-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-512-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-512-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-512-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-512-32768-1000
+ env
++ date
+ echo Wed Jul 31 03:14:13 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Wed Jul 31 03:14:13 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 7cdb488b26 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-32768-1000-1722388453
+ git checkout -b scalability-no-512-32768-1000-1722388453
Switched to a new branch 'scalability-no-512-32768-1000-1722388453'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-32768-1000-1722388453 3a34bf2f1f] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 03:14:37 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 03:14:37 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-512-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-512-32768-1000-1722388453 32768 no 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-512-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-128-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-128-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-128-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-128-32768-1000
+ env
++ date
+ echo Wed Jul 31 03:14:40 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Wed Jul 31 03:14:40 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 3a34bf2f1f fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-32768-1000-1722388480
+ git checkout -b scalability-no-128-32768-1000-1722388480
Switched to a new branch 'scalability-no-128-32768-1000-1722388480'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-32768-1000-1722388480 408404ca8c] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 03:15:04 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Wed Jul 31 03:15:04 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-128-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-128-32768-1000-1722388480 32768 no 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-128-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for p in $PARTITIONS
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-32-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-32-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-32-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-32-32768-100
+ env
++ date
+ echo Wed Jul 31 03:15:07 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Wed Jul 31 03:15:07 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 408404ca8c fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-32768-100-1722388507
+ git checkout -b scalability-yes-32-32768-100-1722388507
Switched to a new branch 'scalability-yes-32-32768-100-1722388507'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-32768-100-1722388507 92f9f79ece] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-32768-100-1722388507 4eb4c34ef6] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 03:15:53 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 03:15:53 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-32-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-32-32768-100-1722388507 32768 yes 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-32-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-0-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-0-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-0-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-0-32768-100
+ env
++ date
+ echo Wed Jul 31 03:17:09 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Wed Jul 31 03:17:09 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 4eb4c34ef6 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-32768-100-1722388629
+ git checkout -b scalability-yes-0-32768-100-1722388629
Switched to a new branch 'scalability-yes-0-32768-100-1722388629'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-32768-100-1722388629 03195d5991] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 03:17:56 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 03:17:56 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-0-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-0-32768-100-1722388629 32768 yes 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-0-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-1-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-1-32768-100
+ env
++ date
+ echo Wed Jul 31 03:19:11 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Wed Jul 31 03:19:11 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 03195d5991 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-32768-100-1722388751
+ git checkout -b scalability-yes-1-32768-100-1722388751
Switched to a new branch 'scalability-yes-1-32768-100-1722388751'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-32768-100-1722388751 0a43e40c34] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-32768-100-1722388751 febf6ce2d1] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 03:19:58 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 03:19:58 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-1-32768-100-1722388751 32768 yes 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1024-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-1024-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1024-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-1024-32768-100
+ env
++ date
+ echo Wed Jul 31 03:21:13 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Wed Jul 31 03:21:13 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at febf6ce2d1 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-32768-100-1722388873
+ git checkout -b scalability-yes-1024-32768-100-1722388873
Switched to a new branch 'scalability-yes-1024-32768-100-1722388873'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-32768-100-1722388873 c50b2a49b6] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-32768-100-1722388873 fd236742da] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 03:22:00 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 03:22:00 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1024-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-1024-32768-100-1722388873 32768 yes 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1024-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-8-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-8-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-8-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-8-32768-100
+ env
++ date
+ echo Wed Jul 31 03:23:15 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Wed Jul 31 03:23:15 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at fd236742da fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-32768-100-1722388995
+ git checkout -b scalability-yes-8-32768-100-1722388995
Switched to a new branch 'scalability-yes-8-32768-100-1722388995'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-32768-100-1722388995 04d2abdfa4] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-32768-100-1722388995 27ce5ff4e4] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 03:24:02 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 03:24:02 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-8-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-8-32768-100-1722388995 32768 yes 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-8-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-512-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-512-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-512-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-512-32768-100
+ env
++ date
+ echo Wed Jul 31 03:25:17 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Wed Jul 31 03:25:17 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 27ce5ff4e4 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-32768-100-1722389117
+ git checkout -b scalability-yes-512-32768-100-1722389117
Switched to a new branch 'scalability-yes-512-32768-100-1722389117'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-32768-100-1722389117 59e71da331] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-32768-100-1722389117 c8651783b1] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 03:26:04 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 03:26:04 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-512-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-512-32768-100-1722389117 32768 yes 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-512-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-128-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-128-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-128-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-128-32768-100
+ env
++ date
+ echo Wed Jul 31 03:27:19 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Wed Jul 31 03:27:19 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at c8651783b1 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-32768-100-1722389239
+ git checkout -b scalability-yes-128-32768-100-1722389239
Switched to a new branch 'scalability-yes-128-32768-100-1722389239'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-32768-100-1722389239 eb60bc5cb5] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-32768-100-1722389239 a7125ac724] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 03:28:06 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 03:28:06 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-128-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-128-32768-100-1722389239 32768 yes 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-128-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-32-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-32-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-32-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-32-32768-100
+ env
++ date
+ echo Wed Jul 31 03:29:21 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Wed Jul 31 03:29:21 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a7125ac724 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-32768-100-1722389361
+ git checkout -b scalability-no-32-32768-100-1722389361
Switched to a new branch 'scalability-no-32-32768-100-1722389361'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-32768-100-1722389361 e5a57933a8] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 03:30:08 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 03:30:08 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-32-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-32-32768-100-1722389361 32768 no 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-32-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-0-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-0-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-0-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-0-32768-100
+ env
++ date
+ echo Wed Jul 31 03:31:23 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Wed Jul 31 03:31:23 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e5a57933a8 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-32768-100-1722389483
+ git checkout -b scalability-no-0-32768-100-1722389483
Switched to a new branch 'scalability-no-0-32768-100-1722389483'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 03:32:10 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 03:32:10 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-0-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-0-32768-100-1722389483 32768 no 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-0-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-1-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-1-32768-100
+ env
++ date
+ echo Wed Jul 31 03:33:25 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Wed Jul 31 03:33:25 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-32768-100-1722389605
+ git checkout -b scalability-no-1-32768-100-1722389605
Switched to a new branch 'scalability-no-1-32768-100-1722389605'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-32768-100-1722389605 0e1fc7fe42] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 03:34:12 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 03:34:12 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-1-32768-100-1722389605 32768 no 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1024-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-1024-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1024-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-1024-32768-100
+ env
++ date
+ echo Wed Jul 31 03:35:27 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Wed Jul 31 03:35:27 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 0e1fc7fe42 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-32768-100-1722389727
+ git checkout -b scalability-no-1024-32768-100-1722389727
Switched to a new branch 'scalability-no-1024-32768-100-1722389727'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-32768-100-1722389727 7fbe672964] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 03:36:14 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 03:36:14 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1024-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-1024-32768-100-1722389727 32768 no 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1024-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-8-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-8-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-8-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-8-32768-100
+ env
++ date
+ echo Wed Jul 31 03:37:29 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Wed Jul 31 03:37:29 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 7fbe672964 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-32768-100-1722389849
+ git checkout -b scalability-no-8-32768-100-1722389849
Switched to a new branch 'scalability-no-8-32768-100-1722389849'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-32768-100-1722389849 72d9d4041a] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 03:38:15 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 03:38:15 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-8-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-8-32768-100-1722389849 32768 no 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-8-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-512-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-512-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-512-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-512-32768-100
+ env
++ date
+ echo Wed Jul 31 03:39:30 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Wed Jul 31 03:39:30 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 72d9d4041a fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-32768-100-1722389971
+ git checkout -b scalability-no-512-32768-100-1722389971
Switched to a new branch 'scalability-no-512-32768-100-1722389971'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/512/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-32768-100-1722389971 6c8cd1e7ca] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 03:40:17 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 03:40:17 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-512-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-512-32768-100-1722389971 32768 no 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-512-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-128-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-128-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-128-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-128-32768-100
+ env
++ date
+ echo Wed Jul 31 03:41:32 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Wed Jul 31 03:41:32 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 6c8cd1e7ca fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-32768-100-1722390092
+ git checkout -b scalability-no-128-32768-100-1722390092
Switched to a new branch 'scalability-no-128-32768-100-1722390092'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-32768-100-1722390092 e1afef1692] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 03:42:19 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 03:42:19 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-128-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-128-32768-100-1722390092 32768 no 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-128-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-32-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-32-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-32-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-32-32768-100
+ env
++ date
+ echo Wed Jul 31 03:43:34 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Wed Jul 31 03:43:34 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e1afef1692 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-32768-100-1722390214
+ git checkout -b scalability-yes-32-32768-100-1722390214
Switched to a new branch 'scalability-yes-32-32768-100-1722390214'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-32768-100-1722390214 f8e35228df] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-32768-100-1722390214 658482b99c] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 03:44:16 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 03:44:16 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-32-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-32-32768-100-1722390214 32768 yes 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-32-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-0-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-0-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-0-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-0-32768-100
+ env
++ date
+ echo Wed Jul 31 03:45:35 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Wed Jul 31 03:45:35 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 658482b99c fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-32768-100-1722390335
+ git checkout -b scalability-yes-0-32768-100-1722390335
Switched to a new branch 'scalability-yes-0-32768-100-1722390335'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-32768-100-1722390335 b550b2cff0] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 03:46:18 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 03:46:18 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-0-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-0-32768-100-1722390335 32768 yes 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-0-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-1-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-1-32768-100
+ env
++ date
+ echo Wed Jul 31 03:47:37 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Wed Jul 31 03:47:37 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b550b2cff0 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-32768-100-1722390457
+ git checkout -b scalability-yes-1-32768-100-1722390457
Switched to a new branch 'scalability-yes-1-32768-100-1722390457'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-32768-100-1722390457 f1ce4bd6d2] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-32768-100-1722390457 cd261243d6] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 03:48:20 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 03:48:20 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-1-32768-100-1722390457 32768 yes 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1024-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-1024-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1024-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-1024-32768-100
+ env
++ date
+ echo Wed Jul 31 03:49:39 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Wed Jul 31 03:49:39 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at cd261243d6 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-32768-100-1722390579
+ git checkout -b scalability-yes-1024-32768-100-1722390579
Switched to a new branch 'scalability-yes-1024-32768-100-1722390579'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-32768-100-1722390579 3cbae1b393] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-32768-100-1722390579 8fbe247888] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 03:50:21 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 03:50:21 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1024-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-1024-32768-100-1722390579 32768 yes 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1024-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-8-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-8-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-8-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-8-32768-100
+ env
++ date
+ echo Wed Jul 31 03:51:40 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Wed Jul 31 03:51:40 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 8fbe247888 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-32768-100-1722390701
+ git checkout -b scalability-yes-8-32768-100-1722390701
Switched to a new branch 'scalability-yes-8-32768-100-1722390701'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-32768-100-1722390701 b56e722b5c] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-32768-100-1722390701 b492bb772a] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 03:52:23 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 03:52:23 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-8-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-8-32768-100-1722390701 32768 yes 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-8-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-512-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-512-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-512-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-512-32768-100
+ env
++ date
+ echo Wed Jul 31 03:53:42 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Wed Jul 31 03:53:42 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b492bb772a fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-32768-100-1722390822
+ git checkout -b scalability-yes-512-32768-100-1722390822
Switched to a new branch 'scalability-yes-512-32768-100-1722390822'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-32768-100-1722390822 325c046faf] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-32768-100-1722390822 a28fe7c2e8] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 03:54:25 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 03:54:25 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-512-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-512-32768-100-1722390822 32768 yes 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-512-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-128-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-128-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-128-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-128-32768-100
+ env
++ date
+ echo Wed Jul 31 03:55:44 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Wed Jul 31 03:55:44 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a28fe7c2e8 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-32768-100-1722390944
+ git checkout -b scalability-yes-128-32768-100-1722390944
Switched to a new branch 'scalability-yes-128-32768-100-1722390944'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-32768-100-1722390944 d14c793f8d] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-32768-100-1722390944 e8f25c6423] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 03:56:27 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 03:56:27 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-128-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-128-32768-100-1722390944 32768 yes 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-128-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-32-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-32-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-32-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-32-32768-100
+ env
++ date
+ echo Wed Jul 31 03:57:46 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Wed Jul 31 03:57:46 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e8f25c6423 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-32768-100-1722391066
+ git checkout -b scalability-no-32-32768-100-1722391066
Switched to a new branch 'scalability-no-32-32768-100-1722391066'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-32768-100-1722391066 707e852422] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 03:58:29 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 03:58:29 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-32-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-32-32768-100-1722391066 32768 no 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-32-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-0-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-0-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-0-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-0-32768-100
+ env
++ date
+ echo Wed Jul 31 03:59:48 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Wed Jul 31 03:59:48 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 707e852422 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-32768-100-1722391188
+ git checkout -b scalability-no-0-32768-100-1722391188
Switched to a new branch 'scalability-no-0-32768-100-1722391188'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 04:00:31 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 04:00:31 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-0-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-0-32768-100-1722391188 32768 no 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-0-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-1-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-1-32768-100
+ env
++ date
+ echo Wed Jul 31 04:01:49 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Wed Jul 31 04:01:49 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-32768-100-1722391309
+ git checkout -b scalability-no-1-32768-100-1722391309
Switched to a new branch 'scalability-no-1-32768-100-1722391309'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-32768-100-1722391309 34494720bf] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 04:02:32 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 04:02:32 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-1-32768-100-1722391309 32768 no 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1024-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-1024-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1024-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-1024-32768-100
+ env
++ date
+ echo Wed Jul 31 04:03:51 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Wed Jul 31 04:03:51 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 34494720bf fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-32768-100-1722391431
+ git checkout -b scalability-no-1024-32768-100-1722391431
Switched to a new branch 'scalability-no-1024-32768-100-1722391431'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-32768-100-1722391431 d9b30d06ba] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 04:04:15 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 04:04:15 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1024-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-1024-32768-100-1722391431 32768 no 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1024-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-8-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-8-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-8-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-8-32768-100
+ env
++ date
+ echo Wed Jul 31 04:05:34 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Wed Jul 31 04:05:34 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d9b30d06ba fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-32768-100-1722391534
+ git checkout -b scalability-no-8-32768-100-1722391534
Switched to a new branch 'scalability-no-8-32768-100-1722391534'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-32768-100-1722391534 37e38cd1f1] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 04:05:58 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 04:05:58 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-8-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-8-32768-100-1722391534 32768 no 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-8-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-512-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-512-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-512-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-512-32768-100
+ env
++ date
+ echo Wed Jul 31 04:07:17 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Wed Jul 31 04:07:17 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 37e38cd1f1 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-32768-100-1722391637
+ git checkout -b scalability-no-512-32768-100-1722391637
Switched to a new branch 'scalability-no-512-32768-100-1722391637'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-32768-100-1722391637 6daeb7b684] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 04:07:41 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 04:07:41 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-512-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-512-32768-100-1722391637 32768 no 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-512-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-128-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-128-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-128-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-128-32768-100
+ env
++ date
+ echo Wed Jul 31 04:09:00 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Wed Jul 31 04:09:00 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 6daeb7b684 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-32768-100-1722391740
+ git checkout -b scalability-no-128-32768-100-1722391740
Switched to a new branch 'scalability-no-128-32768-100-1722391740'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-32768-100-1722391740 e9826fda00] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 04:09:24 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 04:09:24 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-128-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-128-32768-100-1722391740 32768 no 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-128-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-32-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-32-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-32-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-32-32768-100
+ env
++ date
+ echo Wed Jul 31 04:10:43 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Wed Jul 31 04:10:43 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e9826fda00 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-32768-100-1722391843
+ git checkout -b scalability-yes-32-32768-100-1722391843
Switched to a new branch 'scalability-yes-32-32768-100-1722391843'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-32768-100-1722391843 eca264fc4b] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-32768-100-1722391843 c4430dfbba] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 04:11:06 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 04:11:06 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-32-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-32-32768-100-1722391843 32768 yes 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-32-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-0-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-0-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-0-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-0-32768-100
+ env
++ date
+ echo Wed Jul 31 04:12:20 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Wed Jul 31 04:12:20 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at c4430dfbba fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-32768-100-1722391941
+ git checkout -b scalability-yes-0-32768-100-1722391941
Switched to a new branch 'scalability-yes-0-32768-100-1722391941'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-32768-100-1722391941 8ad5fa925b] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 04:12:45 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 04:12:45 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-0-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-0-32768-100-1722391941 32768 yes 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-0-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-1-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-1-32768-100
+ env
++ date
+ echo Wed Jul 31 04:13:58 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Wed Jul 31 04:13:58 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 8ad5fa925b NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-32768-100-1722392039
+ git checkout -b scalability-yes-1-32768-100-1722392039
Switched to a new branch 'scalability-yes-1-32768-100-1722392039'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-32768-100-1722392039 1210f3b90c] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-32768-100-1722392039 0fd7c0665a] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 04:14:23 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 04:14:23 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-1-32768-100-1722392039 32768 yes 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1024-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-1024-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1024-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-1024-32768-100
+ env
++ date
+ echo Wed Jul 31 04:15:36 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Wed Jul 31 04:15:36 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 0fd7c0665a fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-32768-100-1722392137
+ git checkout -b scalability-yes-1024-32768-100-1722392137
Switched to a new branch 'scalability-yes-1024-32768-100-1722392137'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-32768-100-1722392137 5e4e9f47b6] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-32768-100-1722392137 1cf87ffc37] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 04:16:00 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 04:16:00 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1024-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-1024-32768-100-1722392137 32768 yes 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1024-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-8-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-8-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-8-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-8-32768-100
+ env
++ date
+ echo Wed Jul 31 04:17:15 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Wed Jul 31 04:17:15 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 1cf87ffc37 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-32768-100-1722392235
+ git checkout -b scalability-yes-8-32768-100-1722392235
Switched to a new branch 'scalability-yes-8-32768-100-1722392235'
+ '[' yes == yes ']'
+ patch -p1
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-32768-100-1722392235 2f57d3cf7d] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-32768-100-1722392235 0b85795d2b] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 04:17:38 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 04:17:38 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-8-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-8-32768-100-1722392235 32768 yes 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-8-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-512-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-512-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-512-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-512-32768-100
+ env
++ date
+ echo Wed Jul 31 04:18:52 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Wed Jul 31 04:18:52 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 0b85795d2b fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-32768-100-1722392332
+ git checkout -b scalability-yes-512-32768-100-1722392332
Switched to a new branch 'scalability-yes-512-32768-100-1722392332'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-32768-100-1722392332 ad2dcae98a] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-32768-100-1722392332 19f4c03c97] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 04:19:16 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 04:19:16 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-512-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-512-32768-100-1722392332 32768 yes 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-512-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-128-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-128-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-128-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-128-32768-100
+ env
++ date
+ echo Wed Jul 31 04:20:30 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Wed Jul 31 04:20:30 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 19f4c03c97 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-32768-100-1722392430
+ git checkout -b scalability-yes-128-32768-100-1722392430
Switched to a new branch 'scalability-yes-128-32768-100-1722392430'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-32768-100-1722392430 106b5366f3] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-32768-100-1722392430 8012e90556] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 04:20:54 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 04:20:54 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-128-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-128-32768-100-1722392430 32768 yes 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-128-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-32-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-32-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-32-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-32-32768-100
+ env
++ date
+ echo Wed Jul 31 04:22:08 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Wed Jul 31 04:22:08 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 8012e90556 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-32768-100-1722392528
+ git checkout -b scalability-no-32-32768-100-1722392528
Switched to a new branch 'scalability-no-32-32768-100-1722392528'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-32768-100-1722392528 8e0c319ac5] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 04:22:32 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 04:22:32 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-32-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-32-32768-100-1722392528 32768 no 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-32-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-0-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-0-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-0-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-0-32768-100
+ env
++ date
+ echo Wed Jul 31 04:23:46 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Wed Jul 31 04:23:46 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 8e0c319ac5 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-32768-100-1722392626
+ git checkout -b scalability-no-0-32768-100-1722392626
Switched to a new branch 'scalability-no-0-32768-100-1722392626'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 04:24:10 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 04:24:10 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-0-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-0-32768-100-1722392626 32768 no 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-0-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-1-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-1-32768-100
+ env
++ date
+ echo Wed Jul 31 04:25:23 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Wed Jul 31 04:25:23 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-32768-100-1722392724
+ git checkout -b scalability-no-1-32768-100-1722392724
Switched to a new branch 'scalability-no-1-32768-100-1722392724'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-32768-100-1722392724 7ee50e7b42] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 04:25:48 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 04:25:48 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-1-32768-100-1722392724 32768 no 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1024-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-1024-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1024-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-1024-32768-100
+ env
++ date
+ echo Wed Jul 31 04:27:01 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Wed Jul 31 04:27:01 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 7ee50e7b42 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-32768-100-1722392822
+ git checkout -b scalability-no-1024-32768-100-1722392822
Switched to a new branch 'scalability-no-1024-32768-100-1722392822'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-32768-100-1722392822 593b961c16] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 04:27:25 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 04:27:25 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1024-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-1024-32768-100-1722392822 32768 no 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1024-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-8-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-8-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-8-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-8-32768-100
+ env
++ date
+ echo Wed Jul 31 04:28:40 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Wed Jul 31 04:28:40 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 593b961c16 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-32768-100-1722392920
+ git checkout -b scalability-no-8-32768-100-1722392920
Switched to a new branch 'scalability-no-8-32768-100-1722392920'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/8/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-32768-100-1722392920 bcafac2189] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 04:29:03 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 04:29:03 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-8-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-8-32768-100-1722392920 32768 no 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-8-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-512-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-512-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-512-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-512-32768-100
+ env
++ date
+ echo Wed Jul 31 04:30:17 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Wed Jul 31 04:30:17 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at bcafac2189 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-32768-100-1722393018
+ git checkout -b scalability-no-512-32768-100-1722393018
Switched to a new branch 'scalability-no-512-32768-100-1722393018'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/512/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-32768-100-1722393018 191f574c18] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 04:30:41 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 04:30:41 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-512-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-512-32768-100-1722393018 32768 no 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-512-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-128-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-128-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-128-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-128-32768-100
+ env
++ date
+ echo Wed Jul 31 04:31:55 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Wed Jul 31 04:31:55 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 191f574c18 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-32768-100-1722393115
+ git checkout -b scalability-no-128-32768-100-1722393115
Switched to a new branch 'scalability-no-128-32768-100-1722393115'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-32768-100-1722393115 4015098eb3] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 04:32:19 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 04:32:19 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-128-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-128-32768-100-1722393115 32768 no 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-128-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-32-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-32-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-32-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-32-32768-100
+ env
++ date
+ echo Wed Jul 31 04:33:33 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Wed Jul 31 04:33:33 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 4015098eb3 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-32768-100-1722393213
+ git checkout -b scalability-yes-32-32768-100-1722393213
Switched to a new branch 'scalability-yes-32-32768-100-1722393213'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-32768-100-1722393213 b14a55aad7] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-32768-100-1722393213 e8b83c54f3] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 04:33:57 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 04:33:57 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-32-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-32-32768-100-1722393213 32768 yes 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-32-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-0-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-0-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-0-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-0-32768-100
+ env
++ date
+ echo Wed Jul 31 04:35:17 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Wed Jul 31 04:35:17 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e8b83c54f3 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-32768-100-1722393318
+ git checkout -b scalability-yes-0-32768-100-1722393318
Switched to a new branch 'scalability-yes-0-32768-100-1722393318'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-32768-100-1722393318 0aaedb0828] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 04:35:42 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 04:35:42 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-0-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-0-32768-100-1722393318 32768 yes 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-0-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-1-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-1-32768-100
+ env
++ date
+ echo Wed Jul 31 04:37:02 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Wed Jul 31 04:37:02 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 0aaedb0828 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-32768-100-1722393422
+ git checkout -b scalability-yes-1-32768-100-1722393422
Switched to a new branch 'scalability-yes-1-32768-100-1722393422'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-32768-100-1722393422 f5f305dca6] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/1/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-32768-100-1722393422 4ee8ff7662] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 04:37:26 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 04:37:26 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-1-32768-100-1722393422 32768 yes 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1024-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-1024-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1024-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-1024-32768-100
+ env
++ date
+ echo Wed Jul 31 04:38:46 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Wed Jul 31 04:38:46 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 4ee8ff7662 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-32768-100-1722393527
+ git checkout -b scalability-yes-1024-32768-100-1722393527
Switched to a new branch 'scalability-yes-1024-32768-100-1722393527'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-32768-100-1722393527 e8f33be314] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-32768-100-1722393527 430edf38fc] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 04:39:11 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 04:39:11 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1024-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-1024-32768-100-1722393527 32768 yes 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1024-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-8-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-8-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-8-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-8-32768-100
+ env
++ date
+ echo Wed Jul 31 04:40:31 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Wed Jul 31 04:40:31 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 430edf38fc fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-32768-100-1722393631
+ git checkout -b scalability-yes-8-32768-100-1722393631
Switched to a new branch 'scalability-yes-8-32768-100-1722393631'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-32768-100-1722393631 37f2ece7f6] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-32768-100-1722393631 481c691af3] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 04:40:55 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 04:40:55 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-8-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-8-32768-100-1722393631 32768 yes 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-8-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-512-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-512-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-512-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-512-32768-100
+ env
++ date
+ echo Wed Jul 31 04:42:16 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Wed Jul 31 04:42:16 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 481c691af3 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-32768-100-1722393736
+ git checkout -b scalability-yes-512-32768-100-1722393736
Switched to a new branch 'scalability-yes-512-32768-100-1722393736'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-32768-100-1722393736 bb2673c59c] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-32768-100-1722393736 4fee8b2ffd] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 04:42:39 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 04:42:39 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-512-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-512-32768-100-1722393736 32768 yes 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-512-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-128-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-128-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-128-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-128-32768-100
+ env
++ date
+ echo Wed Jul 31 04:44:00 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Wed Jul 31 04:44:00 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 4fee8b2ffd fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-32768-100-1722393840
+ git checkout -b scalability-yes-128-32768-100-1722393840
Switched to a new branch 'scalability-yes-128-32768-100-1722393840'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-32768-100-1722393840 0de9b92a2b] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-32768-100-1722393840 05392509ae] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 04:44:24 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 04:44:24 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-128-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-128-32768-100-1722393840 32768 yes 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-128-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-32-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-32-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-32-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-32-32768-100
+ env
++ date
+ echo Wed Jul 31 04:45:45 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Wed Jul 31 04:45:45 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05392509ae fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-32768-100-1722393945
+ git checkout -b scalability-no-32-32768-100-1722393945
Switched to a new branch 'scalability-no-32-32768-100-1722393945'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-32768-100-1722393945 5ea6455c46] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 04:46:08 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 04:46:08 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-32-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-32-32768-100-1722393945 32768 no 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-32-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-0-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-0-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-0-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-0-32768-100
+ env
++ date
+ echo Wed Jul 31 04:47:29 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Wed Jul 31 04:47:29 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 5ea6455c46 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-32768-100-1722394049
+ git checkout -b scalability-no-0-32768-100-1722394049
Switched to a new branch 'scalability-no-0-32768-100-1722394049'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 04:47:53 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 04:47:53 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-0-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-0-32768-100-1722394049 32768 no 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-0-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-1-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-1-32768-100
+ env
++ date
+ echo Wed Jul 31 04:49:14 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Wed Jul 31 04:49:14 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-32768-100-1722394154
+ git checkout -b scalability-no-1-32768-100-1722394154
Switched to a new branch 'scalability-no-1-32768-100-1722394154'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-32768-100-1722394154 751dba703e] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 04:49:37 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 04:49:37 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-1-32768-100-1722394154 32768 no 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1024-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-1024-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1024-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-1024-32768-100
+ env
++ date
+ echo Wed Jul 31 04:50:58 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Wed Jul 31 04:50:58 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 751dba703e fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-32768-100-1722394258
+ git checkout -b scalability-no-1024-32768-100-1722394258
Switched to a new branch 'scalability-no-1024-32768-100-1722394258'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-32768-100-1722394258 01f5fcccd6] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 04:51:22 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 04:51:22 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1024-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-1024-32768-100-1722394258 32768 no 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1024-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-8-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-8-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-8-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-8-32768-100
+ env
++ date
+ echo Wed Jul 31 04:52:43 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Wed Jul 31 04:52:43 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 01f5fcccd6 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-32768-100-1722394363
+ git checkout -b scalability-no-8-32768-100-1722394363
Switched to a new branch 'scalability-no-8-32768-100-1722394363'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-32768-100-1722394363 e46fbcd03a] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 04:53:07 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 04:53:07 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-8-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-8-32768-100-1722394363 32768 no 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-8-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-512-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-512-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-512-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-512-32768-100
+ env
++ date
+ echo Wed Jul 31 04:54:28 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Wed Jul 31 04:54:28 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e46fbcd03a fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-32768-100-1722394468
+ git checkout -b scalability-no-512-32768-100-1722394468
Switched to a new branch 'scalability-no-512-32768-100-1722394468'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-32768-100-1722394468 95f88e8fde] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 04:54:52 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 04:54:52 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-512-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-512-32768-100-1722394468 32768 no 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-512-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-128-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-128-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-128-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-128-32768-100
+ env
++ date
+ echo Wed Jul 31 04:56:12 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Wed Jul 31 04:56:12 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 95f88e8fde fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-32768-100-1722394573
+ git checkout -b scalability-no-128-32768-100-1722394573
Switched to a new branch 'scalability-no-128-32768-100-1722394573'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-32768-100-1722394573 d5b62acafe] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 04:56:36 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 04:56:36 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-128-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-128-32768-100-1722394573 32768 no 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-128-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-32-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-32-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-32-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-32-32768-100
+ env
++ date
+ echo Wed Jul 31 04:57:57 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Wed Jul 31 04:57:57 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d5b62acafe fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-32768-100-1722394677
+ git checkout -b scalability-yes-32-32768-100-1722394677
Switched to a new branch 'scalability-yes-32-32768-100-1722394677'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-32768-100-1722394677 dcafe00389] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-32768-100-1722394677 b4804b0bce] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 04:58:21 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 04:58:21 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-32-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-32-32768-100-1722394677 32768 yes 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-32-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-0-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-0-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-0-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-0-32768-100
+ env
++ date
+ echo Wed Jul 31 05:15:11 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Wed Jul 31 05:15:11 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b4804b0bce fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-32768-100-1722395711
+ git checkout -b scalability-yes-0-32768-100-1722395711
Switched to a new branch 'scalability-yes-0-32768-100-1722395711'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-32768-100-1722395711 a54053c64c] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 05:15:36 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 05:15:36 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-0-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-0-32768-100-1722395711 32768 yes 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-0-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-1-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-1-32768-100
+ env
++ date
+ echo Wed Jul 31 05:32:18 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Wed Jul 31 05:32:18 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a54053c64c NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-32768-100-1722396738
+ git checkout -b scalability-yes-1-32768-100-1722396738
Switched to a new branch 'scalability-yes-1-32768-100-1722396738'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-32768-100-1722396738 094778dfc1] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-32768-100-1722396738 18a7c6e714] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 05:32:43 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 05:32:43 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-1-32768-100-1722396738 32768 yes 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1024-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-1024-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1024-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-1024-32768-100
+ env
++ date
+ echo Wed Jul 31 05:49:27 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Wed Jul 31 05:49:27 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 18a7c6e714 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-32768-100-1722397768
+ git checkout -b scalability-yes-1024-32768-100-1722397768
Switched to a new branch 'scalability-yes-1024-32768-100-1722397768'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-32768-100-1722397768 a6d0c1d1f5] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-32768-100-1722397768 248a09daeb] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 05:49:52 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 05:49:52 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1024-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-1024-32768-100-1722397768 32768 yes 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1024-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-8-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-8-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-8-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-8-32768-100
+ env
++ date
+ echo Wed Jul 31 06:06:47 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Wed Jul 31 06:06:47 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 248a09daeb fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-32768-100-1722398807
+ git checkout -b scalability-yes-8-32768-100-1722398807
Switched to a new branch 'scalability-yes-8-32768-100-1722398807'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-32768-100-1722398807 9457b9775b] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-32768-100-1722398807 18861c8785] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 06:07:11 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 06:07:11 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-8-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-8-32768-100-1722398807 32768 yes 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-8-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-512-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-512-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-512-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-512-32768-100
+ env
++ date
+ echo Wed Jul 31 06:23:56 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Wed Jul 31 06:23:56 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 18861c8785 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-32768-100-1722399836
+ git checkout -b scalability-yes-512-32768-100-1722399836
Switched to a new branch 'scalability-yes-512-32768-100-1722399836'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-32768-100-1722399836 8168ef4e37] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-32768-100-1722399836 c15d22a8e1] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 06:24:20 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 06:24:20 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-512-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-512-32768-100-1722399836 32768 yes 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-512-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-128-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-128-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-128-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-128-32768-100
+ env
++ date
+ echo Wed Jul 31 06:41:14 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Wed Jul 31 06:41:14 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at c15d22a8e1 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-32768-100-1722400875
+ git checkout -b scalability-yes-128-32768-100-1722400875
Switched to a new branch 'scalability-yes-128-32768-100-1722400875'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-32768-100-1722400875 16bdb3cf91] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-32768-100-1722400875 09e1801b33] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 06:41:40 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 06:41:40 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-128-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-128-32768-100-1722400875 32768 yes 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-128-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-32-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-32-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-32-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-32-32768-100
+ env
++ date
+ echo Wed Jul 31 06:58:23 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Wed Jul 31 06:58:23 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 09e1801b33 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-32768-100-1722401904
+ git checkout -b scalability-no-32-32768-100-1722401904
Switched to a new branch 'scalability-no-32-32768-100-1722401904'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-32768-100-1722401904 f7e6bf1b2a] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 06:58:49 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 06:58:49 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-32-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-32-32768-100-1722401904 32768 no 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-32-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-0-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-0-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-0-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-0-32768-100
+ env
++ date
+ echo Wed Jul 31 07:15:27 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Wed Jul 31 07:15:27 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at f7e6bf1b2a fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-32768-100-1722402927
+ git checkout -b scalability-no-0-32768-100-1722402927
Switched to a new branch 'scalability-no-0-32768-100-1722402927'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 07:15:52 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 07:15:52 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-0-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-0-32768-100-1722402927 32768 no 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-0-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-1-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-1-32768-100
+ env
++ date
+ echo Wed Jul 31 07:32:33 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Wed Jul 31 07:32:33 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-32768-100-1722403954
+ git checkout -b scalability-no-1-32768-100-1722403954
Switched to a new branch 'scalability-no-1-32768-100-1722403954'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/1/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-32768-100-1722403954 bab93cdb3f] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 07:32:59 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 07:32:59 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-1-32768-100-1722403954 32768 no 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1024-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-1024-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1024-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-1024-32768-100
+ env
++ date
+ echo Wed Jul 31 07:49:45 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Wed Jul 31 07:49:45 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at bab93cdb3f fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-32768-100-1722404986
+ git checkout -b scalability-no-1024-32768-100-1722404986
Switched to a new branch 'scalability-no-1024-32768-100-1722404986'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/1024/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-32768-100-1722404986 db46d1924b] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 07:50:11 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 07:50:11 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1024-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-1024-32768-100-1722404986 32768 no 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1024-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-8-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-8-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-8-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-8-32768-100
+ env
++ date
+ echo Wed Jul 31 08:07:05 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Wed Jul 31 08:07:05 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at db46d1924b fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-32768-100-1722406025
+ git checkout -b scalability-no-8-32768-100-1722406025
Switched to a new branch 'scalability-no-8-32768-100-1722406025'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/8/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-32768-100-1722406025 9845a09ae6] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 08:07:29 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 08:07:29 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-8-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-8-32768-100-1722406025 32768 no 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-8-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-512-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-512-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-512-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-512-32768-100
+ env
++ date
+ echo Wed Jul 31 08:24:07 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Wed Jul 31 08:24:07 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 9845a09ae6 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-32768-100-1722407047
+ git checkout -b scalability-no-512-32768-100-1722407047
Switched to a new branch 'scalability-no-512-32768-100-1722407047'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-32768-100-1722407047 905b08bd76] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 08:24:31 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 08:24:31 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-512-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-512-32768-100-1722407047 32768 no 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-512-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-128-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-128-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-128-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-128-32768-100
+ env
++ date
+ echo Wed Jul 31 08:41:24 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Wed Jul 31 08:41:24 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 905b08bd76 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-32768-100-1722408084
+ git checkout -b scalability-no-128-32768-100-1722408084
Switched to a new branch 'scalability-no-128-32768-100-1722408084'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-32768-100-1722408084 b87e8817b8] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 08:41:49 AM CEST 2024 'RUN   files: 32768  partitions: 100'
Wed Jul 31 08:41:49 AM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-128-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-128-32768-100-1722408084 32768 no 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-128-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for p in $PARTITIONS
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-32-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-32-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-32-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-32-32768-1
+ env
++ date
+ echo Wed Jul 31 08:58:26 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Wed Jul 31 08:58:26 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b87e8817b8 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-32768-1-1722409107
+ git checkout -b scalability-yes-32-32768-1-1722409107
Switched to a new branch 'scalability-yes-32-32768-1-1722409107'
+ '[' yes == yes ']'
+ patch -p1
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-32768-1-1722409107 f2a9752664] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-32768-1-1722409107 652e611ad1] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 08:59:14 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 08:59:14 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-32-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-32-32768-1-1722409107 32768 yes 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-32-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-0-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-0-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-0-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-0-32768-1
+ env
++ date
+ echo Wed Jul 31 09:00:29 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Wed Jul 31 09:00:29 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 652e611ad1 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-32768-1-1722409229
+ git checkout -b scalability-yes-0-32768-1-1722409229
Switched to a new branch 'scalability-yes-0-32768-1-1722409229'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-32768-1-1722409229 3dfd579e15] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:01:16 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 09:01:16 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-0-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-0-32768-1-1722409229 32768 yes 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-0-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-1-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-1-32768-1
+ env
++ date
+ echo Wed Jul 31 09:02:30 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Wed Jul 31 09:02:30 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 3dfd579e15 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-32768-1-1722409350
+ git checkout -b scalability-yes-1-32768-1-1722409350
Switched to a new branch 'scalability-yes-1-32768-1-1722409350'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-32768-1-1722409350 ab4ed5e6f5] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-32768-1-1722409350 d6f5ab844e] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:03:16 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 09:03:16 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-1-32768-1-1722409350 32768 yes 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1024-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-1024-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1024-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-1024-32768-1
+ env
++ date
+ echo Wed Jul 31 09:04:30 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Wed Jul 31 09:04:30 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d6f5ab844e fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-32768-1-1722409471
+ git checkout -b scalability-yes-1024-32768-1-1722409471
Switched to a new branch 'scalability-yes-1024-32768-1-1722409471'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-32768-1-1722409471 2ea09b969e] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-32768-1-1722409471 158525e86b] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:05:17 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 09:05:17 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1024-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-1024-32768-1-1722409471 32768 yes 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1024-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-8-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-8-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-8-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-8-32768-1
+ env
++ date
+ echo Wed Jul 31 09:06:31 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Wed Jul 31 09:06:31 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 158525e86b fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-32768-1-1722409591
+ git checkout -b scalability-yes-8-32768-1-1722409591
Switched to a new branch 'scalability-yes-8-32768-1-1722409591'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-32768-1-1722409591 27afa0c4da] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-32768-1-1722409591 01086d642e] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:07:18 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 09:07:18 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-8-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-8-32768-1-1722409591 32768 yes 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-8-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-512-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-512-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-512-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-512-32768-1
+ env
++ date
+ echo Wed Jul 31 09:08:32 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Wed Jul 31 09:08:32 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 01086d642e fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-32768-1-1722409712
+ git checkout -b scalability-yes-512-32768-1-1722409712
Switched to a new branch 'scalability-yes-512-32768-1-1722409712'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-32768-1-1722409712 d7fcca0f77] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-32768-1-1722409712 ec8f065465] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:09:18 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 09:09:18 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-512-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-512-32768-1-1722409712 32768 yes 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-512-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-128-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-128-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-128-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-128-32768-1
+ env
++ date
+ echo Wed Jul 31 09:10:33 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Wed Jul 31 09:10:33 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at ec8f065465 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-32768-1-1722409833
+ git checkout -b scalability-yes-128-32768-1-1722409833
Switched to a new branch 'scalability-yes-128-32768-1-1722409833'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-32768-1-1722409833 fb6001643c] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-32768-1-1722409833 1bceddadbd] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:11:19 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 09:11:19 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-128-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-128-32768-1-1722409833 32768 yes 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-128-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-32-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-32-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-32-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-32-32768-1
+ env
++ date
+ echo Wed Jul 31 09:12:33 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Wed Jul 31 09:12:33 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 1bceddadbd fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-32768-1-1722409953
+ git checkout -b scalability-no-32-32768-1-1722409953
Switched to a new branch 'scalability-no-32-32768-1-1722409953'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-32768-1-1722409953 643c11632e] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:13:20 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 09:13:20 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-32-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-32-32768-1-1722409953 32768 no 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-32-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-0-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-0-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-0-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-0-32768-1
+ env
++ date
+ echo Wed Jul 31 09:14:34 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Wed Jul 31 09:14:34 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 643c11632e fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-32768-1-1722410074
+ git checkout -b scalability-no-0-32768-1-1722410074
Switched to a new branch 'scalability-no-0-32768-1-1722410074'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:15:21 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 09:15:21 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-0-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-0-32768-1-1722410074 32768 no 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-0-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-1-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-1-32768-1
+ env
++ date
+ echo Wed Jul 31 09:16:35 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Wed Jul 31 09:16:35 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-32768-1-1722410195
+ git checkout -b scalability-no-1-32768-1-1722410195
Switched to a new branch 'scalability-no-1-32768-1-1722410195'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-32768-1-1722410195 63718c62e0] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:17:21 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 09:17:21 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-1-32768-1-1722410195 32768 no 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1024-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-1024-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1024-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-1024-32768-1
+ env
++ date
+ echo Wed Jul 31 09:18:35 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Wed Jul 31 09:18:35 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 63718c62e0 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-32768-1-1722410315
+ git checkout -b scalability-no-1024-32768-1-1722410315
Switched to a new branch 'scalability-no-1024-32768-1-1722410315'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-32768-1-1722410315 13615a3cc7] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:19:22 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 09:19:22 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1024-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-1024-32768-1-1722410315 32768 no 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1024-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-8-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-8-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-8-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-8-32768-1
+ env
++ date
+ echo Wed Jul 31 09:20:36 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Wed Jul 31 09:20:36 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 13615a3cc7 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-32768-1-1722410436
+ git checkout -b scalability-no-8-32768-1-1722410436
Switched to a new branch 'scalability-no-8-32768-1-1722410436'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/8/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-32768-1-1722410436 0786d16b99] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:21:23 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 09:21:23 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-8-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-8-32768-1-1722410436 32768 no 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-8-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-512-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-512-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-512-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-512-32768-1
+ env
++ date
+ echo Wed Jul 31 09:22:37 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Wed Jul 31 09:22:37 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 0786d16b99 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-32768-1-1722410557
+ git checkout -b scalability-no-512-32768-1-1722410557
Switched to a new branch 'scalability-no-512-32768-1-1722410557'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-32768-1-1722410557 8ff3a25413] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:23:24 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 09:23:24 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-512-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-512-32768-1-1722410557 32768 no 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-512-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-128-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-128-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-128-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-128-32768-1
+ env
++ date
+ echo Wed Jul 31 09:24:38 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Wed Jul 31 09:24:38 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 8ff3a25413 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-32768-1-1722410678
+ git checkout -b scalability-no-128-32768-1-1722410678
Switched to a new branch 'scalability-no-128-32768-1-1722410678'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-32768-1-1722410678 eb1dbea1e6] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:25:24 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 09:25:24 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-128-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-128-32768-1-1722410678 32768 no 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-128-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-32-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-32-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-32-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-32-32768-1
+ env
++ date
+ echo Wed Jul 31 09:26:38 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Wed Jul 31 09:26:38 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at eb1dbea1e6 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-32768-1-1722410799
+ git checkout -b scalability-yes-32-32768-1-1722410799
Switched to a new branch 'scalability-yes-32-32768-1-1722410799'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-32768-1-1722410799 f8256f2148] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-32768-1-1722410799 0e9924484b] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:27:02 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 09:27:02 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-32-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-32-32768-1-1722410799 32768 yes 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-32-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-0-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-0-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-0-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-0-32768-1
+ env
++ date
+ echo Wed Jul 31 09:28:16 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Wed Jul 31 09:28:16 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 0e9924484b fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-32768-1-1722410897
+ git checkout -b scalability-yes-0-32768-1-1722410897
Switched to a new branch 'scalability-yes-0-32768-1-1722410897'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-32768-1-1722410897 bb1cc4f084] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:28:40 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 09:28:40 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-0-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-0-32768-1-1722410897 32768 yes 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-0-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-1-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-1-32768-1
+ env
++ date
+ echo Wed Jul 31 09:29:55 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Wed Jul 31 09:29:55 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at bb1cc4f084 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-32768-1-1722410995
+ git checkout -b scalability-yes-1-32768-1-1722410995
Switched to a new branch 'scalability-yes-1-32768-1-1722410995'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-32768-1-1722410995 43763098f9] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-32768-1-1722410995 5d1aa8bb5d] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:30:19 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 09:30:19 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-1-32768-1-1722410995 32768 yes 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1024-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-1024-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1024-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-1024-32768-1
+ env
++ date
+ echo Wed Jul 31 09:31:33 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Wed Jul 31 09:31:33 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 5d1aa8bb5d fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-32768-1-1722411093
+ git checkout -b scalability-yes-1024-32768-1-1722411093
Switched to a new branch 'scalability-yes-1024-32768-1-1722411093'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-32768-1-1722411093 46b2a87fbc] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-32768-1-1722411093 11fc4b2a69] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:31:57 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 09:31:57 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1024-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-1024-32768-1-1722411093 32768 yes 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1024-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-8-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-8-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-8-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-8-32768-1
+ env
++ date
+ echo Wed Jul 31 09:33:11 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Wed Jul 31 09:33:11 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 11fc4b2a69 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-32768-1-1722411191
+ git checkout -b scalability-yes-8-32768-1-1722411191
Switched to a new branch 'scalability-yes-8-32768-1-1722411191'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-32768-1-1722411191 11837aa523] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-32768-1-1722411191 f0d4e1f332] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:33:35 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 09:33:35 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-8-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-8-32768-1-1722411191 32768 yes 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-8-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-512-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-512-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-512-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-512-32768-1
+ env
++ date
+ echo Wed Jul 31 09:34:49 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Wed Jul 31 09:34:49 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at f0d4e1f332 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-32768-1-1722411290
+ git checkout -b scalability-yes-512-32768-1-1722411290
Switched to a new branch 'scalability-yes-512-32768-1-1722411290'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-32768-1-1722411290 1cbb9dbcae] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-32768-1-1722411290 2f6c72df66] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:35:13 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 09:35:13 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-512-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-512-32768-1-1722411290 32768 yes 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-512-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-128-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-128-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-128-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-128-32768-1
+ env
++ date
+ echo Wed Jul 31 09:36:28 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Wed Jul 31 09:36:28 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 2f6c72df66 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-32768-1-1722411388
+ git checkout -b scalability-yes-128-32768-1-1722411388
Switched to a new branch 'scalability-yes-128-32768-1-1722411388'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-32768-1-1722411388 3d8b677490] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-32768-1-1722411388 29b8d1724a] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:36:52 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 09:36:52 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-128-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-128-32768-1-1722411388 32768 yes 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-128-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-32-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-32-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-32-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-32-32768-1
+ env
++ date
+ echo Wed Jul 31 09:38:06 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Wed Jul 31 09:38:06 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 29b8d1724a fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-32768-1-1722411486
+ git checkout -b scalability-no-32-32768-1-1722411486
Switched to a new branch 'scalability-no-32-32768-1-1722411486'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-32768-1-1722411486 55efa5d7be] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:38:30 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 09:38:30 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-32-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-32-32768-1-1722411486 32768 no 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-32-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-0-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-0-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-0-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-0-32768-1
+ env
++ date
+ echo Wed Jul 31 09:39:44 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Wed Jul 31 09:39:44 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 55efa5d7be fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-32768-1-1722411584
+ git checkout -b scalability-no-0-32768-1-1722411584
Switched to a new branch 'scalability-no-0-32768-1-1722411584'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ head -n 1000
+ git log
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:40:08 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 09:40:08 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-0-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-0-32768-1-1722411584 32768 no 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-0-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-1-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-1-32768-1
+ env
++ date
+ echo Wed Jul 31 09:41:23 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Wed Jul 31 09:41:23 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-32768-1-1722411683
+ git checkout -b scalability-no-1-32768-1-1722411683
Switched to a new branch 'scalability-no-1-32768-1-1722411683'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-32768-1-1722411683 f1dae2874a] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:41:46 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 09:41:46 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-1-32768-1-1722411683 32768 no 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1024-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-1024-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1024-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-1024-32768-1
+ env
++ date
+ echo Wed Jul 31 09:43:01 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Wed Jul 31 09:43:01 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at f1dae2874a fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-32768-1-1722411781
+ git checkout -b scalability-no-1024-32768-1-1722411781
Switched to a new branch 'scalability-no-1024-32768-1-1722411781'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-32768-1-1722411781 d39b30265f] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:43:24 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 09:43:24 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1024-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-1024-32768-1-1722411781 32768 no 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1024-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-8-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-8-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-8-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-8-32768-1
+ env
++ date
+ echo Wed Jul 31 09:44:39 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Wed Jul 31 09:44:39 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d39b30265f fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-32768-1-1722411879
+ git checkout -b scalability-no-8-32768-1-1722411879
Switched to a new branch 'scalability-no-8-32768-1-1722411879'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ patch -p1
+ sed s/MY_PLACEHOLDER/8/
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-32768-1-1722411879 bb4d645031] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:45:03 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 09:45:03 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-8-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-8-32768-1-1722411879 32768 no 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-8-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-512-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-512-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-512-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-512-32768-1
+ env
++ date
+ echo Wed Jul 31 09:46:17 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Wed Jul 31 09:46:17 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at bb4d645031 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-32768-1-1722411977
+ git checkout -b scalability-no-512-32768-1-1722411977
Switched to a new branch 'scalability-no-512-32768-1-1722411977'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-32768-1-1722411977 c4f01b86f1] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:46:41 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 09:46:41 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-512-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-512-32768-1-1722411977 32768 no 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-512-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-128-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-128-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-128-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-128-32768-1
+ env
++ date
+ echo Wed Jul 31 09:47:55 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Wed Jul 31 09:47:55 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at c4f01b86f1 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-32768-1-1722412075
+ git checkout -b scalability-no-128-32768-1-1722412075
Switched to a new branch 'scalability-no-128-32768-1-1722412075'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-32768-1-1722412075 0286f4d214] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:48:19 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 09:48:19 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-128-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-128-32768-1-1722412075 32768 no 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-128-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-32-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-32-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-32-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-32-32768-1
+ env
++ date
+ echo Wed Jul 31 09:49:34 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Wed Jul 31 09:49:34 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 0286f4d214 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-32768-1-1722412174
+ git checkout -b scalability-yes-32-32768-1-1722412174
Switched to a new branch 'scalability-yes-32-32768-1-1722412174'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-32768-1-1722412174 ef4b26dc54] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-32768-1-1722412174 857f00f7e4] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:49:58 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 09:49:58 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-32-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-32-32768-1-1722412174 32768 yes 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-32-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-0-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-0-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-0-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-0-32768-1
+ env
++ date
+ echo Wed Jul 31 09:51:11 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Wed Jul 31 09:51:11 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 857f00f7e4 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-32768-1-1722412271
+ git checkout -b scalability-yes-0-32768-1-1722412271
Switched to a new branch 'scalability-yes-0-32768-1-1722412271'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-32768-1-1722412271 719a9bc80b] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:51:35 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 09:51:35 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-0-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-0-32768-1-1722412271 32768 yes 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-0-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-1-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-1-32768-1
+ env
++ date
+ echo Wed Jul 31 09:52:48 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Wed Jul 31 09:52:48 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 719a9bc80b NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-32768-1-1722412368
+ git checkout -b scalability-yes-1-32768-1-1722412368
Switched to a new branch 'scalability-yes-1-32768-1-1722412368'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-32768-1-1722412368 88cffb5260] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-32768-1-1722412368 3327dfa890] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:53:12 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 09:53:12 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-1-32768-1-1722412368 32768 yes 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1024-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-1024-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1024-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-1024-32768-1
+ env
++ date
+ echo Wed Jul 31 09:54:25 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Wed Jul 31 09:54:25 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 3327dfa890 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-32768-1-1722412465
+ git checkout -b scalability-yes-1024-32768-1-1722412465
Switched to a new branch 'scalability-yes-1024-32768-1-1722412465'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-32768-1-1722412465 98b5953c18] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-32768-1-1722412465 ebda5e5b98] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:54:49 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 09:54:49 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1024-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-1024-32768-1-1722412465 32768 yes 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1024-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-8-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-8-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-8-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-8-32768-1
+ env
++ date
+ echo Wed Jul 31 09:56:02 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Wed Jul 31 09:56:02 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at ebda5e5b98 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-32768-1-1722412562
+ git checkout -b scalability-yes-8-32768-1-1722412562
Switched to a new branch 'scalability-yes-8-32768-1-1722412562'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-32768-1-1722412562 794b38abed] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-32768-1-1722412562 42f7bb5be5] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:56:26 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 09:56:26 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-8-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-8-32768-1-1722412562 32768 yes 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-8-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-512-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-512-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-512-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-512-32768-1
+ env
++ date
+ echo Wed Jul 31 09:57:39 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Wed Jul 31 09:57:39 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 42f7bb5be5 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-32768-1-1722412659
+ git checkout -b scalability-yes-512-32768-1-1722412659
Switched to a new branch 'scalability-yes-512-32768-1-1722412659'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-32768-1-1722412659 2981ec2437] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-32768-1-1722412659 c6f8b63648] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:58:03 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 09:58:03 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-512-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-512-32768-1-1722412659 32768 yes 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-512-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-128-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-128-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-128-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-128-32768-1
+ env
++ date
+ echo Wed Jul 31 09:59:16 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Wed Jul 31 09:59:16 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at c6f8b63648 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-32768-1-1722412757
+ git checkout -b scalability-yes-128-32768-1-1722412757
Switched to a new branch 'scalability-yes-128-32768-1-1722412757'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-32768-1-1722412757 d2d76c5f4f] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-32768-1-1722412757 6f81baf615] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:59:40 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 09:59:40 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-128-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-128-32768-1-1722412757 32768 yes 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-128-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-32-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-32-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-32-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-32-32768-1
+ env
++ date
+ echo Wed Jul 31 10:00:53 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Wed Jul 31 10:00:53 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 6f81baf615 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-32768-1-1722412853
+ git checkout -b scalability-no-32-32768-1-1722412853
Switched to a new branch 'scalability-no-32-32768-1-1722412853'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/32/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-32768-1-1722412853 c1f28ee5c3] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:01:17 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 10:01:17 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-32-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-32-32768-1-1722412853 32768 no 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-32-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-0-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-0-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-0-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-0-32768-1
+ env
++ date
+ echo Wed Jul 31 10:02:30 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Wed Jul 31 10:02:30 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at c1f28ee5c3 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-32768-1-1722412950
+ git checkout -b scalability-no-0-32768-1-1722412950
Switched to a new branch 'scalability-no-0-32768-1-1722412950'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:02:54 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 10:02:54 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-0-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-0-32768-1-1722412950 32768 no 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-0-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-1-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-1-32768-1
+ env
++ date
+ echo Wed Jul 31 10:04:07 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Wed Jul 31 10:04:07 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-32768-1-1722413047
+ git checkout -b scalability-no-1-32768-1-1722413047
Switched to a new branch 'scalability-no-1-32768-1-1722413047'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/1/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-32768-1-1722413047 8f3e83e245] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:04:31 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 10:04:31 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-1-32768-1-1722413047 32768 no 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1024-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-1024-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1024-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-1024-32768-1
+ env
++ date
+ echo Wed Jul 31 10:05:44 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Wed Jul 31 10:05:44 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 8f3e83e245 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-32768-1-1722413144
+ git checkout -b scalability-no-1024-32768-1-1722413144
Switched to a new branch 'scalability-no-1024-32768-1-1722413144'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/1024/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-32768-1-1722413144 9071169b20] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:06:08 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 10:06:08 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1024-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-1024-32768-1-1722413144 32768 no 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1024-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-8-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-8-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-8-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-8-32768-1
+ env
++ date
+ echo Wed Jul 31 10:07:21 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Wed Jul 31 10:07:21 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 9071169b20 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-32768-1-1722413241
+ git checkout -b scalability-no-8-32768-1-1722413241
Switched to a new branch 'scalability-no-8-32768-1-1722413241'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-32768-1-1722413241 0817e14c19] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:07:45 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 10:07:45 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-8-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-8-32768-1-1722413241 32768 no 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-8-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-512-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-512-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-512-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-512-32768-1
+ env
++ date
+ echo Wed Jul 31 10:08:58 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Wed Jul 31 10:08:58 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 0817e14c19 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-32768-1-1722413338
+ git checkout -b scalability-no-512-32768-1-1722413338
Switched to a new branch 'scalability-no-512-32768-1-1722413338'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-32768-1-1722413338 bfc2efa63e] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:09:22 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 10:09:22 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-512-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-512-32768-1-1722413338 32768 no 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-512-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-128-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-128-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-128-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-128-32768-1
+ env
++ date
+ echo Wed Jul 31 10:10:35 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Wed Jul 31 10:10:35 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at bfc2efa63e fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-32768-1-1722413435
+ git checkout -b scalability-no-128-32768-1-1722413435
Switched to a new branch 'scalability-no-128-32768-1-1722413435'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/128/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-32768-1-1722413435 21175a1cf5] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:10:59 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 10:10:59 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-128-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-128-32768-1-1722413435 32768 no 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-128-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-32-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-32-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-32-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-32-32768-1
+ env
++ date
+ echo Wed Jul 31 10:12:12 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Wed Jul 31 10:12:12 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 21175a1cf5 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-32768-1-1722413533
+ git checkout -b scalability-yes-32-32768-1-1722413533
Switched to a new branch 'scalability-yes-32-32768-1-1722413533'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-32768-1-1722413533 06bda322f7] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-32768-1-1722413533 2f8e6b68e3] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:12:36 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 10:12:36 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-32-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-32-32768-1-1722413533 32768 yes 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-32-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-0-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-0-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-0-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-0-32768-1
+ env
++ date
+ echo Wed Jul 31 10:13:55 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Wed Jul 31 10:13:55 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 2f8e6b68e3 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-32768-1-1722413635
+ git checkout -b scalability-yes-0-32768-1-1722413635
Switched to a new branch 'scalability-yes-0-32768-1-1722413635'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-32768-1-1722413635 3603bf474f] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:14:19 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 10:14:19 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-0-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-0-32768-1-1722413635 32768 yes 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-0-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-1-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-1-32768-1
+ env
++ date
+ echo Wed Jul 31 10:15:37 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Wed Jul 31 10:15:37 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 3603bf474f NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-32768-1-1722413738
+ git checkout -b scalability-yes-1-32768-1-1722413738
Switched to a new branch 'scalability-yes-1-32768-1-1722413738'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-32768-1-1722413738 611f54c4a0] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-32768-1-1722413738 8339fddc9c] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:16:01 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 10:16:01 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-1-32768-1-1722413738 32768 yes 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1024-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-1024-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1024-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-1024-32768-1
+ env
++ date
+ echo Wed Jul 31 10:17:20 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Wed Jul 31 10:17:20 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 8339fddc9c fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-32768-1-1722413840
+ git checkout -b scalability-yes-1024-32768-1-1722413840
Switched to a new branch 'scalability-yes-1024-32768-1-1722413840'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-32768-1-1722413840 14b54a4d81] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-32768-1-1722413840 9d57565186] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:17:44 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 10:17:44 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1024-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-1024-32768-1-1722413840 32768 yes 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1024-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-8-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-8-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-8-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-8-32768-1
+ env
++ date
+ echo Wed Jul 31 10:19:03 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Wed Jul 31 10:19:03 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 9d57565186 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-32768-1-1722413943
+ git checkout -b scalability-yes-8-32768-1-1722413943
Switched to a new branch 'scalability-yes-8-32768-1-1722413943'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-32768-1-1722413943 a8a2ce89d4] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-32768-1-1722413943 33175f6ed5] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:19:27 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 10:19:27 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-8-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-8-32768-1-1722413943 32768 yes 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-8-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-512-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-512-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-512-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-512-32768-1
+ env
++ date
+ echo Wed Jul 31 10:20:46 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Wed Jul 31 10:20:46 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 33175f6ed5 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-32768-1-1722414046
+ git checkout -b scalability-yes-512-32768-1-1722414046
Switched to a new branch 'scalability-yes-512-32768-1-1722414046'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-32768-1-1722414046 6c41fa763f] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-32768-1-1722414046 de34845351] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:21:10 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 10:21:10 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-512-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-512-32768-1-1722414046 32768 yes 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-512-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-128-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-128-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-128-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-128-32768-1
+ env
++ date
+ echo Wed Jul 31 10:22:28 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Wed Jul 31 10:22:28 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at de34845351 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-32768-1-1722414149
+ git checkout -b scalability-yes-128-32768-1-1722414149
Switched to a new branch 'scalability-yes-128-32768-1-1722414149'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-32768-1-1722414149 0cc7252d49] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-32768-1-1722414149 31d96330e7] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:22:52 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 10:22:52 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-128-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-128-32768-1-1722414149 32768 yes 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-128-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-32-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-32-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-32-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-32-32768-1
+ env
++ date
+ echo Wed Jul 31 10:24:11 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Wed Jul 31 10:24:11 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 31d96330e7 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-32768-1-1722414251
+ git checkout -b scalability-no-32-32768-1-1722414251
Switched to a new branch 'scalability-no-32-32768-1-1722414251'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-32768-1-1722414251 8435344c47] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:24:35 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 10:24:35 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-32-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-32-32768-1-1722414251 32768 no 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-32-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-0-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-0-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-0-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-0-32768-1
+ env
++ date
+ echo Wed Jul 31 10:25:53 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Wed Jul 31 10:25:53 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 8435344c47 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-32768-1-1722414354
+ git checkout -b scalability-no-0-32768-1-1722414354
Switched to a new branch 'scalability-no-0-32768-1-1722414354'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:26:17 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 10:26:17 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-0-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-0-32768-1-1722414354 32768 no 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-0-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-1-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-1-32768-1
+ env
++ date
+ echo Wed Jul 31 10:27:36 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Wed Jul 31 10:27:36 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-32768-1-1722414456
+ git checkout -b scalability-no-1-32768-1-1722414456
Switched to a new branch 'scalability-no-1-32768-1-1722414456'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-32768-1-1722414456 5d55f852f4] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:28:00 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 10:28:00 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-1-32768-1-1722414456 32768 no 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1024-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-1024-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1024-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-1024-32768-1
+ env
++ date
+ echo Wed Jul 31 10:29:19 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Wed Jul 31 10:29:19 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 5d55f852f4 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-32768-1-1722414559
+ git checkout -b scalability-no-1024-32768-1-1722414559
Switched to a new branch 'scalability-no-1024-32768-1-1722414559'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-32768-1-1722414559 b4f95ea37e] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:29:43 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 10:29:43 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1024-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-1024-32768-1-1722414559 32768 no 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1024-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-8-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-8-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-8-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-8-32768-1
+ env
++ date
+ echo Wed Jul 31 10:31:01 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Wed Jul 31 10:31:01 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b4f95ea37e fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-32768-1-1722414662
+ git checkout -b scalability-no-8-32768-1-1722414662
Switched to a new branch 'scalability-no-8-32768-1-1722414662'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/8/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-32768-1-1722414662 c640550148] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:31:25 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 10:31:25 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-8-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-8-32768-1-1722414662 32768 no 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-8-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-512-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-512-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-512-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-512-32768-1
+ env
++ date
+ echo Wed Jul 31 10:32:44 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Wed Jul 31 10:32:44 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at c640550148 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-32768-1-1722414764
+ git checkout -b scalability-no-512-32768-1-1722414764
Switched to a new branch 'scalability-no-512-32768-1-1722414764'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-32768-1-1722414764 de55384aec] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:33:08 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 10:33:08 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-512-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-512-32768-1-1722414764 32768 no 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-512-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-128-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-128-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-128-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-128-32768-1
+ env
++ date
+ echo Wed Jul 31 10:34:27 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Wed Jul 31 10:34:27 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at de55384aec fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-32768-1-1722414867
+ git checkout -b scalability-no-128-32768-1-1722414867
Switched to a new branch 'scalability-no-128-32768-1-1722414867'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-32768-1-1722414867 cb5ec51c15] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:34:51 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 10:34:51 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-128-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-128-32768-1-1722414867 32768 no 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-128-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-32-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-32-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-32-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-32-32768-1
+ env
++ date
+ echo Wed Jul 31 10:36:09 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Wed Jul 31 10:36:09 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at cb5ec51c15 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-32768-1-1722414969
+ git checkout -b scalability-yes-32-32768-1-1722414969
Switched to a new branch 'scalability-yes-32-32768-1-1722414969'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-32768-1-1722414969 40fd9cc224] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-32768-1-1722414969 c91e98df3b] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:36:33 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 10:36:33 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-32-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-32-32768-1-1722414969 32768 yes 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-32-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-0-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-0-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-0-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-0-32768-1
+ env
++ date
+ echo Wed Jul 31 10:38:24 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Wed Jul 31 10:38:24 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at c91e98df3b fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-32768-1-1722415104
+ git checkout -b scalability-yes-0-32768-1-1722415104
Switched to a new branch 'scalability-yes-0-32768-1-1722415104'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-32768-1-1722415104 f999b8e7dd] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:38:47 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 10:38:47 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-0-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-0-32768-1-1722415104 32768 yes 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-0-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-1-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-1-32768-1
+ env
++ date
+ echo Wed Jul 31 10:40:39 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Wed Jul 31 10:40:39 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at f999b8e7dd NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-32768-1-1722415239
+ git checkout -b scalability-yes-1-32768-1-1722415239
Switched to a new branch 'scalability-yes-1-32768-1-1722415239'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-32768-1-1722415239 7c594586e1] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-32768-1-1722415239 bacd4a3bfe] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:41:02 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 10:41:02 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-1-32768-1-1722415239 32768 yes 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1024-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-1024-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1024-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-1024-32768-1
+ env
++ date
+ echo Wed Jul 31 10:42:54 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Wed Jul 31 10:42:54 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at bacd4a3bfe fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-32768-1-1722415374
+ git checkout -b scalability-yes-1024-32768-1-1722415374
Switched to a new branch 'scalability-yes-1024-32768-1-1722415374'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-32768-1-1722415374 912a1c85ec] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-32768-1-1722415374 c77e7fff85] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:43:18 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 10:43:18 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1024-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-1024-32768-1-1722415374 32768 yes 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1024-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-8-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-8-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-8-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-8-32768-1
+ env
++ date
+ echo Wed Jul 31 10:45:08 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Wed Jul 31 10:45:08 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at c77e7fff85 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-32768-1-1722415508
+ git checkout -b scalability-yes-8-32768-1-1722415508
Switched to a new branch 'scalability-yes-8-32768-1-1722415508'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-32768-1-1722415508 5311ebe475] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-32768-1-1722415508 6a4c79405d] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:45:32 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 10:45:32 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-8-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-8-32768-1-1722415508 32768 yes 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-8-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-512-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-512-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-512-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-512-32768-1
+ env
++ date
+ echo Wed Jul 31 10:47:22 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Wed Jul 31 10:47:22 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 6a4c79405d fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-32768-1-1722415642
+ git checkout -b scalability-yes-512-32768-1-1722415642
Switched to a new branch 'scalability-yes-512-32768-1-1722415642'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-32768-1-1722415642 1ca2633293] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-32768-1-1722415642 d47e26f9fe] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:47:46 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 10:47:46 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-512-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-512-32768-1-1722415642 32768 yes 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-512-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-128-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-128-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-128-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-128-32768-1
+ env
++ date
+ echo Wed Jul 31 10:49:37 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Wed Jul 31 10:49:37 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d47e26f9fe fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-32768-1-1722415777
+ git checkout -b scalability-yes-128-32768-1-1722415777
Switched to a new branch 'scalability-yes-128-32768-1-1722415777'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-32768-1-1722415777 fcb7db64d3] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-32768-1-1722415777 696ee0598d] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:50:01 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 10:50:01 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-128-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-128-32768-1-1722415777 32768 yes 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-128-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-32-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-32-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-32-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-32-32768-1
+ env
++ date
+ echo Wed Jul 31 10:51:51 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Wed Jul 31 10:51:51 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 696ee0598d fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-32768-1-1722415911
+ git checkout -b scalability-no-32-32768-1-1722415911
Switched to a new branch 'scalability-no-32-32768-1-1722415911'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-32768-1-1722415911 e7b4464e7c] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:52:15 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 10:52:15 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-32-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-32-32768-1-1722415911 32768 no 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-32-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-0-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-0-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-0-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-0-32768-1
+ env
++ date
+ echo Wed Jul 31 10:54:05 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Wed Jul 31 10:54:05 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e7b4464e7c fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-32768-1-1722416045
+ git checkout -b scalability-no-0-32768-1-1722416045
Switched to a new branch 'scalability-no-0-32768-1-1722416045'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:54:29 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 10:54:29 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-0-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-0-32768-1-1722416045 32768 no 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-0-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-1-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-1-32768-1
+ env
++ date
+ echo Wed Jul 31 10:56:20 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Wed Jul 31 10:56:20 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-32768-1-1722416181
+ git checkout -b scalability-no-1-32768-1-1722416181
Switched to a new branch 'scalability-no-1-32768-1-1722416181'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-32768-1-1722416181 4ef6e2e7a3] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:56:44 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 10:56:44 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-1-32768-1-1722416181 32768 no 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1024-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-1024-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1024-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-1024-32768-1
+ env
++ date
+ echo Wed Jul 31 10:58:36 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Wed Jul 31 10:58:36 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 4ef6e2e7a3 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-32768-1-1722416316
+ git checkout -b scalability-no-1024-32768-1-1722416316
Switched to a new branch 'scalability-no-1024-32768-1-1722416316'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-32768-1-1722416316 e4524aef10] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:59:00 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 10:59:00 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1024-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-1024-32768-1-1722416316 32768 no 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1024-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-8-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-8-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-8-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-8-32768-1
+ env
++ date
+ echo Wed Jul 31 11:00:50 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Wed Jul 31 11:00:50 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e4524aef10 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-32768-1-1722416450
+ git checkout -b scalability-no-8-32768-1-1722416450
Switched to a new branch 'scalability-no-8-32768-1-1722416450'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/8/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-32768-1-1722416450 0b606e2f47] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:01:14 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 11:01:14 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-8-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-8-32768-1-1722416450 32768 no 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-8-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-512-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-512-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-512-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-512-32768-1
+ env
++ date
+ echo Wed Jul 31 11:03:04 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Wed Jul 31 11:03:04 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 0b606e2f47 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-32768-1-1722416584
+ git checkout -b scalability-no-512-32768-1-1722416584
Switched to a new branch 'scalability-no-512-32768-1-1722416584'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-32768-1-1722416584 b1b14bb953] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:03:28 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 11:03:28 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-512-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-512-32768-1-1722416584 32768 no 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-512-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-128-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-128-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-128-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-128-32768-1
+ env
++ date
+ echo Wed Jul 31 11:05:18 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Wed Jul 31 11:05:18 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b1b14bb953 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-32768-1-1722416719
+ git checkout -b scalability-no-128-32768-1-1722416719
Switched to a new branch 'scalability-no-128-32768-1-1722416719'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-32768-1-1722416719 28fbc80b50] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:05:43 AM CEST 2024 'RUN   files: 32768  partitions: 1'
Wed Jul 31 11:05:43 AM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-128-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-128-32768-1-1722416719 32768 no 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-128-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for p in $PARTITIONS
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-32-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-32-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-32-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-32-32768-0
+ env
++ date
+ echo Wed Jul 31 11:07:33 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Wed Jul 31 11:07:33 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 28fbc80b50 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-32768-0-1722416853
+ git checkout -b scalability-yes-32-32768-0-1722416853
Switched to a new branch 'scalability-yes-32-32768-0-1722416853'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-32768-0-1722416853 96dec932e6] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-32768-0-1722416853 6f801fdefc] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:08:19 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 11:08:19 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-32-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-32-32768-0-1722416853 32768 yes 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-32-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-0-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-0-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-0-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-0-32768-0
+ env
++ date
+ echo Wed Jul 31 11:09:33 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Wed Jul 31 11:09:33 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 6f801fdefc fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-32768-0-1722416973
+ git checkout -b scalability-yes-0-32768-0-1722416973
Switched to a new branch 'scalability-yes-0-32768-0-1722416973'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-32768-0-1722416973 f8c61165bc] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:10:20 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 11:10:20 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-0-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-0-32768-0-1722416973 32768 yes 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-0-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-1-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-1-32768-0
+ env
++ date
+ echo Wed Jul 31 11:11:34 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Wed Jul 31 11:11:34 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at f8c61165bc NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-32768-0-1722417094
+ git checkout -b scalability-yes-1-32768-0-1722417094
Switched to a new branch 'scalability-yes-1-32768-0-1722417094'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-32768-0-1722417094 865644b4da] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-32768-0-1722417094 9ba092d72c] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:12:20 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 11:12:20 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-1-32768-0-1722417094 32768 yes 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1024-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-1024-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1024-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-1024-32768-0
+ env
++ date
+ echo Wed Jul 31 11:13:34 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Wed Jul 31 11:13:34 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 9ba092d72c fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-32768-0-1722417214
+ git checkout -b scalability-yes-1024-32768-0-1722417214
Switched to a new branch 'scalability-yes-1024-32768-0-1722417214'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-32768-0-1722417214 f24a73ebec] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-32768-0-1722417214 a3eb0374d9] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:14:21 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 11:14:21 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1024-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-1024-32768-0-1722417214 32768 yes 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-1024-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-8-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-8-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-8-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-8-32768-0
+ env
++ date
+ echo Wed Jul 31 11:15:35 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Wed Jul 31 11:15:35 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a3eb0374d9 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-32768-0-1722417335
+ git checkout -b scalability-yes-8-32768-0-1722417335
Switched to a new branch 'scalability-yes-8-32768-0-1722417335'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-32768-0-1722417335 9637bb411f] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-32768-0-1722417335 f35b91d946] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:16:21 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 11:16:21 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-8-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-8-32768-0-1722417335 32768 yes 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-8-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-512-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-512-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-512-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-512-32768-0
+ env
++ date
+ echo Wed Jul 31 11:17:35 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Wed Jul 31 11:17:35 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at f35b91d946 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-32768-0-1722417455
+ git checkout -b scalability-yes-512-32768-0-1722417455
Switched to a new branch 'scalability-yes-512-32768-0-1722417455'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-32768-0-1722417455 3d61d3c8c6] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-32768-0-1722417455 aad9d07f00] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:18:22 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 11:18:22 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-512-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-512-32768-0-1722417455 32768 yes 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-512-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-128-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-128-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-128-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-yes-128-32768-0
+ env
++ date
+ echo Wed Jul 31 11:19:36 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Wed Jul 31 11:19:36 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at aad9d07f00 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-32768-0-1722417576
+ git checkout -b scalability-yes-128-32768-0-1722417576
Switched to a new branch 'scalability-yes-128-32768-0-1722417576'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-32768-0-1722417576 42927dafe9] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-32768-0-1722417576 1ef4edbc7c] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:20:23 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 11:20:23 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-128-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-128-32768-0-1722417576 32768 yes 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-yes-128-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-32-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-32-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-32-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-32-32768-0
+ env
++ date
+ echo Wed Jul 31 11:21:37 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Wed Jul 31 11:21:37 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 1ef4edbc7c fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-32768-0-1722417697
+ git checkout -b scalability-no-32-32768-0-1722417697
Switched to a new branch 'scalability-no-32-32768-0-1722417697'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-32768-0-1722417697 b53466fe30] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:22:23 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 11:22:23 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-32-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-32-32768-0-1722417697 32768 no 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-32-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-0-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-0-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-0-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-0-32768-0
+ env
++ date
+ echo Wed Jul 31 11:23:37 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Wed Jul 31 11:23:37 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b53466fe30 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-32768-0-1722417817
+ git checkout -b scalability-no-0-32768-0-1722417817
Switched to a new branch 'scalability-no-0-32768-0-1722417817'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:24:24 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 11:24:24 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-0-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-0-32768-0-1722417817 32768 no 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-0-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-1-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-1-32768-0
+ env
++ date
+ echo Wed Jul 31 11:25:37 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Wed Jul 31 11:25:37 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-32768-0-1722417938
+ git checkout -b scalability-no-1-32768-0-1722417938
Switched to a new branch 'scalability-no-1-32768-0-1722417938'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/1/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-32768-0-1722417938 5a01fec4d1] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:26:24 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 11:26:24 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-1-32768-0-1722417938 32768 no 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1024-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-1024-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1024-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-1024-32768-0
+ env
++ date
+ echo Wed Jul 31 11:27:38 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Wed Jul 31 11:27:38 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 5a01fec4d1 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-32768-0-1722418058
+ git checkout -b scalability-no-1024-32768-0-1722418058
Switched to a new branch 'scalability-no-1024-32768-0-1722418058'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-32768-0-1722418058 b7f53f77c6] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:28:25 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 11:28:25 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1024-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-1024-32768-0-1722418058 32768 no 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-1024-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-8-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-8-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-8-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-8-32768-0
+ env
++ date
+ echo Wed Jul 31 11:29:39 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Wed Jul 31 11:29:39 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b7f53f77c6 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-32768-0-1722418179
+ git checkout -b scalability-no-8-32768-0-1722418179
Switched to a new branch 'scalability-no-8-32768-0-1722418179'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/8/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-32768-0-1722418179 c49b3499a4] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:30:25 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 11:30:25 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-8-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-8-32768-0-1722418179 32768 no 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-8-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-512-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-512-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-512-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-512-32768-0
+ env
++ date
+ echo Wed Jul 31 11:31:39 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Wed Jul 31 11:31:39 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at c49b3499a4 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-32768-0-1722418299
+ git checkout -b scalability-no-512-32768-0-1722418299
Switched to a new branch 'scalability-no-512-32768-0-1722418299'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-32768-0-1722418299 6fe94759f9] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:32:26 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 11:32:26 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-512-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-512-32768-0-1722418299 32768 no 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-512-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-128-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-128-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-128-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/pgbench-no-128-32768-0
+ env
++ date
+ echo Wed Jul 31 11:33:40 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Wed Jul 31 11:33:40 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 6fe94759f9 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-32768-0-1722418420
+ git checkout -b scalability-no-128-32768-0-1722418420
Switched to a new branch 'scalability-no-128-32768-0-1722418420'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/128/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-32768-0-1722418420 b4d26f50bd] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:34:27 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 11:34:27 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-128-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-128-32768-0-1722418420 32768 no 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/pgbench-no-128-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-32-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-32-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-32-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-32-32768-0
+ env
++ date
+ echo Wed Jul 31 11:35:41 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Wed Jul 31 11:35:41 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b4d26f50bd fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-32768-0-1722418541
+ git checkout -b scalability-yes-32-32768-0-1722418541
Switched to a new branch 'scalability-yes-32-32768-0-1722418541'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-32768-0-1722418541 57ea6d29be] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-32768-0-1722418541 373067cdda] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:36:05 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 11:36:05 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-32-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-32-32768-0-1722418541 32768 yes 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-32-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-0-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-0-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-0-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-0-32768-0
+ env
++ date
+ echo Wed Jul 31 11:37:19 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Wed Jul 31 11:37:19 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 373067cdda fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-32768-0-1722418639
+ git checkout -b scalability-yes-0-32768-0-1722418639
Switched to a new branch 'scalability-yes-0-32768-0-1722418639'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-32768-0-1722418639 cfab5150ad] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:37:43 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 11:37:43 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-0-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-0-32768-0-1722418639 32768 yes 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-0-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-1-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-1-32768-0
+ env
++ date
+ echo Wed Jul 31 11:38:57 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Wed Jul 31 11:38:57 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at cfab5150ad NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-32768-0-1722418737
+ git checkout -b scalability-yes-1-32768-0-1722418737
Switched to a new branch 'scalability-yes-1-32768-0-1722418737'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-32768-0-1722418737 d9bc6e2eb2] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-32768-0-1722418737 d43ebc1b52] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:39:21 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 11:39:21 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-1-32768-0-1722418737 32768 yes 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1024-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-1024-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1024-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-1024-32768-0
+ env
++ date
+ echo Wed Jul 31 11:40:35 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Wed Jul 31 11:40:35 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d43ebc1b52 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-32768-0-1722418836
+ git checkout -b scalability-yes-1024-32768-0-1722418836
Switched to a new branch 'scalability-yes-1024-32768-0-1722418836'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-32768-0-1722418836 29bcae2a53] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-32768-0-1722418836 362ddd1d8d] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:40:59 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 11:40:59 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1024-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-1024-32768-0-1722418836 32768 yes 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-1024-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-8-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-8-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-8-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-8-32768-0
+ env
++ date
+ echo Wed Jul 31 11:42:14 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Wed Jul 31 11:42:14 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 362ddd1d8d fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-32768-0-1722418934
+ git checkout -b scalability-yes-8-32768-0-1722418934
Switched to a new branch 'scalability-yes-8-32768-0-1722418934'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-32768-0-1722418934 66df2d3cd3] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-32768-0-1722418934 f69dc9f39f] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:42:38 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 11:42:38 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-8-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-8-32768-0-1722418934 32768 yes 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-8-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-512-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-512-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-512-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-512-32768-0
+ env
++ date
+ echo Wed Jul 31 11:43:52 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Wed Jul 31 11:43:52 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at f69dc9f39f fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-32768-0-1722419032
+ git checkout -b scalability-yes-512-32768-0-1722419032
Switched to a new branch 'scalability-yes-512-32768-0-1722419032'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-32768-0-1722419032 8756497e67] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-32768-0-1722419032 90c8227f65] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:44:16 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 11:44:16 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-512-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-512-32768-0-1722419032 32768 yes 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-512-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-128-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-128-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-128-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-yes-128-32768-0
+ env
++ date
+ echo Wed Jul 31 11:45:30 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Wed Jul 31 11:45:30 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 90c8227f65 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-32768-0-1722419130
+ git checkout -b scalability-yes-128-32768-0-1722419130
Switched to a new branch 'scalability-yes-128-32768-0-1722419130'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-32768-0-1722419130 ffab5e73c4] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-32768-0-1722419130 548bc880ac] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:45:54 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 11:45:54 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-128-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-128-32768-0-1722419130 32768 yes 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-yes-128-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-32-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-32-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-32-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-32-32768-0
+ env
++ date
+ echo Wed Jul 31 11:47:08 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Wed Jul 31 11:47:08 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 548bc880ac fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-32768-0-1722419229
+ git checkout -b scalability-no-32-32768-0-1722419229
Switched to a new branch 'scalability-no-32-32768-0-1722419229'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/32/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-32768-0-1722419229 102de69703] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:47:33 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 11:47:33 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-32-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-32-32768-0-1722419229 32768 no 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-32-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-0-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-0-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-0-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-0-32768-0
+ env
++ date
+ echo Wed Jul 31 11:48:47 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Wed Jul 31 11:48:47 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 102de69703 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-32768-0-1722419327
+ git checkout -b scalability-no-0-32768-0-1722419327
Switched to a new branch 'scalability-no-0-32768-0-1722419327'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:49:11 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 11:49:11 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-0-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-0-32768-0-1722419327 32768 no 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-0-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-1-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-1-32768-0
+ env
++ date
+ echo Wed Jul 31 11:50:25 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Wed Jul 31 11:50:25 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-32768-0-1722419425
+ git checkout -b scalability-no-1-32768-0-1722419425
Switched to a new branch 'scalability-no-1-32768-0-1722419425'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-32768-0-1722419425 03838a4116] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:50:49 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 11:50:49 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-1-32768-0-1722419425 32768 no 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1024-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-1024-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1024-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-1024-32768-0
+ env
++ date
+ echo Wed Jul 31 11:52:03 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Wed Jul 31 11:52:03 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 03838a4116 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-32768-0-1722419524
+ git checkout -b scalability-no-1024-32768-0-1722419524
Switched to a new branch 'scalability-no-1024-32768-0-1722419524'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-32768-0-1722419524 6b603dbd6f] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:52:27 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 11:52:27 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1024-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-1024-32768-0-1722419524 32768 no 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-1024-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-8-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-8-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-8-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-8-32768-0
+ env
++ date
+ echo Wed Jul 31 11:53:41 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Wed Jul 31 11:53:41 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 6b603dbd6f fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-32768-0-1722419622
+ git checkout -b scalability-no-8-32768-0-1722419622
Switched to a new branch 'scalability-no-8-32768-0-1722419622'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-32768-0-1722419622 4225d60670] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:54:05 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 11:54:05 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-8-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-8-32768-0-1722419622 32768 no 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-8-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-512-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-512-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-512-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-512-32768-0
+ env
++ date
+ echo Wed Jul 31 11:55:20 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Wed Jul 31 11:55:20 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 4225d60670 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-32768-0-1722419720
+ git checkout -b scalability-no-512-32768-0-1722419720
Switched to a new branch 'scalability-no-512-32768-0-1722419720'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-32768-0-1722419720 d9153012d0] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:55:43 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 11:55:43 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-512-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-512-32768-0-1722419720 32768 no 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-512-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-128-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-128-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-128-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/index-no-128-32768-0
+ env
++ date
+ echo Wed Jul 31 11:56:58 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Wed Jul 31 11:56:58 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d9153012d0 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-32768-0-1722419818
+ git checkout -b scalability-no-128-32768-0-1722419818
Switched to a new branch 'scalability-no-128-32768-0-1722419818'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-32768-0-1722419818 399b4104ff] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:57:22 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 11:57:22 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-128-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-128-32768-0-1722419818 32768 no 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/index-no-128-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-32-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-32-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-32-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-32-32768-0
+ env
++ date
+ echo Wed Jul 31 11:58:36 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Wed Jul 31 11:58:36 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 399b4104ff fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-32768-0-1722419916
+ git checkout -b scalability-yes-32-32768-0-1722419916
Switched to a new branch 'scalability-yes-32-32768-0-1722419916'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-32768-0-1722419916 87b10a1075] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-32768-0-1722419916 f72d403dac] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:59:00 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 11:59:00 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-32-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-32-32768-0-1722419916 32768 yes 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-32-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-0-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-0-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-0-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-0-32768-0
+ env
++ date
+ echo Wed Jul 31 12:00:13 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Wed Jul 31 12:00:13 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at f72d403dac fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-32768-0-1722420013
+ git checkout -b scalability-yes-0-32768-0-1722420013
Switched to a new branch 'scalability-yes-0-32768-0-1722420013'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-32768-0-1722420013 a861de7bb7] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:00:37 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 12:00:37 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-0-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-0-32768-0-1722420013 32768 yes 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-0-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-1-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-1-32768-0
+ env
++ date
+ echo Wed Jul 31 12:01:50 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Wed Jul 31 12:01:50 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a861de7bb7 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-32768-0-1722420110
+ git checkout -b scalability-yes-1-32768-0-1722420110
Switched to a new branch 'scalability-yes-1-32768-0-1722420110'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-32768-0-1722420110 4351062cc8] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-32768-0-1722420110 04da11837f] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:02:14 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 12:02:14 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-1-32768-0-1722420110 32768 yes 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1024-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-1024-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1024-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-1024-32768-0
+ env
++ date
+ echo Wed Jul 31 12:03:27 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Wed Jul 31 12:03:27 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 04da11837f fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-32768-0-1722420207
+ git checkout -b scalability-yes-1024-32768-0-1722420207
Switched to a new branch 'scalability-yes-1024-32768-0-1722420207'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-32768-0-1722420207 e3bdc7558c] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-32768-0-1722420207 0445ddd94d] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:03:51 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 12:03:51 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1024-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-1024-32768-0-1722420207 32768 yes 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-1024-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-8-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-8-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-8-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-8-32768-0
+ env
++ date
+ echo Wed Jul 31 12:05:04 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Wed Jul 31 12:05:04 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 0445ddd94d fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-32768-0-1722420305
+ git checkout -b scalability-yes-8-32768-0-1722420305
Switched to a new branch 'scalability-yes-8-32768-0-1722420305'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-32768-0-1722420305 5bf84d54a1] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-32768-0-1722420305 db04141ad5] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:05:28 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 12:05:28 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-8-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-8-32768-0-1722420305 32768 yes 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-8-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-512-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-512-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-512-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-512-32768-0
+ env
++ date
+ echo Wed Jul 31 12:06:42 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Wed Jul 31 12:06:42 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at db04141ad5 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-32768-0-1722420402
+ git checkout -b scalability-yes-512-32768-0-1722420402
Switched to a new branch 'scalability-yes-512-32768-0-1722420402'
+ '[' yes == yes ']'
+ patch -p1
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-32768-0-1722420402 6a31d6dd99] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-32768-0-1722420402 1ecf898e1b] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:07:05 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 12:07:05 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-512-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-512-32768-0-1722420402 32768 yes 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-512-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-128-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-128-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-128-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-yes-128-32768-0
+ env
++ date
+ echo Wed Jul 31 12:08:19 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Wed Jul 31 12:08:19 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 1ecf898e1b fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-32768-0-1722420499
+ git checkout -b scalability-yes-128-32768-0-1722420499
Switched to a new branch 'scalability-yes-128-32768-0-1722420499'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-32768-0-1722420499 637a1e433e] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-32768-0-1722420499 7e1be56c1e] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:08:43 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 12:08:43 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-128-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-128-32768-0-1722420499 32768 yes 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-yes-128-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-32-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-32-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-32-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-32-32768-0
+ env
++ date
+ echo Wed Jul 31 12:09:56 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Wed Jul 31 12:09:56 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 7e1be56c1e fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-32768-0-1722420596
+ git checkout -b scalability-no-32-32768-0-1722420596
Switched to a new branch 'scalability-no-32-32768-0-1722420596'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-32768-0-1722420596 25f1c7df3a] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:10:20 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 12:10:20 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-32-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-32-32768-0-1722420596 32768 no 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-32-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-0-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-0-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-0-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-0-32768-0
+ env
++ date
+ echo Wed Jul 31 12:11:33 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Wed Jul 31 12:11:33 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 25f1c7df3a fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-32768-0-1722420693
+ git checkout -b scalability-no-0-32768-0-1722420693
Switched to a new branch 'scalability-no-0-32768-0-1722420693'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:11:57 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 12:11:57 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-0-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-0-32768-0-1722420693 32768 no 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-0-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-1-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-1-32768-0
+ env
++ date
+ echo Wed Jul 31 12:13:10 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Wed Jul 31 12:13:10 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-32768-0-1722420790
+ git checkout -b scalability-no-1-32768-0-1722420790
Switched to a new branch 'scalability-no-1-32768-0-1722420790'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-32768-0-1722420790 dcac3c0255] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:13:34 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 12:13:34 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-1-32768-0-1722420790 32768 no 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1024-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-1024-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1024-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-1024-32768-0
+ env
++ date
+ echo Wed Jul 31 12:14:47 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Wed Jul 31 12:14:47 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at dcac3c0255 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-32768-0-1722420887
+ git checkout -b scalability-no-1024-32768-0-1722420887
Switched to a new branch 'scalability-no-1024-32768-0-1722420887'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-32768-0-1722420887 d7682570a2] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:15:11 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 12:15:11 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1024-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-1024-32768-0-1722420887 32768 no 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-1024-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-8-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-8-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-8-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-8-32768-0
+ env
++ date
+ echo Wed Jul 31 12:16:24 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Wed Jul 31 12:16:24 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d7682570a2 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-32768-0-1722420984
+ git checkout -b scalability-no-8-32768-0-1722420984
Switched to a new branch 'scalability-no-8-32768-0-1722420984'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-32768-0-1722420984 5605f81d70] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:16:48 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 12:16:48 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-8-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-8-32768-0-1722420984 32768 no 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-8-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-512-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-512-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-512-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-512-32768-0
+ env
++ date
+ echo Wed Jul 31 12:18:01 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Wed Jul 31 12:18:01 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 5605f81d70 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-32768-0-1722421081
+ git checkout -b scalability-no-512-32768-0-1722421081
Switched to a new branch 'scalability-no-512-32768-0-1722421081'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/512/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-32768-0-1722421081 ae3ab186a6] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:18:25 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 12:18:25 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-512-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-512-32768-0-1722421081 32768 no 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-512-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-128-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-128-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-128-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/count-no-128-32768-0
+ env
++ date
+ echo Wed Jul 31 12:19:38 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Wed Jul 31 12:19:38 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at ae3ab186a6 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-32768-0-1722421178
+ git checkout -b scalability-no-128-32768-0-1722421178
Switched to a new branch 'scalability-no-128-32768-0-1722421178'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-32768-0-1722421178 5d4d7bdca1] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:20:02 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 12:20:02 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-128-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-128-32768-0-1722421178 32768 no 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/count-no-128-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-32-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-32-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-32-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-32-32768-0
+ env
++ date
+ echo Wed Jul 31 12:21:15 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Wed Jul 31 12:21:15 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 5d4d7bdca1 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-32768-0-1722421275
+ git checkout -b scalability-yes-32-32768-0-1722421275
Switched to a new branch 'scalability-yes-32-32768-0-1722421275'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-32768-0-1722421275 1e56de87d5] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-32768-0-1722421275 76604db5df] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:21:39 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 12:21:39 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-32-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-32-32768-0-1722421275 32768 yes 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-32-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-0-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-0-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-0-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-0-32768-0
+ env
++ date
+ echo Wed Jul 31 12:22:57 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Wed Jul 31 12:22:57 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 76604db5df fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-32768-0-1722421378
+ git checkout -b scalability-yes-0-32768-0-1722421378
Switched to a new branch 'scalability-yes-0-32768-0-1722421378'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-32768-0-1722421378 d035ccf2dd] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:23:21 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 12:23:21 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-0-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-0-32768-0-1722421378 32768 yes 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-0-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-1-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-1-32768-0
+ env
++ date
+ echo Wed Jul 31 12:24:40 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Wed Jul 31 12:24:40 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d035ccf2dd NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-32768-0-1722421480
+ git checkout -b scalability-yes-1-32768-0-1722421480
Switched to a new branch 'scalability-yes-1-32768-0-1722421480'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-32768-0-1722421480 025e638ccc] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-32768-0-1722421480 2529fd3773] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:25:04 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 12:25:04 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-1-32768-0-1722421480 32768 yes 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1024-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-1024-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1024-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-1024-32768-0
+ env
++ date
+ echo Wed Jul 31 12:26:22 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Wed Jul 31 12:26:22 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 2529fd3773 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-32768-0-1722421582
+ git checkout -b scalability-yes-1024-32768-0-1722421582
Switched to a new branch 'scalability-yes-1024-32768-0-1722421582'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-32768-0-1722421582 e14c1a83e2] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-32768-0-1722421582 a3365c3001] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:26:46 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 12:26:46 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1024-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-1024-32768-0-1722421582 32768 yes 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-1024-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-8-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-8-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-8-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-8-32768-0
+ env
++ date
+ echo Wed Jul 31 12:28:05 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Wed Jul 31 12:28:05 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a3365c3001 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-32768-0-1722421685
+ git checkout -b scalability-yes-8-32768-0-1722421685
Switched to a new branch 'scalability-yes-8-32768-0-1722421685'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-32768-0-1722421685 1b9de58ecd] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-32768-0-1722421685 470c8c37c0] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:28:29 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 12:28:29 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-8-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-8-32768-0-1722421685 32768 yes 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-8-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-512-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-512-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-512-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-512-32768-0
+ env
++ date
+ echo Wed Jul 31 12:29:48 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Wed Jul 31 12:29:48 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 470c8c37c0 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-32768-0-1722421788
+ git checkout -b scalability-yes-512-32768-0-1722421788
Switched to a new branch 'scalability-yes-512-32768-0-1722421788'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-32768-0-1722421788 4f81bd328d] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-32768-0-1722421788 cfd10326ee] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:30:12 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 12:30:12 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-512-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-512-32768-0-1722421788 32768 yes 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-512-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-128-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-128-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-128-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-yes-128-32768-0
+ env
++ date
+ echo Wed Jul 31 12:31:30 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Wed Jul 31 12:31:30 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at cfd10326ee fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-32768-0-1722421890
+ git checkout -b scalability-yes-128-32768-0-1722421890
Switched to a new branch 'scalability-yes-128-32768-0-1722421890'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-32768-0-1722421890 53ae9a99f6] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-32768-0-1722421890 5551cf5aa4] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:31:54 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 12:31:54 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-128-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-128-32768-0-1722421890 32768 yes 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-yes-128-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-32-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-32-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-32-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-32-32768-0
+ env
++ date
+ echo Wed Jul 31 12:33:12 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Wed Jul 31 12:33:12 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 5551cf5aa4 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-32768-0-1722421993
+ git checkout -b scalability-no-32-32768-0-1722421993
Switched to a new branch 'scalability-no-32-32768-0-1722421993'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-32768-0-1722421993 9445825dd7] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:33:37 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 12:33:37 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-32-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-32-32768-0-1722421993 32768 no 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-32-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-0-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-0-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-0-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-0-32768-0
+ env
++ date
+ echo Wed Jul 31 12:34:55 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Wed Jul 31 12:34:55 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 9445825dd7 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-32768-0-1722422095
+ git checkout -b scalability-no-0-32768-0-1722422095
Switched to a new branch 'scalability-no-0-32768-0-1722422095'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:35:19 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 12:35:19 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-0-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-0-32768-0-1722422095 32768 no 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-0-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-1-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-1-32768-0
+ env
++ date
+ echo Wed Jul 31 12:36:37 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Wed Jul 31 12:36:37 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-32768-0-1722422197
+ git checkout -b scalability-no-1-32768-0-1722422197
Switched to a new branch 'scalability-no-1-32768-0-1722422197'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-32768-0-1722422197 d0dbe33779] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:37:01 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 12:37:01 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-1-32768-0-1722422197 32768 no 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1024-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-1024-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1024-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-1024-32768-0
+ env
++ date
+ echo Wed Jul 31 12:38:20 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Wed Jul 31 12:38:20 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d0dbe33779 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-32768-0-1722422300
+ git checkout -b scalability-no-1024-32768-0-1722422300
Switched to a new branch 'scalability-no-1024-32768-0-1722422300'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-32768-0-1722422300 9833864ccb] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:38:43 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 12:38:43 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1024-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-1024-32768-0-1722422300 32768 no 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-1024-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-8-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-8-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-8-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-8-32768-0
+ env
++ date
+ echo Wed Jul 31 12:40:02 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Wed Jul 31 12:40:02 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 9833864ccb fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-32768-0-1722422402
+ git checkout -b scalability-no-8-32768-0-1722422402
Switched to a new branch 'scalability-no-8-32768-0-1722422402'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-32768-0-1722422402 d14b0a4c55] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:40:26 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 12:40:26 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-8-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-8-32768-0-1722422402 32768 no 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-8-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-512-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-512-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-512-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-512-32768-0
+ env
++ date
+ echo Wed Jul 31 12:41:45 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Wed Jul 31 12:41:45 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d14b0a4c55 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-32768-0-1722422505
+ git checkout -b scalability-no-512-32768-0-1722422505
Switched to a new branch 'scalability-no-512-32768-0-1722422505'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-32768-0-1722422505 b0aa038079] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:42:09 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 12:42:09 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-512-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-512-32768-0-1722422505 32768 no 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-512-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-128-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-128-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-128-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/join-no-128-32768-0
+ env
++ date
+ echo Wed Jul 31 12:43:27 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Wed Jul 31 12:43:27 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b0aa038079 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-32768-0-1722422607
+ git checkout -b scalability-no-128-32768-0-1722422607
Switched to a new branch 'scalability-no-128-32768-0-1722422607'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-32768-0-1722422607 a40a9e1304] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:43:51 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 12:43:51 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-128-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-128-32768-0-1722422607 32768 no 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/join-no-128-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-32-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-32-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-32-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-32-32768-0
+ env
++ date
+ echo Wed Jul 31 12:45:10 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Wed Jul 31 12:45:10 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a40a9e1304 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-32768-0-1722422710
+ git checkout -b scalability-yes-32-32768-0-1722422710
Switched to a new branch 'scalability-yes-32-32768-0-1722422710'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-32768-0-1722422710 b95453511d] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-32768-0-1722422710 d6d6c91a3d] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:45:33 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 12:45:33 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-32-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-32-32768-0-1722422710 32768 yes 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-32-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-0-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-0-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-0-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-0-32768-0
+ env
++ date
+ echo Wed Jul 31 12:45:36 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Wed Jul 31 12:45:36 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d6d6c91a3d fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-32768-0-1722422736
+ git checkout -b scalability-yes-0-32768-0-1722422736
Switched to a new branch 'scalability-yes-0-32768-0-1722422736'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-32768-0-1722422736 730525485a] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:46:00 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 12:46:00 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-0-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-0-32768-0-1722422736 32768 yes 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-0-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-1-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-1-32768-0
+ env
++ date
+ echo Wed Jul 31 12:46:03 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Wed Jul 31 12:46:03 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 730525485a NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-32768-0-1722422763
+ git checkout -b scalability-yes-1-32768-0-1722422763
Switched to a new branch 'scalability-yes-1-32768-0-1722422763'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-32768-0-1722422763 c5ada60e41] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-32768-0-1722422763 cfef48ca6e] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:46:27 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 12:46:27 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-1-32768-0-1722422763 32768 yes 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1024-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-1024-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1024-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-1024-32768-0
+ env
++ date
+ echo Wed Jul 31 12:46:30 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Wed Jul 31 12:46:30 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at cfef48ca6e fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-32768-0-1722422790
+ git checkout -b scalability-yes-1024-32768-0-1722422790
Switched to a new branch 'scalability-yes-1024-32768-0-1722422790'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-32768-0-1722422790 289a4983f8] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-32768-0-1722422790 679f1ff703] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:46:54 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 12:46:54 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1024-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-1024-32768-0-1722422790 32768 yes 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-1024-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-8-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-8-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-8-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-8-32768-0
+ env
++ date
+ echo Wed Jul 31 12:46:57 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Wed Jul 31 12:46:57 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 679f1ff703 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-32768-0-1722422817
+ git checkout -b scalability-yes-8-32768-0-1722422817
Switched to a new branch 'scalability-yes-8-32768-0-1722422817'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-32768-0-1722422817 1146db3112] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-32768-0-1722422817 8b6da56ea1] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:47:21 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 12:47:21 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-8-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-8-32768-0-1722422817 32768 yes 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-8-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-512-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-512-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-512-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-512-32768-0
+ env
++ date
+ echo Wed Jul 31 12:47:24 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Wed Jul 31 12:47:24 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 8b6da56ea1 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-32768-0-1722422844
+ git checkout -b scalability-yes-512-32768-0-1722422844
Switched to a new branch 'scalability-yes-512-32768-0-1722422844'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-32768-0-1722422844 a86a01e0ed] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-32768-0-1722422844 7ee99f8aab] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:47:48 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 12:47:48 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-512-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-512-32768-0-1722422844 32768 yes 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-512-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-128-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-128-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-128-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-yes-128-32768-0
+ env
++ date
+ echo Wed Jul 31 12:47:51 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Wed Jul 31 12:47:51 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 7ee99f8aab fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-32768-0-1722422871
+ git checkout -b scalability-yes-128-32768-0-1722422871
Switched to a new branch 'scalability-yes-128-32768-0-1722422871'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-32768-0-1722422871 efc34919ee] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-32768-0-1722422871 9b75ecd813] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:48:15 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 12:48:15 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-128-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-128-32768-0-1722422871 32768 yes 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-yes-128-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-32-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-32-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-32-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-32-32768-0
+ env
++ date
+ echo Wed Jul 31 12:48:18 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Wed Jul 31 12:48:18 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 9b75ecd813 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-32768-0-1722422898
+ git checkout -b scalability-no-32-32768-0-1722422898
Switched to a new branch 'scalability-no-32-32768-0-1722422898'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-32768-0-1722422898 c59250bd85] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:48:42 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 12:48:42 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-32-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-32-32768-0-1722422898 32768 no 32 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-32-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-0-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-0-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-0-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-0-32768-0
+ env
++ date
+ echo Wed Jul 31 12:48:45 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Wed Jul 31 12:48:45 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at c59250bd85 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-32768-0-1722422925
+ git checkout -b scalability-no-0-32768-0-1722422925
Switched to a new branch 'scalability-no-0-32768-0-1722422925'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:49:09 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 12:49:09 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-0-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-0-32768-0-1722422925 32768 no 0 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-0-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-1-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-1-32768-0
+ env
++ date
+ echo Wed Jul 31 12:49:12 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Wed Jul 31 12:49:12 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-32768-0-1722422952
+ git checkout -b scalability-no-1-32768-0-1722422952
Switched to a new branch 'scalability-no-1-32768-0-1722422952'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-32768-0-1722422952 cb0397627e] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:49:36 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 12:49:36 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-1-32768-0-1722422952 32768 no 1 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1024-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-1024-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1024-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-1024-32768-0
+ env
++ date
+ echo Wed Jul 31 12:49:39 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Wed Jul 31 12:49:39 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at cb0397627e fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-32768-0-1722422979
+ git checkout -b scalability-no-1024-32768-0-1722422979
Switched to a new branch 'scalability-no-1024-32768-0-1722422979'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-32768-0-1722422979 ea44465e11] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:50:02 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 12:50:02 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1024-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-1024-32768-0-1722422979 32768 no 1024 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-1024-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-8-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-8-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-8-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-8-32768-0
+ env
++ date
+ echo Wed Jul 31 12:50:05 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Wed Jul 31 12:50:05 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at ea44465e11 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-32768-0-1722423006
+ git checkout -b scalability-no-8-32768-0-1722423006
Switched to a new branch 'scalability-no-8-32768-0-1722423006'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-32768-0-1722423006 3f9e1b7d4f] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:50:29 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 12:50:29 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-8-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-8-32768-0-1722423006 32768 no 8 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-8-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-512-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-512-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-512-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-512-32768-0
+ env
++ date
+ echo Wed Jul 31 12:50:32 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Wed Jul 31 12:50:32 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 3f9e1b7d4f fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-32768-0-1722423032
+ git checkout -b scalability-no-512-32768-0-1722423032
Switched to a new branch 'scalability-no-512-32768-0-1722423032'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-32768-0-1722423032 a3f7df2930] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:50:56 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 12:50:56 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-512-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-512-32768-0-1722423032 32768 no 512 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-512-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-128-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-128-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-128-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240730-1352-glibc-default/results/star-no-128-32768-0
+ env
++ date
+ echo Wed Jul 31 12:50:59 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Wed Jul 31 12:50:59 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a3f7df2930 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-32768-0-1722423059
+ git checkout -b scalability-no-128-32768-0-1722423059
Switched to a new branch 'scalability-no-128-32768-0-1722423059'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-32768-0-1722423059 2b00dfc37a] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 12:51:23 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Wed Jul 31 12:51:23 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-128-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-128-32768-0-1722423059 32768 no 128 /mnt/data/lock-scalability-test/20240730-1352-glibc-default/logs/star-no-128-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
