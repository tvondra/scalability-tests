+ set -e
+ LABEL=glibc-tuned
+ MACHINE=i5
+ DBNAME=test
+ RUNS=1
+ DURATION=10
+ CLIENTS='1 4 16'
+ PARTITIONS='1000 100 10 1 0'
+ BUILDS=/mnt/data/builds
+ SOURCE=/mnt/data/postgres
+ PATH_OLD=/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
++ date +%Y%m%d-%H%M
+ DATE=20240731-2049
++ pwd
+ PATCHES=/mnt/data/lock-scalability-test/patches
++ pwd
+ LOGS=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs
++ pwd
+ RESULTS=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results
+ DATADIR=/mnt/pgdata/data-test
+ ulimit -n 35000
+ export MALLOC_TOP_PAD_=67108864
+ MALLOC_TOP_PAD_=67108864
+ export MALLOC_MMAP_THRESHOLD_=1048576
+ MALLOC_MMAP_THRESHOLD_=1048576
+ export MALLOC_TRIM_THRESHOLD_=1048576
+ MALLOC_TRIM_THRESHOLD_=1048576
+ for files in 1000 32768
+ for p in $PARTITIONS
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-32-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-32-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-32-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-32-1000-1000
+ env
++ date
+ echo Wed Jul 31 08:49:30 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Wed Jul 31 08:49:30 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e6f1ffc8bf fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-1000-1000-1722451770
+ git checkout -b scalability-yes-32-1000-1000-1722451770
Switched to a new branch 'scalability-yes-32-1000-1000-1722451770'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-1000-1000-1722451770 3461a79945] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-1000-1000-1722451770 795d02ba12] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 08:50:13 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 08:50:13 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-32-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-32-1000-1000-1722451770 1000 yes 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-32-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-0-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-0-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-0-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-0-1000-1000
+ env
++ date
+ echo Wed Jul 31 08:51:33 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Wed Jul 31 08:51:33 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 795d02ba12 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-1000-1000-1722451893
+ git checkout -b scalability-yes-0-1000-1000-1722451893
Switched to a new branch 'scalability-yes-0-1000-1000-1722451893'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-1000-1000-1722451893 3a449a8405] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 08:52:15 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 08:52:15 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-0-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-0-1000-1000-1722451893 1000 yes 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-0-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-1-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-1-1000-1000
+ env
++ date
+ echo Wed Jul 31 08:53:35 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Wed Jul 31 08:53:35 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 3a449a8405 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-1000-1000-1722452015
+ git checkout -b scalability-yes-1-1000-1000-1722452015
Switched to a new branch 'scalability-yes-1-1000-1000-1722452015'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-1000-1000-1722452015 cb2256f3d4] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-1000-1000-1722452015 57c4a3630f] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 08:54:18 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 08:54:18 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-1-1000-1000-1722452015 1000 yes 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1024-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-1024-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1024-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-1024-1000-1000
+ env
++ date
+ echo Wed Jul 31 08:55:38 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Wed Jul 31 08:55:38 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 57c4a3630f fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-1000-1000-1722452138
+ git checkout -b scalability-yes-1024-1000-1000-1722452138
Switched to a new branch 'scalability-yes-1024-1000-1000-1722452138'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-1000-1000-1722452138 fa90d1bb29] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-1000-1000-1722452138 71222071ef] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 08:56:20 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 08:56:20 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1024-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-1024-1000-1000-1722452138 1000 yes 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1024-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-8-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-8-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-8-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-8-1000-1000
+ env
++ date
+ echo Wed Jul 31 08:57:40 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Wed Jul 31 08:57:40 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 71222071ef fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-1000-1000-1722452260
+ git checkout -b scalability-yes-8-1000-1000-1722452260
Switched to a new branch 'scalability-yes-8-1000-1000-1722452260'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-1000-1000-1722452260 0162bcefe1] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-1000-1000-1722452260 eae8bd6667] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 08:58:22 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 08:58:22 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-8-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-8-1000-1000-1722452260 1000 yes 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-8-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-512-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-512-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-512-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-512-1000-1000
+ env
++ date
+ echo Wed Jul 31 08:59:42 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Wed Jul 31 08:59:42 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at eae8bd6667 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-1000-1000-1722452382
+ git checkout -b scalability-yes-512-1000-1000-1722452382
Switched to a new branch 'scalability-yes-512-1000-1000-1722452382'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-1000-1000-1722452382 c265f93123] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-1000-1000-1722452382 85069a8182] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:00:25 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 09:00:25 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-512-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-512-1000-1000-1722452382 1000 yes 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-512-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-128-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-128-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-128-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-128-1000-1000
+ env
++ date
+ echo Wed Jul 31 09:01:45 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Wed Jul 31 09:01:45 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 85069a8182 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-1000-1000-1722452505
+ git checkout -b scalability-yes-128-1000-1000-1722452505
Switched to a new branch 'scalability-yes-128-1000-1000-1722452505'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-1000-1000-1722452505 bd0f795c27] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-1000-1000-1722452505 e275229c07] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:02:27 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 09:02:27 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-128-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-128-1000-1000-1722452505 1000 yes 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-128-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-32-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-32-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-32-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-32-1000-1000
+ env
++ date
+ echo Wed Jul 31 09:03:47 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Wed Jul 31 09:03:47 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e275229c07 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-1000-1000-1722452627
+ git checkout -b scalability-no-32-1000-1000-1722452627
Switched to a new branch 'scalability-no-32-1000-1000-1722452627'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/32/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-1000-1000-1722452627 31ac2e3051] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:04:30 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 09:04:30 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-32-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-32-1000-1000-1722452627 1000 no 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-32-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-0-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-0-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-0-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-0-1000-1000
+ env
++ date
+ echo Wed Jul 31 09:05:49 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Wed Jul 31 09:05:49 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 31ac2e3051 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-1000-1000-1722452749
+ git checkout -b scalability-no-0-1000-1000-1722452749
Switched to a new branch 'scalability-no-0-1000-1000-1722452749'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:06:32 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 09:06:32 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-0-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-0-1000-1000-1722452749 1000 no 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-0-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-1-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-1-1000-1000
+ env
++ date
+ echo Wed Jul 31 09:07:51 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Wed Jul 31 09:07:51 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-1000-1000-1722452872
+ git checkout -b scalability-no-1-1000-1000-1722452872
Switched to a new branch 'scalability-no-1-1000-1000-1722452872'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-1000-1000-1722452872 81b31aa782] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:08:34 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 09:08:34 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-1-1000-1000-1722452872 1000 no 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1024-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-1024-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1024-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-1024-1000-1000
+ env
++ date
+ echo Wed Jul 31 09:09:54 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Wed Jul 31 09:09:54 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 81b31aa782 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-1000-1000-1722452994
+ git checkout -b scalability-no-1024-1000-1000-1722452994
Switched to a new branch 'scalability-no-1024-1000-1000-1722452994'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-1000-1000-1722452994 c867e434bb] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:10:36 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 09:10:36 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1024-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-1024-1000-1000-1722452994 1000 no 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1024-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-8-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-8-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-8-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-8-1000-1000
+ env
++ date
+ echo Wed Jul 31 09:11:56 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Wed Jul 31 09:11:56 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at c867e434bb fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-1000-1000-1722453116
+ git checkout -b scalability-no-8-1000-1000-1722453116
Switched to a new branch 'scalability-no-8-1000-1000-1722453116'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-1000-1000-1722453116 98ec0c7cce] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:12:38 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 09:12:38 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-8-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-8-1000-1000-1722453116 1000 no 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-8-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-512-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-512-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-512-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-512-1000-1000
+ env
++ date
+ echo Wed Jul 31 09:13:58 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Wed Jul 31 09:13:58 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 98ec0c7cce fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-1000-1000-1722453238
+ git checkout -b scalability-no-512-1000-1000-1722453238
Switched to a new branch 'scalability-no-512-1000-1000-1722453238'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-1000-1000-1722453238 ad9f54c481] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:14:41 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 09:14:41 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-512-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-512-1000-1000-1722453238 1000 no 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-512-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-128-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-128-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-128-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-128-1000-1000
+ env
++ date
+ echo Wed Jul 31 09:16:00 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Wed Jul 31 09:16:00 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at ad9f54c481 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-1000-1000-1722453361
+ git checkout -b scalability-no-128-1000-1000-1722453361
Switched to a new branch 'scalability-no-128-1000-1000-1722453361'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-1000-1000-1722453361 dc813bf3c4] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:16:43 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 09:16:43 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-128-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-128-1000-1000-1722453361 1000 no 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-128-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-32-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-32-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-32-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-32-1000-1000
+ env
++ date
+ echo Wed Jul 31 09:18:03 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Wed Jul 31 09:18:03 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at dc813bf3c4 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-1000-1000-1722453483
+ git checkout -b scalability-yes-32-1000-1000-1722453483
Switched to a new branch 'scalability-yes-32-1000-1000-1722453483'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-1000-1000-1722453483 d72622dc53] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-1000-1000-1722453483 924a4d41b4] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:18:27 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 09:18:27 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-32-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-32-1000-1000-1722453483 1000 yes 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-32-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-0-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-0-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-0-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-0-1000-1000
+ env
++ date
+ echo Wed Jul 31 09:20:22 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Wed Jul 31 09:20:22 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 924a4d41b4 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-1000-1000-1722453622
+ git checkout -b scalability-yes-0-1000-1000-1722453622
Switched to a new branch 'scalability-yes-0-1000-1000-1722453622'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-1000-1000-1722453622 e47e16bcdc] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:20:46 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 09:20:46 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-0-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-0-1000-1000-1722453622 1000 yes 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-0-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-1-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-1-1000-1000
+ env
++ date
+ echo Wed Jul 31 09:22:41 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Wed Jul 31 09:22:41 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e47e16bcdc NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-1000-1000-1722453762
+ git checkout -b scalability-yes-1-1000-1000-1722453762
Switched to a new branch 'scalability-yes-1-1000-1000-1722453762'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-1000-1000-1722453762 012896b98d] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-1000-1000-1722453762 0729710f90] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:23:05 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 09:23:05 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-1-1000-1000-1722453762 1000 yes 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1024-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-1024-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1024-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-1024-1000-1000
+ env
++ date
+ echo Wed Jul 31 09:25:00 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Wed Jul 31 09:25:00 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 0729710f90 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-1000-1000-1722453900
+ git checkout -b scalability-yes-1024-1000-1000-1722453900
Switched to a new branch 'scalability-yes-1024-1000-1000-1722453900'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-1000-1000-1722453900 d2984affb2] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-1000-1000-1722453900 2ac36d2c4a] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:25:24 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 09:25:24 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1024-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-1024-1000-1000-1722453900 1000 yes 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1024-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-8-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-8-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-8-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-8-1000-1000
+ env
++ date
+ echo Wed Jul 31 09:27:21 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Wed Jul 31 09:27:21 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 2ac36d2c4a fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-1000-1000-1722454041
+ git checkout -b scalability-yes-8-1000-1000-1722454041
Switched to a new branch 'scalability-yes-8-1000-1000-1722454041'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-1000-1000-1722454041 c004c8fa46] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-1000-1000-1722454041 3144ebccd6] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:27:44 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 09:27:44 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-8-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-8-1000-1000-1722454041 1000 yes 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-8-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-512-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-512-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-512-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-512-1000-1000
+ env
++ date
+ echo Wed Jul 31 09:29:40 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Wed Jul 31 09:29:40 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 3144ebccd6 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-1000-1000-1722454180
+ git checkout -b scalability-yes-512-1000-1000-1722454180
Switched to a new branch 'scalability-yes-512-1000-1000-1722454180'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-1000-1000-1722454180 e6d92df4bb] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-1000-1000-1722454180 4f40d6d75a] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:30:03 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 09:30:03 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-512-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-512-1000-1000-1722454180 1000 yes 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-512-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-128-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-128-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-128-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-128-1000-1000
+ env
++ date
+ echo Wed Jul 31 09:32:00 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Wed Jul 31 09:32:00 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 4f40d6d75a fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-1000-1000-1722454320
+ git checkout -b scalability-yes-128-1000-1000-1722454320
Switched to a new branch 'scalability-yes-128-1000-1000-1722454320'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-1000-1000-1722454320 cd23907327] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-1000-1000-1722454320 48c957ff69] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:32:23 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 09:32:23 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-128-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-128-1000-1000-1722454320 1000 yes 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-128-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-32-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-32-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-32-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-32-1000-1000
+ env
++ date
+ echo Wed Jul 31 09:34:19 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Wed Jul 31 09:34:19 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 48c957ff69 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-1000-1000-1722454459
+ git checkout -b scalability-no-32-1000-1000-1722454459
Switched to a new branch 'scalability-no-32-1000-1000-1722454459'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-1000-1000-1722454459 ca476d1611] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:34:43 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 09:34:43 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-32-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-32-1000-1000-1722454459 1000 no 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-32-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-0-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-0-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-0-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-0-1000-1000
+ env
++ date
+ echo Wed Jul 31 09:36:38 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Wed Jul 31 09:36:38 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at ca476d1611 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-1000-1000-1722454599
+ git checkout -b scalability-no-0-1000-1000-1722454599
Switched to a new branch 'scalability-no-0-1000-1000-1722454599'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:37:02 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 09:37:02 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-0-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-0-1000-1000-1722454599 1000 no 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-0-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-1-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-1-1000-1000
+ env
++ date
+ echo Wed Jul 31 09:38:57 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Wed Jul 31 09:38:57 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-1000-1000-1722454737
+ git checkout -b scalability-no-1-1000-1000-1722454737
Switched to a new branch 'scalability-no-1-1000-1000-1722454737'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-1000-1000-1722454737 498f584489] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:39:21 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 09:39:21 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-1-1000-1000-1722454737 1000 no 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1024-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-1024-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1024-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-1024-1000-1000
+ env
++ date
+ echo Wed Jul 31 09:41:18 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Wed Jul 31 09:41:18 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 498f584489 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-1000-1000-1722454878
+ git checkout -b scalability-no-1024-1000-1000-1722454878
Switched to a new branch 'scalability-no-1024-1000-1000-1722454878'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-1000-1000-1722454878 e19774a816] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:41:41 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 09:41:41 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1024-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-1024-1000-1000-1722454878 1000 no 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1024-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-8-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-8-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-8-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-8-1000-1000
+ env
++ date
+ echo Wed Jul 31 09:43:38 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Wed Jul 31 09:43:38 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e19774a816 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-1000-1000-1722455019
+ git checkout -b scalability-no-8-1000-1000-1722455019
Switched to a new branch 'scalability-no-8-1000-1000-1722455019'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/8/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-1000-1000-1722455019 8093f1fb9a] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:44:02 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 09:44:02 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-8-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-8-1000-1000-1722455019 1000 no 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-8-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-512-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-512-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-512-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-512-1000-1000
+ env
++ date
+ echo Wed Jul 31 09:45:57 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Wed Jul 31 09:45:57 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 8093f1fb9a fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-1000-1000-1722455158
+ git checkout -b scalability-no-512-1000-1000-1722455158
Switched to a new branch 'scalability-no-512-1000-1000-1722455158'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/512/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-1000-1000-1722455158 aae46b2438] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:46:21 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 09:46:21 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-512-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-512-1000-1000-1722455158 1000 no 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-512-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-128-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-128-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-128-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-128-1000-1000
+ env
++ date
+ echo Wed Jul 31 09:48:18 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Wed Jul 31 09:48:18 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at aae46b2438 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-1000-1000-1722455298
+ git checkout -b scalability-no-128-1000-1000-1722455298
Switched to a new branch 'scalability-no-128-1000-1000-1722455298'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/128/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-1000-1000-1722455298 2c0ae3a78b] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:48:41 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 09:48:41 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-128-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-128-1000-1000-1722455298 1000 no 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-128-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-32-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-32-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-32-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-32-1000-1000
+ env
++ date
+ echo Wed Jul 31 09:50:37 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Wed Jul 31 09:50:37 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 2c0ae3a78b fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-1000-1000-1722455437
+ git checkout -b scalability-yes-32-1000-1000-1722455437
Switched to a new branch 'scalability-yes-32-1000-1000-1722455437'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-1000-1000-1722455437 e5a0fc5870] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-1000-1000-1722455437 ca02dcc3ad] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:51:00 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 09:51:00 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-32-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-32-1000-1000-1722455437 1000 yes 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-32-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-0-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-0-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-0-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-0-1000-1000
+ env
++ date
+ echo Wed Jul 31 09:52:23 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Wed Jul 31 09:52:23 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at ca02dcc3ad fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-1000-1000-1722455543
+ git checkout -b scalability-yes-0-1000-1000-1722455543
Switched to a new branch 'scalability-yes-0-1000-1000-1722455543'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-1000-1000-1722455543 a1fa2081b2] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:52:46 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 09:52:46 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-0-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-0-1000-1000-1722455543 1000 yes 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-0-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-1-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-1-1000-1000
+ env
++ date
+ echo Wed Jul 31 09:54:08 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Wed Jul 31 09:54:08 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a1fa2081b2 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-1000-1000-1722455648
+ git checkout -b scalability-yes-1-1000-1000-1722455648
Switched to a new branch 'scalability-yes-1-1000-1000-1722455648'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-1000-1000-1722455648 043190baad] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-1000-1000-1722455648 ff5b507b6f] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:54:32 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 09:54:32 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-1-1000-1000-1722455648 1000 yes 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1024-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-1024-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1024-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-1024-1000-1000
+ env
++ date
+ echo Wed Jul 31 09:55:54 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Wed Jul 31 09:55:54 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at ff5b507b6f fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-1000-1000-1722455754
+ git checkout -b scalability-yes-1024-1000-1000-1722455754
Switched to a new branch 'scalability-yes-1024-1000-1000-1722455754'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-1000-1000-1722455754 5c8fcefebf] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-1000-1000-1722455754 c725e339cd] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:56:17 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 09:56:17 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1024-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-1024-1000-1000-1722455754 1000 yes 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1024-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-8-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-8-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-8-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-8-1000-1000
+ env
++ date
+ echo Wed Jul 31 09:57:42 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Wed Jul 31 09:57:42 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at c725e339cd fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-1000-1000-1722455862
+ git checkout -b scalability-yes-8-1000-1000-1722455862
Switched to a new branch 'scalability-yes-8-1000-1000-1722455862'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-1000-1000-1722455862 2c43431969] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-1000-1000-1722455862 e91ca9f253] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:58:06 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 09:58:06 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-8-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-8-1000-1000-1722455862 1000 yes 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-8-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-512-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-512-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-512-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-512-1000-1000
+ env
++ date
+ echo Wed Jul 31 09:59:28 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Wed Jul 31 09:59:28 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e91ca9f253 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-1000-1000-1722455968
+ git checkout -b scalability-yes-512-1000-1000-1722455968
Switched to a new branch 'scalability-yes-512-1000-1000-1722455968'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-1000-1000-1722455968 b1f80d1d7e] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-1000-1000-1722455968 42fc222f46] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 09:59:52 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 09:59:52 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-512-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-512-1000-1000-1722455968 1000 yes 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-512-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-128-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-128-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-128-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-128-1000-1000
+ env
++ date
+ echo Wed Jul 31 10:01:15 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Wed Jul 31 10:01:15 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 42fc222f46 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-1000-1000-1722456075
+ git checkout -b scalability-yes-128-1000-1000-1722456075
Switched to a new branch 'scalability-yes-128-1000-1000-1722456075'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-1000-1000-1722456075 d9416708a4] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-1000-1000-1722456075 a9e13f468f] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:01:38 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 10:01:38 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-128-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-128-1000-1000-1722456075 1000 yes 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-128-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-32-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-32-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-32-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-32-1000-1000
+ env
++ date
+ echo Wed Jul 31 10:03:00 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Wed Jul 31 10:03:00 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a9e13f468f fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-1000-1000-1722456181
+ git checkout -b scalability-no-32-1000-1000-1722456181
Switched to a new branch 'scalability-no-32-1000-1000-1722456181'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/32/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-1000-1000-1722456181 cb49841e67] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:03:24 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 10:03:24 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-32-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-32-1000-1000-1722456181 1000 no 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-32-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-0-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-0-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-0-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-0-1000-1000
+ env
++ date
+ echo Wed Jul 31 10:04:46 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Wed Jul 31 10:04:46 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at cb49841e67 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-1000-1000-1722456286
+ git checkout -b scalability-no-0-1000-1000-1722456286
Switched to a new branch 'scalability-no-0-1000-1000-1722456286'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:05:09 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 10:05:09 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-0-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-0-1000-1000-1722456286 1000 no 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-0-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-1-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-1-1000-1000
+ env
++ date
+ echo Wed Jul 31 10:06:32 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Wed Jul 31 10:06:32 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-1000-1000-1722456392
+ git checkout -b scalability-no-1-1000-1000-1722456392
Switched to a new branch 'scalability-no-1-1000-1000-1722456392'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/1/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-1000-1000-1722456392 a6ac425b70] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:06:56 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 10:06:56 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-1-1000-1000-1722456392 1000 no 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1024-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-1024-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1024-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-1024-1000-1000
+ env
++ date
+ echo Wed Jul 31 10:08:17 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Wed Jul 31 10:08:17 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a6ac425b70 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-1000-1000-1722456498
+ git checkout -b scalability-no-1024-1000-1000-1722456498
Switched to a new branch 'scalability-no-1024-1000-1000-1722456498'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/1024/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-1000-1000-1722456498 90f8c8dffd] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:08:41 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 10:08:41 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1024-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-1024-1000-1000-1722456498 1000 no 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1024-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-8-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-8-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-8-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-8-1000-1000
+ env
++ date
+ echo Wed Jul 31 10:10:06 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Wed Jul 31 10:10:06 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 90f8c8dffd fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-1000-1000-1722456606
+ git checkout -b scalability-no-8-1000-1000-1722456606
Switched to a new branch 'scalability-no-8-1000-1000-1722456606'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/8/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-1000-1000-1722456606 622d982f9e] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:10:29 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 10:10:29 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-8-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-8-1000-1000-1722456606 1000 no 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-8-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-512-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-512-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-512-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-512-1000-1000
+ env
++ date
+ echo Wed Jul 31 10:11:51 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Wed Jul 31 10:11:51 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 622d982f9e fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-1000-1000-1722456711
+ git checkout -b scalability-no-512-1000-1000-1722456711
Switched to a new branch 'scalability-no-512-1000-1000-1722456711'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-1000-1000-1722456711 69c2ac9a8f] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:12:15 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 10:12:15 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-512-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-512-1000-1000-1722456711 1000 no 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-512-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-128-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-128-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-128-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-128-1000-1000
+ env
++ date
+ echo Wed Jul 31 10:13:38 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Wed Jul 31 10:13:38 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 69c2ac9a8f fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-1000-1000-1722456818
+ git checkout -b scalability-no-128-1000-1000-1722456818
Switched to a new branch 'scalability-no-128-1000-1000-1722456818'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-1000-1000-1722456818 0a3f12448f] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:14:02 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 10:14:02 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-128-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-128-1000-1000-1722456818 1000 no 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-128-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-32-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-32-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-32-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-32-1000-1000
+ env
++ date
+ echo Wed Jul 31 10:15:24 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Wed Jul 31 10:15:24 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 0a3f12448f fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-1000-1000-1722456925
+ git checkout -b scalability-yes-32-1000-1000-1722456925
Switched to a new branch 'scalability-yes-32-1000-1000-1722456925'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-1000-1000-1722456925 3d6b316e55] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-1000-1000-1722456925 bcaace851b] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:15:48 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 10:15:48 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-32-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-32-1000-1000-1722456925 1000 yes 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-32-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-0-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-0-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-0-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-0-1000-1000
+ env
++ date
+ echo Wed Jul 31 10:17:19 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Wed Jul 31 10:17:19 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at bcaace851b fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-1000-1000-1722457039
+ git checkout -b scalability-yes-0-1000-1000-1722457039
Switched to a new branch 'scalability-yes-0-1000-1000-1722457039'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-1000-1000-1722457039 b41d913ada] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:17:42 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 10:17:42 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-0-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-0-1000-1000-1722457039 1000 yes 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-0-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-1-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-1-1000-1000
+ env
++ date
+ echo Wed Jul 31 10:19:13 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Wed Jul 31 10:19:13 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b41d913ada NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-1000-1000-1722457153
+ git checkout -b scalability-yes-1-1000-1000-1722457153
Switched to a new branch 'scalability-yes-1-1000-1000-1722457153'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-1000-1000-1722457153 7cb075d147] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-1000-1000-1722457153 a5e1dd09cc] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:19:37 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 10:19:37 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-1-1000-1000-1722457153 1000 yes 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1024-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-1024-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1024-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-1024-1000-1000
+ env
++ date
+ echo Wed Jul 31 10:21:08 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Wed Jul 31 10:21:08 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a5e1dd09cc fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-1000-1000-1722457268
+ git checkout -b scalability-yes-1024-1000-1000-1722457268
Switched to a new branch 'scalability-yes-1024-1000-1000-1722457268'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-1000-1000-1722457268 aa30773424] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-1000-1000-1722457268 fcd4fb9836] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:21:32 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 10:21:32 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1024-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-1024-1000-1000-1722457268 1000 yes 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1024-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-8-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-8-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-8-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-8-1000-1000
+ env
++ date
+ echo Wed Jul 31 10:23:03 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Wed Jul 31 10:23:03 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at fcd4fb9836 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-1000-1000-1722457383
+ git checkout -b scalability-yes-8-1000-1000-1722457383
Switched to a new branch 'scalability-yes-8-1000-1000-1722457383'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-1000-1000-1722457383 405440decb] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-1000-1000-1722457383 e0a8913f0a] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:23:26 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 10:23:26 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-8-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-8-1000-1000-1722457383 1000 yes 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-8-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-512-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-512-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-512-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-512-1000-1000
+ env
++ date
+ echo Wed Jul 31 10:24:58 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Wed Jul 31 10:24:58 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e0a8913f0a fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-1000-1000-1722457498
+ git checkout -b scalability-yes-512-1000-1000-1722457498
Switched to a new branch 'scalability-yes-512-1000-1000-1722457498'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-1000-1000-1722457498 5c49384254] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-1000-1000-1722457498 9078f1089e] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:25:21 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 10:25:21 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-512-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-512-1000-1000-1722457498 1000 yes 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-512-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-128-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-128-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-128-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-128-1000-1000
+ env
++ date
+ echo Wed Jul 31 10:26:52 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Wed Jul 31 10:26:52 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 9078f1089e fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-1000-1000-1722457612
+ git checkout -b scalability-yes-128-1000-1000-1722457612
Switched to a new branch 'scalability-yes-128-1000-1000-1722457612'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-1000-1000-1722457612 77a7c33204] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-1000-1000-1722457612 d34195e345] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:27:15 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 10:27:15 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-128-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-128-1000-1000-1722457612 1000 yes 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-128-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-32-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-32-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-32-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-32-1000-1000
+ env
++ date
+ echo Wed Jul 31 10:28:47 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Wed Jul 31 10:28:47 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d34195e345 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-1000-1000-1722457727
+ git checkout -b scalability-no-32-1000-1000-1722457727
Switched to a new branch 'scalability-no-32-1000-1000-1722457727'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/32/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-1000-1000-1722457727 18be1bca31] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:29:10 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 10:29:10 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-32-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-32-1000-1000-1722457727 1000 no 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-32-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-0-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-0-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-0-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-0-1000-1000
+ env
++ date
+ echo Wed Jul 31 10:30:41 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Wed Jul 31 10:30:41 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 18be1bca31 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-1000-1000-1722457842
+ git checkout -b scalability-no-0-1000-1000-1722457842
Switched to a new branch 'scalability-no-0-1000-1000-1722457842'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:31:05 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 10:31:05 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-0-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-0-1000-1000-1722457842 1000 no 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-0-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-1-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-1-1000-1000
+ env
++ date
+ echo Wed Jul 31 10:32:36 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Wed Jul 31 10:32:36 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-1000-1000-1722457956
+ git checkout -b scalability-no-1-1000-1000-1722457956
Switched to a new branch 'scalability-no-1-1000-1000-1722457956'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/1/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-1000-1000-1722457956 c521910552] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:33:00 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 10:33:00 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-1-1000-1000-1722457956 1000 no 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1024-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-1024-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1024-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-1024-1000-1000
+ env
++ date
+ echo Wed Jul 31 10:34:31 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Wed Jul 31 10:34:31 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at c521910552 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-1000-1000-1722458071
+ git checkout -b scalability-no-1024-1000-1000-1722458071
Switched to a new branch 'scalability-no-1024-1000-1000-1722458071'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/1024/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-1000-1000-1722458071 b8af5eb9e0] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:34:55 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 10:34:55 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1024-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-1024-1000-1000-1722458071 1000 no 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1024-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-8-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-8-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-8-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-8-1000-1000
+ env
++ date
+ echo Wed Jul 31 10:36:26 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Wed Jul 31 10:36:26 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b8af5eb9e0 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-1000-1000-1722458186
+ git checkout -b scalability-no-8-1000-1000-1722458186
Switched to a new branch 'scalability-no-8-1000-1000-1722458186'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/8/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-1000-1000-1722458186 1bdc2d1761] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:36:49 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 10:36:49 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-8-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-8-1000-1000-1722458186 1000 no 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-8-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-512-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-512-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-512-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-512-1000-1000
+ env
++ date
+ echo Wed Jul 31 10:38:20 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Wed Jul 31 10:38:20 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 1bdc2d1761 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-1000-1000-1722458301
+ git checkout -b scalability-no-512-1000-1000-1722458301
Switched to a new branch 'scalability-no-512-1000-1000-1722458301'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-1000-1000-1722458301 b36fbff4c9] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:38:44 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 10:38:44 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-512-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-512-1000-1000-1722458301 1000 no 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-512-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-128-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-128-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-128-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-128-1000-1000
+ env
++ date
+ echo Wed Jul 31 10:40:15 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Wed Jul 31 10:40:15 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b36fbff4c9 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-1000-1000-1722458415
+ git checkout -b scalability-no-128-1000-1000-1722458415
Switched to a new branch 'scalability-no-128-1000-1000-1722458415'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-1000-1000-1722458415 23e6ccdb5a] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:40:38 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 10:40:38 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-128-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-128-1000-1000-1722458415 1000 no 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-128-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-32-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-32-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-32-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-32-1000-1000
+ env
++ date
+ echo Wed Jul 31 10:42:09 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Wed Jul 31 10:42:09 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 23e6ccdb5a fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-1000-1000-1722458530
+ git checkout -b scalability-yes-32-1000-1000-1722458530
Switched to a new branch 'scalability-yes-32-1000-1000-1722458530'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-1000-1000-1722458530 e7ac38d667] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-1000-1000-1722458530 d47b98cb37] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:42:33 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 10:42:33 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-32-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-32-1000-1000-1722458530 1000 yes 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-32-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-0-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-0-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-0-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-0-1000-1000
+ env
++ date
+ echo Wed Jul 31 10:42:36 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Wed Jul 31 10:42:36 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d47b98cb37 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-1000-1000-1722458556
+ git checkout -b scalability-yes-0-1000-1000-1722458556
Switched to a new branch 'scalability-yes-0-1000-1000-1722458556'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-1000-1000-1722458556 a32b6f95cf] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:43:00 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 10:43:00 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-0-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-0-1000-1000-1722458556 1000 yes 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-0-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-1-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-1-1000-1000
+ env
++ date
+ echo Wed Jul 31 10:43:02 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Wed Jul 31 10:43:02 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a32b6f95cf NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-1000-1000-1722458583
+ git checkout -b scalability-yes-1-1000-1000-1722458583
Switched to a new branch 'scalability-yes-1-1000-1000-1722458583'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-1000-1000-1722458583 f6765d2fea] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-1000-1000-1722458583 61d43e81bf] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:43:26 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 10:43:26 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-1-1000-1000-1722458583 1000 yes 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1024-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-1024-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1024-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-1024-1000-1000
+ env
++ date
+ echo Wed Jul 31 10:43:29 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Wed Jul 31 10:43:29 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 61d43e81bf fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-1000-1000-1722458609
+ git checkout -b scalability-yes-1024-1000-1000-1722458609
Switched to a new branch 'scalability-yes-1024-1000-1000-1722458609'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-1000-1000-1722458609 e3e43d8dae] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-1000-1000-1722458609 453120bbe6] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:43:52 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 10:43:52 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1024-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-1024-1000-1000-1722458609 1000 yes 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1024-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-8-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-8-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-8-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-8-1000-1000
+ env
++ date
+ echo Wed Jul 31 10:43:55 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Wed Jul 31 10:43:55 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 453120bbe6 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-1000-1000-1722458635
+ git checkout -b scalability-yes-8-1000-1000-1722458635
Switched to a new branch 'scalability-yes-8-1000-1000-1722458635'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-1000-1000-1722458635 f31f86c879] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-1000-1000-1722458635 066981323b] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:44:19 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 10:44:19 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-8-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-8-1000-1000-1722458635 1000 yes 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-8-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-512-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-512-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-512-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-512-1000-1000
+ env
++ date
+ echo Wed Jul 31 10:44:22 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Wed Jul 31 10:44:22 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 066981323b fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-1000-1000-1722458662
+ git checkout -b scalability-yes-512-1000-1000-1722458662
Switched to a new branch 'scalability-yes-512-1000-1000-1722458662'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-1000-1000-1722458662 3b6ed1c2ba] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-1000-1000-1722458662 6e15276995] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:44:46 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 10:44:46 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-512-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-512-1000-1000-1722458662 1000 yes 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-512-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-128-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-128-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-128-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-128-1000-1000
+ env
++ date
+ echo Wed Jul 31 10:44:48 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Wed Jul 31 10:44:48 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 6e15276995 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-1000-1000-1722458689
+ git checkout -b scalability-yes-128-1000-1000-1722458689
Switched to a new branch 'scalability-yes-128-1000-1000-1722458689'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-1000-1000-1722458689 99d5761cb5] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-1000-1000-1722458689 c2c173ea35] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:45:12 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 10:45:12 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-128-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-128-1000-1000-1722458689 1000 yes 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-128-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-32-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-32-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-32-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-32-1000-1000
+ env
++ date
+ echo Wed Jul 31 10:45:15 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Wed Jul 31 10:45:15 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at c2c173ea35 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-1000-1000-1722458715
+ git checkout -b scalability-no-32-1000-1000-1722458715
Switched to a new branch 'scalability-no-32-1000-1000-1722458715'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/32/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-1000-1000-1722458715 932999d502] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:45:39 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 10:45:39 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-32-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-32-1000-1000-1722458715 1000 no 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-32-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-0-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-0-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-0-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-0-1000-1000
+ env
++ date
+ echo Wed Jul 31 10:45:41 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Wed Jul 31 10:45:41 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 932999d502 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-1000-1000-1722458742
+ git checkout -b scalability-no-0-1000-1000-1722458742
Switched to a new branch 'scalability-no-0-1000-1000-1722458742'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:46:05 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 10:46:05 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-0-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-0-1000-1000-1722458742 1000 no 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-0-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-1-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-1-1000-1000
+ env
++ date
+ echo Wed Jul 31 10:46:08 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Wed Jul 31 10:46:08 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-1000-1000-1722458768
+ git checkout -b scalability-no-1-1000-1000-1722458768
Switched to a new branch 'scalability-no-1-1000-1000-1722458768'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-1000-1000-1722458768 4ad0298206] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:46:31 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 10:46:31 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-1-1000-1000-1722458768 1000 no 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1024-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-1024-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1024-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-1024-1000-1000
+ env
++ date
+ echo Wed Jul 31 10:46:34 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Wed Jul 31 10:46:34 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 4ad0298206 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-1000-1000-1722458794
+ git checkout -b scalability-no-1024-1000-1000-1722458794
Switched to a new branch 'scalability-no-1024-1000-1000-1722458794'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-1000-1000-1722458794 5af7d3cb72] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:46:57 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 10:46:57 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1024-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-1024-1000-1000-1722458794 1000 no 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1024-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-8-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-8-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-8-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-8-1000-1000
+ env
++ date
+ echo Wed Jul 31 10:47:00 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Wed Jul 31 10:47:00 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 5af7d3cb72 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-1000-1000-1722458820
+ git checkout -b scalability-no-8-1000-1000-1722458820
Switched to a new branch 'scalability-no-8-1000-1000-1722458820'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-1000-1000-1722458820 facdace204] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:47:24 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 10:47:24 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-8-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-8-1000-1000-1722458820 1000 no 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-8-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-512-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-512-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-512-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-512-1000-1000
+ env
++ date
+ echo Wed Jul 31 10:47:27 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Wed Jul 31 10:47:27 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at facdace204 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-1000-1000-1722458847
+ git checkout -b scalability-no-512-1000-1000-1722458847
Switched to a new branch 'scalability-no-512-1000-1000-1722458847'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-1000-1000-1722458847 9f9632a247] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:47:50 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 10:47:50 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-512-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-512-1000-1000-1722458847 1000 no 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-512-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-128-1000-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-128-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-128-1000-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-128-1000-1000
+ env
++ date
+ echo Wed Jul 31 10:47:53 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Wed Jul 31 10:47:53 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 9f9632a247 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-1000-1000-1722458873
+ git checkout -b scalability-no-128-1000-1000-1722458873
Switched to a new branch 'scalability-no-128-1000-1000-1722458873'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-1000-1000-1722458873 b4cea6782a] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-1000-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:48:16 PM CEST 2024 'RUN   files: 1000  partitions: 1000'
Wed Jul 31 10:48:16 PM CEST 2024 RUN   files: 1000  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-1000-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-128-1000-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-128-1000-1000-1722458873 1000 no 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-128-1000-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for p in $PARTITIONS
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-32-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-32-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-32-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-32-1000-100
+ env
++ date
+ echo Wed Jul 31 10:48:19 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Wed Jul 31 10:48:19 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b4cea6782a fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-1000-100-1722458899
+ git checkout -b scalability-yes-32-1000-100-1722458899
Switched to a new branch 'scalability-yes-32-1000-100-1722458899'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-1000-100-1722458899 0024007094] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-1000-100-1722458899 8e006a581b] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:49:02 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Wed Jul 31 10:49:02 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-32-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-32-1000-100-1722458899 1000 yes 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-32-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-0-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-0-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-0-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-0-1000-100
+ env
++ date
+ echo Wed Jul 31 10:50:17 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Wed Jul 31 10:50:17 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 8e006a581b fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-1000-100-1722459017
+ git checkout -b scalability-yes-0-1000-100-1722459017
Switched to a new branch 'scalability-yes-0-1000-100-1722459017'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-1000-100-1722459017 22c0a033bc] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:50:59 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Wed Jul 31 10:50:59 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-0-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-0-1000-100-1722459017 1000 yes 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-0-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-1-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-1-1000-100
+ env
++ date
+ echo Wed Jul 31 10:52:14 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Wed Jul 31 10:52:14 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 22c0a033bc NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-1000-100-1722459134
+ git checkout -b scalability-yes-1-1000-100-1722459134
Switched to a new branch 'scalability-yes-1-1000-100-1722459134'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-1000-100-1722459134 d2915b34f0] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-1000-100-1722459134 ee3860a01e] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:52:57 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Wed Jul 31 10:52:57 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-1-1000-100-1722459134 1000 yes 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1024-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-1024-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1024-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-1024-1000-100
+ env
++ date
+ echo Wed Jul 31 10:54:12 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Wed Jul 31 10:54:12 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at ee3860a01e fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-1000-100-1722459252
+ git checkout -b scalability-yes-1024-1000-100-1722459252
Switched to a new branch 'scalability-yes-1024-1000-100-1722459252'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-1000-100-1722459252 9c72827004] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/1024/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-1000-100-1722459252 ccc07f2c0b] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:54:54 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Wed Jul 31 10:54:54 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1024-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-1024-1000-100-1722459252 1000 yes 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1024-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-8-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-8-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-8-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-8-1000-100
+ env
++ date
+ echo Wed Jul 31 10:56:10 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Wed Jul 31 10:56:10 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at ccc07f2c0b fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-1000-100-1722459370
+ git checkout -b scalability-yes-8-1000-100-1722459370
Switched to a new branch 'scalability-yes-8-1000-100-1722459370'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-1000-100-1722459370 b1606df26c] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-1000-100-1722459370 993298ba87] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:56:52 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Wed Jul 31 10:56:52 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-8-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-8-1000-100-1722459370 1000 yes 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-8-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-512-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-512-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-512-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-512-1000-100
+ env
++ date
+ echo Wed Jul 31 10:58:07 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Wed Jul 31 10:58:07 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 993298ba87 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-1000-100-1722459487
+ git checkout -b scalability-yes-512-1000-100-1722459487
Switched to a new branch 'scalability-yes-512-1000-100-1722459487'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-1000-100-1722459487 8af8f40a9f] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-1000-100-1722459487 252d12b1a8] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 10:58:50 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Wed Jul 31 10:58:50 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-512-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-512-1000-100-1722459487 1000 yes 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-512-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-128-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-128-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-128-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-128-1000-100
+ env
++ date
+ echo Wed Jul 31 11:00:05 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Wed Jul 31 11:00:05 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 252d12b1a8 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-1000-100-1722459605
+ git checkout -b scalability-yes-128-1000-100-1722459605
Switched to a new branch 'scalability-yes-128-1000-100-1722459605'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-1000-100-1722459605 b6712deac0] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-1000-100-1722459605 d9b13c78f1] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:00:48 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Wed Jul 31 11:00:48 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-128-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-128-1000-100-1722459605 1000 yes 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-128-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-32-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-32-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-32-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-32-1000-100
+ env
++ date
+ echo Wed Jul 31 11:02:03 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Wed Jul 31 11:02:03 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d9b13c78f1 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-1000-100-1722459723
+ git checkout -b scalability-no-32-1000-100-1722459723
Switched to a new branch 'scalability-no-32-1000-100-1722459723'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-1000-100-1722459723 b281dde126] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:02:45 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Wed Jul 31 11:02:45 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-32-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-32-1000-100-1722459723 1000 no 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-32-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-0-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-0-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-0-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-0-1000-100
+ env
++ date
+ echo Wed Jul 31 11:04:00 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Wed Jul 31 11:04:00 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b281dde126 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-1000-100-1722459840
+ git checkout -b scalability-no-0-1000-100-1722459840
Switched to a new branch 'scalability-no-0-1000-100-1722459840'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:04:43 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Wed Jul 31 11:04:43 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-0-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-0-1000-100-1722459840 1000 no 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-0-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-1-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-1-1000-100
+ env
++ date
+ echo Wed Jul 31 11:05:58 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Wed Jul 31 11:05:58 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-1000-100-1722459958
+ git checkout -b scalability-no-1-1000-100-1722459958
Switched to a new branch 'scalability-no-1-1000-100-1722459958'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/1/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-1000-100-1722459958 906b75c06c] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:06:40 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Wed Jul 31 11:06:40 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-1-1000-100-1722459958 1000 no 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1024-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-1024-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1024-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-1024-1000-100
+ env
++ date
+ echo Wed Jul 31 11:07:55 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Wed Jul 31 11:07:55 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 906b75c06c fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-1000-100-1722460076
+ git checkout -b scalability-no-1024-1000-100-1722460076
Switched to a new branch 'scalability-no-1024-1000-100-1722460076'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-1000-100-1722460076 79db2c8d90] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:08:38 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Wed Jul 31 11:08:38 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1024-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-1024-1000-100-1722460076 1000 no 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1024-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-8-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-8-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-8-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-8-1000-100
+ env
++ date
+ echo Wed Jul 31 11:09:53 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Wed Jul 31 11:09:53 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 79db2c8d90 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-1000-100-1722460193
+ git checkout -b scalability-no-8-1000-100-1722460193
Switched to a new branch 'scalability-no-8-1000-100-1722460193'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/8/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-1000-100-1722460193 156dd206a8] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:10:36 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Wed Jul 31 11:10:36 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-8-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-8-1000-100-1722460193 1000 no 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-8-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-512-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-512-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-512-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-512-1000-100
+ env
++ date
+ echo Wed Jul 31 11:11:51 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Wed Jul 31 11:11:51 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 156dd206a8 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-1000-100-1722460311
+ git checkout -b scalability-no-512-1000-100-1722460311
Switched to a new branch 'scalability-no-512-1000-100-1722460311'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-1000-100-1722460311 435f0bbdc7] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:12:33 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Wed Jul 31 11:12:33 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-512-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-512-1000-100-1722460311 1000 no 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-512-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-128-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-128-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-128-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-128-1000-100
+ env
++ date
+ echo Wed Jul 31 11:13:48 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Wed Jul 31 11:13:48 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 435f0bbdc7 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-1000-100-1722460429
+ git checkout -b scalability-no-128-1000-100-1722460429
Switched to a new branch 'scalability-no-128-1000-100-1722460429'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-1000-100-1722460429 8e67ea8e2b] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:14:31 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Wed Jul 31 11:14:31 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-128-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-128-1000-100-1722460429 1000 no 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-128-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-32-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-32-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-32-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-32-1000-100
+ env
++ date
+ echo Wed Jul 31 11:15:46 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Wed Jul 31 11:15:46 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 8e67ea8e2b fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-1000-100-1722460546
+ git checkout -b scalability-yes-32-1000-100-1722460546
Switched to a new branch 'scalability-yes-32-1000-100-1722460546'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-1000-100-1722460546 2e632d698c] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-1000-100-1722460546 9bff3b240c] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:16:10 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Wed Jul 31 11:16:10 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-32-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-32-1000-100-1722460546 1000 yes 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-32-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-0-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-0-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-0-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-0-1000-100
+ env
++ date
+ echo Wed Jul 31 11:17:28 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Wed Jul 31 11:17:28 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 9bff3b240c fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-1000-100-1722460648
+ git checkout -b scalability-yes-0-1000-100-1722460648
Switched to a new branch 'scalability-yes-0-1000-100-1722460648'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-1000-100-1722460648 45219be247] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:17:52 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Wed Jul 31 11:17:52 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-0-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-0-1000-100-1722460648 1000 yes 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-0-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-1-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-1-1000-100
+ env
++ date
+ echo Wed Jul 31 11:19:11 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Wed Jul 31 11:19:11 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 45219be247 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-1000-100-1722460751
+ git checkout -b scalability-yes-1-1000-100-1722460751
Switched to a new branch 'scalability-yes-1-1000-100-1722460751'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-1000-100-1722460751 94d69fe7aa] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-1000-100-1722460751 ce5d9772fe] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:19:34 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Wed Jul 31 11:19:34 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-1-1000-100-1722460751 1000 yes 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1024-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-1024-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1024-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-1024-1000-100
+ env
++ date
+ echo Wed Jul 31 11:20:53 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Wed Jul 31 11:20:53 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at ce5d9772fe fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-1000-100-1722460853
+ git checkout -b scalability-yes-1024-1000-100-1722460853
Switched to a new branch 'scalability-yes-1024-1000-100-1722460853'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-1000-100-1722460853 998fb2e939] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-1000-100-1722460853 8926126365] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:21:16 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Wed Jul 31 11:21:16 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1024-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-1024-1000-100-1722460853 1000 yes 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1024-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-8-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-8-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-8-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-8-1000-100
+ env
++ date
+ echo Wed Jul 31 11:22:36 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Wed Jul 31 11:22:36 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 8926126365 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-1000-100-1722460956
+ git checkout -b scalability-yes-8-1000-100-1722460956
Switched to a new branch 'scalability-yes-8-1000-100-1722460956'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-1000-100-1722460956 e2d5a1415f] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-1000-100-1722460956 75b6221784] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:22:59 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Wed Jul 31 11:22:59 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-8-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-8-1000-100-1722460956 1000 yes 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-8-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-512-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-512-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-512-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-512-1000-100
+ env
++ date
+ echo Wed Jul 31 11:24:18 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Wed Jul 31 11:24:18 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 75b6221784 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-1000-100-1722461058
+ git checkout -b scalability-yes-512-1000-100-1722461058
Switched to a new branch 'scalability-yes-512-1000-100-1722461058'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-1000-100-1722461058 dd9dbd3135] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-1000-100-1722461058 81929e2544] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:24:41 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Wed Jul 31 11:24:41 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-512-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-512-1000-100-1722461058 1000 yes 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-512-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-128-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-128-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-128-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-128-1000-100
+ env
++ date
+ echo Wed Jul 31 11:26:00 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Wed Jul 31 11:26:00 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 81929e2544 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-1000-100-1722461160
+ git checkout -b scalability-yes-128-1000-100-1722461160
Switched to a new branch 'scalability-yes-128-1000-100-1722461160'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-1000-100-1722461160 5b95df3caa] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-1000-100-1722461160 5bcdb3d23c] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:26:24 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Wed Jul 31 11:26:24 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-128-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-128-1000-100-1722461160 1000 yes 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-128-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-32-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-32-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-32-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-32-1000-100
+ env
++ date
+ echo Wed Jul 31 11:27:43 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Wed Jul 31 11:27:43 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 5bcdb3d23c fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-1000-100-1722461263
+ git checkout -b scalability-no-32-1000-100-1722461263
Switched to a new branch 'scalability-no-32-1000-100-1722461263'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-1000-100-1722461263 60dae9606e] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:28:06 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Wed Jul 31 11:28:06 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-32-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-32-1000-100-1722461263 1000 no 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-32-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-0-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-0-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-0-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-0-1000-100
+ env
++ date
+ echo Wed Jul 31 11:29:25 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Wed Jul 31 11:29:25 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 60dae9606e fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-1000-100-1722461365
+ git checkout -b scalability-no-0-1000-100-1722461365
Switched to a new branch 'scalability-no-0-1000-100-1722461365'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:29:48 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Wed Jul 31 11:29:48 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-0-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-0-1000-100-1722461365 1000 no 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-0-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-1-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-1-1000-100
+ env
++ date
+ echo Wed Jul 31 11:31:07 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Wed Jul 31 11:31:07 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-1000-100-1722461467
+ git checkout -b scalability-no-1-1000-100-1722461467
Switched to a new branch 'scalability-no-1-1000-100-1722461467'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-1000-100-1722461467 75f73d3eb2] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:31:31 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Wed Jul 31 11:31:31 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-1-1000-100-1722461467 1000 no 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1024-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-1024-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1024-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-1024-1000-100
+ env
++ date
+ echo Wed Jul 31 11:32:49 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Wed Jul 31 11:32:49 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 75f73d3eb2 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-1000-100-1722461570
+ git checkout -b scalability-no-1024-1000-100-1722461570
Switched to a new branch 'scalability-no-1024-1000-100-1722461570'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/1024/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-1000-100-1722461570 ec20f6a5f6] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:33:13 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Wed Jul 31 11:33:13 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1024-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-1024-1000-100-1722461570 1000 no 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1024-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-8-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-8-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-8-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-8-1000-100
+ env
++ date
+ echo Wed Jul 31 11:34:32 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Wed Jul 31 11:34:32 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at ec20f6a5f6 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-1000-100-1722461672
+ git checkout -b scalability-no-8-1000-100-1722461672
Switched to a new branch 'scalability-no-8-1000-100-1722461672'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-1000-100-1722461672 527be656da] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:34:56 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Wed Jul 31 11:34:56 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-8-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-8-1000-100-1722461672 1000 no 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-8-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-512-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-512-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-512-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-512-1000-100
+ env
++ date
+ echo Wed Jul 31 11:36:14 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Wed Jul 31 11:36:14 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 527be656da fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-1000-100-1722461774
+ git checkout -b scalability-no-512-1000-100-1722461774
Switched to a new branch 'scalability-no-512-1000-100-1722461774'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-1000-100-1722461774 8f47ea5e5f] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:36:38 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Wed Jul 31 11:36:38 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-512-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-512-1000-100-1722461774 1000 no 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-512-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-128-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-128-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-128-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-128-1000-100
+ env
++ date
+ echo Wed Jul 31 11:37:57 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Wed Jul 31 11:37:57 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 8f47ea5e5f fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-1000-100-1722461877
+ git checkout -b scalability-no-128-1000-100-1722461877
Switched to a new branch 'scalability-no-128-1000-100-1722461877'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-1000-100-1722461877 1272ee9e27] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:38:20 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Wed Jul 31 11:38:20 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-128-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-128-1000-100-1722461877 1000 no 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-128-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-32-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-32-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-32-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-32-1000-100
+ env
++ date
+ echo Wed Jul 31 11:39:39 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Wed Jul 31 11:39:39 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 1272ee9e27 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-1000-100-1722461979
+ git checkout -b scalability-yes-32-1000-100-1722461979
Switched to a new branch 'scalability-yes-32-1000-100-1722461979'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-1000-100-1722461979 2ad731602f] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-1000-100-1722461979 d172002001] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:40:02 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Wed Jul 31 11:40:02 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-32-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-32-1000-100-1722461979 1000 yes 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-32-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-0-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-0-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-0-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-0-1000-100
+ env
++ date
+ echo Wed Jul 31 11:41:16 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Wed Jul 31 11:41:16 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d172002001 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-1000-100-1722462076
+ git checkout -b scalability-yes-0-1000-100-1722462076
Switched to a new branch 'scalability-yes-0-1000-100-1722462076'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-1000-100-1722462076 ffcb08413a] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:41:40 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Wed Jul 31 11:41:40 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-0-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-0-1000-100-1722462076 1000 yes 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-0-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-1-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-1-1000-100
+ env
++ date
+ echo Wed Jul 31 11:42:54 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Wed Jul 31 11:42:54 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at ffcb08413a NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-1000-100-1722462174
+ git checkout -b scalability-yes-1-1000-100-1722462174
Switched to a new branch 'scalability-yes-1-1000-100-1722462174'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-1000-100-1722462174 4cf01f5bac] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-1000-100-1722462174 cbc222242d] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:43:17 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Wed Jul 31 11:43:17 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-1-1000-100-1722462174 1000 yes 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1024-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-1024-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1024-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-1024-1000-100
+ env
++ date
+ echo Wed Jul 31 11:44:31 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Wed Jul 31 11:44:31 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at cbc222242d fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-1000-100-1722462271
+ git checkout -b scalability-yes-1024-1000-100-1722462271
Switched to a new branch 'scalability-yes-1024-1000-100-1722462271'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-1000-100-1722462271 5d0be71c8a] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-1000-100-1722462271 15868dcea2] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:44:55 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Wed Jul 31 11:44:55 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1024-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-1024-1000-100-1722462271 1000 yes 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1024-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-8-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-8-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-8-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-8-1000-100
+ env
++ date
+ echo Wed Jul 31 11:46:09 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Wed Jul 31 11:46:09 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 15868dcea2 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-1000-100-1722462369
+ git checkout -b scalability-yes-8-1000-100-1722462369
Switched to a new branch 'scalability-yes-8-1000-100-1722462369'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-1000-100-1722462369 d2a265c264] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-1000-100-1722462369 26a663d726] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:46:33 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Wed Jul 31 11:46:33 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-8-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-8-1000-100-1722462369 1000 yes 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-8-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-512-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-512-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-512-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-512-1000-100
+ env
++ date
+ echo Wed Jul 31 11:47:46 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Wed Jul 31 11:47:46 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 26a663d726 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-1000-100-1722462466
+ git checkout -b scalability-yes-512-1000-100-1722462466
Switched to a new branch 'scalability-yes-512-1000-100-1722462466'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-1000-100-1722462466 779f1b8ebd] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-1000-100-1722462466 707c68600c] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:48:10 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Wed Jul 31 11:48:10 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-512-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-512-1000-100-1722462466 1000 yes 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-512-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-128-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-128-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-128-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-128-1000-100
+ env
++ date
+ echo Wed Jul 31 11:49:24 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Wed Jul 31 11:49:24 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 707c68600c fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-1000-100-1722462564
+ git checkout -b scalability-yes-128-1000-100-1722462564
Switched to a new branch 'scalability-yes-128-1000-100-1722462564'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-1000-100-1722462564 540a2030de] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-1000-100-1722462564 ca1e17d61e] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:49:47 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Wed Jul 31 11:49:47 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-128-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-128-1000-100-1722462564 1000 yes 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-128-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-32-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-32-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-32-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-32-1000-100
+ env
++ date
+ echo Wed Jul 31 11:51:01 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Wed Jul 31 11:51:01 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at ca1e17d61e fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-1000-100-1722462661
+ git checkout -b scalability-no-32-1000-100-1722462661
Switched to a new branch 'scalability-no-32-1000-100-1722462661'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/32/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-1000-100-1722462661 3705515ef4] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:51:25 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Wed Jul 31 11:51:25 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-32-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-32-1000-100-1722462661 1000 no 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-32-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-0-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-0-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-0-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-0-1000-100
+ env
++ date
+ echo Wed Jul 31 11:52:38 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Wed Jul 31 11:52:38 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 3705515ef4 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-1000-100-1722462758
+ git checkout -b scalability-no-0-1000-100-1722462758
Switched to a new branch 'scalability-no-0-1000-100-1722462758'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:53:02 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Wed Jul 31 11:53:02 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-0-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-0-1000-100-1722462758 1000 no 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-0-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-1-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-1-1000-100
+ env
++ date
+ echo Wed Jul 31 11:54:16 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Wed Jul 31 11:54:16 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-1000-100-1722462856
+ git checkout -b scalability-no-1-1000-100-1722462856
Switched to a new branch 'scalability-no-1-1000-100-1722462856'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-1000-100-1722462856 002e680ee7] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:54:39 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Wed Jul 31 11:54:39 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-1-1000-100-1722462856 1000 no 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1024-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-1024-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1024-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-1024-1000-100
+ env
++ date
+ echo Wed Jul 31 11:55:53 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Wed Jul 31 11:55:53 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 002e680ee7 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-1000-100-1722462953
+ git checkout -b scalability-no-1024-1000-100-1722462953
Switched to a new branch 'scalability-no-1024-1000-100-1722462953'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ patch -p1
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-1000-100-1722462953 afbbaba863] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:56:16 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Wed Jul 31 11:56:16 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1024-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-1024-1000-100-1722462953 1000 no 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1024-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-8-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-8-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-8-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-8-1000-100
+ env
++ date
+ echo Wed Jul 31 11:57:30 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Wed Jul 31 11:57:30 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at afbbaba863 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-1000-100-1722463051
+ git checkout -b scalability-no-8-1000-100-1722463051
Switched to a new branch 'scalability-no-8-1000-100-1722463051'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-1000-100-1722463051 cca204fd04] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:57:54 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Wed Jul 31 11:57:54 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-8-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-8-1000-100-1722463051 1000 no 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-8-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-512-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-512-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-512-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-512-1000-100
+ env
++ date
+ echo Wed Jul 31 11:59:08 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Wed Jul 31 11:59:08 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at cca204fd04 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-1000-100-1722463148
+ git checkout -b scalability-no-512-1000-100-1722463148
Switched to a new branch 'scalability-no-512-1000-100-1722463148'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-1000-100-1722463148 3544b93d32] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Wed Jul 31 11:59:31 PM CEST 2024 'RUN   files: 1000  partitions: 100'
Wed Jul 31 11:59:31 PM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-512-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-512-1000-100-1722463148 1000 no 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-512-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-128-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-128-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-128-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-128-1000-100
+ env
++ date
+ echo Thu Aug 1 12:00:45 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Thu Aug 1 12:00:45 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 3544b93d32 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-1000-100-1722463245
+ git checkout -b scalability-no-128-1000-100-1722463245
Switched to a new branch 'scalability-no-128-1000-100-1722463245'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-1000-100-1722463245 d62f916ed6] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:01:08 AM CEST 2024 'RUN   files: 1000  partitions: 100'
Thu Aug 1 12:01:08 AM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-128-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-128-1000-100-1722463245 1000 no 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-128-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-32-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-32-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-32-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-32-1000-100
+ env
++ date
+ echo Thu Aug 1 12:02:22 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Thu Aug 1 12:02:22 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d62f916ed6 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-1000-100-1722463342
+ git checkout -b scalability-yes-32-1000-100-1722463342
Switched to a new branch 'scalability-yes-32-1000-100-1722463342'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-1000-100-1722463342 a39524b455] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-1000-100-1722463342 78012b7561] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:02:46 AM CEST 2024 'RUN   files: 1000  partitions: 100'
Thu Aug 1 12:02:46 AM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-32-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-32-1000-100-1722463342 1000 yes 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-32-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-0-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-0-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-0-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-0-1000-100
+ env
++ date
+ echo Thu Aug 1 12:04:06 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Thu Aug 1 12:04:06 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 78012b7561 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-1000-100-1722463446
+ git checkout -b scalability-yes-0-1000-100-1722463446
Switched to a new branch 'scalability-yes-0-1000-100-1722463446'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-1000-100-1722463446 ffb5a3cd99] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:04:30 AM CEST 2024 'RUN   files: 1000  partitions: 100'
Thu Aug 1 12:04:30 AM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-0-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-0-1000-100-1722463446 1000 yes 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-0-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-1-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-1-1000-100
+ env
++ date
+ echo Thu Aug 1 12:05:50 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Thu Aug 1 12:05:50 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at ffb5a3cd99 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-1000-100-1722463550
+ git checkout -b scalability-yes-1-1000-100-1722463550
Switched to a new branch 'scalability-yes-1-1000-100-1722463550'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-1000-100-1722463550 a4ae42485f] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-1000-100-1722463550 7bff24d80d] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:06:14 AM CEST 2024 'RUN   files: 1000  partitions: 100'
Thu Aug 1 12:06:14 AM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-1-1000-100-1722463550 1000 yes 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1024-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-1024-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1024-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-1024-1000-100
+ env
++ date
+ echo Thu Aug 1 12:07:34 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Thu Aug 1 12:07:34 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 7bff24d80d fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-1000-100-1722463654
+ git checkout -b scalability-yes-1024-1000-100-1722463654
Switched to a new branch 'scalability-yes-1024-1000-100-1722463654'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-1000-100-1722463654 2a05c1e940] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-1000-100-1722463654 b419593fc1] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:07:58 AM CEST 2024 'RUN   files: 1000  partitions: 100'
Thu Aug 1 12:07:58 AM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1024-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-1024-1000-100-1722463654 1000 yes 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1024-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-8-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-8-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-8-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-8-1000-100
+ env
++ date
+ echo Thu Aug 1 12:09:18 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Thu Aug 1 12:09:18 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b419593fc1 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-1000-100-1722463758
+ git checkout -b scalability-yes-8-1000-100-1722463758
Switched to a new branch 'scalability-yes-8-1000-100-1722463758'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-1000-100-1722463758 fbdc27e060] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-1000-100-1722463758 3673015f9a] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:09:42 AM CEST 2024 'RUN   files: 1000  partitions: 100'
Thu Aug 1 12:09:42 AM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-8-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-8-1000-100-1722463758 1000 yes 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-8-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-512-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-512-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-512-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-512-1000-100
+ env
++ date
+ echo Thu Aug 1 12:11:02 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Thu Aug 1 12:11:02 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 3673015f9a fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-1000-100-1722463862
+ git checkout -b scalability-yes-512-1000-100-1722463862
Switched to a new branch 'scalability-yes-512-1000-100-1722463862'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-1000-100-1722463862 5d8b4a6214] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-1000-100-1722463862 f074fb1df8] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:11:26 AM CEST 2024 'RUN   files: 1000  partitions: 100'
Thu Aug 1 12:11:26 AM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-512-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-512-1000-100-1722463862 1000 yes 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-512-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-128-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-128-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-128-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-128-1000-100
+ env
++ date
+ echo Thu Aug 1 12:12:46 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Thu Aug 1 12:12:46 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at f074fb1df8 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-1000-100-1722463966
+ git checkout -b scalability-yes-128-1000-100-1722463966
Switched to a new branch 'scalability-yes-128-1000-100-1722463966'
+ '[' yes == yes ']'
+ patch -p1
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-1000-100-1722463966 d3299b141f] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-1000-100-1722463966 0ca9486fcd] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:13:10 AM CEST 2024 'RUN   files: 1000  partitions: 100'
Thu Aug 1 12:13:10 AM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-128-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-128-1000-100-1722463966 1000 yes 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-128-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-32-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-32-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-32-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-32-1000-100
+ env
++ date
+ echo Thu Aug 1 12:14:30 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Thu Aug 1 12:14:30 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 0ca9486fcd fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-1000-100-1722464070
+ git checkout -b scalability-no-32-1000-100-1722464070
Switched to a new branch 'scalability-no-32-1000-100-1722464070'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/32/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-1000-100-1722464070 7ce5c331ad] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:14:54 AM CEST 2024 'RUN   files: 1000  partitions: 100'
Thu Aug 1 12:14:54 AM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-32-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-32-1000-100-1722464070 1000 no 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-32-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-0-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-0-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-0-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-0-1000-100
+ env
++ date
+ echo Thu Aug 1 12:16:14 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Thu Aug 1 12:16:14 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 7ce5c331ad fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-1000-100-1722464174
+ git checkout -b scalability-no-0-1000-100-1722464174
Switched to a new branch 'scalability-no-0-1000-100-1722464174'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:16:38 AM CEST 2024 'RUN   files: 1000  partitions: 100'
Thu Aug 1 12:16:38 AM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-0-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-0-1000-100-1722464174 1000 no 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-0-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-1-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-1-1000-100
+ env
++ date
+ echo Thu Aug 1 12:17:58 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Thu Aug 1 12:17:58 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-1000-100-1722464278
+ git checkout -b scalability-no-1-1000-100-1722464278
Switched to a new branch 'scalability-no-1-1000-100-1722464278'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-1000-100-1722464278 86406981f5] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:18:21 AM CEST 2024 'RUN   files: 1000  partitions: 100'
Thu Aug 1 12:18:21 AM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-1-1000-100-1722464278 1000 no 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1024-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-1024-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1024-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-1024-1000-100
+ env
++ date
+ echo Thu Aug 1 12:19:42 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Thu Aug 1 12:19:42 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 86406981f5 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-1000-100-1722464382
+ git checkout -b scalability-no-1024-1000-100-1722464382
Switched to a new branch 'scalability-no-1024-1000-100-1722464382'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/1024/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-1000-100-1722464382 c50624de9f] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:20:05 AM CEST 2024 'RUN   files: 1000  partitions: 100'
Thu Aug 1 12:20:05 AM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1024-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-1024-1000-100-1722464382 1000 no 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1024-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-8-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-8-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-8-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-8-1000-100
+ env
++ date
+ echo Thu Aug 1 12:21:26 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Thu Aug 1 12:21:26 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at c50624de9f fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-1000-100-1722464486
+ git checkout -b scalability-no-8-1000-100-1722464486
Switched to a new branch 'scalability-no-8-1000-100-1722464486'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-1000-100-1722464486 c74ecd103b] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:21:49 AM CEST 2024 'RUN   files: 1000  partitions: 100'
Thu Aug 1 12:21:49 AM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-8-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-8-1000-100-1722464486 1000 no 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-8-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-512-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-512-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-512-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-512-1000-100
+ env
++ date
+ echo Thu Aug 1 12:23:10 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Thu Aug 1 12:23:10 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at c74ecd103b fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-1000-100-1722464590
+ git checkout -b scalability-no-512-1000-100-1722464590
Switched to a new branch 'scalability-no-512-1000-100-1722464590'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/512/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-1000-100-1722464590 bf70c49004] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:23:33 AM CEST 2024 'RUN   files: 1000  partitions: 100'
Thu Aug 1 12:23:33 AM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-512-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-512-1000-100-1722464590 1000 no 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-512-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-128-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-128-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-128-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-128-1000-100
+ env
++ date
+ echo Thu Aug 1 12:24:54 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Thu Aug 1 12:24:54 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at bf70c49004 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-1000-100-1722464694
+ git checkout -b scalability-no-128-1000-100-1722464694
Switched to a new branch 'scalability-no-128-1000-100-1722464694'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/128/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-1000-100-1722464694 a493ce263c] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:25:17 AM CEST 2024 'RUN   files: 1000  partitions: 100'
Thu Aug 1 12:25:17 AM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-128-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-128-1000-100-1722464694 1000 no 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-128-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-32-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-32-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-32-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-32-1000-100
+ env
++ date
+ echo Thu Aug 1 12:26:38 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Thu Aug 1 12:26:38 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a493ce263c fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-1000-100-1722464798
+ git checkout -b scalability-yes-32-1000-100-1722464798
Switched to a new branch 'scalability-yes-32-1000-100-1722464798'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-1000-100-1722464798 a47b8261f9] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-1000-100-1722464798 16f5e398ab] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:27:01 AM CEST 2024 'RUN   files: 1000  partitions: 100'
Thu Aug 1 12:27:01 AM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-32-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-32-1000-100-1722464798 1000 yes 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-32-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-0-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-0-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-0-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-0-1000-100
+ env
++ date
+ echo Thu Aug 1 12:43:48 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Thu Aug 1 12:43:48 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 16f5e398ab fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-1000-100-1722465829
+ git checkout -b scalability-yes-0-1000-100-1722465829
Switched to a new branch 'scalability-yes-0-1000-100-1722465829'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-1000-100-1722465829 1071fb4b35] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:44:13 AM CEST 2024 'RUN   files: 1000  partitions: 100'
Thu Aug 1 12:44:13 AM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-0-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-0-1000-100-1722465829 1000 yes 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-0-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-1-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-1-1000-100
+ env
++ date
+ echo Thu Aug 1 01:01:00 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Thu Aug 1 01:01:00 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 1071fb4b35 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-1000-100-1722466860
+ git checkout -b scalability-yes-1-1000-100-1722466860
Switched to a new branch 'scalability-yes-1-1000-100-1722466860'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-1000-100-1722466860 f6c0e17bfa] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-1000-100-1722466860 45b6a4561d] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 01:01:25 AM CEST 2024 'RUN   files: 1000  partitions: 100'
Thu Aug 1 01:01:25 AM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-1-1000-100-1722466860 1000 yes 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1024-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-1024-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1024-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-1024-1000-100
+ env
++ date
+ echo Thu Aug 1 01:18:06 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Thu Aug 1 01:18:06 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 45b6a4561d fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-1000-100-1722467887
+ git checkout -b scalability-yes-1024-1000-100-1722467887
Switched to a new branch 'scalability-yes-1024-1000-100-1722467887'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-1000-100-1722467887 ae465a3484] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-1000-100-1722467887 715a93fb24] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 01:18:32 AM CEST 2024 'RUN   files: 1000  partitions: 100'
Thu Aug 1 01:18:32 AM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1024-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-1024-1000-100-1722467887 1000 yes 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1024-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-8-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-8-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-8-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-8-1000-100
+ env
++ date
+ echo Thu Aug 1 01:35:24 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Thu Aug 1 01:35:24 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 715a93fb24 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-1000-100-1722468924
+ git checkout -b scalability-yes-8-1000-100-1722468924
Switched to a new branch 'scalability-yes-8-1000-100-1722468924'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-1000-100-1722468924 b24662c10a] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-1000-100-1722468924 b6c54ab5cb] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 01:35:49 AM CEST 2024 'RUN   files: 1000  partitions: 100'
Thu Aug 1 01:35:49 AM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-8-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-8-1000-100-1722468924 1000 yes 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-8-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-512-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-512-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-512-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-512-1000-100
+ env
++ date
+ echo Thu Aug 1 01:52:31 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Thu Aug 1 01:52:31 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b6c54ab5cb fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-1000-100-1722469951
+ git checkout -b scalability-yes-512-1000-100-1722469951
Switched to a new branch 'scalability-yes-512-1000-100-1722469951'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-1000-100-1722469951 5561450a76] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-1000-100-1722469951 3184d585d9] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 01:52:56 AM CEST 2024 'RUN   files: 1000  partitions: 100'
Thu Aug 1 01:52:56 AM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-512-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-512-1000-100-1722469951 1000 yes 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-512-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-128-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-128-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-128-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-128-1000-100
+ env
++ date
+ echo Thu Aug 1 02:09:48 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Thu Aug 1 02:09:48 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 3184d585d9 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-1000-100-1722470988
+ git checkout -b scalability-yes-128-1000-100-1722470988
Switched to a new branch 'scalability-yes-128-1000-100-1722470988'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-1000-100-1722470988 6cd0e7d48b] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-1000-100-1722470988 20a3bb4b82] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 02:10:13 AM CEST 2024 'RUN   files: 1000  partitions: 100'
Thu Aug 1 02:10:13 AM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-128-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-128-1000-100-1722470988 1000 yes 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-128-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-32-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-32-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-32-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-32-1000-100
+ env
++ date
+ echo Thu Aug 1 02:26:56 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Thu Aug 1 02:26:56 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 20a3bb4b82 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-1000-100-1722472017
+ git checkout -b scalability-no-32-1000-100-1722472017
Switched to a new branch 'scalability-no-32-1000-100-1722472017'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-1000-100-1722472017 b7637a34f6] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 02:27:21 AM CEST 2024 'RUN   files: 1000  partitions: 100'
Thu Aug 1 02:27:21 AM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-32-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-32-1000-100-1722472017 1000 no 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-32-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-0-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-0-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-0-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-0-1000-100
+ env
++ date
+ echo Thu Aug 1 02:43:53 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Thu Aug 1 02:43:53 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b7637a34f6 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-1000-100-1722473033
+ git checkout -b scalability-no-0-1000-100-1722473033
Switched to a new branch 'scalability-no-0-1000-100-1722473033'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ head -n 1000
+ git log
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 02:44:18 AM CEST 2024 'RUN   files: 1000  partitions: 100'
Thu Aug 1 02:44:18 AM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-0-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-0-1000-100-1722473033 1000 no 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-0-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-1-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-1-1000-100
+ env
++ date
+ echo Thu Aug 1 03:00:56 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Thu Aug 1 03:00:56 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-1000-100-1722474057
+ git checkout -b scalability-no-1-1000-100-1722474057
Switched to a new branch 'scalability-no-1-1000-100-1722474057'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-1000-100-1722474057 e46159a9a9] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 03:01:21 AM CEST 2024 'RUN   files: 1000  partitions: 100'
Thu Aug 1 03:01:21 AM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-1-1000-100-1722474057 1000 no 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1024-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-1024-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1024-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-1024-1000-100
+ env
++ date
+ echo Thu Aug 1 03:18:02 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Thu Aug 1 03:18:02 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e46159a9a9 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-1000-100-1722475082
+ git checkout -b scalability-no-1024-1000-100-1722475082
Switched to a new branch 'scalability-no-1024-1000-100-1722475082'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-1000-100-1722475082 b0de5273d4] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 03:18:26 AM CEST 2024 'RUN   files: 1000  partitions: 100'
Thu Aug 1 03:18:26 AM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1024-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-1024-1000-100-1722475082 1000 no 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1024-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-8-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-8-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-8-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-8-1000-100
+ env
++ date
+ echo Thu Aug 1 03:35:15 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Thu Aug 1 03:35:15 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b0de5273d4 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-1000-100-1722476115
+ git checkout -b scalability-no-8-1000-100-1722476115
Switched to a new branch 'scalability-no-8-1000-100-1722476115'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/8/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-1000-100-1722476115 a1a026ef2e] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 03:35:39 AM CEST 2024 'RUN   files: 1000  partitions: 100'
Thu Aug 1 03:35:39 AM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-8-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-8-1000-100-1722476115 1000 no 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-8-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-512-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-512-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-512-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-512-1000-100
+ env
++ date
+ echo Thu Aug 1 03:52:14 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Thu Aug 1 03:52:14 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a1a026ef2e fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-1000-100-1722477134
+ git checkout -b scalability-no-512-1000-100-1722477134
Switched to a new branch 'scalability-no-512-1000-100-1722477134'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-1000-100-1722477134 fb72058e79] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 03:52:39 AM CEST 2024 'RUN   files: 1000  partitions: 100'
Thu Aug 1 03:52:39 AM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-512-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-512-1000-100-1722477134 1000 no 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-512-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-128-1000-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-128-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-128-1000-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-128-1000-100
+ env
++ date
+ echo Thu Aug 1 04:09:30 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Thu Aug 1 04:09:30 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at fb72058e79 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-1000-100-1722478171
+ git checkout -b scalability-no-128-1000-100-1722478171
Switched to a new branch 'scalability-no-128-1000-100-1722478171'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-1000-100-1722478171 7afb9bc66b] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-1000-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 04:09:55 AM CEST 2024 'RUN   files: 1000  partitions: 100'
Thu Aug 1 04:09:55 AM CEST 2024 RUN   files: 1000  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-1000-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-128-1000-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-128-1000-100-1722478171 1000 no 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-128-1000-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for p in $PARTITIONS
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-32-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-32-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-32-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-32-1000-10
+ env
++ date
+ echo Thu Aug 1 04:26:29 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Thu Aug 1 04:26:29 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 7afb9bc66b fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-1000-10-1722479189
+ git checkout -b scalability-yes-32-1000-10-1722479189
Switched to a new branch 'scalability-yes-32-1000-10-1722479189'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-1000-10-1722479189 a4789ed6b6] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-1000-10-1722479189 e46cb6f103] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 04:26:53 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 04:26:53 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-32-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-32-1000-10-1722479189 1000 yes 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-32-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-0-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-0-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-0-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-0-1000-10
+ env
++ date
+ echo Thu Aug 1 04:28:08 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Thu Aug 1 04:28:08 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e46cb6f103 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-1000-10-1722479289
+ git checkout -b scalability-yes-0-1000-10-1722479289
Switched to a new branch 'scalability-yes-0-1000-10-1722479289'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-1000-10-1722479289 9497335a7c] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 04:28:32 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 04:28:32 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-0-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-0-1000-10-1722479289 1000 yes 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-0-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-1-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-1-1000-10
+ env
++ date
+ echo Thu Aug 1 04:29:46 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Thu Aug 1 04:29:46 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 9497335a7c NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-1000-10-1722479386
+ git checkout -b scalability-yes-1-1000-10-1722479386
Switched to a new branch 'scalability-yes-1-1000-10-1722479386'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-1000-10-1722479386 7dd77dc137] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-1000-10-1722479386 a62ef73f8a] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 04:30:10 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 04:30:10 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-1-1000-10-1722479386 1000 yes 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1024-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-1024-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1024-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-1024-1000-10
+ env
++ date
+ echo Thu Aug 1 04:31:24 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Thu Aug 1 04:31:24 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a62ef73f8a fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-1000-10-1722479484
+ git checkout -b scalability-yes-1024-1000-10-1722479484
Switched to a new branch 'scalability-yes-1024-1000-10-1722479484'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-1000-10-1722479484 b41a43f3a9] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-1000-10-1722479484 38d49e1c98] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 04:31:47 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 04:31:47 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1024-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-1024-1000-10-1722479484 1000 yes 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1024-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-8-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-8-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-8-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-8-1000-10
+ env
++ date
+ echo Thu Aug 1 04:33:02 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Thu Aug 1 04:33:02 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 38d49e1c98 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-1000-10-1722479582
+ git checkout -b scalability-yes-8-1000-10-1722479582
Switched to a new branch 'scalability-yes-8-1000-10-1722479582'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-1000-10-1722479582 de091bcb25] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-1000-10-1722479582 f44af8ae42] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 04:33:25 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 04:33:25 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-8-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-8-1000-10-1722479582 1000 yes 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-8-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-512-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-512-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-512-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-512-1000-10
+ env
++ date
+ echo Thu Aug 1 04:34:39 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Thu Aug 1 04:34:39 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at f44af8ae42 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-1000-10-1722479680
+ git checkout -b scalability-yes-512-1000-10-1722479680
Switched to a new branch 'scalability-yes-512-1000-10-1722479680'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-1000-10-1722479680 45d954c87c] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-1000-10-1722479680 6b83f17015] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 04:35:03 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 04:35:03 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-512-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-512-1000-10-1722479680 1000 yes 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-512-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-128-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-128-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-128-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-128-1000-10
+ env
++ date
+ echo Thu Aug 1 04:36:17 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Thu Aug 1 04:36:17 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 6b83f17015 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-1000-10-1722479777
+ git checkout -b scalability-yes-128-1000-10-1722479777
Switched to a new branch 'scalability-yes-128-1000-10-1722479777'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-1000-10-1722479777 6b60efd03b] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-1000-10-1722479777 c99fff41e9] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 04:36:41 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 04:36:41 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-128-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-128-1000-10-1722479777 1000 yes 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-128-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-32-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-32-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-32-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-32-1000-10
+ env
++ date
+ echo Thu Aug 1 04:37:55 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Thu Aug 1 04:37:55 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at c99fff41e9 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-1000-10-1722479875
+ git checkout -b scalability-no-32-1000-10-1722479875
Switched to a new branch 'scalability-no-32-1000-10-1722479875'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-1000-10-1722479875 52623037df] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 04:38:18 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 04:38:18 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-32-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-32-1000-10-1722479875 1000 no 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-32-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-0-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-0-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-0-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-0-1000-10
+ env
++ date
+ echo Thu Aug 1 04:39:33 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Thu Aug 1 04:39:33 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 52623037df fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-1000-10-1722479973
+ git checkout -b scalability-no-0-1000-10-1722479973
Switched to a new branch 'scalability-no-0-1000-10-1722479973'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 04:39:56 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 04:39:56 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-0-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-0-1000-10-1722479973 1000 no 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-0-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-1-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-1-1000-10
+ env
++ date
+ echo Thu Aug 1 04:41:10 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Thu Aug 1 04:41:10 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-1000-10-1722480070
+ git checkout -b scalability-no-1-1000-10-1722480070
Switched to a new branch 'scalability-no-1-1000-10-1722480070'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-1000-10-1722480070 2c84d8af2a] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 04:41:34 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 04:41:34 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-1-1000-10-1722480070 1000 no 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1024-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-1024-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1024-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-1024-1000-10
+ env
++ date
+ echo Thu Aug 1 04:42:48 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Thu Aug 1 04:42:48 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 2c84d8af2a fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-1000-10-1722480168
+ git checkout -b scalability-no-1024-1000-10-1722480168
Switched to a new branch 'scalability-no-1024-1000-10-1722480168'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-1000-10-1722480168 675d804859] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 04:43:11 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 04:43:11 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1024-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-1024-1000-10-1722480168 1000 no 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1024-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-8-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-8-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-8-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-8-1000-10
+ env
++ date
+ echo Thu Aug 1 04:44:25 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Thu Aug 1 04:44:25 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 675d804859 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-1000-10-1722480265
+ git checkout -b scalability-no-8-1000-10-1722480265
Switched to a new branch 'scalability-no-8-1000-10-1722480265'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-1000-10-1722480265 9396af9f10] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 04:44:49 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 04:44:49 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-8-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-8-1000-10-1722480265 1000 no 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-8-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-512-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-512-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-512-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-512-1000-10
+ env
++ date
+ echo Thu Aug 1 04:46:03 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Thu Aug 1 04:46:03 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 9396af9f10 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-1000-10-1722480363
+ git checkout -b scalability-no-512-1000-10-1722480363
Switched to a new branch 'scalability-no-512-1000-10-1722480363'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-1000-10-1722480363 25cd772861] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 04:46:27 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 04:46:27 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-512-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-512-1000-10-1722480363 1000 no 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-512-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-128-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-128-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-128-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-128-1000-10
+ env
++ date
+ echo Thu Aug 1 04:47:41 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Thu Aug 1 04:47:41 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 25cd772861 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-1000-10-1722480461
+ git checkout -b scalability-no-128-1000-10-1722480461
Switched to a new branch 'scalability-no-128-1000-10-1722480461'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/128/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-1000-10-1722480461 fe3d729b4e] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 04:48:04 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 04:48:04 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-128-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-128-1000-10-1722480461 1000 no 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-128-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-32-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-32-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-32-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-32-1000-10
+ env
++ date
+ echo Thu Aug 1 04:49:18 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Thu Aug 1 04:49:18 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at fe3d729b4e fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-1000-10-1722480559
+ git checkout -b scalability-yes-32-1000-10-1722480559
Switched to a new branch 'scalability-yes-32-1000-10-1722480559'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-1000-10-1722480559 4a12e434bc] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-1000-10-1722480559 0cd271c498] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 04:49:42 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 04:49:42 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-32-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-32-1000-10-1722480559 1000 yes 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-32-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-0-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-0-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-0-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-0-1000-10
+ env
++ date
+ echo Thu Aug 1 04:50:57 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Thu Aug 1 04:50:57 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 0cd271c498 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-1000-10-1722480657
+ git checkout -b scalability-yes-0-1000-10-1722480657
Switched to a new branch 'scalability-yes-0-1000-10-1722480657'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-1000-10-1722480657 3f14db7c4a] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 04:51:20 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 04:51:20 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-0-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-0-1000-10-1722480657 1000 yes 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-0-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-1-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-1-1000-10
+ env
++ date
+ echo Thu Aug 1 04:52:35 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Thu Aug 1 04:52:35 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 3f14db7c4a NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-1000-10-1722480755
+ git checkout -b scalability-yes-1-1000-10-1722480755
Switched to a new branch 'scalability-yes-1-1000-10-1722480755'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-1000-10-1722480755 ec03687514] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-1000-10-1722480755 7a1ca37a86] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 04:52:59 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 04:52:59 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-1-1000-10-1722480755 1000 yes 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1024-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-1024-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1024-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-1024-1000-10
+ env
++ date
+ echo Thu Aug 1 04:54:13 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Thu Aug 1 04:54:13 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 7a1ca37a86 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-1000-10-1722480854
+ git checkout -b scalability-yes-1024-1000-10-1722480854
Switched to a new branch 'scalability-yes-1024-1000-10-1722480854'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-1000-10-1722480854 0945ebf539] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-1000-10-1722480854 76c53f2009] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 04:54:37 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 04:54:37 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1024-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-1024-1000-10-1722480854 1000 yes 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1024-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-8-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-8-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-8-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-8-1000-10
+ env
++ date
+ echo Thu Aug 1 04:55:52 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Thu Aug 1 04:55:52 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 76c53f2009 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-1000-10-1722480952
+ git checkout -b scalability-yes-8-1000-10-1722480952
Switched to a new branch 'scalability-yes-8-1000-10-1722480952'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-1000-10-1722480952 431a53d72e] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-1000-10-1722480952 eef1d673b6] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 04:56:15 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 04:56:15 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-8-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-8-1000-10-1722480952 1000 yes 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-8-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-512-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-512-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-512-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-512-1000-10
+ env
++ date
+ echo Thu Aug 1 04:57:30 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Thu Aug 1 04:57:30 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at eef1d673b6 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-1000-10-1722481050
+ git checkout -b scalability-yes-512-1000-10-1722481050
Switched to a new branch 'scalability-yes-512-1000-10-1722481050'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-1000-10-1722481050 1b40b4138d] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-1000-10-1722481050 793ebcd229] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 04:57:54 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 04:57:54 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-512-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-512-1000-10-1722481050 1000 yes 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-512-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-128-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-128-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-128-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-128-1000-10
+ env
++ date
+ echo Thu Aug 1 04:59:08 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Thu Aug 1 04:59:08 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 793ebcd229 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-1000-10-1722481148
+ git checkout -b scalability-yes-128-1000-10-1722481148
Switched to a new branch 'scalability-yes-128-1000-10-1722481148'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-1000-10-1722481148 3d188e5bd1] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-1000-10-1722481148 35fcb6ebcf] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 04:59:32 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 04:59:32 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-128-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-128-1000-10-1722481148 1000 yes 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-128-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-32-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-32-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-32-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-32-1000-10
+ env
++ date
+ echo Thu Aug 1 05:00:46 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Thu Aug 1 05:00:46 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 35fcb6ebcf fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-1000-10-1722481247
+ git checkout -b scalability-no-32-1000-10-1722481247
Switched to a new branch 'scalability-no-32-1000-10-1722481247'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-1000-10-1722481247 62a99ba06e] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 05:01:10 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 05:01:10 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-32-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-32-1000-10-1722481247 1000 no 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-32-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-0-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-0-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-0-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-0-1000-10
+ env
++ date
+ echo Thu Aug 1 05:02:24 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Thu Aug 1 05:02:24 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 62a99ba06e fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-1000-10-1722481345
+ git checkout -b scalability-no-0-1000-10-1722481345
Switched to a new branch 'scalability-no-0-1000-10-1722481345'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 05:02:48 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 05:02:48 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-0-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-0-1000-10-1722481345 1000 no 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-0-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-1-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-1-1000-10
+ env
++ date
+ echo Thu Aug 1 05:04:03 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Thu Aug 1 05:04:03 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-1000-10-1722481443
+ git checkout -b scalability-no-1-1000-10-1722481443
Switched to a new branch 'scalability-no-1-1000-10-1722481443'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-1000-10-1722481443 1287003b6e] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 05:04:26 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 05:04:26 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-1-1000-10-1722481443 1000 no 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1024-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-1024-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1024-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-1024-1000-10
+ env
++ date
+ echo Thu Aug 1 05:05:41 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Thu Aug 1 05:05:41 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 1287003b6e fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-1000-10-1722481541
+ git checkout -b scalability-no-1024-1000-10-1722481541
Switched to a new branch 'scalability-no-1024-1000-10-1722481541'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-1000-10-1722481541 ae8800833b] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 05:06:04 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 05:06:04 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1024-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-1024-1000-10-1722481541 1000 no 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1024-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-8-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-8-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-8-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-8-1000-10
+ env
++ date
+ echo Thu Aug 1 05:07:19 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Thu Aug 1 05:07:19 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at ae8800833b fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-1000-10-1722481639
+ git checkout -b scalability-no-8-1000-10-1722481639
Switched to a new branch 'scalability-no-8-1000-10-1722481639'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/8/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-1000-10-1722481639 e8eb8d82f1] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 05:07:43 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 05:07:43 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-8-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-8-1000-10-1722481639 1000 no 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-8-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-512-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-512-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-512-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-512-1000-10
+ env
++ date
+ echo Thu Aug 1 05:08:57 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Thu Aug 1 05:08:57 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e8eb8d82f1 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-1000-10-1722481737
+ git checkout -b scalability-no-512-1000-10-1722481737
Switched to a new branch 'scalability-no-512-1000-10-1722481737'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/512/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-1000-10-1722481737 1160c6d85c] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 05:09:21 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 05:09:21 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-512-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-512-1000-10-1722481737 1000 no 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-512-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-128-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-128-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-128-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-128-1000-10
+ env
++ date
+ echo Thu Aug 1 05:10:35 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Thu Aug 1 05:10:35 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 1160c6d85c fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-1000-10-1722481835
+ git checkout -b scalability-no-128-1000-10-1722481835
Switched to a new branch 'scalability-no-128-1000-10-1722481835'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/128/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-1000-10-1722481835 0355996db0] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 05:10:59 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 05:10:59 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-128-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-128-1000-10-1722481835 1000 no 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-128-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-32-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-32-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-32-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-32-1000-10
+ env
++ date
+ echo Thu Aug 1 05:12:13 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Thu Aug 1 05:12:13 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 0355996db0 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-1000-10-1722481933
+ git checkout -b scalability-yes-32-1000-10-1722481933
Switched to a new branch 'scalability-yes-32-1000-10-1722481933'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-1000-10-1722481933 08c05f7e16] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-1000-10-1722481933 0c2f3aeeb3] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 05:12:37 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 05:12:37 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-32-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-32-1000-10-1722481933 1000 yes 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-32-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-0-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-0-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-0-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-0-1000-10
+ env
++ date
+ echo Thu Aug 1 05:13:50 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Thu Aug 1 05:13:50 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 0c2f3aeeb3 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-1000-10-1722482030
+ git checkout -b scalability-yes-0-1000-10-1722482030
Switched to a new branch 'scalability-yes-0-1000-10-1722482030'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-1000-10-1722482030 75fa38924c] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 05:14:13 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 05:14:13 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-0-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-0-1000-10-1722482030 1000 yes 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-0-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-1-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-1-1000-10
+ env
++ date
+ echo Thu Aug 1 05:15:27 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Thu Aug 1 05:15:27 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 75fa38924c NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-1000-10-1722482127
+ git checkout -b scalability-yes-1-1000-10-1722482127
Switched to a new branch 'scalability-yes-1-1000-10-1722482127'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-1000-10-1722482127 fd11f31828] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-1000-10-1722482127 c5dde0f8d5] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 05:15:50 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 05:15:50 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-1-1000-10-1722482127 1000 yes 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1024-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-1024-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1024-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-1024-1000-10
+ env
++ date
+ echo Thu Aug 1 05:17:03 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Thu Aug 1 05:17:03 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at c5dde0f8d5 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-1000-10-1722482223
+ git checkout -b scalability-yes-1024-1000-10-1722482223
Switched to a new branch 'scalability-yes-1024-1000-10-1722482223'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-1000-10-1722482223 f8a0077e4f] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-1000-10-1722482223 6a69a5b6c1] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 05:17:27 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 05:17:27 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1024-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-1024-1000-10-1722482223 1000 yes 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1024-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-8-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-8-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-8-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-8-1000-10
+ env
++ date
+ echo Thu Aug 1 05:18:40 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Thu Aug 1 05:18:40 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 6a69a5b6c1 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-1000-10-1722482320
+ git checkout -b scalability-yes-8-1000-10-1722482320
Switched to a new branch 'scalability-yes-8-1000-10-1722482320'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-1000-10-1722482320 28a4dfeebe] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-1000-10-1722482320 af5ae6363a] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 05:19:03 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 05:19:03 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-8-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-8-1000-10-1722482320 1000 yes 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-8-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-512-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-512-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-512-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-512-1000-10
+ env
++ date
+ echo Thu Aug 1 05:20:17 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Thu Aug 1 05:20:17 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at af5ae6363a fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-1000-10-1722482417
+ git checkout -b scalability-yes-512-1000-10-1722482417
Switched to a new branch 'scalability-yes-512-1000-10-1722482417'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-1000-10-1722482417 c3922ddee5] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-1000-10-1722482417 184e74ec85] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 05:20:40 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 05:20:40 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-512-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-512-1000-10-1722482417 1000 yes 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-512-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-128-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-128-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-128-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-128-1000-10
+ env
++ date
+ echo Thu Aug 1 05:21:53 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Thu Aug 1 05:21:53 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 184e74ec85 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-1000-10-1722482513
+ git checkout -b scalability-yes-128-1000-10-1722482513
Switched to a new branch 'scalability-yes-128-1000-10-1722482513'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-1000-10-1722482513 f12a053091] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-1000-10-1722482513 7fec1cd6ca] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 05:22:17 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 05:22:17 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-128-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-128-1000-10-1722482513 1000 yes 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-128-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-32-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-32-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-32-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-32-1000-10
+ env
++ date
+ echo Thu Aug 1 05:23:30 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Thu Aug 1 05:23:30 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 7fec1cd6ca fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-1000-10-1722482610
+ git checkout -b scalability-no-32-1000-10-1722482610
Switched to a new branch 'scalability-no-32-1000-10-1722482610'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-1000-10-1722482610 47f92aa06c] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 05:23:53 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 05:23:53 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-32-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-32-1000-10-1722482610 1000 no 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-32-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-0-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-0-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-0-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-0-1000-10
+ env
++ date
+ echo Thu Aug 1 05:25:07 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Thu Aug 1 05:25:07 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 47f92aa06c fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-1000-10-1722482707
+ git checkout -b scalability-no-0-1000-10-1722482707
Switched to a new branch 'scalability-no-0-1000-10-1722482707'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 05:25:30 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 05:25:30 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-0-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-0-1000-10-1722482707 1000 no 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-0-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-1-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-1-1000-10
+ env
++ date
+ echo Thu Aug 1 05:26:43 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Thu Aug 1 05:26:43 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-1000-10-1722482803
+ git checkout -b scalability-no-1-1000-10-1722482803
Switched to a new branch 'scalability-no-1-1000-10-1722482803'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/1/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-1000-10-1722482803 a9938195a7] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 05:27:07 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 05:27:07 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-1-1000-10-1722482803 1000 no 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1024-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-1024-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1024-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-1024-1000-10
+ env
++ date
+ echo Thu Aug 1 05:28:20 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Thu Aug 1 05:28:20 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a9938195a7 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-1000-10-1722482900
+ git checkout -b scalability-no-1024-1000-10-1722482900
Switched to a new branch 'scalability-no-1024-1000-10-1722482900'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-1000-10-1722482900 03a6a0eb89] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 05:28:43 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 05:28:43 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1024-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-1024-1000-10-1722482900 1000 no 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1024-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-8-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-8-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-8-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-8-1000-10
+ env
++ date
+ echo Thu Aug 1 05:29:57 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Thu Aug 1 05:29:57 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 03a6a0eb89 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-1000-10-1722482997
+ git checkout -b scalability-no-8-1000-10-1722482997
Switched to a new branch 'scalability-no-8-1000-10-1722482997'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-1000-10-1722482997 3103ef21ef] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 05:30:20 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 05:30:20 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-8-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-8-1000-10-1722482997 1000 no 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-8-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-512-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-512-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-512-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-512-1000-10
+ env
++ date
+ echo Thu Aug 1 05:31:33 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Thu Aug 1 05:31:33 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 3103ef21ef fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-1000-10-1722483093
+ git checkout -b scalability-no-512-1000-10-1722483093
Switched to a new branch 'scalability-no-512-1000-10-1722483093'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/512/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-1000-10-1722483093 72cd02ce5b] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 05:31:57 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 05:31:57 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-512-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-512-1000-10-1722483093 1000 no 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-512-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-128-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-128-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-128-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-128-1000-10
+ env
++ date
+ echo Thu Aug 1 05:33:10 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Thu Aug 1 05:33:10 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 72cd02ce5b fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-1000-10-1722483190
+ git checkout -b scalability-no-128-1000-10-1722483190
Switched to a new branch 'scalability-no-128-1000-10-1722483190'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-1000-10-1722483190 04396281c4] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 05:33:33 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 05:33:33 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-128-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-128-1000-10-1722483190 1000 no 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-128-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-32-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-32-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-32-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-32-1000-10
+ env
++ date
+ echo Thu Aug 1 05:34:47 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Thu Aug 1 05:34:47 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 04396281c4 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-1000-10-1722483287
+ git checkout -b scalability-yes-32-1000-10-1722483287
Switched to a new branch 'scalability-yes-32-1000-10-1722483287'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-1000-10-1722483287 846de84e92] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-1000-10-1722483287 e2bfe3374a] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 05:35:10 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 05:35:10 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-32-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-32-1000-10-1722483287 1000 yes 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-32-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-0-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-0-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-0-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-0-1000-10
+ env
++ date
+ echo Thu Aug 1 05:36:29 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Thu Aug 1 05:36:29 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e2bfe3374a fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-1000-10-1722483389
+ git checkout -b scalability-yes-0-1000-10-1722483389
Switched to a new branch 'scalability-yes-0-1000-10-1722483389'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-1000-10-1722483389 b8aaa52a71] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 05:36:53 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 05:36:53 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-0-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-0-1000-10-1722483389 1000 yes 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-0-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-1-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-1-1000-10
+ env
++ date
+ echo Thu Aug 1 05:38:12 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Thu Aug 1 05:38:12 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b8aaa52a71 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-1000-10-1722483492
+ git checkout -b scalability-yes-1-1000-10-1722483492
Switched to a new branch 'scalability-yes-1-1000-10-1722483492'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-1000-10-1722483492 120fe80d86] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-1000-10-1722483492 09b9cb42de] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 05:38:35 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 05:38:35 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-1-1000-10-1722483492 1000 yes 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1024-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-1024-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1024-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-1024-1000-10
+ env
++ date
+ echo Thu Aug 1 05:39:54 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Thu Aug 1 05:39:54 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 09b9cb42de fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-1000-10-1722483594
+ git checkout -b scalability-yes-1024-1000-10-1722483594
Switched to a new branch 'scalability-yes-1024-1000-10-1722483594'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-1000-10-1722483594 3da9a09a85] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-1000-10-1722483594 5b6dce76c5] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 05:40:18 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 05:40:18 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1024-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-1024-1000-10-1722483594 1000 yes 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1024-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-8-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-8-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-8-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-8-1000-10
+ env
++ date
+ echo Thu Aug 1 05:41:37 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Thu Aug 1 05:41:37 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 5b6dce76c5 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-1000-10-1722483697
+ git checkout -b scalability-yes-8-1000-10-1722483697
Switched to a new branch 'scalability-yes-8-1000-10-1722483697'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-1000-10-1722483697 8b85d846a3] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-1000-10-1722483697 77126bbc1d] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 05:42:01 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 05:42:01 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-8-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-8-1000-10-1722483697 1000 yes 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-8-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-512-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-512-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-512-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-512-1000-10
+ env
++ date
+ echo Thu Aug 1 05:43:19 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Thu Aug 1 05:43:19 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 77126bbc1d fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-1000-10-1722483800
+ git checkout -b scalability-yes-512-1000-10-1722483800
Switched to a new branch 'scalability-yes-512-1000-10-1722483800'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-1000-10-1722483800 9e08104cc0] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-1000-10-1722483800 937aa2f18b] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 05:43:43 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 05:43:43 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-512-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-512-1000-10-1722483800 1000 yes 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-512-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-128-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-128-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-128-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-128-1000-10
+ env
++ date
+ echo Thu Aug 1 05:45:02 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Thu Aug 1 05:45:02 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 937aa2f18b fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-1000-10-1722483902
+ git checkout -b scalability-yes-128-1000-10-1722483902
Switched to a new branch 'scalability-yes-128-1000-10-1722483902'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-1000-10-1722483902 1412f46d6c] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-1000-10-1722483902 e2d283f2b7] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 05:45:26 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 05:45:26 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-128-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-128-1000-10-1722483902 1000 yes 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-128-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-32-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-32-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-32-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-32-1000-10
+ env
++ date
+ echo Thu Aug 1 05:46:45 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Thu Aug 1 05:46:45 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e2d283f2b7 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-1000-10-1722484005
+ git checkout -b scalability-no-32-1000-10-1722484005
Switched to a new branch 'scalability-no-32-1000-10-1722484005'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-1000-10-1722484005 677f7e3c45] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 05:47:08 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 05:47:08 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-32-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-32-1000-10-1722484005 1000 no 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-32-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-0-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-0-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-0-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-0-1000-10
+ env
++ date
+ echo Thu Aug 1 05:48:27 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Thu Aug 1 05:48:27 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 677f7e3c45 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-1000-10-1722484107
+ git checkout -b scalability-no-0-1000-10-1722484107
Switched to a new branch 'scalability-no-0-1000-10-1722484107'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 05:48:50 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 05:48:50 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-0-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-0-1000-10-1722484107 1000 no 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-0-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-1-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-1-1000-10
+ env
++ date
+ echo Thu Aug 1 05:50:09 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Thu Aug 1 05:50:09 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-1000-10-1722484210
+ git checkout -b scalability-no-1-1000-10-1722484210
Switched to a new branch 'scalability-no-1-1000-10-1722484210'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-1000-10-1722484210 2cbe6892c3] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 05:50:33 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 05:50:33 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-1-1000-10-1722484210 1000 no 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1024-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-1024-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1024-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-1024-1000-10
+ env
++ date
+ echo Thu Aug 1 05:51:52 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Thu Aug 1 05:51:52 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 2cbe6892c3 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-1000-10-1722484312
+ git checkout -b scalability-no-1024-1000-10-1722484312
Switched to a new branch 'scalability-no-1024-1000-10-1722484312'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/1024/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-1000-10-1722484312 fbc16bbe48] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 05:52:16 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 05:52:16 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1024-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-1024-1000-10-1722484312 1000 no 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1024-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-8-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-8-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-8-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-8-1000-10
+ env
++ date
+ echo Thu Aug 1 05:53:35 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Thu Aug 1 05:53:35 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at fbc16bbe48 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-1000-10-1722484415
+ git checkout -b scalability-no-8-1000-10-1722484415
Switched to a new branch 'scalability-no-8-1000-10-1722484415'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-1000-10-1722484415 0601b181cd] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 05:53:58 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 05:53:58 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-8-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-8-1000-10-1722484415 1000 no 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-8-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-512-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-512-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-512-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-512-1000-10
+ env
++ date
+ echo Thu Aug 1 05:55:17 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Thu Aug 1 05:55:17 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 0601b181cd fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-1000-10-1722484518
+ git checkout -b scalability-no-512-1000-10-1722484518
Switched to a new branch 'scalability-no-512-1000-10-1722484518'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/512/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-1000-10-1722484518 c15acb2f57] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 05:55:41 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 05:55:41 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-512-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-512-1000-10-1722484518 1000 no 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-512-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-128-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-128-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-128-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-128-1000-10
+ env
++ date
+ echo Thu Aug 1 05:57:00 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Thu Aug 1 05:57:00 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at c15acb2f57 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-1000-10-1722484620
+ git checkout -b scalability-no-128-1000-10-1722484620
Switched to a new branch 'scalability-no-128-1000-10-1722484620'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-1000-10-1722484620 145d86ad60] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 05:57:24 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 05:57:24 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-128-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-128-1000-10-1722484620 1000 no 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-128-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-32-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-32-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-32-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-32-1000-10
+ env
++ date
+ echo Thu Aug 1 05:58:43 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Thu Aug 1 05:58:43 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 145d86ad60 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-1000-10-1722484723
+ git checkout -b scalability-yes-32-1000-10-1722484723
Switched to a new branch 'scalability-yes-32-1000-10-1722484723'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-1000-10-1722484723 27acf3d3d9] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-1000-10-1722484723 5b2e709093] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 05:59:06 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 05:59:06 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-32-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-32-1000-10-1722484723 1000 yes 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-32-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-0-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-0-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-0-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-0-1000-10
+ env
++ date
+ echo Thu Aug 1 06:02:01 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Thu Aug 1 06:02:01 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 5b2e709093 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-1000-10-1722484921
+ git checkout -b scalability-yes-0-1000-10-1722484921
Switched to a new branch 'scalability-yes-0-1000-10-1722484921'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-1000-10-1722484921 2955154ae6] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 06:02:25 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 06:02:25 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-0-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-0-1000-10-1722484921 1000 yes 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-0-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-1-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-1-1000-10
+ env
++ date
+ echo Thu Aug 1 06:05:21 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Thu Aug 1 06:05:21 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 2955154ae6 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-1000-10-1722485121
+ git checkout -b scalability-yes-1-1000-10-1722485121
Switched to a new branch 'scalability-yes-1-1000-10-1722485121'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-1000-10-1722485121 c687548ec3] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-1000-10-1722485121 1c16ef8a93] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 06:05:45 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 06:05:45 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-1-1000-10-1722485121 1000 yes 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1024-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-1024-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1024-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-1024-1000-10
+ env
++ date
+ echo Thu Aug 1 06:08:41 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Thu Aug 1 06:08:41 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 1c16ef8a93 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-1000-10-1722485321
+ git checkout -b scalability-yes-1024-1000-10-1722485321
Switched to a new branch 'scalability-yes-1024-1000-10-1722485321'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-1000-10-1722485321 ca5931dd58] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-1000-10-1722485321 48354e1bdf] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 06:09:04 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 06:09:04 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1024-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-1024-1000-10-1722485321 1000 yes 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1024-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-8-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-8-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-8-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-8-1000-10
+ env
++ date
+ echo Thu Aug 1 06:12:00 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Thu Aug 1 06:12:00 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 48354e1bdf fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-1000-10-1722485521
+ git checkout -b scalability-yes-8-1000-10-1722485521
Switched to a new branch 'scalability-yes-8-1000-10-1722485521'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-1000-10-1722485521 fc5b10c225] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/8/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-1000-10-1722485521 fb66f5677b] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 06:12:24 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 06:12:24 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-8-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-8-1000-10-1722485521 1000 yes 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-8-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-512-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-512-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-512-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-512-1000-10
+ env
++ date
+ echo Thu Aug 1 06:15:21 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Thu Aug 1 06:15:21 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at fb66f5677b fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-1000-10-1722485721
+ git checkout -b scalability-yes-512-1000-10-1722485721
Switched to a new branch 'scalability-yes-512-1000-10-1722485721'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-1000-10-1722485721 b63fc97a9b] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-1000-10-1722485721 ebfa933f23] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 06:15:44 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 06:15:44 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-512-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-512-1000-10-1722485721 1000 yes 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-512-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-128-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-128-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-128-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-128-1000-10
+ env
++ date
+ echo Thu Aug 1 06:18:41 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Thu Aug 1 06:18:41 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at ebfa933f23 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-1000-10-1722485921
+ git checkout -b scalability-yes-128-1000-10-1722485921
Switched to a new branch 'scalability-yes-128-1000-10-1722485921'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-1000-10-1722485921 19eb5b0113] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-1000-10-1722485921 246d64c59f] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 06:19:04 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 06:19:04 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-128-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-128-1000-10-1722485921 1000 yes 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-128-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-32-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-32-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-32-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-32-1000-10
+ env
++ date
+ echo Thu Aug 1 06:21:59 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Thu Aug 1 06:21:59 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 246d64c59f fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-1000-10-1722486119
+ git checkout -b scalability-no-32-1000-10-1722486119
Switched to a new branch 'scalability-no-32-1000-10-1722486119'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-1000-10-1722486119 c51a4cf50d] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 06:22:23 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 06:22:23 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-32-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-32-1000-10-1722486119 1000 no 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-32-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-0-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-0-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-0-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-0-1000-10
+ env
++ date
+ echo Thu Aug 1 06:25:17 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Thu Aug 1 06:25:17 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at c51a4cf50d fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-1000-10-1722486318
+ git checkout -b scalability-no-0-1000-10-1722486318
Switched to a new branch 'scalability-no-0-1000-10-1722486318'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 06:25:41 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 06:25:41 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-0-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-0-1000-10-1722486318 1000 no 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-0-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-1-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-1-1000-10
+ env
++ date
+ echo Thu Aug 1 06:28:37 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Thu Aug 1 06:28:37 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-1000-10-1722486517
+ git checkout -b scalability-no-1-1000-10-1722486517
Switched to a new branch 'scalability-no-1-1000-10-1722486517'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-1000-10-1722486517 298f5c0c57] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 06:29:01 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 06:29:01 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-1-1000-10-1722486517 1000 no 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1024-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-1024-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1024-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-1024-1000-10
+ env
++ date
+ echo Thu Aug 1 06:31:58 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Thu Aug 1 06:31:58 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 298f5c0c57 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-1000-10-1722486718
+ git checkout -b scalability-no-1024-1000-10-1722486718
Switched to a new branch 'scalability-no-1024-1000-10-1722486718'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-1000-10-1722486718 bd2107cac1] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 06:32:21 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 06:32:21 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1024-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-1024-1000-10-1722486718 1000 no 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1024-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-8-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-8-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-8-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-8-1000-10
+ env
++ date
+ echo Thu Aug 1 06:35:18 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Thu Aug 1 06:35:18 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at bd2107cac1 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-1000-10-1722486918
+ git checkout -b scalability-no-8-1000-10-1722486918
Switched to a new branch 'scalability-no-8-1000-10-1722486918'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-1000-10-1722486918 9d0bee726b] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 06:35:41 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 06:35:41 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-8-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-8-1000-10-1722486918 1000 no 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-8-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-512-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-512-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-512-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-512-1000-10
+ env
++ date
+ echo Thu Aug 1 06:38:36 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Thu Aug 1 06:38:36 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 9d0bee726b fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-1000-10-1722487116
+ git checkout -b scalability-no-512-1000-10-1722487116
Switched to a new branch 'scalability-no-512-1000-10-1722487116'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-1000-10-1722487116 19384bdd56] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 06:39:00 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 06:39:00 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-512-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-512-1000-10-1722487116 1000 no 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-512-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-128-1000-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-128-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-128-1000-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-128-1000-10
+ env
++ date
+ echo Thu Aug 1 06:41:56 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Thu Aug 1 06:41:56 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 19384bdd56 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-1000-10-1722487316
+ git checkout -b scalability-no-128-1000-10-1722487316
Switched to a new branch 'scalability-no-128-1000-10-1722487316'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-1000-10-1722487316 fb2fffecd6] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-1000-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 06:42:20 AM CEST 2024 'RUN   files: 1000  partitions: 10'
Thu Aug 1 06:42:20 AM CEST 2024 RUN   files: 1000  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-1000-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-128-1000-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-128-1000-10-1722487316 1000 no 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-128-1000-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for p in $PARTITIONS
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-32-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-32-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-32-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-32-1000-1
+ env
++ date
+ echo Thu Aug 1 06:45:14 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Thu Aug 1 06:45:14 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at fb2fffecd6 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-1000-1-1722487514
+ git checkout -b scalability-yes-32-1000-1-1722487514
Switched to a new branch 'scalability-yes-32-1000-1-1722487514'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-1000-1-1722487514 3aa43a2a09] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-1000-1-1722487514 33fa60ed7f] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 06:45:57 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 06:45:57 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-32-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-32-1000-1-1722487514 1000 yes 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-32-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-0-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-0-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-0-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-0-1000-1
+ env
++ date
+ echo Thu Aug 1 06:47:11 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Thu Aug 1 06:47:11 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 33fa60ed7f fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-1000-1-1722487631
+ git checkout -b scalability-yes-0-1000-1-1722487631
Switched to a new branch 'scalability-yes-0-1000-1-1722487631'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-1000-1-1722487631 dc5bf56045] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 06:47:54 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 06:47:54 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-0-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-0-1000-1-1722487631 1000 yes 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-0-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-1-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-1-1000-1
+ env
++ date
+ echo Thu Aug 1 06:49:08 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Thu Aug 1 06:49:08 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at dc5bf56045 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-1000-1-1722487748
+ git checkout -b scalability-yes-1-1000-1-1722487748
Switched to a new branch 'scalability-yes-1-1000-1-1722487748'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-1000-1-1722487748 dfca5f6793] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-1000-1-1722487748 6c4070dd50] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 06:49:50 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 06:49:50 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-1-1000-1-1722487748 1000 yes 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1024-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-1024-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1024-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-1024-1000-1
+ env
++ date
+ echo Thu Aug 1 06:51:04 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Thu Aug 1 06:51:04 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 6c4070dd50 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-1000-1-1722487864
+ git checkout -b scalability-yes-1024-1000-1-1722487864
Switched to a new branch 'scalability-yes-1024-1000-1-1722487864'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-1000-1-1722487864 1552b55170] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-1000-1-1722487864 e5beaea873] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 06:51:47 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 06:51:47 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1024-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-1024-1000-1-1722487864 1000 yes 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1024-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-8-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-8-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-8-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-8-1000-1
+ env
++ date
+ echo Thu Aug 1 06:53:01 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Thu Aug 1 06:53:01 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e5beaea873 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-1000-1-1722487981
+ git checkout -b scalability-yes-8-1000-1-1722487981
Switched to a new branch 'scalability-yes-8-1000-1-1722487981'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-1000-1-1722487981 367dc15d32] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-1000-1-1722487981 6a52c81878] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 06:53:43 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 06:53:43 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-8-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-8-1000-1-1722487981 1000 yes 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-8-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-512-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-512-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-512-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-512-1000-1
+ env
++ date
+ echo Thu Aug 1 06:54:57 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Thu Aug 1 06:54:57 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 6a52c81878 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-1000-1-1722488097
+ git checkout -b scalability-yes-512-1000-1-1722488097
Switched to a new branch 'scalability-yes-512-1000-1-1722488097'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-1000-1-1722488097 aeb5012d48] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-1000-1-1722488097 31c8921fcb] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 06:55:39 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 06:55:39 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-512-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-512-1000-1-1722488097 1000 yes 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-512-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-128-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-128-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-128-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-128-1000-1
+ env
++ date
+ echo Thu Aug 1 06:56:53 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Thu Aug 1 06:56:53 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 31c8921fcb fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-1000-1-1722488213
+ git checkout -b scalability-yes-128-1000-1-1722488213
Switched to a new branch 'scalability-yes-128-1000-1-1722488213'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-1000-1-1722488213 4497ed537c] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-1000-1-1722488213 0ee9432f90] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 06:57:35 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 06:57:35 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-128-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-128-1000-1-1722488213 1000 yes 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-128-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-32-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-32-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-32-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-32-1000-1
+ env
++ date
+ echo Thu Aug 1 06:58:49 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Thu Aug 1 06:58:49 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 0ee9432f90 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-1000-1-1722488329
+ git checkout -b scalability-no-32-1000-1-1722488329
Switched to a new branch 'scalability-no-32-1000-1-1722488329'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-1000-1-1722488329 fdb9c21609] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 06:59:31 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 06:59:31 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-32-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-32-1000-1-1722488329 1000 no 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-32-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-0-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-0-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-0-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-0-1000-1
+ env
++ date
+ echo Thu Aug 1 07:00:45 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Thu Aug 1 07:00:45 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at fdb9c21609 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-1000-1-1722488445
+ git checkout -b scalability-no-0-1000-1-1722488445
Switched to a new branch 'scalability-no-0-1000-1-1722488445'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:01:27 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 07:01:27 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-0-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-0-1000-1-1722488445 1000 no 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-0-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-1-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-1-1000-1
+ env
++ date
+ echo Thu Aug 1 07:02:41 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Thu Aug 1 07:02:41 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-1000-1-1722488561
+ git checkout -b scalability-no-1-1000-1-1722488561
Switched to a new branch 'scalability-no-1-1000-1-1722488561'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-1000-1-1722488561 d1de733cb8] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:03:23 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 07:03:23 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-1-1000-1-1722488561 1000 no 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1024-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-1024-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1024-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-1024-1000-1
+ env
++ date
+ echo Thu Aug 1 07:04:37 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Thu Aug 1 07:04:37 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d1de733cb8 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-1000-1-1722488677
+ git checkout -b scalability-no-1024-1000-1-1722488677
Switched to a new branch 'scalability-no-1024-1000-1-1722488677'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-1000-1-1722488677 88118aaeeb] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:05:19 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 07:05:19 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1024-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-1024-1000-1-1722488677 1000 no 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1024-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-8-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-8-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-8-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-8-1000-1
+ env
++ date
+ echo Thu Aug 1 07:06:34 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Thu Aug 1 07:06:34 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 88118aaeeb fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-1000-1-1722488794
+ git checkout -b scalability-no-8-1000-1-1722488794
Switched to a new branch 'scalability-no-8-1000-1-1722488794'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/8/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-1000-1-1722488794 c5b4bbc5cd] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:07:16 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 07:07:16 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-8-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-8-1000-1-1722488794 1000 no 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-8-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-512-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-512-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-512-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-512-1000-1
+ env
++ date
+ echo Thu Aug 1 07:08:30 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Thu Aug 1 07:08:30 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at c5b4bbc5cd fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-1000-1-1722488910
+ git checkout -b scalability-no-512-1000-1-1722488910
Switched to a new branch 'scalability-no-512-1000-1-1722488910'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-1000-1-1722488910 d1131757e0] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:09:12 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 07:09:12 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-512-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-512-1000-1-1722488910 1000 no 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-512-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-128-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-128-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-128-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-128-1000-1
+ env
++ date
+ echo Thu Aug 1 07:10:26 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Thu Aug 1 07:10:26 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d1131757e0 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-1000-1-1722489026
+ git checkout -b scalability-no-128-1000-1-1722489026
Switched to a new branch 'scalability-no-128-1000-1-1722489026'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-1000-1-1722489026 e51ce01c72] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:11:08 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 07:11:08 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-128-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-128-1000-1-1722489026 1000 no 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-128-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-32-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-32-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-32-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-32-1000-1
+ env
++ date
+ echo Thu Aug 1 07:12:22 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Thu Aug 1 07:12:22 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e51ce01c72 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-1000-1-1722489143
+ git checkout -b scalability-yes-32-1000-1-1722489143
Switched to a new branch 'scalability-yes-32-1000-1-1722489143'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-1000-1-1722489143 bd9684a06f] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-1000-1-1722489143 0094a77b4a] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:13:05 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 07:13:05 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-32-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-32-1000-1-1722489143 1000 yes 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-32-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-0-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-0-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-0-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-0-1000-1
+ env
++ date
+ echo Thu Aug 1 07:14:19 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Thu Aug 1 07:14:19 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 0094a77b4a fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-1000-1-1722489259
+ git checkout -b scalability-yes-0-1000-1-1722489259
Switched to a new branch 'scalability-yes-0-1000-1-1722489259'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-1000-1-1722489259 e6831b251e] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:15:01 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 07:15:01 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-0-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-0-1000-1-1722489259 1000 yes 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-0-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-1-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-1-1000-1
+ env
++ date
+ echo Thu Aug 1 07:16:15 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Thu Aug 1 07:16:15 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e6831b251e NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-1000-1-1722489376
+ git checkout -b scalability-yes-1-1000-1-1722489376
Switched to a new branch 'scalability-yes-1-1000-1-1722489376'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-1000-1-1722489376 70570415bd] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-1000-1-1722489376 9122f18590] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:16:58 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 07:16:58 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-1-1000-1-1722489376 1000 yes 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1024-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-1024-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1024-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-1024-1000-1
+ env
++ date
+ echo Thu Aug 1 07:18:12 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Thu Aug 1 07:18:12 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 9122f18590 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-1000-1-1722489492
+ git checkout -b scalability-yes-1024-1000-1-1722489492
Switched to a new branch 'scalability-yes-1024-1000-1-1722489492'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-1000-1-1722489492 c4385aa833] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-1000-1-1722489492 548add1db6] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:18:35 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 07:18:35 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1024-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-1024-1000-1-1722489492 1000 yes 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1024-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-8-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-8-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-8-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-8-1000-1
+ env
++ date
+ echo Thu Aug 1 07:19:50 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Thu Aug 1 07:19:50 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 548add1db6 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-1000-1-1722489590
+ git checkout -b scalability-yes-8-1000-1-1722489590
Switched to a new branch 'scalability-yes-8-1000-1-1722489590'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-1000-1-1722489590 f1f119a521] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-1000-1-1722489590 5a08fe5ebc] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:20:13 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 07:20:13 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-8-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-8-1000-1-1722489590 1000 yes 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-8-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-512-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-512-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-512-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-512-1000-1
+ env
++ date
+ echo Thu Aug 1 07:21:27 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Thu Aug 1 07:21:27 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 5a08fe5ebc fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-1000-1-1722489688
+ git checkout -b scalability-yes-512-1000-1-1722489688
Switched to a new branch 'scalability-yes-512-1000-1-1722489688'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-1000-1-1722489688 5e0dfab9fb] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-1000-1-1722489688 7bd578ba89] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:21:51 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 07:21:51 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-512-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-512-1000-1-1722489688 1000 yes 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-512-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-128-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-128-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-128-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-128-1000-1
+ env
++ date
+ echo Thu Aug 1 07:23:05 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Thu Aug 1 07:23:05 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 7bd578ba89 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-1000-1-1722489785
+ git checkout -b scalability-yes-128-1000-1-1722489785
Switched to a new branch 'scalability-yes-128-1000-1-1722489785'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-1000-1-1722489785 44a093f06f] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-1000-1-1722489785 a9fcb82404] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:23:29 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 07:23:29 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-128-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-128-1000-1-1722489785 1000 yes 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-128-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-32-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-32-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-32-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-32-1000-1
+ env
++ date
+ echo Thu Aug 1 07:24:43 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Thu Aug 1 07:24:43 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a9fcb82404 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-1000-1-1722489883
+ git checkout -b scalability-no-32-1000-1-1722489883
Switched to a new branch 'scalability-no-32-1000-1-1722489883'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-1000-1-1722489883 4565366ae7] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:25:06 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 07:25:06 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-32-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-32-1000-1-1722489883 1000 no 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-32-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-0-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-0-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-0-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-0-1000-1
+ env
++ date
+ echo Thu Aug 1 07:26:21 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Thu Aug 1 07:26:21 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 4565366ae7 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-1000-1-1722489981
+ git checkout -b scalability-no-0-1000-1-1722489981
Switched to a new branch 'scalability-no-0-1000-1-1722489981'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:26:44 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 07:26:44 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-0-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-0-1000-1-1722489981 1000 no 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-0-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-1-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-1-1000-1
+ env
++ date
+ echo Thu Aug 1 07:27:58 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Thu Aug 1 07:27:58 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-1000-1-1722490078
+ git checkout -b scalability-no-1-1000-1-1722490078
Switched to a new branch 'scalability-no-1-1000-1-1722490078'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-1000-1-1722490078 1b72d70c5f] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:28:21 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 07:28:21 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-1-1000-1-1722490078 1000 no 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1024-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-1024-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1024-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-1024-1000-1
+ env
++ date
+ echo Thu Aug 1 07:29:36 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Thu Aug 1 07:29:36 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 1b72d70c5f fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-1000-1-1722490176
+ git checkout -b scalability-no-1024-1000-1-1722490176
Switched to a new branch 'scalability-no-1024-1000-1-1722490176'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-1000-1-1722490176 5fac89816f] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:29:59 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 07:29:59 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1024-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-1024-1000-1-1722490176 1000 no 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1024-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-8-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-8-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-8-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-8-1000-1
+ env
++ date
+ echo Thu Aug 1 07:31:13 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Thu Aug 1 07:31:13 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 5fac89816f fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-1000-1-1722490273
+ git checkout -b scalability-no-8-1000-1-1722490273
Switched to a new branch 'scalability-no-8-1000-1-1722490273'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/8/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-1000-1-1722490273 026e33fbdf] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:31:37 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 07:31:37 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-8-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-8-1000-1-1722490273 1000 no 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-8-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-512-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-512-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-512-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-512-1000-1
+ env
++ date
+ echo Thu Aug 1 07:32:51 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Thu Aug 1 07:32:51 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 026e33fbdf fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-1000-1-1722490371
+ git checkout -b scalability-no-512-1000-1-1722490371
Switched to a new branch 'scalability-no-512-1000-1-1722490371'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/512/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-1000-1-1722490371 b17ac15527] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:33:14 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 07:33:14 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-512-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-512-1000-1-1722490371 1000 no 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-512-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-128-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-128-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-128-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-128-1000-1
+ env
++ date
+ echo Thu Aug 1 07:34:28 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Thu Aug 1 07:34:28 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b17ac15527 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-1000-1-1722490469
+ git checkout -b scalability-no-128-1000-1-1722490469
Switched to a new branch 'scalability-no-128-1000-1-1722490469'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-1000-1-1722490469 5ae81a23b5] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:34:52 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 07:34:52 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-128-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-128-1000-1-1722490469 1000 no 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-128-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-32-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-32-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-32-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-32-1000-1
+ env
++ date
+ echo Thu Aug 1 07:36:06 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Thu Aug 1 07:36:06 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 5ae81a23b5 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-1000-1-1722490566
+ git checkout -b scalability-yes-32-1000-1-1722490566
Switched to a new branch 'scalability-yes-32-1000-1-1722490566'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-1000-1-1722490566 d417677cfd] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-1000-1-1722490566 50beff482b] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:36:29 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 07:36:29 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-32-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-32-1000-1-1722490566 1000 yes 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-32-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-0-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-0-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-0-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-0-1000-1
+ env
++ date
+ echo Thu Aug 1 07:37:42 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Thu Aug 1 07:37:42 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 50beff482b fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-1000-1-1722490663
+ git checkout -b scalability-yes-0-1000-1-1722490663
Switched to a new branch 'scalability-yes-0-1000-1-1722490663'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-1000-1-1722490663 b214f5a126] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:38:06 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 07:38:06 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-0-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-0-1000-1-1722490663 1000 yes 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-0-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-1-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-1-1000-1
+ env
++ date
+ echo Thu Aug 1 07:39:19 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Thu Aug 1 07:39:19 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b214f5a126 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-1000-1-1722490759
+ git checkout -b scalability-yes-1-1000-1-1722490759
Switched to a new branch 'scalability-yes-1-1000-1-1722490759'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-1000-1-1722490759 a3a099e4dc] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-1000-1-1722490759 004420cf3a] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:39:42 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 07:39:42 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-1-1000-1-1722490759 1000 yes 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1024-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-1024-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1024-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-1024-1000-1
+ env
++ date
+ echo Thu Aug 1 07:40:55 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Thu Aug 1 07:40:55 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 004420cf3a fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-1000-1-1722490855
+ git checkout -b scalability-yes-1024-1000-1-1722490855
Switched to a new branch 'scalability-yes-1024-1000-1-1722490855'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-1000-1-1722490855 56eff38875] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-1000-1-1722490855 11178176da] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:41:19 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 07:41:19 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1024-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-1024-1000-1-1722490855 1000 yes 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1024-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-8-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-8-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-8-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-8-1000-1
+ env
++ date
+ echo Thu Aug 1 07:42:32 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Thu Aug 1 07:42:32 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 11178176da fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-1000-1-1722490952
+ git checkout -b scalability-yes-8-1000-1-1722490952
Switched to a new branch 'scalability-yes-8-1000-1-1722490952'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-1000-1-1722490952 c7c42da930] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-1000-1-1722490952 469d6c96eb] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:42:56 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 07:42:56 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-8-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-8-1000-1-1722490952 1000 yes 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-8-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-512-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-512-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-512-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-512-1000-1
+ env
++ date
+ echo Thu Aug 1 07:44:09 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Thu Aug 1 07:44:09 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 469d6c96eb fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-1000-1-1722491049
+ git checkout -b scalability-yes-512-1000-1-1722491049
Switched to a new branch 'scalability-yes-512-1000-1-1722491049'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-1000-1-1722491049 a982eca4bf] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-1000-1-1722491049 b1f2849cce] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:44:32 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 07:44:32 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-512-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-512-1000-1-1722491049 1000 yes 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-512-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-128-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-128-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-128-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-128-1000-1
+ env
++ date
+ echo Thu Aug 1 07:45:45 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Thu Aug 1 07:45:45 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b1f2849cce fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-1000-1-1722491145
+ git checkout -b scalability-yes-128-1000-1-1722491145
Switched to a new branch 'scalability-yes-128-1000-1-1722491145'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-1000-1-1722491145 6d86f4e1a0] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-1000-1-1722491145 d6abc66fb4] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:46:09 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 07:46:09 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-128-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-128-1000-1-1722491145 1000 yes 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-128-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-32-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-32-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-32-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-32-1000-1
+ env
++ date
+ echo Thu Aug 1 07:47:22 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Thu Aug 1 07:47:22 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d6abc66fb4 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-1000-1-1722491242
+ git checkout -b scalability-no-32-1000-1-1722491242
Switched to a new branch 'scalability-no-32-1000-1-1722491242'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-1000-1-1722491242 182ca0cc12] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:47:45 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 07:47:45 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-32-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-32-1000-1-1722491242 1000 no 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-32-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-0-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-0-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-0-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-0-1000-1
+ env
++ date
+ echo Thu Aug 1 07:48:58 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Thu Aug 1 07:48:58 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 182ca0cc12 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-1000-1-1722491338
+ git checkout -b scalability-no-0-1000-1-1722491338
Switched to a new branch 'scalability-no-0-1000-1-1722491338'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:49:21 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 07:49:21 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-0-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-0-1000-1-1722491338 1000 no 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-0-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-1-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-1-1000-1
+ env
++ date
+ echo Thu Aug 1 07:50:34 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Thu Aug 1 07:50:34 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-1000-1-1722491435
+ git checkout -b scalability-no-1-1000-1-1722491435
Switched to a new branch 'scalability-no-1-1000-1-1722491435'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-1000-1-1722491435 c34cc2a777] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:50:58 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 07:50:58 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-1-1000-1-1722491435 1000 no 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1024-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-1024-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1024-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-1024-1000-1
+ env
++ date
+ echo Thu Aug 1 07:52:11 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Thu Aug 1 07:52:11 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at c34cc2a777 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-1000-1-1722491531
+ git checkout -b scalability-no-1024-1000-1-1722491531
Switched to a new branch 'scalability-no-1024-1000-1-1722491531'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/1024/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-1000-1-1722491531 1c9ad7fb3e] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:52:34 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 07:52:34 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1024-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-1024-1000-1-1722491531 1000 no 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1024-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-8-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-8-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-8-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-8-1000-1
+ env
++ date
+ echo Thu Aug 1 07:53:47 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Thu Aug 1 07:53:47 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 1c9ad7fb3e fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-1000-1-1722491628
+ git checkout -b scalability-no-8-1000-1-1722491628
Switched to a new branch 'scalability-no-8-1000-1-1722491628'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-1000-1-1722491628 18c8b2aa9f] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:54:11 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 07:54:11 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-8-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-8-1000-1-1722491628 1000 no 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-8-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-512-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-512-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-512-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-512-1000-1
+ env
++ date
+ echo Thu Aug 1 07:55:24 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Thu Aug 1 07:55:24 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 18c8b2aa9f fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-1000-1-1722491724
+ git checkout -b scalability-no-512-1000-1-1722491724
Switched to a new branch 'scalability-no-512-1000-1-1722491724'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/512/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-1000-1-1722491724 f87cba5215] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:55:47 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 07:55:47 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-512-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-512-1000-1-1722491724 1000 no 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-512-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-128-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-128-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-128-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-128-1000-1
+ env
++ date
+ echo Thu Aug 1 07:57:00 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Thu Aug 1 07:57:00 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at f87cba5215 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-1000-1-1722491820
+ git checkout -b scalability-no-128-1000-1-1722491820
Switched to a new branch 'scalability-no-128-1000-1-1722491820'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-1000-1-1722491820 9493b1abd9] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:57:24 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 07:57:24 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-128-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-128-1000-1-1722491820 1000 no 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-128-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-32-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-32-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-32-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-32-1000-1
+ env
++ date
+ echo Thu Aug 1 07:58:37 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Thu Aug 1 07:58:37 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 9493b1abd9 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-1000-1-1722491917
+ git checkout -b scalability-yes-32-1000-1-1722491917
Switched to a new branch 'scalability-yes-32-1000-1-1722491917'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-1000-1-1722491917 dd65bcec1f] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-1000-1-1722491917 5e0971141b] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:59:00 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 07:59:00 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-32-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-32-1000-1-1722491917 1000 yes 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-32-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-0-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-0-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-0-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-0-1000-1
+ env
++ date
+ echo Thu Aug 1 08:00:19 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Thu Aug 1 08:00:19 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 5e0971141b fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-1000-1-1722492019
+ git checkout -b scalability-yes-0-1000-1-1722492019
Switched to a new branch 'scalability-yes-0-1000-1-1722492019'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-1000-1-1722492019 a139f82c62] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:00:42 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 08:00:42 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-0-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-0-1000-1-1722492019 1000 yes 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-0-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-1-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-1-1000-1
+ env
++ date
+ echo Thu Aug 1 08:02:01 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Thu Aug 1 08:02:01 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a139f82c62 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-1000-1-1722492121
+ git checkout -b scalability-yes-1-1000-1-1722492121
Switched to a new branch 'scalability-yes-1-1000-1-1722492121'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-1000-1-1722492121 10a4d0dd9d] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-1000-1-1722492121 133eff7a5b] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:02:24 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 08:02:24 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-1-1000-1-1722492121 1000 yes 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1024-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-1024-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1024-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-1024-1000-1
+ env
++ date
+ echo Thu Aug 1 08:03:42 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Thu Aug 1 08:03:42 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 133eff7a5b fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-1000-1-1722492223
+ git checkout -b scalability-yes-1024-1000-1-1722492223
Switched to a new branch 'scalability-yes-1024-1000-1-1722492223'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-1000-1-1722492223 faea5503a6] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-1000-1-1722492223 ec15129d94] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:04:06 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 08:04:06 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1024-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-1024-1000-1-1722492223 1000 yes 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1024-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-8-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-8-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-8-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-8-1000-1
+ env
++ date
+ echo Thu Aug 1 08:05:25 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Thu Aug 1 08:05:25 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at ec15129d94 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-1000-1-1722492325
+ git checkout -b scalability-yes-8-1000-1-1722492325
Switched to a new branch 'scalability-yes-8-1000-1-1722492325'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-1000-1-1722492325 43c7a20135] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-1000-1-1722492325 db93e3887e] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:05:48 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 08:05:48 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-8-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-8-1000-1-1722492325 1000 yes 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-8-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-512-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-512-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-512-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-512-1000-1
+ env
++ date
+ echo Thu Aug 1 08:07:06 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Thu Aug 1 08:07:06 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at db93e3887e fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-1000-1-1722492427
+ git checkout -b scalability-yes-512-1000-1-1722492427
Switched to a new branch 'scalability-yes-512-1000-1-1722492427'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-1000-1-1722492427 c5a3c2e72a] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-1000-1-1722492427 161cb61e05] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:07:30 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 08:07:30 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-512-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-512-1000-1-1722492427 1000 yes 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-512-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-128-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-128-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-128-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-128-1000-1
+ env
++ date
+ echo Thu Aug 1 08:08:48 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Thu Aug 1 08:08:48 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 161cb61e05 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-1000-1-1722492529
+ git checkout -b scalability-yes-128-1000-1-1722492529
Switched to a new branch 'scalability-yes-128-1000-1-1722492529'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-1000-1-1722492529 a3cdeaa484] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-1000-1-1722492529 362d4b63d6] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:09:12 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 08:09:12 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-128-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-128-1000-1-1722492529 1000 yes 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-128-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-32-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-32-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-32-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-32-1000-1
+ env
++ date
+ echo Thu Aug 1 08:10:30 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Thu Aug 1 08:10:30 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 362d4b63d6 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-1000-1-1722492631
+ git checkout -b scalability-no-32-1000-1-1722492631
Switched to a new branch 'scalability-no-32-1000-1-1722492631'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-1000-1-1722492631 4ecd57c697] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:10:54 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 08:10:54 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-32-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-32-1000-1-1722492631 1000 no 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-32-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-0-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-0-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-0-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-0-1000-1
+ env
++ date
+ echo Thu Aug 1 08:12:12 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Thu Aug 1 08:12:12 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 4ecd57c697 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-1000-1-1722492733
+ git checkout -b scalability-no-0-1000-1-1722492733
Switched to a new branch 'scalability-no-0-1000-1-1722492733'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:12:36 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 08:12:36 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-0-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-0-1000-1-1722492733 1000 no 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-0-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-1-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-1-1000-1
+ env
++ date
+ echo Thu Aug 1 08:13:54 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Thu Aug 1 08:13:54 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-1000-1-1722492835
+ git checkout -b scalability-no-1-1000-1-1722492835
Switched to a new branch 'scalability-no-1-1000-1-1722492835'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-1000-1-1722492835 992579816e] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:14:18 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 08:14:18 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-1-1000-1-1722492835 1000 no 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1024-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-1024-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1024-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-1024-1000-1
+ env
++ date
+ echo Thu Aug 1 08:15:37 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Thu Aug 1 08:15:37 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 992579816e fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-1000-1-1722492937
+ git checkout -b scalability-no-1024-1000-1-1722492937
Switched to a new branch 'scalability-no-1024-1000-1-1722492937'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/1024/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-1000-1-1722492937 827904a007] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:16:00 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 08:16:00 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1024-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-1024-1000-1-1722492937 1000 no 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1024-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-8-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-8-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-8-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-8-1000-1
+ env
++ date
+ echo Thu Aug 1 08:17:19 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Thu Aug 1 08:17:19 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 827904a007 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-1000-1-1722493039
+ git checkout -b scalability-no-8-1000-1-1722493039
Switched to a new branch 'scalability-no-8-1000-1-1722493039'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/8/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-1000-1-1722493039 616a689f9b] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:17:42 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 08:17:42 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-8-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-8-1000-1-1722493039 1000 no 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-8-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-512-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-512-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-512-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-512-1000-1
+ env
++ date
+ echo Thu Aug 1 08:19:00 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Thu Aug 1 08:19:00 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 616a689f9b fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-1000-1-1722493140
+ git checkout -b scalability-no-512-1000-1-1722493140
Switched to a new branch 'scalability-no-512-1000-1-1722493140'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/512/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-1000-1-1722493140 6649b0c02b] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:19:24 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 08:19:24 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-512-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-512-1000-1-1722493140 1000 no 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-512-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-128-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-128-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-128-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-128-1000-1
+ env
++ date
+ echo Thu Aug 1 08:20:43 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Thu Aug 1 08:20:43 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 6649b0c02b fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-1000-1-1722493243
+ git checkout -b scalability-no-128-1000-1-1722493243
Switched to a new branch 'scalability-no-128-1000-1-1722493243'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-1000-1-1722493243 fbf7c1a3dd] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:21:06 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 08:21:06 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-128-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-128-1000-1-1722493243 1000 no 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-128-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-32-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-32-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-32-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-32-1000-1
+ env
++ date
+ echo Thu Aug 1 08:22:24 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Thu Aug 1 08:22:24 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at fbf7c1a3dd fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-1000-1-1722493345
+ git checkout -b scalability-yes-32-1000-1-1722493345
Switched to a new branch 'scalability-yes-32-1000-1-1722493345'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-1000-1-1722493345 77359c4388] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-1000-1-1722493345 087582feb8] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:22:48 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 08:22:48 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-32-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-32-1000-1-1722493345 1000 yes 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-32-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-0-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-0-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-0-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-0-1000-1
+ env
++ date
+ echo Thu Aug 1 08:24:38 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Thu Aug 1 08:24:38 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 087582feb8 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-1000-1-1722493478
+ git checkout -b scalability-yes-0-1000-1-1722493478
Switched to a new branch 'scalability-yes-0-1000-1-1722493478'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-1000-1-1722493478 f94817628d] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:25:01 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 08:25:01 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-0-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-0-1000-1-1722493478 1000 yes 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-0-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-1-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-1-1000-1
+ env
++ date
+ echo Thu Aug 1 08:26:52 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Thu Aug 1 08:26:52 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at f94817628d NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-1000-1-1722493613
+ git checkout -b scalability-yes-1-1000-1-1722493613
Switched to a new branch 'scalability-yes-1-1000-1-1722493613'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-1000-1-1722493613 f7c06a4213] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-1000-1-1722493613 d23284854c] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:27:16 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 08:27:16 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-1-1000-1-1722493613 1000 yes 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1024-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-1024-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1024-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-1024-1000-1
+ env
++ date
+ echo Thu Aug 1 08:29:07 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Thu Aug 1 08:29:07 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d23284854c fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-1000-1-1722493747
+ git checkout -b scalability-yes-1024-1000-1-1722493747
Switched to a new branch 'scalability-yes-1024-1000-1-1722493747'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-1000-1-1722493747 4de5ed7d2b] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-1000-1-1722493747 a417feb080] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:29:31 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 08:29:31 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1024-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-1024-1000-1-1722493747 1000 yes 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1024-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-8-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-8-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-8-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-8-1000-1
+ env
++ date
+ echo Thu Aug 1 08:31:21 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Thu Aug 1 08:31:21 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a417feb080 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-1000-1-1722493881
+ git checkout -b scalability-yes-8-1000-1-1722493881
Switched to a new branch 'scalability-yes-8-1000-1-1722493881'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-1000-1-1722493881 8c58d18503] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-1000-1-1722493881 320785c379] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:31:44 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 08:31:44 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-8-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-8-1000-1-1722493881 1000 yes 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-8-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-512-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-512-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-512-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-512-1000-1
+ env
++ date
+ echo Thu Aug 1 08:33:34 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Thu Aug 1 08:33:34 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 320785c379 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-1000-1-1722494015
+ git checkout -b scalability-yes-512-1000-1-1722494015
Switched to a new branch 'scalability-yes-512-1000-1-1722494015'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-1000-1-1722494015 39feca7c54] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-1000-1-1722494015 e48a7bda79] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:33:58 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 08:33:58 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-512-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-512-1000-1-1722494015 1000 yes 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-512-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-128-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-128-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-128-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-128-1000-1
+ env
++ date
+ echo Thu Aug 1 08:35:48 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Thu Aug 1 08:35:48 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e48a7bda79 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-1000-1-1722494148
+ git checkout -b scalability-yes-128-1000-1-1722494148
Switched to a new branch 'scalability-yes-128-1000-1-1722494148'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-1000-1-1722494148 34fbdc8b08] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-1000-1-1722494148 85624aa3ab] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:36:12 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 08:36:12 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-128-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-128-1000-1-1722494148 1000 yes 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-128-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-32-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-32-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-32-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-32-1000-1
+ env
++ date
+ echo Thu Aug 1 08:38:01 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Thu Aug 1 08:38:01 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 85624aa3ab fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-1000-1-1722494282
+ git checkout -b scalability-no-32-1000-1-1722494282
Switched to a new branch 'scalability-no-32-1000-1-1722494282'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/32/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-1000-1-1722494282 ef02ed750e] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:38:25 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 08:38:25 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-32-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-32-1000-1-1722494282 1000 no 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-32-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-0-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-0-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-0-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-0-1000-1
+ env
++ date
+ echo Thu Aug 1 08:40:15 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Thu Aug 1 08:40:15 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at ef02ed750e fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-1000-1-1722494415
+ git checkout -b scalability-no-0-1000-1-1722494415
Switched to a new branch 'scalability-no-0-1000-1-1722494415'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:40:38 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 08:40:38 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-0-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-0-1000-1-1722494415 1000 no 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-0-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-1-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-1-1000-1
+ env
++ date
+ echo Thu Aug 1 08:42:29 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Thu Aug 1 08:42:29 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-1000-1-1722494550
+ git checkout -b scalability-no-1-1000-1-1722494550
Switched to a new branch 'scalability-no-1-1000-1-1722494550'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-1000-1-1722494550 b800b8c04c] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:42:53 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 08:42:53 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-1-1000-1-1722494550 1000 no 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1024-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-1024-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1024-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-1024-1000-1
+ env
++ date
+ echo Thu Aug 1 08:44:44 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Thu Aug 1 08:44:44 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b800b8c04c fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-1000-1-1722494684
+ git checkout -b scalability-no-1024-1000-1-1722494684
Switched to a new branch 'scalability-no-1024-1000-1-1722494684'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-1000-1-1722494684 2169369289] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:45:08 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 08:45:08 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1024-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-1024-1000-1-1722494684 1000 no 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1024-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-8-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-8-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-8-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-8-1000-1
+ env
++ date
+ echo Thu Aug 1 08:46:58 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Thu Aug 1 08:46:58 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 2169369289 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-1000-1-1722494818
+ git checkout -b scalability-no-8-1000-1-1722494818
Switched to a new branch 'scalability-no-8-1000-1-1722494818'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-1000-1-1722494818 50d4025e99] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:47:21 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 08:47:21 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-8-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-8-1000-1-1722494818 1000 no 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-8-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-512-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-512-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-512-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-512-1000-1
+ env
++ date
+ echo Thu Aug 1 08:49:11 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Thu Aug 1 08:49:11 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 50d4025e99 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-1000-1-1722494951
+ git checkout -b scalability-no-512-1000-1-1722494951
Switched to a new branch 'scalability-no-512-1000-1-1722494951'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/512/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-1000-1-1722494951 3ba2533617] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:49:34 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 08:49:34 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-512-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-512-1000-1-1722494951 1000 no 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-512-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-128-1000-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-128-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-128-1000-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-128-1000-1
+ env
++ date
+ echo Thu Aug 1 08:51:24 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Thu Aug 1 08:51:24 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 3ba2533617 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-1000-1-1722495085
+ git checkout -b scalability-no-128-1000-1-1722495085
Switched to a new branch 'scalability-no-128-1000-1-1722495085'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-1000-1-1722495085 473682448b] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-1000-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:51:48 AM CEST 2024 'RUN   files: 1000  partitions: 1'
Thu Aug 1 08:51:48 AM CEST 2024 RUN   files: 1000  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-1000-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-128-1000-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-128-1000-1-1722495085 1000 no 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-128-1000-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for p in $PARTITIONS
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-32-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-32-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-32-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-32-1000-0
+ env
++ date
+ echo Thu Aug 1 08:53:37 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Thu Aug 1 08:53:37 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 473682448b fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-1000-0-1722495218
+ git checkout -b scalability-yes-32-1000-0-1722495218
Switched to a new branch 'scalability-yes-32-1000-0-1722495218'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-1000-0-1722495218 4637f1dc41] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-1000-0-1722495218 5b6cc2bf32] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:54:20 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 08:54:20 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-32-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-32-1000-0-1722495218 1000 yes 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-32-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-0-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-0-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-0-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-0-1000-0
+ env
++ date
+ echo Thu Aug 1 08:55:34 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Thu Aug 1 08:55:34 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 5b6cc2bf32 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-1000-0-1722495334
+ git checkout -b scalability-yes-0-1000-0-1722495334
Switched to a new branch 'scalability-yes-0-1000-0-1722495334'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-1000-0-1722495334 a1d829dc5f] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:56:16 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 08:56:16 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-0-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-0-1000-0-1722495334 1000 yes 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-0-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-1-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-1-1000-0
+ env
++ date
+ echo Thu Aug 1 08:57:30 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Thu Aug 1 08:57:30 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a1d829dc5f NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-1000-0-1722495450
+ git checkout -b scalability-yes-1-1000-0-1722495450
Switched to a new branch 'scalability-yes-1-1000-0-1722495450'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-1000-0-1722495450 6254038eec] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-1000-0-1722495450 6f8ef7f054] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:58:12 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 08:58:12 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-1-1000-0-1722495450 1000 yes 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1024-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-1024-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1024-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-1024-1000-0
+ env
++ date
+ echo Thu Aug 1 08:59:26 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Thu Aug 1 08:59:26 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 6f8ef7f054 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-1000-0-1722495566
+ git checkout -b scalability-yes-1024-1000-0-1722495566
Switched to a new branch 'scalability-yes-1024-1000-0-1722495566'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-1000-0-1722495566 254a327877] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-1000-0-1722495566 956f45175d] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:00:08 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 09:00:08 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1024-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-1024-1000-0-1722495566 1000 yes 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1024-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-8-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-8-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-8-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-8-1000-0
+ env
++ date
+ echo Thu Aug 1 09:01:22 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Thu Aug 1 09:01:22 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 956f45175d fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-1000-0-1722495683
+ git checkout -b scalability-yes-8-1000-0-1722495683
Switched to a new branch 'scalability-yes-8-1000-0-1722495683'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-1000-0-1722495683 6e68ea5ca8] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-1000-0-1722495683 45131914d4] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:02:05 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 09:02:05 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-8-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-8-1000-0-1722495683 1000 yes 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-8-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-512-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-512-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-512-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-512-1000-0
+ env
++ date
+ echo Thu Aug 1 09:03:18 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Thu Aug 1 09:03:18 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 45131914d4 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-1000-0-1722495799
+ git checkout -b scalability-yes-512-1000-0-1722495799
Switched to a new branch 'scalability-yes-512-1000-0-1722495799'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-1000-0-1722495799 2e6cd9f5b8] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-1000-0-1722495799 e6fd0d9969] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:04:01 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 09:04:01 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-512-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-512-1000-0-1722495799 1000 yes 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-512-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-128-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-128-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-128-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-128-1000-0
+ env
++ date
+ echo Thu Aug 1 09:05:15 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Thu Aug 1 09:05:15 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e6fd0d9969 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-1000-0-1722495915
+ git checkout -b scalability-yes-128-1000-0-1722495915
Switched to a new branch 'scalability-yes-128-1000-0-1722495915'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-1000-0-1722495915 af3fbc229a] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-1000-0-1722495915 fce349c66d] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:05:57 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 09:05:57 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-128-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-128-1000-0-1722495915 1000 yes 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-128-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-32-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-32-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-32-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-32-1000-0
+ env
++ date
+ echo Thu Aug 1 09:07:11 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Thu Aug 1 09:07:11 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at fce349c66d fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-1000-0-1722496031
+ git checkout -b scalability-no-32-1000-0-1722496031
Switched to a new branch 'scalability-no-32-1000-0-1722496031'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-1000-0-1722496031 6bdad9d81a] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:07:53 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 09:07:53 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-32-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-32-1000-0-1722496031 1000 no 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-32-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-0-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-0-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-0-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-0-1000-0
+ env
++ date
+ echo Thu Aug 1 09:09:07 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Thu Aug 1 09:09:07 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 6bdad9d81a fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-1000-0-1722496147
+ git checkout -b scalability-no-0-1000-0-1722496147
Switched to a new branch 'scalability-no-0-1000-0-1722496147'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:09:49 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 09:09:49 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-0-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-0-1000-0-1722496147 1000 no 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-0-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-1-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-1-1000-0
+ env
++ date
+ echo Thu Aug 1 09:11:03 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Thu Aug 1 09:11:03 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-1000-0-1722496263
+ git checkout -b scalability-no-1-1000-0-1722496263
Switched to a new branch 'scalability-no-1-1000-0-1722496263'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-1000-0-1722496263 96a38e2973] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:11:45 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 09:11:45 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-1-1000-0-1722496263 1000 no 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1024-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-1024-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1024-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-1024-1000-0
+ env
++ date
+ echo Thu Aug 1 09:12:59 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Thu Aug 1 09:12:59 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 96a38e2973 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-1000-0-1722496379
+ git checkout -b scalability-no-1024-1000-0-1722496379
Switched to a new branch 'scalability-no-1024-1000-0-1722496379'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-1000-0-1722496379 49b2f04454] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:13:41 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 09:13:41 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1024-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-1024-1000-0-1722496379 1000 no 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1024-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-8-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-8-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-8-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-8-1000-0
+ env
++ date
+ echo Thu Aug 1 09:14:55 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Thu Aug 1 09:14:55 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 49b2f04454 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-1000-0-1722496495
+ git checkout -b scalability-no-8-1000-0-1722496495
Switched to a new branch 'scalability-no-8-1000-0-1722496495'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-1000-0-1722496495 f5e7b6acd0] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:15:37 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 09:15:37 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-8-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-8-1000-0-1722496495 1000 no 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-8-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-512-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-512-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-512-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-512-1000-0
+ env
++ date
+ echo Thu Aug 1 09:16:51 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Thu Aug 1 09:16:51 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at f5e7b6acd0 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-1000-0-1722496611
+ git checkout -b scalability-no-512-1000-0-1722496611
Switched to a new branch 'scalability-no-512-1000-0-1722496611'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-1000-0-1722496611 602a2add34] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:17:33 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 09:17:33 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-512-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-512-1000-0-1722496611 1000 no 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-512-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-128-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-128-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-128-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-128-1000-0
+ env
++ date
+ echo Thu Aug 1 09:18:47 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Thu Aug 1 09:18:47 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 602a2add34 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-1000-0-1722496727
+ git checkout -b scalability-no-128-1000-0-1722496727
Switched to a new branch 'scalability-no-128-1000-0-1722496727'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/128/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-1000-0-1722496727 6916a833da] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:19:30 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 09:19:30 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-128-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-128-1000-0-1722496727 1000 no 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-128-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-32-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-32-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-32-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-32-1000-0
+ env
++ date
+ echo Thu Aug 1 09:20:43 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Thu Aug 1 09:20:43 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 6916a833da fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-1000-0-1722496844
+ git checkout -b scalability-yes-32-1000-0-1722496844
Switched to a new branch 'scalability-yes-32-1000-0-1722496844'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-1000-0-1722496844 e1bf26ef64] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-1000-0-1722496844 33b06d4a5d] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:21:07 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 09:21:07 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-32-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-32-1000-0-1722496844 1000 yes 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-32-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-0-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-0-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-0-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-0-1000-0
+ env
++ date
+ echo Thu Aug 1 09:22:21 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Thu Aug 1 09:22:21 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 33b06d4a5d fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-1000-0-1722496941
+ git checkout -b scalability-yes-0-1000-0-1722496941
Switched to a new branch 'scalability-yes-0-1000-0-1722496941'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-1000-0-1722496941 6741c25fc0] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:22:44 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 09:22:44 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-0-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-0-1000-0-1722496941 1000 yes 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-0-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-1-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-1-1000-0
+ env
++ date
+ echo Thu Aug 1 09:23:59 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Thu Aug 1 09:23:59 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 6741c25fc0 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-1000-0-1722497039
+ git checkout -b scalability-yes-1-1000-0-1722497039
Switched to a new branch 'scalability-yes-1-1000-0-1722497039'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-1000-0-1722497039 9d834a5284] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-1000-0-1722497039 6c16029c21] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:24:22 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 09:24:22 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-1-1000-0-1722497039 1000 yes 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1024-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-1024-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1024-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-1024-1000-0
+ env
++ date
+ echo Thu Aug 1 09:25:37 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Thu Aug 1 09:25:37 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 6c16029c21 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-1000-0-1722497137
+ git checkout -b scalability-yes-1024-1000-0-1722497137
Switched to a new branch 'scalability-yes-1024-1000-0-1722497137'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-1000-0-1722497137 55e4a95b90] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-1000-0-1722497137 3c1f3fcb5e] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:26:00 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 09:26:00 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1024-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-1024-1000-0-1722497137 1000 yes 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1024-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-8-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-8-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-8-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-8-1000-0
+ env
++ date
+ echo Thu Aug 1 09:27:14 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Thu Aug 1 09:27:14 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 3c1f3fcb5e fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-1000-0-1722497234
+ git checkout -b scalability-yes-8-1000-0-1722497234
Switched to a new branch 'scalability-yes-8-1000-0-1722497234'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-1000-0-1722497234 fdda2c2427] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-1000-0-1722497234 bc50398872] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:27:38 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 09:27:38 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-8-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-8-1000-0-1722497234 1000 yes 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-8-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-512-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-512-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-512-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-512-1000-0
+ env
++ date
+ echo Thu Aug 1 09:28:52 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Thu Aug 1 09:28:52 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at bc50398872 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-1000-0-1722497332
+ git checkout -b scalability-yes-512-1000-0-1722497332
Switched to a new branch 'scalability-yes-512-1000-0-1722497332'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-1000-0-1722497332 713ada6a01] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-1000-0-1722497332 8c8c941eb2] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:29:15 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 09:29:15 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-512-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-512-1000-0-1722497332 1000 yes 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-512-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-128-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-128-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-128-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-128-1000-0
+ env
++ date
+ echo Thu Aug 1 09:30:29 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Thu Aug 1 09:30:29 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 8c8c941eb2 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-1000-0-1722497430
+ git checkout -b scalability-yes-128-1000-0-1722497430
Switched to a new branch 'scalability-yes-128-1000-0-1722497430'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-1000-0-1722497430 e851c452f4] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-1000-0-1722497430 cdbbfcfb25] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:30:53 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 09:30:53 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-128-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-128-1000-0-1722497430 1000 yes 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-128-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-32-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-32-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-32-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-32-1000-0
+ env
++ date
+ echo Thu Aug 1 09:32:07 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Thu Aug 1 09:32:07 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at cdbbfcfb25 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-1000-0-1722497527
+ git checkout -b scalability-no-32-1000-0-1722497527
Switched to a new branch 'scalability-no-32-1000-0-1722497527'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-1000-0-1722497527 3e8d055321] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:32:30 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 09:32:30 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-32-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-32-1000-0-1722497527 1000 no 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-32-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-0-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-0-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-0-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-0-1000-0
+ env
++ date
+ echo Thu Aug 1 09:33:45 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Thu Aug 1 09:33:45 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 3e8d055321 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-1000-0-1722497625
+ git checkout -b scalability-no-0-1000-0-1722497625
Switched to a new branch 'scalability-no-0-1000-0-1722497625'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:34:08 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 09:34:08 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-0-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-0-1000-0-1722497625 1000 no 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-0-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-1-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-1-1000-0
+ env
++ date
+ echo Thu Aug 1 09:35:22 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Thu Aug 1 09:35:22 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-1000-0-1722497722
+ git checkout -b scalability-no-1-1000-0-1722497722
Switched to a new branch 'scalability-no-1-1000-0-1722497722'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-1000-0-1722497722 9d9ac6216f] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:35:46 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 09:35:46 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-1-1000-0-1722497722 1000 no 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1024-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-1024-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1024-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-1024-1000-0
+ env
++ date
+ echo Thu Aug 1 09:37:00 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Thu Aug 1 09:37:00 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 9d9ac6216f fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-1000-0-1722497820
+ git checkout -b scalability-no-1024-1000-0-1722497820
Switched to a new branch 'scalability-no-1024-1000-0-1722497820'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-1000-0-1722497820 a4500e995d] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:37:23 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 09:37:23 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1024-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-1024-1000-0-1722497820 1000 no 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1024-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-8-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-8-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-8-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-8-1000-0
+ env
++ date
+ echo Thu Aug 1 09:38:38 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Thu Aug 1 09:38:38 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a4500e995d fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-1000-0-1722497918
+ git checkout -b scalability-no-8-1000-0-1722497918
Switched to a new branch 'scalability-no-8-1000-0-1722497918'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-1000-0-1722497918 ccaac17a93] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:39:01 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 09:39:01 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-8-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-8-1000-0-1722497918 1000 no 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-8-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-512-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-512-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-512-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-512-1000-0
+ env
++ date
+ echo Thu Aug 1 09:40:15 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Thu Aug 1 09:40:15 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at ccaac17a93 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-1000-0-1722498015
+ git checkout -b scalability-no-512-1000-0-1722498015
Switched to a new branch 'scalability-no-512-1000-0-1722498015'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-1000-0-1722498015 7936d09c46] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:40:39 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 09:40:39 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-512-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-512-1000-0-1722498015 1000 no 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-512-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-128-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-128-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-128-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-128-1000-0
+ env
++ date
+ echo Thu Aug 1 09:41:53 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Thu Aug 1 09:41:53 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 7936d09c46 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-1000-0-1722498113
+ git checkout -b scalability-no-128-1000-0-1722498113
Switched to a new branch 'scalability-no-128-1000-0-1722498113'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/128/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-1000-0-1722498113 0fbe480bd1] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:42:16 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 09:42:16 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-128-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-128-1000-0-1722498113 1000 no 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-128-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-32-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-32-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-32-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-32-1000-0
+ env
++ date
+ echo Thu Aug 1 09:43:30 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Thu Aug 1 09:43:30 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 0fbe480bd1 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-1000-0-1722498211
+ git checkout -b scalability-yes-32-1000-0-1722498211
Switched to a new branch 'scalability-yes-32-1000-0-1722498211'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-1000-0-1722498211 55d25ec9af] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-1000-0-1722498211 72c443ac1f] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:43:54 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 09:43:54 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-32-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-32-1000-0-1722498211 1000 yes 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-32-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-0-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-0-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-0-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-0-1000-0
+ env
++ date
+ echo Thu Aug 1 09:45:07 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Thu Aug 1 09:45:07 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 72c443ac1f fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-1000-0-1722498307
+ git checkout -b scalability-yes-0-1000-0-1722498307
Switched to a new branch 'scalability-yes-0-1000-0-1722498307'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-1000-0-1722498307 2f5c56f7b7] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:45:30 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 09:45:30 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-0-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-0-1000-0-1722498307 1000 yes 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-0-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-1-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-1-1000-0
+ env
++ date
+ echo Thu Aug 1 09:46:43 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Thu Aug 1 09:46:43 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 2f5c56f7b7 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-1000-0-1722498404
+ git checkout -b scalability-yes-1-1000-0-1722498404
Switched to a new branch 'scalability-yes-1-1000-0-1722498404'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-1000-0-1722498404 42fd40a444] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-1000-0-1722498404 a9ba715ad9] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:47:07 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 09:47:07 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-1-1000-0-1722498404 1000 yes 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1024-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-1024-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1024-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-1024-1000-0
+ env
++ date
+ echo Thu Aug 1 09:48:20 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Thu Aug 1 09:48:20 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a9ba715ad9 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-1000-0-1722498500
+ git checkout -b scalability-yes-1024-1000-0-1722498500
Switched to a new branch 'scalability-yes-1024-1000-0-1722498500'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-1000-0-1722498500 096ddab2ef] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-1000-0-1722498500 fb1bcdff0e] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:48:43 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 09:48:43 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1024-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-1024-1000-0-1722498500 1000 yes 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1024-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-8-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-8-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-8-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-8-1000-0
+ env
++ date
+ echo Thu Aug 1 09:49:57 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Thu Aug 1 09:49:57 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at fb1bcdff0e fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-1000-0-1722498597
+ git checkout -b scalability-yes-8-1000-0-1722498597
Switched to a new branch 'scalability-yes-8-1000-0-1722498597'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-1000-0-1722498597 fb1fd62d96] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-1000-0-1722498597 ddca55d4c6] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:50:20 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 09:50:20 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-8-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-8-1000-0-1722498597 1000 yes 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-8-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-512-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-512-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-512-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-512-1000-0
+ env
++ date
+ echo Thu Aug 1 09:51:33 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Thu Aug 1 09:51:33 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at ddca55d4c6 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-1000-0-1722498693
+ git checkout -b scalability-yes-512-1000-0-1722498693
Switched to a new branch 'scalability-yes-512-1000-0-1722498693'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-1000-0-1722498693 1deac6a36f] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-1000-0-1722498693 b675424cc1] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:51:56 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 09:51:56 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-512-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-512-1000-0-1722498693 1000 yes 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-512-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-128-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-128-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-128-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-128-1000-0
+ env
++ date
+ echo Thu Aug 1 09:53:10 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Thu Aug 1 09:53:10 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b675424cc1 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-1000-0-1722498790
+ git checkout -b scalability-yes-128-1000-0-1722498790
Switched to a new branch 'scalability-yes-128-1000-0-1722498790'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-1000-0-1722498790 eddeffc12f] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-1000-0-1722498790 070b877243] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:53:33 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 09:53:33 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-128-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-128-1000-0-1722498790 1000 yes 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-128-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-32-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-32-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-32-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-32-1000-0
+ env
++ date
+ echo Thu Aug 1 09:54:46 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Thu Aug 1 09:54:46 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 070b877243 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-1000-0-1722498886
+ git checkout -b scalability-no-32-1000-0-1722498886
Switched to a new branch 'scalability-no-32-1000-0-1722498886'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-1000-0-1722498886 888c275c60] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:55:10 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 09:55:10 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-32-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-32-1000-0-1722498886 1000 no 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-32-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-0-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-0-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-0-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-0-1000-0
+ env
++ date
+ echo Thu Aug 1 09:56:23 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Thu Aug 1 09:56:23 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 888c275c60 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-1000-0-1722498983
+ git checkout -b scalability-no-0-1000-0-1722498983
Switched to a new branch 'scalability-no-0-1000-0-1722498983'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:56:46 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 09:56:46 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-0-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-0-1000-0-1722498983 1000 no 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-0-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-1-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-1-1000-0
+ env
++ date
+ echo Thu Aug 1 09:57:59 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Thu Aug 1 09:57:59 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-1000-0-1722499079
+ git checkout -b scalability-no-1-1000-0-1722499079
Switched to a new branch 'scalability-no-1-1000-0-1722499079'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/1/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-1000-0-1722499079 3f8c6fd677] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:58:22 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 09:58:22 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-1-1000-0-1722499079 1000 no 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1024-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-1024-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1024-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-1024-1000-0
+ env
++ date
+ echo Thu Aug 1 09:59:35 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Thu Aug 1 09:59:35 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 3f8c6fd677 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-1000-0-1722499176
+ git checkout -b scalability-no-1024-1000-0-1722499176
Switched to a new branch 'scalability-no-1024-1000-0-1722499176'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-1000-0-1722499176 dcc7601e85] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:59:59 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 09:59:59 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1024-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-1024-1000-0-1722499176 1000 no 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1024-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-8-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-8-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-8-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-8-1000-0
+ env
++ date
+ echo Thu Aug 1 10:01:12 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Thu Aug 1 10:01:12 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at dcc7601e85 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-1000-0-1722499272
+ git checkout -b scalability-no-8-1000-0-1722499272
Switched to a new branch 'scalability-no-8-1000-0-1722499272'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-1000-0-1722499272 4e70b61d98] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:01:36 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 10:01:36 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-8-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-8-1000-0-1722499272 1000 no 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-8-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-512-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-512-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-512-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-512-1000-0
+ env
++ date
+ echo Thu Aug 1 10:02:49 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Thu Aug 1 10:02:49 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 4e70b61d98 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-1000-0-1722499369
+ git checkout -b scalability-no-512-1000-0-1722499369
Switched to a new branch 'scalability-no-512-1000-0-1722499369'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-1000-0-1722499369 1bf48e40e0] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:03:12 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 10:03:12 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-512-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-512-1000-0-1722499369 1000 no 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-512-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-128-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-128-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-128-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-128-1000-0
+ env
++ date
+ echo Thu Aug 1 10:04:25 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Thu Aug 1 10:04:25 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 1bf48e40e0 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-1000-0-1722499465
+ git checkout -b scalability-no-128-1000-0-1722499465
Switched to a new branch 'scalability-no-128-1000-0-1722499465'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-1000-0-1722499465 f07922a390] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:04:48 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 10:04:48 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-128-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-128-1000-0-1722499465 1000 no 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-128-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-32-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-32-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-32-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-32-1000-0
+ env
++ date
+ echo Thu Aug 1 10:06:01 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Thu Aug 1 10:06:01 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at f07922a390 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-1000-0-1722499562
+ git checkout -b scalability-yes-32-1000-0-1722499562
Switched to a new branch 'scalability-yes-32-1000-0-1722499562'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-1000-0-1722499562 9a9bb07067] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-1000-0-1722499562 75e726cd92] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:06:25 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 10:06:25 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-32-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-32-1000-0-1722499562 1000 yes 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-32-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-0-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-0-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-0-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-0-1000-0
+ env
++ date
+ echo Thu Aug 1 10:07:43 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Thu Aug 1 10:07:43 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 75e726cd92 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-1000-0-1722499663
+ git checkout -b scalability-yes-0-1000-0-1722499663
Switched to a new branch 'scalability-yes-0-1000-0-1722499663'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-1000-0-1722499663 42b31553e7] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:08:06 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 10:08:06 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-0-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-0-1000-0-1722499663 1000 yes 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-0-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-1-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-1-1000-0
+ env
++ date
+ echo Thu Aug 1 10:09:25 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Thu Aug 1 10:09:25 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 42b31553e7 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-1000-0-1722499765
+ git checkout -b scalability-yes-1-1000-0-1722499765
Switched to a new branch 'scalability-yes-1-1000-0-1722499765'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-1000-0-1722499765 ae1854697d] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-1000-0-1722499765 ed098e243a] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:09:48 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 10:09:48 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-1-1000-0-1722499765 1000 yes 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1024-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-1024-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1024-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-1024-1000-0
+ env
++ date
+ echo Thu Aug 1 10:11:07 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Thu Aug 1 10:11:07 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at ed098e243a fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-1000-0-1722499867
+ git checkout -b scalability-yes-1024-1000-0-1722499867
Switched to a new branch 'scalability-yes-1024-1000-0-1722499867'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-1000-0-1722499867 5216595442] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-1000-0-1722499867 c744a56e24] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:11:30 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 10:11:30 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1024-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-1024-1000-0-1722499867 1000 yes 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1024-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-8-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-8-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-8-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-8-1000-0
+ env
++ date
+ echo Thu Aug 1 10:12:49 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Thu Aug 1 10:12:49 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at c744a56e24 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-1000-0-1722499969
+ git checkout -b scalability-yes-8-1000-0-1722499969
Switched to a new branch 'scalability-yes-8-1000-0-1722499969'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-1000-0-1722499969 11afc0b4d7] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-1000-0-1722499969 e662595126] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:13:12 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 10:13:12 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-8-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-8-1000-0-1722499969 1000 yes 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-8-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-512-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-512-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-512-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-512-1000-0
+ env
++ date
+ echo Thu Aug 1 10:14:31 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Thu Aug 1 10:14:31 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e662595126 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-1000-0-1722500071
+ git checkout -b scalability-yes-512-1000-0-1722500071
Switched to a new branch 'scalability-yes-512-1000-0-1722500071'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-1000-0-1722500071 62dcbf5a0a] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-1000-0-1722500071 afe18f2f21] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:14:54 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 10:14:54 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-512-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-512-1000-0-1722500071 1000 yes 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-512-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-128-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-128-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-128-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-128-1000-0
+ env
++ date
+ echo Thu Aug 1 10:16:12 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Thu Aug 1 10:16:12 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at afe18f2f21 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-1000-0-1722500173
+ git checkout -b scalability-yes-128-1000-0-1722500173
Switched to a new branch 'scalability-yes-128-1000-0-1722500173'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-1000-0-1722500173 a0dd2fe400] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-1000-0-1722500173 bcde84c05c] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:16:36 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 10:16:36 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-128-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-128-1000-0-1722500173 1000 yes 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-128-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-32-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-32-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-32-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-32-1000-0
+ env
++ date
+ echo Thu Aug 1 10:17:54 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Thu Aug 1 10:17:54 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at bcde84c05c fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-1000-0-1722500274
+ git checkout -b scalability-no-32-1000-0-1722500274
Switched to a new branch 'scalability-no-32-1000-0-1722500274'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-1000-0-1722500274 3da81ed22f] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:18:17 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 10:18:17 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-32-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-32-1000-0-1722500274 1000 no 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-32-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-0-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-0-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-0-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-0-1000-0
+ env
++ date
+ echo Thu Aug 1 10:19:36 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Thu Aug 1 10:19:36 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 3da81ed22f fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-1000-0-1722500376
+ git checkout -b scalability-no-0-1000-0-1722500376
Switched to a new branch 'scalability-no-0-1000-0-1722500376'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:19:59 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 10:19:59 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-0-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-0-1000-0-1722500376 1000 no 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-0-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-1-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-1-1000-0
+ env
++ date
+ echo Thu Aug 1 10:21:17 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Thu Aug 1 10:21:17 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-1000-0-1722500478
+ git checkout -b scalability-no-1-1000-0-1722500478
Switched to a new branch 'scalability-no-1-1000-0-1722500478'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-1000-0-1722500478 53de521f6c] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:21:41 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 10:21:41 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-1-1000-0-1722500478 1000 no 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1024-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-1024-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1024-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-1024-1000-0
+ env
++ date
+ echo Thu Aug 1 10:22:59 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Thu Aug 1 10:22:59 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 53de521f6c fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-1000-0-1722500579
+ git checkout -b scalability-no-1024-1000-0-1722500579
Switched to a new branch 'scalability-no-1024-1000-0-1722500579'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-1000-0-1722500579 c2265dfb04] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:23:22 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 10:23:22 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1024-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-1024-1000-0-1722500579 1000 no 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1024-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-8-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-8-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-8-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-8-1000-0
+ env
++ date
+ echo Thu Aug 1 10:24:41 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Thu Aug 1 10:24:41 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at c2265dfb04 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-1000-0-1722500681
+ git checkout -b scalability-no-8-1000-0-1722500681
Switched to a new branch 'scalability-no-8-1000-0-1722500681'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-1000-0-1722500681 785b184c28] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:25:04 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 10:25:04 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-8-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-8-1000-0-1722500681 1000 no 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-8-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-512-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-512-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-512-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-512-1000-0
+ env
++ date
+ echo Thu Aug 1 10:26:23 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Thu Aug 1 10:26:23 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 785b184c28 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-1000-0-1722500783
+ git checkout -b scalability-no-512-1000-0-1722500783
Switched to a new branch 'scalability-no-512-1000-0-1722500783'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/512/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-1000-0-1722500783 978a86c64c] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:26:46 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 10:26:46 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-512-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-512-1000-0-1722500783 1000 no 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-512-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-128-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-128-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-128-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-128-1000-0
+ env
++ date
+ echo Thu Aug 1 10:28:05 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Thu Aug 1 10:28:05 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 978a86c64c fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-1000-0-1722500885
+ git checkout -b scalability-no-128-1000-0-1722500885
Switched to a new branch 'scalability-no-128-1000-0-1722500885'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/128/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-1000-0-1722500885 bcfe2a3d22] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:28:28 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 10:28:28 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-128-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-128-1000-0-1722500885 1000 no 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-128-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-32-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-32-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-32-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-32-1000-0
+ env
++ date
+ echo Thu Aug 1 10:29:46 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Thu Aug 1 10:29:46 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at bcfe2a3d22 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-1000-0-1722500986
+ git checkout -b scalability-yes-32-1000-0-1722500986
Switched to a new branch 'scalability-yes-32-1000-0-1722500986'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-1000-0-1722500986 3aca3a1d02] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-1000-0-1722500986 b06b9a12bc] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:30:10 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 10:30:10 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-32-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-32-1000-0-1722500986 1000 yes 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-32-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-0-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-0-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-0-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-0-1000-0
+ env
++ date
+ echo Thu Aug 1 10:30:13 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Thu Aug 1 10:30:13 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b06b9a12bc fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-1000-0-1722501013
+ git checkout -b scalability-yes-0-1000-0-1722501013
Switched to a new branch 'scalability-yes-0-1000-0-1722501013'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-1000-0-1722501013 d8f24f6685] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:30:36 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 10:30:36 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-0-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-0-1000-0-1722501013 1000 yes 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-0-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-1-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-1-1000-0
+ env
++ date
+ echo Thu Aug 1 10:30:39 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Thu Aug 1 10:30:39 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d8f24f6685 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-1000-0-1722501039
+ git checkout -b scalability-yes-1-1000-0-1722501039
Switched to a new branch 'scalability-yes-1-1000-0-1722501039'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-1000-0-1722501039 21d2f26ab4] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-1000-0-1722501039 e83b447af4] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:31:02 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 10:31:02 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-1-1000-0-1722501039 1000 yes 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1024-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-1024-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1024-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-1024-1000-0
+ env
++ date
+ echo Thu Aug 1 10:31:05 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Thu Aug 1 10:31:05 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e83b447af4 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-1000-0-1722501065
+ git checkout -b scalability-yes-1024-1000-0-1722501065
Switched to a new branch 'scalability-yes-1024-1000-0-1722501065'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-1000-0-1722501065 bc6d525b4d] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-1000-0-1722501065 04fb9c3e99] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:31:29 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 10:31:29 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1024-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-1024-1000-0-1722501065 1000 yes 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1024-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-8-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-8-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-8-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-8-1000-0
+ env
++ date
+ echo Thu Aug 1 10:31:32 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Thu Aug 1 10:31:32 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 04fb9c3e99 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-1000-0-1722501092
+ git checkout -b scalability-yes-8-1000-0-1722501092
Switched to a new branch 'scalability-yes-8-1000-0-1722501092'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-1000-0-1722501092 3699a17af0] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-1000-0-1722501092 b9e3f4b0c4] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:31:55 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 10:31:55 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-8-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-8-1000-0-1722501092 1000 yes 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-8-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-512-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-512-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-512-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-512-1000-0
+ env
++ date
+ echo Thu Aug 1 10:31:58 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Thu Aug 1 10:31:58 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b9e3f4b0c4 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-1000-0-1722501118
+ git checkout -b scalability-yes-512-1000-0-1722501118
Switched to a new branch 'scalability-yes-512-1000-0-1722501118'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-1000-0-1722501118 84e2e0f9c9] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-1000-0-1722501118 6f1ad96634] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:32:21 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 10:32:21 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-512-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-512-1000-0-1722501118 1000 yes 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-512-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-128-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-128-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-128-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-128-1000-0
+ env
++ date
+ echo Thu Aug 1 10:32:24 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Thu Aug 1 10:32:24 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 6f1ad96634 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-1000-0-1722501144
+ git checkout -b scalability-yes-128-1000-0-1722501144
Switched to a new branch 'scalability-yes-128-1000-0-1722501144'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-1000-0-1722501144 62bb5da47f] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-1000-0-1722501144 bb89f6ecf5] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:32:48 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 10:32:48 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-128-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-128-1000-0-1722501144 1000 yes 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-128-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-32-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-32-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-32-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-32-1000-0
+ env
++ date
+ echo Thu Aug 1 10:32:51 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Thu Aug 1 10:32:51 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at bb89f6ecf5 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-1000-0-1722501171
+ git checkout -b scalability-no-32-1000-0-1722501171
Switched to a new branch 'scalability-no-32-1000-0-1722501171'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-1000-0-1722501171 7df95f1ebb] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:33:14 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 10:33:14 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-32-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-32-1000-0-1722501171 1000 no 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-32-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-0-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-0-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-0-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-0-1000-0
+ env
++ date
+ echo Thu Aug 1 10:33:17 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Thu Aug 1 10:33:17 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 7df95f1ebb fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-1000-0-1722501197
+ git checkout -b scalability-no-0-1000-0-1722501197
Switched to a new branch 'scalability-no-0-1000-0-1722501197'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:33:40 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 10:33:40 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-0-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-0-1000-0-1722501197 1000 no 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-0-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-1-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-1-1000-0
+ env
++ date
+ echo Thu Aug 1 10:33:43 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Thu Aug 1 10:33:43 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-1000-0-1722501223
+ git checkout -b scalability-no-1-1000-0-1722501223
Switched to a new branch 'scalability-no-1-1000-0-1722501223'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/1/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-1000-0-1722501223 bdd5cdf815] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:34:06 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 10:34:06 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-1-1000-0-1722501223 1000 no 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1024-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-1024-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1024-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-1024-1000-0
+ env
++ date
+ echo Thu Aug 1 10:34:09 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Thu Aug 1 10:34:09 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at bdd5cdf815 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-1000-0-1722501249
+ git checkout -b scalability-no-1024-1000-0-1722501249
Switched to a new branch 'scalability-no-1024-1000-0-1722501249'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/1024/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-1000-0-1722501249 a029b0e598] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:34:33 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 10:34:33 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1024-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-1024-1000-0-1722501249 1000 no 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1024-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-8-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-8-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-8-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-8-1000-0
+ env
++ date
+ echo Thu Aug 1 10:34:35 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Thu Aug 1 10:34:35 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a029b0e598 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-1000-0-1722501276
+ git checkout -b scalability-no-8-1000-0-1722501276
Switched to a new branch 'scalability-no-8-1000-0-1722501276'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-1000-0-1722501276 294ab72433] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:34:59 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 10:34:59 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-8-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-8-1000-0-1722501276 1000 no 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-8-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-512-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-512-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-512-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-512-1000-0
+ env
++ date
+ echo Thu Aug 1 10:35:01 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Thu Aug 1 10:35:01 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 294ab72433 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-1000-0-1722501302
+ git checkout -b scalability-no-512-1000-0-1722501302
Switched to a new branch 'scalability-no-512-1000-0-1722501302'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-1000-0-1722501302 7a0e7f107a] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:35:25 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 10:35:25 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-512-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-512-1000-0-1722501302 1000 no 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-512-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-128-1000-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-128-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-128-1000-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-128-1000-0
+ env
++ date
+ echo Thu Aug 1 10:35:28 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Thu Aug 1 10:35:28 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 7a0e7f107a fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-1000-0-1722501328
+ git checkout -b scalability-no-128-1000-0-1722501328
Switched to a new branch 'scalability-no-128-1000-0-1722501328'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-1000-0-1722501328 0504674dce] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-1000-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:35:51 AM CEST 2024 'RUN   files: 1000  partitions: 0'
Thu Aug 1 10:35:51 AM CEST 2024 RUN   files: 1000  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-1000-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 1000'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-128-1000-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-128-1000-0-1722501328 1000 no 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-128-1000-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for files in 1000 32768
+ for p in $PARTITIONS
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-32-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-32-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-32-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-32-32768-1000
+ env
++ date
+ echo Thu Aug 1 10:35:54 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Thu Aug 1 10:35:54 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 0504674dce fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-32768-1000-1722501354
+ git checkout -b scalability-yes-32-32768-1000-1722501354
Switched to a new branch 'scalability-yes-32-32768-1000-1722501354'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-32768-1000-1722501354 737b2f6608] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-32768-1000-1722501354 519b90ffae] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:36:37 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 10:36:37 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-32-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-32-32768-1000-1722501354 32768 yes 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-32-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-0-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-0-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-0-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-0-32768-1000
+ env
++ date
+ echo Thu Aug 1 10:37:56 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Thu Aug 1 10:37:56 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 519b90ffae fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-32768-1000-1722501476
+ git checkout -b scalability-yes-0-32768-1000-1722501476
Switched to a new branch 'scalability-yes-0-32768-1000-1722501476'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-32768-1000-1722501476 7b71c793e3] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:38:38 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 10:38:38 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-0-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-0-32768-1000-1722501476 32768 yes 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-0-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-1-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-1-32768-1000
+ env
++ date
+ echo Thu Aug 1 10:39:58 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Thu Aug 1 10:39:58 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 7b71c793e3 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-32768-1000-1722501598
+ git checkout -b scalability-yes-1-32768-1000-1722501598
Switched to a new branch 'scalability-yes-1-32768-1000-1722501598'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-32768-1000-1722501598 bfe1920161] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-32768-1000-1722501598 48b83ad1fd] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:40:41 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 10:40:41 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-1-32768-1000-1722501598 32768 yes 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1024-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-1024-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1024-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-1024-32768-1000
+ env
++ date
+ echo Thu Aug 1 10:42:00 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Thu Aug 1 10:42:00 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 48b83ad1fd fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-32768-1000-1722501720
+ git checkout -b scalability-yes-1024-32768-1000-1722501720
Switched to a new branch 'scalability-yes-1024-32768-1000-1722501720'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-32768-1000-1722501720 20c515081f] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-32768-1000-1722501720 a7ebde9a41] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:42:42 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 10:42:42 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1024-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-1024-32768-1000-1722501720 32768 yes 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1024-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-8-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-8-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-8-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-8-32768-1000
+ env
++ date
+ echo Thu Aug 1 10:44:02 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Thu Aug 1 10:44:02 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a7ebde9a41 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-32768-1000-1722501843
+ git checkout -b scalability-yes-8-32768-1000-1722501843
Switched to a new branch 'scalability-yes-8-32768-1000-1722501843'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-32768-1000-1722501843 6107ba811c] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-32768-1000-1722501843 6e673826ee] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:44:45 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 10:44:45 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-8-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-8-32768-1000-1722501843 32768 yes 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-8-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-512-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-512-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-512-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-512-32768-1000
+ env
++ date
+ echo Thu Aug 1 10:46:04 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Thu Aug 1 10:46:04 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 6e673826ee fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-32768-1000-1722501965
+ git checkout -b scalability-yes-512-32768-1000-1722501965
Switched to a new branch 'scalability-yes-512-32768-1000-1722501965'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-32768-1000-1722501965 5491f10def] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-32768-1000-1722501965 7615509003] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:46:47 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 10:46:47 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-512-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-512-32768-1000-1722501965 32768 yes 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-512-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-128-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-128-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-128-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-128-32768-1000
+ env
++ date
+ echo Thu Aug 1 10:48:07 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Thu Aug 1 10:48:07 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 7615509003 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-32768-1000-1722502087
+ git checkout -b scalability-yes-128-32768-1000-1722502087
Switched to a new branch 'scalability-yes-128-32768-1000-1722502087'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-32768-1000-1722502087 deb1c8b9f8] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-32768-1000-1722502087 2f79fe007e] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:48:49 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 10:48:49 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-128-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-128-32768-1000-1722502087 32768 yes 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-128-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-32-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-32-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-32-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-32-32768-1000
+ env
++ date
+ echo Thu Aug 1 10:50:09 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Thu Aug 1 10:50:09 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 2f79fe007e fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-32768-1000-1722502209
+ git checkout -b scalability-no-32-32768-1000-1722502209
Switched to a new branch 'scalability-no-32-32768-1000-1722502209'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-32768-1000-1722502209 14a58fc617] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:50:51 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 10:50:51 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-32-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-32-32768-1000-1722502209 32768 no 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-32-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-0-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-0-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-0-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-0-32768-1000
+ env
++ date
+ echo Thu Aug 1 10:52:11 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Thu Aug 1 10:52:11 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 14a58fc617 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-32768-1000-1722502331
+ git checkout -b scalability-no-0-32768-1000-1722502331
Switched to a new branch 'scalability-no-0-32768-1000-1722502331'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:52:53 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 10:52:53 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-0-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-0-32768-1000-1722502331 32768 no 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-0-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-1-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-1-32768-1000
+ env
++ date
+ echo Thu Aug 1 10:54:13 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Thu Aug 1 10:54:13 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-32768-1000-1722502453
+ git checkout -b scalability-no-1-32768-1000-1722502453
Switched to a new branch 'scalability-no-1-32768-1000-1722502453'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-32768-1000-1722502453 d2faf149fd] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:54:56 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 10:54:56 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-1-32768-1000-1722502453 32768 no 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1024-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-1024-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1024-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-1024-32768-1000
+ env
++ date
+ echo Thu Aug 1 10:56:15 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Thu Aug 1 10:56:15 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d2faf149fd fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-32768-1000-1722502576
+ git checkout -b scalability-no-1024-32768-1000-1722502576
Switched to a new branch 'scalability-no-1024-32768-1000-1722502576'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/1024/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-32768-1000-1722502576 1508a3c3a1] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:56:58 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 10:56:58 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1024-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-1024-32768-1000-1722502576 32768 no 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1024-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-8-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-8-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-8-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-8-32768-1000
+ env
++ date
+ echo Thu Aug 1 10:58:17 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Thu Aug 1 10:58:17 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 1508a3c3a1 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-32768-1000-1722502698
+ git checkout -b scalability-no-8-32768-1000-1722502698
Switched to a new branch 'scalability-no-8-32768-1000-1722502698'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/8/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-32768-1000-1722502698 c6d215ee8c] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:59:00 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 10:59:00 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-8-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-8-32768-1000-1722502698 32768 no 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-8-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-512-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-512-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-512-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-512-32768-1000
+ env
++ date
+ echo Thu Aug 1 11:00:20 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Thu Aug 1 11:00:20 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at c6d215ee8c fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-32768-1000-1722502820
+ git checkout -b scalability-no-512-32768-1000-1722502820
Switched to a new branch 'scalability-no-512-32768-1000-1722502820'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-32768-1000-1722502820 a9e4671bb5] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:01:02 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 11:01:02 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-512-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-512-32768-1000-1722502820 32768 no 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-512-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-128-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-128-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-128-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-128-32768-1000
+ env
++ date
+ echo Thu Aug 1 11:02:22 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Thu Aug 1 11:02:22 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a9e4671bb5 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-32768-1000-1722502942
+ git checkout -b scalability-no-128-32768-1000-1722502942
Switched to a new branch 'scalability-no-128-32768-1000-1722502942'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-32768-1000-1722502942 c65e67a0f2] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:03:05 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 11:03:05 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-128-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-128-32768-1000-1722502942 32768 no 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-128-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-32-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-32-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-32-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-32-32768-1000
+ env
++ date
+ echo Thu Aug 1 11:04:25 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Thu Aug 1 11:04:25 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at c65e67a0f2 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-32768-1000-1722503065
+ git checkout -b scalability-yes-32-32768-1000-1722503065
Switched to a new branch 'scalability-yes-32-32768-1000-1722503065'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-32768-1000-1722503065 b89c8b4e68] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-32768-1000-1722503065 5b18cc1909] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:04:48 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 11:04:48 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-32-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-32-32768-1000-1722503065 32768 yes 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-32-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-0-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-0-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-0-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-0-32768-1000
+ env
++ date
+ echo Thu Aug 1 11:06:44 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Thu Aug 1 11:06:44 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 5b18cc1909 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-32768-1000-1722503204
+ git checkout -b scalability-yes-0-32768-1000-1722503204
Switched to a new branch 'scalability-yes-0-32768-1000-1722503204'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-32768-1000-1722503204 f493243685] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:07:07 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 11:07:07 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-0-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-0-32768-1000-1722503204 32768 yes 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-0-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-1-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-1-32768-1000
+ env
++ date
+ echo Thu Aug 1 11:09:03 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Thu Aug 1 11:09:03 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at f493243685 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-32768-1000-1722503343
+ git checkout -b scalability-yes-1-32768-1000-1722503343
Switched to a new branch 'scalability-yes-1-32768-1000-1722503343'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-32768-1000-1722503343 28a913d099] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-32768-1000-1722503343 73aa7f8676] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:09:26 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 11:09:26 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-1-32768-1000-1722503343 32768 yes 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1024-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-1024-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1024-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-1024-32768-1000
+ env
++ date
+ echo Thu Aug 1 11:11:22 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Thu Aug 1 11:11:22 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 73aa7f8676 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-32768-1000-1722503482
+ git checkout -b scalability-yes-1024-32768-1000-1722503482
Switched to a new branch 'scalability-yes-1024-32768-1000-1722503482'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-32768-1000-1722503482 0b736b91d2] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-32768-1000-1722503482 32deb4a78d] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:11:46 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 11:11:46 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1024-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-1024-32768-1000-1722503482 32768 yes 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1024-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-8-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-8-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-8-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-8-32768-1000
+ env
++ date
+ echo Thu Aug 1 11:13:43 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Thu Aug 1 11:13:43 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 32deb4a78d fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-32768-1000-1722503623
+ git checkout -b scalability-yes-8-32768-1000-1722503623
Switched to a new branch 'scalability-yes-8-32768-1000-1722503623'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-32768-1000-1722503623 8ff1043ab5] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-32768-1000-1722503623 18ba26af62] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:14:06 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 11:14:06 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-8-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-8-32768-1000-1722503623 32768 yes 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-8-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-512-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-512-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-512-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-512-32768-1000
+ env
++ date
+ echo Thu Aug 1 11:16:02 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Thu Aug 1 11:16:02 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 18ba26af62 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-32768-1000-1722503762
+ git checkout -b scalability-yes-512-32768-1000-1722503762
Switched to a new branch 'scalability-yes-512-32768-1000-1722503762'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-32768-1000-1722503762 30720516a5] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-32768-1000-1722503762 65cf908094] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:16:26 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 11:16:26 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-512-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-512-32768-1000-1722503762 32768 yes 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-512-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-128-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-128-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-128-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-128-32768-1000
+ env
++ date
+ echo Thu Aug 1 11:18:22 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Thu Aug 1 11:18:22 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 65cf908094 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-32768-1000-1722503903
+ git checkout -b scalability-yes-128-32768-1000-1722503903
Switched to a new branch 'scalability-yes-128-32768-1000-1722503903'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-32768-1000-1722503903 5434f9bd95] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-32768-1000-1722503903 d8f9e1321e] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:18:46 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 11:18:46 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-128-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-128-32768-1000-1722503903 32768 yes 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-128-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-32-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-32-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-32-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-32-32768-1000
+ env
++ date
+ echo Thu Aug 1 11:20:42 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Thu Aug 1 11:20:42 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d8f9e1321e fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-32768-1000-1722504042
+ git checkout -b scalability-no-32-32768-1000-1722504042
Switched to a new branch 'scalability-no-32-32768-1000-1722504042'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/32/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-32768-1000-1722504042 a3145edf6f] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:21:05 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 11:21:05 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-32-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-32-32768-1000-1722504042 32768 no 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-32-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-0-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-0-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-0-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-0-32768-1000
+ env
++ date
+ echo Thu Aug 1 11:23:01 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Thu Aug 1 11:23:01 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a3145edf6f fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-32768-1000-1722504181
+ git checkout -b scalability-no-0-32768-1000-1722504181
Switched to a new branch 'scalability-no-0-32768-1000-1722504181'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:23:24 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 11:23:24 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-0-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-0-32768-1000-1722504181 32768 no 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-0-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-1-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-1-32768-1000
+ env
++ date
+ echo Thu Aug 1 11:25:20 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Thu Aug 1 11:25:20 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-32768-1000-1722504320
+ git checkout -b scalability-no-1-32768-1000-1722504320
Switched to a new branch 'scalability-no-1-32768-1000-1722504320'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-32768-1000-1722504320 86d071acec] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:25:43 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 11:25:43 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-1-32768-1000-1722504320 32768 no 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1024-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-1024-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1024-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-1024-32768-1000
+ env
++ date
+ echo Thu Aug 1 11:27:41 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Thu Aug 1 11:27:41 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 86d071acec fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-32768-1000-1722504461
+ git checkout -b scalability-no-1024-32768-1000-1722504461
Switched to a new branch 'scalability-no-1024-32768-1000-1722504461'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-32768-1000-1722504461 6a8db13e2d] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:28:04 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 11:28:04 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1024-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-1024-32768-1000-1722504461 32768 no 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1024-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-8-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-8-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-8-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-8-32768-1000
+ env
++ date
+ echo Thu Aug 1 11:30:01 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Thu Aug 1 11:30:01 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 6a8db13e2d fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-32768-1000-1722504601
+ git checkout -b scalability-no-8-32768-1000-1722504601
Switched to a new branch 'scalability-no-8-32768-1000-1722504601'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-32768-1000-1722504601 b7e9c7e7f9] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:30:25 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 11:30:25 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-8-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-8-32768-1000-1722504601 32768 no 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-8-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-512-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-512-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-512-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-512-32768-1000
+ env
++ date
+ echo Thu Aug 1 11:32:20 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Thu Aug 1 11:32:20 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b7e9c7e7f9 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-32768-1000-1722504740
+ git checkout -b scalability-no-512-32768-1000-1722504740
Switched to a new branch 'scalability-no-512-32768-1000-1722504740'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-32768-1000-1722504740 b1ec5907ee] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:32:43 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 11:32:43 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-512-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-512-32768-1000-1722504740 32768 no 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-512-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-128-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-128-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-128-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-128-32768-1000
+ env
++ date
+ echo Thu Aug 1 11:34:40 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Thu Aug 1 11:34:40 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b1ec5907ee fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-32768-1000-1722504880
+ git checkout -b scalability-no-128-32768-1000-1722504880
Switched to a new branch 'scalability-no-128-32768-1000-1722504880'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-32768-1000-1722504880 b3cc21b1bf] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:35:04 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 11:35:04 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-128-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-128-32768-1000-1722504880 32768 no 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-128-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-32-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-32-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-32-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-32-32768-1000
+ env
++ date
+ echo Thu Aug 1 11:36:59 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Thu Aug 1 11:36:59 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b3cc21b1bf fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-32768-1000-1722505019
+ git checkout -b scalability-yes-32-32768-1000-1722505019
Switched to a new branch 'scalability-yes-32-32768-1000-1722505019'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-32768-1000-1722505019 076a6da882] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-32768-1000-1722505019 d3380dd47f] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:37:23 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 11:37:23 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-32-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-32-32768-1000-1722505019 32768 yes 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-32-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-0-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-0-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-0-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-0-32768-1000
+ env
++ date
+ echo Thu Aug 1 11:38:45 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Thu Aug 1 11:38:45 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d3380dd47f fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-32768-1000-1722505125
+ git checkout -b scalability-yes-0-32768-1000-1722505125
Switched to a new branch 'scalability-yes-0-32768-1000-1722505125'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-32768-1000-1722505125 74450739cc] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:39:08 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 11:39:08 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-0-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-0-32768-1000-1722505125 32768 yes 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-0-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-1-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-1-32768-1000
+ env
++ date
+ echo Thu Aug 1 11:40:31 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Thu Aug 1 11:40:31 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 74450739cc NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-32768-1000-1722505231
+ git checkout -b scalability-yes-1-32768-1000-1722505231
Switched to a new branch 'scalability-yes-1-32768-1000-1722505231'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-32768-1000-1722505231 dc14d85735] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-32768-1000-1722505231 81b474d83f] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:40:54 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 11:40:54 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-1-32768-1000-1722505231 32768 yes 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1024-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-1024-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1024-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-1024-32768-1000
+ env
++ date
+ echo Thu Aug 1 11:42:16 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Thu Aug 1 11:42:16 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 81b474d83f fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-32768-1000-1722505336
+ git checkout -b scalability-yes-1024-32768-1000-1722505336
Switched to a new branch 'scalability-yes-1024-32768-1000-1722505336'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-32768-1000-1722505336 11ceb6c06a] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-32768-1000-1722505336 e4bbf2ae68] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:42:39 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 11:42:39 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1024-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-1024-32768-1000-1722505336 32768 yes 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1024-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-8-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-8-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-8-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-8-32768-1000
+ env
++ date
+ echo Thu Aug 1 11:44:04 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Thu Aug 1 11:44:04 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e4bbf2ae68 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-32768-1000-1722505444
+ git checkout -b scalability-yes-8-32768-1000-1722505444
Switched to a new branch 'scalability-yes-8-32768-1000-1722505444'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-32768-1000-1722505444 a0b03c03c5] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-32768-1000-1722505444 7e0ce7f9f2] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:44:27 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 11:44:27 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-8-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-8-32768-1000-1722505444 32768 yes 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-8-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-512-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-512-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-512-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-512-32768-1000
+ env
++ date
+ echo Thu Aug 1 11:45:50 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Thu Aug 1 11:45:50 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 7e0ce7f9f2 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-32768-1000-1722505550
+ git checkout -b scalability-yes-512-32768-1000-1722505550
Switched to a new branch 'scalability-yes-512-32768-1000-1722505550'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-32768-1000-1722505550 0848afbe49] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-32768-1000-1722505550 f9f2a2c57d] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:46:13 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 11:46:13 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-512-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-512-32768-1000-1722505550 32768 yes 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-512-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-128-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-128-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-128-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-128-32768-1000
+ env
++ date
+ echo Thu Aug 1 11:47:37 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Thu Aug 1 11:47:37 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at f9f2a2c57d fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-32768-1000-1722505657
+ git checkout -b scalability-yes-128-32768-1000-1722505657
Switched to a new branch 'scalability-yes-128-32768-1000-1722505657'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-32768-1000-1722505657 a13b88202b] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-32768-1000-1722505657 dae3f6f6af] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:48:00 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 11:48:00 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-128-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-128-32768-1000-1722505657 32768 yes 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-128-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-32-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-32-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-32-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-32-32768-1000
+ env
++ date
+ echo Thu Aug 1 11:49:23 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Thu Aug 1 11:49:23 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at dae3f6f6af fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-32768-1000-1722505763
+ git checkout -b scalability-no-32-32768-1000-1722505763
Switched to a new branch 'scalability-no-32-32768-1000-1722505763'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/32/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-32768-1000-1722505763 4e8dcdeeea] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:49:47 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 11:49:47 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-32-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-32-32768-1000-1722505763 32768 no 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-32-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-0-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-0-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-0-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-0-32768-1000
+ env
++ date
+ echo Thu Aug 1 11:51:10 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Thu Aug 1 11:51:10 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 4e8dcdeeea fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-32768-1000-1722505870
+ git checkout -b scalability-no-0-32768-1000-1722505870
Switched to a new branch 'scalability-no-0-32768-1000-1722505870'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:51:33 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 11:51:33 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-0-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-0-32768-1000-1722505870 32768 no 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-0-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-1-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-1-32768-1000
+ env
++ date
+ echo Thu Aug 1 11:52:55 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Thu Aug 1 11:52:55 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-32768-1000-1722505975
+ git checkout -b scalability-no-1-32768-1000-1722505975
Switched to a new branch 'scalability-no-1-32768-1000-1722505975'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/1/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-32768-1000-1722505975 09d6ccbcb1] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:53:19 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 11:53:19 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-1-32768-1000-1722505975 32768 no 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1024-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-1024-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1024-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-1024-32768-1000
+ env
++ date
+ echo Thu Aug 1 11:54:41 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Thu Aug 1 11:54:41 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 09d6ccbcb1 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-32768-1000-1722506081
+ git checkout -b scalability-no-1024-32768-1000-1722506081
Switched to a new branch 'scalability-no-1024-32768-1000-1722506081'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-32768-1000-1722506081 32fb90662d] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:55:04 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 11:55:04 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1024-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-1024-32768-1000-1722506081 32768 no 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1024-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-8-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-8-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-8-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-8-32768-1000
+ env
++ date
+ echo Thu Aug 1 11:56:28 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Thu Aug 1 11:56:28 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 32fb90662d fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-32768-1000-1722506189
+ git checkout -b scalability-no-8-32768-1000-1722506189
Switched to a new branch 'scalability-no-8-32768-1000-1722506189'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ sed s/MY_PLACEHOLDER/8/
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-32768-1000-1722506189 7d06f7e6f1] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:56:52 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 11:56:52 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-8-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-8-32768-1000-1722506189 32768 no 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-8-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-512-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-512-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-512-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-512-32768-1000
+ env
++ date
+ echo Thu Aug 1 11:58:14 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Thu Aug 1 11:58:14 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 7d06f7e6f1 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-32768-1000-1722506294
+ git checkout -b scalability-no-512-32768-1000-1722506294
Switched to a new branch 'scalability-no-512-32768-1000-1722506294'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-32768-1000-1722506294 5d05ebb7cc] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:58:38 AM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 11:58:38 AM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-512-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-512-32768-1000-1722506294 32768 no 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-512-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-128-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-128-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-128-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-128-32768-1000
+ env
++ date
+ echo Thu Aug 1 12:00:01 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Thu Aug 1 12:00:01 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 5d05ebb7cc fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-32768-1000-1722506401
+ git checkout -b scalability-no-128-32768-1000-1722506401
Switched to a new branch 'scalability-no-128-32768-1000-1722506401'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-32768-1000-1722506401 61f01dab4c] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:00:24 PM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 12:00:24 PM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-128-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-128-32768-1000-1722506401 32768 no 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-128-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-32-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-32-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-32-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-32-32768-1000
+ env
++ date
+ echo Thu Aug 1 12:01:47 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Thu Aug 1 12:01:47 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 61f01dab4c fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-32768-1000-1722506507
+ git checkout -b scalability-yes-32-32768-1000-1722506507
Switched to a new branch 'scalability-yes-32-32768-1000-1722506507'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-32768-1000-1722506507 9fc7a1a64a] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-32768-1000-1722506507 a79b19b094] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:02:10 PM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 12:02:10 PM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-32-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-32-32768-1000-1722506507 32768 yes 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-32-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-0-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-0-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-0-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-0-32768-1000
+ env
++ date
+ echo Thu Aug 1 12:03:41 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Thu Aug 1 12:03:41 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a79b19b094 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-32768-1000-1722506621
+ git checkout -b scalability-yes-0-32768-1000-1722506621
Switched to a new branch 'scalability-yes-0-32768-1000-1722506621'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-32768-1000-1722506621 957ba002f5] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:04:04 PM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 12:04:04 PM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-0-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-0-32768-1000-1722506621 32768 yes 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-0-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-1-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-1-32768-1000
+ env
++ date
+ echo Thu Aug 1 12:05:35 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Thu Aug 1 12:05:35 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 957ba002f5 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-32768-1000-1722506736
+ git checkout -b scalability-yes-1-32768-1000-1722506736
Switched to a new branch 'scalability-yes-1-32768-1000-1722506736'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-32768-1000-1722506736 277c757f48] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-32768-1000-1722506736 56e101392a] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:05:59 PM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 12:05:59 PM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-1-32768-1000-1722506736 32768 yes 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1024-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-1024-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1024-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-1024-32768-1000
+ env
++ date
+ echo Thu Aug 1 12:07:30 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Thu Aug 1 12:07:30 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 56e101392a fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-32768-1000-1722506850
+ git checkout -b scalability-yes-1024-32768-1000-1722506850
Switched to a new branch 'scalability-yes-1024-32768-1000-1722506850'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-32768-1000-1722506850 99344c565b] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-32768-1000-1722506850 e8caab1bc0] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:07:54 PM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 12:07:54 PM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1024-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-1024-32768-1000-1722506850 32768 yes 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1024-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-8-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-8-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-8-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-8-32768-1000
+ env
++ date
+ echo Thu Aug 1 12:09:25 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Thu Aug 1 12:09:25 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e8caab1bc0 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-32768-1000-1722506965
+ git checkout -b scalability-yes-8-32768-1000-1722506965
Switched to a new branch 'scalability-yes-8-32768-1000-1722506965'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-32768-1000-1722506965 fcd9d43923] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-32768-1000-1722506965 53898c248a] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:09:48 PM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 12:09:48 PM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-8-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-8-32768-1000-1722506965 32768 yes 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-8-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-512-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-512-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-512-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-512-32768-1000
+ env
++ date
+ echo Thu Aug 1 12:11:19 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Thu Aug 1 12:11:19 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 53898c248a fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-32768-1000-1722507079
+ git checkout -b scalability-yes-512-32768-1000-1722507079
Switched to a new branch 'scalability-yes-512-32768-1000-1722507079'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-32768-1000-1722507079 32facd52be] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-32768-1000-1722507079 03b19eb9b2] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:11:43 PM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 12:11:43 PM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-512-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-512-32768-1000-1722507079 32768 yes 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-512-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-128-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-128-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-128-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-128-32768-1000
+ env
++ date
+ echo Thu Aug 1 12:13:14 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Thu Aug 1 12:13:14 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 03b19eb9b2 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-32768-1000-1722507194
+ git checkout -b scalability-yes-128-32768-1000-1722507194
Switched to a new branch 'scalability-yes-128-32768-1000-1722507194'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-32768-1000-1722507194 c242bae2bc] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-32768-1000-1722507194 7bb43689de] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:13:37 PM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 12:13:37 PM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-128-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-128-32768-1000-1722507194 32768 yes 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-128-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-32-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-32-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-32-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-32-32768-1000
+ env
++ date
+ echo Thu Aug 1 12:15:08 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Thu Aug 1 12:15:08 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 7bb43689de fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-32768-1000-1722507308
+ git checkout -b scalability-no-32-32768-1000-1722507308
Switched to a new branch 'scalability-no-32-32768-1000-1722507308'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/32/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-32768-1000-1722507308 b7b416dcd7] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:15:31 PM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 12:15:31 PM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-32-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-32-32768-1000-1722507308 32768 no 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-32-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-0-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-0-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-0-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-0-32768-1000
+ env
++ date
+ echo Thu Aug 1 12:17:03 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Thu Aug 1 12:17:03 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b7b416dcd7 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-32768-1000-1722507423
+ git checkout -b scalability-no-0-32768-1000-1722507423
Switched to a new branch 'scalability-no-0-32768-1000-1722507423'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:17:26 PM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 12:17:26 PM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-0-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-0-32768-1000-1722507423 32768 no 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-0-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-1-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-1-32768-1000
+ env
++ date
+ echo Thu Aug 1 12:18:57 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Thu Aug 1 12:18:57 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-32768-1000-1722507538
+ git checkout -b scalability-no-1-32768-1000-1722507538
Switched to a new branch 'scalability-no-1-32768-1000-1722507538'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-32768-1000-1722507538 903952864e] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:19:21 PM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 12:19:21 PM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-1-32768-1000-1722507538 32768 no 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1024-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-1024-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1024-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-1024-32768-1000
+ env
++ date
+ echo Thu Aug 1 12:20:52 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Thu Aug 1 12:20:52 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 903952864e fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-32768-1000-1722507652
+ git checkout -b scalability-no-1024-32768-1000-1722507652
Switched to a new branch 'scalability-no-1024-32768-1000-1722507652'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-32768-1000-1722507652 7951bdd0b6] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:21:15 PM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 12:21:15 PM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1024-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-1024-32768-1000-1722507652 32768 no 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1024-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-8-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-8-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-8-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-8-32768-1000
+ env
++ date
+ echo Thu Aug 1 12:22:47 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Thu Aug 1 12:22:47 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 7951bdd0b6 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-32768-1000-1722507767
+ git checkout -b scalability-no-8-32768-1000-1722507767
Switched to a new branch 'scalability-no-8-32768-1000-1722507767'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-32768-1000-1722507767 0d93e57723] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:23:10 PM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 12:23:10 PM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-8-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-8-32768-1000-1722507767 32768 no 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-8-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-512-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-512-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-512-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-512-32768-1000
+ env
++ date
+ echo Thu Aug 1 12:24:41 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Thu Aug 1 12:24:41 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 0d93e57723 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-32768-1000-1722507881
+ git checkout -b scalability-no-512-32768-1000-1722507881
Switched to a new branch 'scalability-no-512-32768-1000-1722507881'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-32768-1000-1722507881 a77022886b] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:25:05 PM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 12:25:05 PM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-512-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-512-32768-1000-1722507881 32768 no 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-512-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-128-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-128-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-128-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-128-32768-1000
+ env
++ date
+ echo Thu Aug 1 12:26:36 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Thu Aug 1 12:26:36 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a77022886b fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-32768-1000-1722507996
+ git checkout -b scalability-no-128-32768-1000-1722507996
Switched to a new branch 'scalability-no-128-32768-1000-1722507996'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-32768-1000-1722507996 42bee6b900] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:26:59 PM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 12:26:59 PM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-128-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-128-32768-1000-1722507996 32768 no 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-128-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-32-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-32-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-32-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-32-32768-1000
+ env
++ date
+ echo Thu Aug 1 12:28:30 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Thu Aug 1 12:28:30 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 42bee6b900 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-32768-1000-1722508110
+ git checkout -b scalability-yes-32-32768-1000-1722508110
Switched to a new branch 'scalability-yes-32-32768-1000-1722508110'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-32768-1000-1722508110 d8eb1d7d87] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-32768-1000-1722508110 90f68ff978] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:28:54 PM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 12:28:54 PM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-32-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-32-32768-1000-1722508110 32768 yes 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-32-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-0-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-0-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-0-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-0-32768-1000
+ env
++ date
+ echo Thu Aug 1 12:28:57 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Thu Aug 1 12:28:57 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 90f68ff978 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-32768-1000-1722508137
+ git checkout -b scalability-yes-0-32768-1000-1722508137
Switched to a new branch 'scalability-yes-0-32768-1000-1722508137'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-32768-1000-1722508137 d02506135a] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:29:20 PM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 12:29:20 PM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-0-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-0-32768-1000-1722508137 32768 yes 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-0-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-1-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-1-32768-1000
+ env
++ date
+ echo Thu Aug 1 12:29:23 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Thu Aug 1 12:29:23 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d02506135a NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-32768-1000-1722508163
+ git checkout -b scalability-yes-1-32768-1000-1722508163
Switched to a new branch 'scalability-yes-1-32768-1000-1722508163'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-32768-1000-1722508163 2de56557e7] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-32768-1000-1722508163 877cb930f6] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:29:46 PM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 12:29:46 PM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-1-32768-1000-1722508163 32768 yes 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1024-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-1024-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1024-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-1024-32768-1000
+ env
++ date
+ echo Thu Aug 1 12:29:49 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Thu Aug 1 12:29:49 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 877cb930f6 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-32768-1000-1722508189
+ git checkout -b scalability-yes-1024-32768-1000-1722508189
Switched to a new branch 'scalability-yes-1024-32768-1000-1722508189'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-32768-1000-1722508189 6b7110eeb5] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-32768-1000-1722508189 8540e097a4] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:30:13 PM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 12:30:13 PM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1024-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-1024-32768-1000-1722508189 32768 yes 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1024-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-8-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-8-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-8-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-8-32768-1000
+ env
++ date
+ echo Thu Aug 1 12:30:15 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Thu Aug 1 12:30:15 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 8540e097a4 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-32768-1000-1722508216
+ git checkout -b scalability-yes-8-32768-1000-1722508216
Switched to a new branch 'scalability-yes-8-32768-1000-1722508216'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-32768-1000-1722508216 7bfb2cd79e] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-32768-1000-1722508216 2b58626edc] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:30:39 PM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 12:30:39 PM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-8-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-8-32768-1000-1722508216 32768 yes 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-8-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-512-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-512-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-512-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-512-32768-1000
+ env
++ date
+ echo Thu Aug 1 12:30:42 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Thu Aug 1 12:30:42 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 2b58626edc fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-32768-1000-1722508242
+ git checkout -b scalability-yes-512-32768-1000-1722508242
Switched to a new branch 'scalability-yes-512-32768-1000-1722508242'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-32768-1000-1722508242 e81257ff8b] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-32768-1000-1722508242 b2688a2057] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:31:05 PM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 12:31:05 PM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-512-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-512-32768-1000-1722508242 32768 yes 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-512-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-128-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-128-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-128-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-128-32768-1000
+ env
++ date
+ echo Thu Aug 1 12:31:08 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Thu Aug 1 12:31:08 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b2688a2057 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-32768-1000-1722508268
+ git checkout -b scalability-yes-128-32768-1000-1722508268
Switched to a new branch 'scalability-yes-128-32768-1000-1722508268'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-32768-1000-1722508268 02ec52a684] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-32768-1000-1722508268 0a6e30a989] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:31:31 PM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 12:31:31 PM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-128-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-128-32768-1000-1722508268 32768 yes 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-128-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-32-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-32-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-32-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-32-32768-1000
+ env
++ date
+ echo Thu Aug 1 12:31:34 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Thu Aug 1 12:31:34 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 0a6e30a989 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-32768-1000-1722508294
+ git checkout -b scalability-no-32-32768-1000-1722508294
Switched to a new branch 'scalability-no-32-32768-1000-1722508294'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-32768-1000-1722508294 972e99736e] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:31:58 PM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 12:31:58 PM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-32-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-32-32768-1000-1722508294 32768 no 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-32-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-0-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-0-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-0-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-0-32768-1000
+ env
++ date
+ echo Thu Aug 1 12:32:00 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Thu Aug 1 12:32:00 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 972e99736e fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-32768-1000-1722508321
+ git checkout -b scalability-no-0-32768-1000-1722508321
Switched to a new branch 'scalability-no-0-32768-1000-1722508321'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:32:24 PM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 12:32:24 PM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-0-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-0-32768-1000-1722508321 32768 no 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-0-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-1-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-1-32768-1000
+ env
++ date
+ echo Thu Aug 1 12:32:27 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Thu Aug 1 12:32:27 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-32768-1000-1722508347
+ git checkout -b scalability-no-1-32768-1000-1722508347
Switched to a new branch 'scalability-no-1-32768-1000-1722508347'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-32768-1000-1722508347 208fe66793] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:32:50 PM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 12:32:50 PM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-1-32768-1000-1722508347 32768 no 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1024-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-1024-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1024-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-1024-32768-1000
+ env
++ date
+ echo Thu Aug 1 12:32:53 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Thu Aug 1 12:32:53 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 208fe66793 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-32768-1000-1722508373
+ git checkout -b scalability-no-1024-32768-1000-1722508373
Switched to a new branch 'scalability-no-1024-32768-1000-1722508373'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-32768-1000-1722508373 d9456d1e8e] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:33:16 PM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 12:33:16 PM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1024-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-1024-32768-1000-1722508373 32768 no 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1024-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-8-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-8-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-8-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-8-32768-1000
+ env
++ date
+ echo Thu Aug 1 12:33:19 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Thu Aug 1 12:33:19 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d9456d1e8e fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-32768-1000-1722508399
+ git checkout -b scalability-no-8-32768-1000-1722508399
Switched to a new branch 'scalability-no-8-32768-1000-1722508399'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-32768-1000-1722508399 5e0741d0d8] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:33:42 PM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 12:33:42 PM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-8-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-8-32768-1000-1722508399 32768 no 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-8-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-512-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-512-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-512-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-512-32768-1000
+ env
++ date
+ echo Thu Aug 1 12:33:45 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Thu Aug 1 12:33:45 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 5e0741d0d8 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-32768-1000-1722508425
+ git checkout -b scalability-no-512-32768-1000-1722508425
Switched to a new branch 'scalability-no-512-32768-1000-1722508425'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-32768-1000-1722508425 358478c0ba] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:34:09 PM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 12:34:09 PM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-512-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-512-32768-1000-1722508425 32768 no 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-512-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-128-32768-1000
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-128-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-128-32768-1000
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-128-32768-1000
+ env
++ date
+ echo Thu Aug 1 12:34:11 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Thu Aug 1 12:34:11 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 358478c0ba fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-32768-1000-1722508452
+ git checkout -b scalability-no-128-32768-1000-1722508452
Switched to a new branch 'scalability-no-128-32768-1000-1722508452'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-32768-1000-1722508452 7bd2822a67] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-32768-1000 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:34:35 PM CEST 2024 'RUN   files: 32768  partitions: 1000'
Thu Aug 1 12:34:35 PM CEST 2024 RUN   files: 32768  partitions: 1000
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-32768-1000/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-128-32768-1000/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-128-32768-1000-1722508452 32768 no 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-128-32768-1000 1 10 '1 4 16' 1000
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for p in $PARTITIONS
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-32-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-32-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-32-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-32-32768-100
+ env
++ date
+ echo Thu Aug 1 12:34:38 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Thu Aug 1 12:34:38 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 7bd2822a67 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-32768-100-1722508478
+ git checkout -b scalability-yes-32-32768-100-1722508478
Switched to a new branch 'scalability-yes-32-32768-100-1722508478'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-32768-100-1722508478 aed0fcdd41] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-32768-100-1722508478 4f904146fe] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:35:20 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 12:35:20 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-32-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-32-32768-100-1722508478 32768 yes 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-32-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-0-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-0-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-0-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-0-32768-100
+ env
++ date
+ echo Thu Aug 1 12:36:35 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Thu Aug 1 12:36:35 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 4f904146fe fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-32768-100-1722508595
+ git checkout -b scalability-yes-0-32768-100-1722508595
Switched to a new branch 'scalability-yes-0-32768-100-1722508595'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-32768-100-1722508595 560be6e098] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:37:17 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 12:37:17 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-0-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-0-32768-100-1722508595 32768 yes 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-0-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-1-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-1-32768-100
+ env
++ date
+ echo Thu Aug 1 12:38:32 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Thu Aug 1 12:38:32 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 560be6e098 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-32768-100-1722508712
+ git checkout -b scalability-yes-1-32768-100-1722508712
Switched to a new branch 'scalability-yes-1-32768-100-1722508712'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-32768-100-1722508712 4765763089] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-32768-100-1722508712 ac02ac6355] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:39:15 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 12:39:15 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-1-32768-100-1722508712 32768 yes 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1024-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-1024-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1024-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-1024-32768-100
+ env
++ date
+ echo Thu Aug 1 12:40:30 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Thu Aug 1 12:40:30 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at ac02ac6355 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-32768-100-1722508830
+ git checkout -b scalability-yes-1024-32768-100-1722508830
Switched to a new branch 'scalability-yes-1024-32768-100-1722508830'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-32768-100-1722508830 1c7ec71e08] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-32768-100-1722508830 d946f22b97] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:41:12 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 12:41:12 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1024-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-1024-32768-100-1722508830 32768 yes 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1024-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-8-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-8-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-8-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-8-32768-100
+ env
++ date
+ echo Thu Aug 1 12:42:27 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Thu Aug 1 12:42:27 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d946f22b97 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-32768-100-1722508947
+ git checkout -b scalability-yes-8-32768-100-1722508947
Switched to a new branch 'scalability-yes-8-32768-100-1722508947'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-32768-100-1722508947 5a897067fc] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-32768-100-1722508947 d711ee90dd] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:43:09 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 12:43:09 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-8-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-8-32768-100-1722508947 32768 yes 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-8-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-512-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-512-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-512-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-512-32768-100
+ env
++ date
+ echo Thu Aug 1 12:44:24 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Thu Aug 1 12:44:24 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d711ee90dd fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-32768-100-1722509065
+ git checkout -b scalability-yes-512-32768-100-1722509065
Switched to a new branch 'scalability-yes-512-32768-100-1722509065'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-32768-100-1722509065 48f92674ee] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-32768-100-1722509065 e6ce85f60b] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:45:07 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 12:45:07 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-512-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-512-32768-100-1722509065 32768 yes 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-512-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-128-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-128-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-128-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-128-32768-100
+ env
++ date
+ echo Thu Aug 1 12:46:22 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Thu Aug 1 12:46:22 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e6ce85f60b fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-32768-100-1722509182
+ git checkout -b scalability-yes-128-32768-100-1722509182
Switched to a new branch 'scalability-yes-128-32768-100-1722509182'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-32768-100-1722509182 43eb2c586f] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-32768-100-1722509182 b514d9eb1f] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:47:04 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 12:47:04 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-128-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-128-32768-100-1722509182 32768 yes 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-128-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-32-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-32-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-32-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-32-32768-100
+ env
++ date
+ echo Thu Aug 1 12:48:19 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Thu Aug 1 12:48:19 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b514d9eb1f fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-32768-100-1722509299
+ git checkout -b scalability-no-32-32768-100-1722509299
Switched to a new branch 'scalability-no-32-32768-100-1722509299'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/32/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-32768-100-1722509299 7c7a7613ac] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:49:02 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 12:49:02 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-32-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-32-32768-100-1722509299 32768 no 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-32-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-0-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-0-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-0-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-0-32768-100
+ env
++ date
+ echo Thu Aug 1 12:50:17 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Thu Aug 1 12:50:17 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 7c7a7613ac fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-32768-100-1722509417
+ git checkout -b scalability-no-0-32768-100-1722509417
Switched to a new branch 'scalability-no-0-32768-100-1722509417'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:50:59 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 12:50:59 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-0-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-0-32768-100-1722509417 32768 no 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-0-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-1-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-1-32768-100
+ env
++ date
+ echo Thu Aug 1 12:52:14 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Thu Aug 1 12:52:14 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-32768-100-1722509534
+ git checkout -b scalability-no-1-32768-100-1722509534
Switched to a new branch 'scalability-no-1-32768-100-1722509534'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-32768-100-1722509534 9b663d3a12] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:52:56 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 12:52:56 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-1-32768-100-1722509534 32768 no 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1024-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-1024-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1024-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-1024-32768-100
+ env
++ date
+ echo Thu Aug 1 12:54:11 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Thu Aug 1 12:54:11 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 9b663d3a12 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-32768-100-1722509652
+ git checkout -b scalability-no-1024-32768-100-1722509652
Switched to a new branch 'scalability-no-1024-32768-100-1722509652'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-32768-100-1722509652 fcf819ad37] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:54:54 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 12:54:54 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1024-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-1024-32768-100-1722509652 32768 no 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1024-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-8-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-8-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-8-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-8-32768-100
+ env
++ date
+ echo Thu Aug 1 12:56:09 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Thu Aug 1 12:56:09 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at fcf819ad37 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-32768-100-1722509769
+ git checkout -b scalability-no-8-32768-100-1722509769
Switched to a new branch 'scalability-no-8-32768-100-1722509769'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-32768-100-1722509769 ede2cca3cb] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:56:52 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 12:56:52 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-8-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-8-32768-100-1722509769 32768 no 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-8-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-512-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-512-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-512-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-512-32768-100
+ env
++ date
+ echo Thu Aug 1 12:58:07 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Thu Aug 1 12:58:07 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at ede2cca3cb fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-32768-100-1722509887
+ git checkout -b scalability-no-512-32768-100-1722509887
Switched to a new branch 'scalability-no-512-32768-100-1722509887'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-32768-100-1722509887 c4f9c13b70] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 12:58:49 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 12:58:49 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-512-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-512-32768-100-1722509887 32768 no 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-512-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-128-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-128-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-128-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-128-32768-100
+ env
++ date
+ echo Thu Aug 1 01:00:04 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Thu Aug 1 01:00:04 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at c4f9c13b70 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-32768-100-1722510004
+ git checkout -b scalability-no-128-32768-100-1722510004
Switched to a new branch 'scalability-no-128-32768-100-1722510004'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/128/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-32768-100-1722510004 a7f322e35d] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 01:00:47 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 01:00:47 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-128-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-128-32768-100-1722510004 32768 no 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-128-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-32-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-32-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-32-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-32-32768-100
+ env
++ date
+ echo Thu Aug 1 01:02:02 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Thu Aug 1 01:02:02 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a7f322e35d fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-32768-100-1722510122
+ git checkout -b scalability-yes-32-32768-100-1722510122
Switched to a new branch 'scalability-yes-32-32768-100-1722510122'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-32768-100-1722510122 fcf8ce57c5] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-32768-100-1722510122 97b6e8dfba] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 01:02:25 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 01:02:25 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-32-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-32-32768-100-1722510122 32768 yes 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-32-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-0-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-0-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-0-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-0-32768-100
+ env
++ date
+ echo Thu Aug 1 01:03:44 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Thu Aug 1 01:03:44 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 97b6e8dfba fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-32768-100-1722510224
+ git checkout -b scalability-yes-0-32768-100-1722510224
Switched to a new branch 'scalability-yes-0-32768-100-1722510224'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-32768-100-1722510224 d75cebe393] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 01:04:07 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 01:04:07 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-0-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-0-32768-100-1722510224 32768 yes 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-0-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-1-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-1-32768-100
+ env
++ date
+ echo Thu Aug 1 01:05:26 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Thu Aug 1 01:05:26 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d75cebe393 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-32768-100-1722510326
+ git checkout -b scalability-yes-1-32768-100-1722510326
Switched to a new branch 'scalability-yes-1-32768-100-1722510326'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-32768-100-1722510326 b5d4e1f1a7] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-32768-100-1722510326 ab181db16f] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 01:05:50 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 01:05:50 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-1-32768-100-1722510326 32768 yes 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1024-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-1024-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1024-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-1024-32768-100
+ env
++ date
+ echo Thu Aug 1 01:07:09 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Thu Aug 1 01:07:09 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at ab181db16f fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-32768-100-1722510429
+ git checkout -b scalability-yes-1024-32768-100-1722510429
Switched to a new branch 'scalability-yes-1024-32768-100-1722510429'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-32768-100-1722510429 0b246aa196] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-32768-100-1722510429 77c5c9835e] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 01:07:32 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 01:07:32 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1024-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-1024-32768-100-1722510429 32768 yes 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1024-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-8-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-8-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-8-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-8-32768-100
+ env
++ date
+ echo Thu Aug 1 01:08:51 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Thu Aug 1 01:08:51 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 77c5c9835e fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-32768-100-1722510531
+ git checkout -b scalability-yes-8-32768-100-1722510531
Switched to a new branch 'scalability-yes-8-32768-100-1722510531'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-32768-100-1722510531 3839d9baf4] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-32768-100-1722510531 a7a4d37f23] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 01:09:15 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 01:09:15 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-8-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-8-32768-100-1722510531 32768 yes 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-8-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-512-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-512-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-512-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-512-32768-100
+ env
++ date
+ echo Thu Aug 1 01:10:34 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Thu Aug 1 01:10:34 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a7a4d37f23 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-32768-100-1722510634
+ git checkout -b scalability-yes-512-32768-100-1722510634
Switched to a new branch 'scalability-yes-512-32768-100-1722510634'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-32768-100-1722510634 6f11fd4897] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-32768-100-1722510634 eb91161bcd] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 01:10:57 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 01:10:57 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-512-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-512-32768-100-1722510634 32768 yes 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-512-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-128-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-128-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-128-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-128-32768-100
+ env
++ date
+ echo Thu Aug 1 01:12:16 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Thu Aug 1 01:12:16 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at eb91161bcd fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-32768-100-1722510736
+ git checkout -b scalability-yes-128-32768-100-1722510736
Switched to a new branch 'scalability-yes-128-32768-100-1722510736'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-32768-100-1722510736 105f92397d] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-32768-100-1722510736 e79cfa9e91] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 01:12:40 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 01:12:40 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-128-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-128-32768-100-1722510736 32768 yes 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-128-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-32-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-32-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-32-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-32-32768-100
+ env
++ date
+ echo Thu Aug 1 01:13:59 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Thu Aug 1 01:13:59 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e79cfa9e91 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-32768-100-1722510839
+ git checkout -b scalability-no-32-32768-100-1722510839
Switched to a new branch 'scalability-no-32-32768-100-1722510839'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ sed s/MY_PLACEHOLDER/32/
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-32768-100-1722510839 bee00a30c1] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 01:14:22 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 01:14:22 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-32-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-32-32768-100-1722510839 32768 no 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-32-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-0-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-0-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-0-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-0-32768-100
+ env
++ date
+ echo Thu Aug 1 01:15:41 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Thu Aug 1 01:15:41 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at bee00a30c1 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-32768-100-1722510941
+ git checkout -b scalability-no-0-32768-100-1722510941
Switched to a new branch 'scalability-no-0-32768-100-1722510941'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 01:16:04 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 01:16:04 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-0-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-0-32768-100-1722510941 32768 no 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-0-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-1-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-1-32768-100
+ env
++ date
+ echo Thu Aug 1 01:17:23 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Thu Aug 1 01:17:23 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-32768-100-1722511043
+ git checkout -b scalability-no-1-32768-100-1722511043
Switched to a new branch 'scalability-no-1-32768-100-1722511043'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-32768-100-1722511043 4d77467e5c] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 01:17:47 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 01:17:47 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-1-32768-100-1722511043 32768 no 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1024-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-1024-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1024-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-1024-32768-100
+ env
++ date
+ echo Thu Aug 1 01:19:05 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Thu Aug 1 01:19:05 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 4d77467e5c fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-32768-100-1722511146
+ git checkout -b scalability-no-1024-32768-100-1722511146
Switched to a new branch 'scalability-no-1024-32768-100-1722511146'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-32768-100-1722511146 d14c53608d] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 01:19:29 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 01:19:29 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1024-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-1024-32768-100-1722511146 32768 no 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1024-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-8-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-8-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-8-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-8-32768-100
+ env
++ date
+ echo Thu Aug 1 01:20:48 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Thu Aug 1 01:20:48 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d14c53608d fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-32768-100-1722511248
+ git checkout -b scalability-no-8-32768-100-1722511248
Switched to a new branch 'scalability-no-8-32768-100-1722511248'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/8/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-32768-100-1722511248 1c0ec4b2c1] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 01:21:12 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 01:21:12 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-8-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-8-32768-100-1722511248 32768 no 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-8-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-512-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-512-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-512-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-512-32768-100
+ env
++ date
+ echo Thu Aug 1 01:22:31 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Thu Aug 1 01:22:31 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 1c0ec4b2c1 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-32768-100-1722511351
+ git checkout -b scalability-no-512-32768-100-1722511351
Switched to a new branch 'scalability-no-512-32768-100-1722511351'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-32768-100-1722511351 59eae671bf] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 01:22:54 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 01:22:54 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-512-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-512-32768-100-1722511351 32768 no 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-512-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-128-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-128-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-128-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-128-32768-100
+ env
++ date
+ echo Thu Aug 1 01:24:13 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Thu Aug 1 01:24:13 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 59eae671bf fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-32768-100-1722511454
+ git checkout -b scalability-no-128-32768-100-1722511454
Switched to a new branch 'scalability-no-128-32768-100-1722511454'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-32768-100-1722511454 66a8147195] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 01:24:37 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 01:24:37 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-128-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-128-32768-100-1722511454 32768 no 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-128-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-32-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-32-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-32-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-32-32768-100
+ env
++ date
+ echo Thu Aug 1 01:25:56 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Thu Aug 1 01:25:56 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 66a8147195 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-32768-100-1722511556
+ git checkout -b scalability-yes-32-32768-100-1722511556
Switched to a new branch 'scalability-yes-32-32768-100-1722511556'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-32768-100-1722511556 97d5195f33] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-32768-100-1722511556 84d1dbc0b8] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 01:26:19 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 01:26:19 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-32-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-32-32768-100-1722511556 32768 yes 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-32-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-0-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-0-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-0-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-0-32768-100
+ env
++ date
+ echo Thu Aug 1 01:27:33 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Thu Aug 1 01:27:33 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 84d1dbc0b8 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-32768-100-1722511653
+ git checkout -b scalability-yes-0-32768-100-1722511653
Switched to a new branch 'scalability-yes-0-32768-100-1722511653'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-32768-100-1722511653 0e7e5507c0] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 01:27:57 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 01:27:57 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-0-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-0-32768-100-1722511653 32768 yes 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-0-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-1-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-1-32768-100
+ env
++ date
+ echo Thu Aug 1 01:29:11 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Thu Aug 1 01:29:11 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 0e7e5507c0 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-32768-100-1722511751
+ git checkout -b scalability-yes-1-32768-100-1722511751
Switched to a new branch 'scalability-yes-1-32768-100-1722511751'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-32768-100-1722511751 699c0d0270] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-32768-100-1722511751 ae739df2d0] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 01:29:34 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 01:29:34 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-1-32768-100-1722511751 32768 yes 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1024-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-1024-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1024-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-1024-32768-100
+ env
++ date
+ echo Thu Aug 1 01:30:48 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Thu Aug 1 01:30:48 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at ae739df2d0 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-32768-100-1722511848
+ git checkout -b scalability-yes-1024-32768-100-1722511848
Switched to a new branch 'scalability-yes-1024-32768-100-1722511848'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-32768-100-1722511848 ccaa29b6d1] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-32768-100-1722511848 ab3f00cb41] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 01:31:11 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 01:31:11 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1024-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-1024-32768-100-1722511848 32768 yes 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1024-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-8-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-8-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-8-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-8-32768-100
+ env
++ date
+ echo Thu Aug 1 01:32:26 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Thu Aug 1 01:32:26 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at ab3f00cb41 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-32768-100-1722511946
+ git checkout -b scalability-yes-8-32768-100-1722511946
Switched to a new branch 'scalability-yes-8-32768-100-1722511946'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-32768-100-1722511946 46d4c73bb3] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-32768-100-1722511946 0e07aee35f] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 01:32:49 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 01:32:49 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-8-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-8-32768-100-1722511946 32768 yes 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-8-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-512-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-512-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-512-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-512-32768-100
+ env
++ date
+ echo Thu Aug 1 01:34:03 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Thu Aug 1 01:34:03 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 0e07aee35f fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-32768-100-1722512043
+ git checkout -b scalability-yes-512-32768-100-1722512043
Switched to a new branch 'scalability-yes-512-32768-100-1722512043'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-32768-100-1722512043 479d8dbc7b] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-32768-100-1722512043 127516c6da] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 01:34:27 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 01:34:27 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-512-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-512-32768-100-1722512043 32768 yes 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-512-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-128-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-128-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-128-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-128-32768-100
+ env
++ date
+ echo Thu Aug 1 01:35:41 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Thu Aug 1 01:35:41 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 127516c6da fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-32768-100-1722512141
+ git checkout -b scalability-yes-128-32768-100-1722512141
Switched to a new branch 'scalability-yes-128-32768-100-1722512141'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-32768-100-1722512141 98eaea577a] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-32768-100-1722512141 c82c8b7e5c] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 01:36:04 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 01:36:04 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-128-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-128-32768-100-1722512141 32768 yes 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-128-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-32-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-32-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-32-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-32-32768-100
+ env
++ date
+ echo Thu Aug 1 01:37:18 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Thu Aug 1 01:37:18 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at c82c8b7e5c fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-32768-100-1722512239
+ git checkout -b scalability-no-32-32768-100-1722512239
Switched to a new branch 'scalability-no-32-32768-100-1722512239'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/32/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-32768-100-1722512239 0eae5ed7d8] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 01:37:42 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 01:37:42 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-32-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-32-32768-100-1722512239 32768 no 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-32-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-0-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-0-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-0-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-0-32768-100
+ env
++ date
+ echo Thu Aug 1 01:38:56 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Thu Aug 1 01:38:56 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 0eae5ed7d8 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-32768-100-1722512336
+ git checkout -b scalability-no-0-32768-100-1722512336
Switched to a new branch 'scalability-no-0-32768-100-1722512336'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 01:39:19 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 01:39:19 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-0-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-0-32768-100-1722512336 32768 no 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-0-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-1-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-1-32768-100
+ env
++ date
+ echo Thu Aug 1 01:40:33 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Thu Aug 1 01:40:33 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-32768-100-1722512433
+ git checkout -b scalability-no-1-32768-100-1722512433
Switched to a new branch 'scalability-no-1-32768-100-1722512433'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-32768-100-1722512433 e9e4b246d9] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 01:40:56 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 01:40:56 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-1-32768-100-1722512433 32768 no 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1024-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-1024-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1024-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-1024-32768-100
+ env
++ date
+ echo Thu Aug 1 01:42:10 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Thu Aug 1 01:42:10 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e9e4b246d9 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-32768-100-1722512531
+ git checkout -b scalability-no-1024-32768-100-1722512531
Switched to a new branch 'scalability-no-1024-32768-100-1722512531'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-32768-100-1722512531 0166d3ae38] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 01:42:34 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 01:42:34 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1024-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-1024-32768-100-1722512531 32768 no 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1024-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-8-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-8-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-8-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-8-32768-100
+ env
++ date
+ echo Thu Aug 1 01:43:48 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Thu Aug 1 01:43:48 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 0166d3ae38 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-32768-100-1722512628
+ git checkout -b scalability-no-8-32768-100-1722512628
Switched to a new branch 'scalability-no-8-32768-100-1722512628'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-32768-100-1722512628 556a2a15a7] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 01:44:12 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 01:44:12 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-8-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-8-32768-100-1722512628 32768 no 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-8-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-512-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-512-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-512-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-512-32768-100
+ env
++ date
+ echo Thu Aug 1 01:45:26 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Thu Aug 1 01:45:26 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 556a2a15a7 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-32768-100-1722512726
+ git checkout -b scalability-no-512-32768-100-1722512726
Switched to a new branch 'scalability-no-512-32768-100-1722512726'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-32768-100-1722512726 e4eedbae3e] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 01:45:49 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 01:45:49 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-512-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-512-32768-100-1722512726 32768 no 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-512-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-128-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-128-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-128-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-128-32768-100
+ env
++ date
+ echo Thu Aug 1 01:47:03 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Thu Aug 1 01:47:03 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e4eedbae3e fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-32768-100-1722512823
+ git checkout -b scalability-no-128-32768-100-1722512823
Switched to a new branch 'scalability-no-128-32768-100-1722512823'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-32768-100-1722512823 84c470b89c] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 01:47:27 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 01:47:27 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-128-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-128-32768-100-1722512823 32768 no 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-128-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-32-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-32-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-32-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-32-32768-100
+ env
++ date
+ echo Thu Aug 1 01:48:41 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Thu Aug 1 01:48:41 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 84c470b89c fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-32768-100-1722512921
+ git checkout -b scalability-yes-32-32768-100-1722512921
Switched to a new branch 'scalability-yes-32-32768-100-1722512921'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-32768-100-1722512921 5d071f6ec8] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-32768-100-1722512921 89b98af28c] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 01:49:04 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 01:49:04 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-32-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-32-32768-100-1722512921 32768 yes 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-32-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-0-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-0-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-0-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-0-32768-100
+ env
++ date
+ echo Thu Aug 1 01:50:25 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Thu Aug 1 01:50:25 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 89b98af28c fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-32768-100-1722513025
+ git checkout -b scalability-yes-0-32768-100-1722513025
Switched to a new branch 'scalability-yes-0-32768-100-1722513025'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-32768-100-1722513025 222cc0486d] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 01:50:48 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 01:50:48 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-0-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-0-32768-100-1722513025 32768 yes 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-0-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-1-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-1-32768-100
+ env
++ date
+ echo Thu Aug 1 01:52:09 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Thu Aug 1 01:52:09 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 222cc0486d NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-32768-100-1722513129
+ git checkout -b scalability-yes-1-32768-100-1722513129
Switched to a new branch 'scalability-yes-1-32768-100-1722513129'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-32768-100-1722513129 4f1600c457] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-32768-100-1722513129 eeb32dadab] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 01:52:32 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 01:52:32 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-1-32768-100-1722513129 32768 yes 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1024-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-1024-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1024-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-1024-32768-100
+ env
++ date
+ echo Thu Aug 1 01:53:52 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Thu Aug 1 01:53:52 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at eeb32dadab fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-32768-100-1722513233
+ git checkout -b scalability-yes-1024-32768-100-1722513233
Switched to a new branch 'scalability-yes-1024-32768-100-1722513233'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-32768-100-1722513233 79a2565848] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-32768-100-1722513233 c3db88077b] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 01:54:16 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 01:54:16 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1024-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-1024-32768-100-1722513233 32768 yes 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1024-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-8-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-8-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-8-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-8-32768-100
+ env
++ date
+ echo Thu Aug 1 01:55:36 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Thu Aug 1 01:55:36 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at c3db88077b fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-32768-100-1722513337
+ git checkout -b scalability-yes-8-32768-100-1722513337
Switched to a new branch 'scalability-yes-8-32768-100-1722513337'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-32768-100-1722513337 8f29b0d9c8] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-32768-100-1722513337 55c09eb8f6] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 01:56:00 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 01:56:00 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-8-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-8-32768-100-1722513337 32768 yes 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-8-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-512-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-512-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-512-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-512-32768-100
+ env
++ date
+ echo Thu Aug 1 01:57:21 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Thu Aug 1 01:57:21 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 55c09eb8f6 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-32768-100-1722513441
+ git checkout -b scalability-yes-512-32768-100-1722513441
Switched to a new branch 'scalability-yes-512-32768-100-1722513441'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-32768-100-1722513441 6e2ef536f1] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-32768-100-1722513441 9bcbf8a718] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 01:57:44 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 01:57:44 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-512-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-512-32768-100-1722513441 32768 yes 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-512-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-128-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-128-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-128-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-128-32768-100
+ env
++ date
+ echo Thu Aug 1 01:59:05 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Thu Aug 1 01:59:05 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 9bcbf8a718 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-32768-100-1722513545
+ git checkout -b scalability-yes-128-32768-100-1722513545
Switched to a new branch 'scalability-yes-128-32768-100-1722513545'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-32768-100-1722513545 0229e3bf78] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-32768-100-1722513545 69d213f603] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 01:59:28 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 01:59:28 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-128-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-128-32768-100-1722513545 32768 yes 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-128-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-32-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-32-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-32-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-32-32768-100
+ env
++ date
+ echo Thu Aug 1 02:00:48 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Thu Aug 1 02:00:48 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 69d213f603 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-32768-100-1722513649
+ git checkout -b scalability-no-32-32768-100-1722513649
Switched to a new branch 'scalability-no-32-32768-100-1722513649'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-32768-100-1722513649 78d5f0e1de] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 02:01:12 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 02:01:12 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-32-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-32-32768-100-1722513649 32768 no 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-32-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-0-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-0-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-0-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-0-32768-100
+ env
++ date
+ echo Thu Aug 1 02:02:32 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Thu Aug 1 02:02:32 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 78d5f0e1de fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-32768-100-1722513753
+ git checkout -b scalability-no-0-32768-100-1722513753
Switched to a new branch 'scalability-no-0-32768-100-1722513753'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 02:02:56 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 02:02:56 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-0-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-0-32768-100-1722513753 32768 no 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-0-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-1-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-1-32768-100
+ env
++ date
+ echo Thu Aug 1 02:04:16 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Thu Aug 1 02:04:16 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-32768-100-1722513857
+ git checkout -b scalability-no-1-32768-100-1722513857
Switched to a new branch 'scalability-no-1-32768-100-1722513857'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-32768-100-1722513857 0c7657b4d4] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 02:04:40 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 02:04:40 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-1-32768-100-1722513857 32768 no 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1024-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-1024-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1024-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-1024-32768-100
+ env
++ date
+ echo Thu Aug 1 02:06:00 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Thu Aug 1 02:06:00 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 0c7657b4d4 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-32768-100-1722513960
+ git checkout -b scalability-no-1024-32768-100-1722513960
Switched to a new branch 'scalability-no-1024-32768-100-1722513960'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/1024/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-32768-100-1722513960 a4402ed50d] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 02:06:24 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 02:06:24 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1024-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-1024-32768-100-1722513960 32768 no 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1024-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-8-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-8-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-8-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-8-32768-100
+ env
++ date
+ echo Thu Aug 1 02:07:44 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Thu Aug 1 02:07:44 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a4402ed50d fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-32768-100-1722514064
+ git checkout -b scalability-no-8-32768-100-1722514064
Switched to a new branch 'scalability-no-8-32768-100-1722514064'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/8/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-32768-100-1722514064 5e0b852ce6] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 02:08:08 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 02:08:08 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-8-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-8-32768-100-1722514064 32768 no 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-8-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-512-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-512-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-512-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-512-32768-100
+ env
++ date
+ echo Thu Aug 1 02:09:28 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Thu Aug 1 02:09:28 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 5e0b852ce6 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-32768-100-1722514168
+ git checkout -b scalability-no-512-32768-100-1722514168
Switched to a new branch 'scalability-no-512-32768-100-1722514168'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/512/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-32768-100-1722514168 a76d44571c] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 02:09:51 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 02:09:51 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-512-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-512-32768-100-1722514168 32768 no 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-512-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-128-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-128-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-128-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-128-32768-100
+ env
++ date
+ echo Thu Aug 1 02:11:12 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Thu Aug 1 02:11:12 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a76d44571c fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-32768-100-1722514272
+ git checkout -b scalability-no-128-32768-100-1722514272
Switched to a new branch 'scalability-no-128-32768-100-1722514272'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-32768-100-1722514272 c661fa5e10] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 02:11:36 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 02:11:36 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-128-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-128-32768-100-1722514272 32768 no 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-128-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-32-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-32-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-32-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-32-32768-100
+ env
++ date
+ echo Thu Aug 1 02:12:56 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Thu Aug 1 02:12:56 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at c661fa5e10 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-32768-100-1722514376
+ git checkout -b scalability-yes-32-32768-100-1722514376
Switched to a new branch 'scalability-yes-32-32768-100-1722514376'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-32768-100-1722514376 bf54fa05e6] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-32768-100-1722514376 07f5297ec6] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 02:13:19 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 02:13:19 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-32-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-32-32768-100-1722514376 32768 yes 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-32-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-0-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-0-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-0-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-0-32768-100
+ env
++ date
+ echo Thu Aug 1 02:30:04 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Thu Aug 1 02:30:04 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 07f5297ec6 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-32768-100-1722515404
+ git checkout -b scalability-yes-0-32768-100-1722515404
Switched to a new branch 'scalability-yes-0-32768-100-1722515404'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-32768-100-1722515404 dd10414488] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 02:30:28 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 02:30:28 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-0-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-0-32768-100-1722515404 32768 yes 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-0-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-1-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-1-32768-100
+ env
++ date
+ echo Thu Aug 1 02:47:08 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Thu Aug 1 02:47:08 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at dd10414488 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-32768-100-1722516428
+ git checkout -b scalability-yes-1-32768-100-1722516428
Switched to a new branch 'scalability-yes-1-32768-100-1722516428'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-32768-100-1722516428 b486397c78] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-32768-100-1722516428 d0fa5ebad3] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 02:47:32 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 02:47:32 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-1-32768-100-1722516428 32768 yes 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1024-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-1024-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1024-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-1024-32768-100
+ env
++ date
+ echo Thu Aug 1 03:04:11 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Thu Aug 1 03:04:11 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d0fa5ebad3 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-32768-100-1722517451
+ git checkout -b scalability-yes-1024-32768-100-1722517451
Switched to a new branch 'scalability-yes-1024-32768-100-1722517451'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-32768-100-1722517451 25d44ddfc3] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-32768-100-1722517451 cd36df9748] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 03:04:34 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 03:04:34 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1024-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-1024-32768-100-1722517451 32768 yes 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1024-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-8-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-8-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-8-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-8-32768-100
+ env
++ date
+ echo Thu Aug 1 03:21:25 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Thu Aug 1 03:21:25 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at cd36df9748 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-32768-100-1722518485
+ git checkout -b scalability-yes-8-32768-100-1722518485
Switched to a new branch 'scalability-yes-8-32768-100-1722518485'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-32768-100-1722518485 a53e295d25] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-32768-100-1722518485 5aae421164] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 03:21:50 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 03:21:50 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-8-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-8-32768-100-1722518485 32768 yes 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-8-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-512-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-512-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-512-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-512-32768-100
+ env
++ date
+ echo Thu Aug 1 03:38:30 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Thu Aug 1 03:38:30 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 5aae421164 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-32768-100-1722519510
+ git checkout -b scalability-yes-512-32768-100-1722519510
Switched to a new branch 'scalability-yes-512-32768-100-1722519510'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-32768-100-1722519510 e142faaaf9] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-32768-100-1722519510 3d5cc784f6] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 03:38:55 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 03:38:55 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-512-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-512-32768-100-1722519510 32768 yes 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-512-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-128-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-128-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-128-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-128-32768-100
+ env
++ date
+ echo Thu Aug 1 03:55:43 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Thu Aug 1 03:55:43 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 3d5cc784f6 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-32768-100-1722520544
+ git checkout -b scalability-yes-128-32768-100-1722520544
Switched to a new branch 'scalability-yes-128-32768-100-1722520544'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-32768-100-1722520544 67a3f4686a] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-32768-100-1722520544 b4b2ee3f78] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 03:56:08 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 03:56:08 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-128-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-128-32768-100-1722520544 32768 yes 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-128-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-32-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-32-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-32-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-32-32768-100
+ env
++ date
+ echo Thu Aug 1 04:12:48 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Thu Aug 1 04:12:48 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b4b2ee3f78 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-32768-100-1722521569
+ git checkout -b scalability-no-32-32768-100-1722521569
Switched to a new branch 'scalability-no-32-32768-100-1722521569'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-32768-100-1722521569 7a1c69d2b6] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 04:13:14 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 04:13:14 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-32-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-32-32768-100-1722521569 32768 no 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-32-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-0-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-0-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-0-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-0-32768-100
+ env
++ date
+ echo Thu Aug 1 04:29:45 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Thu Aug 1 04:29:45 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 7a1c69d2b6 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-32768-100-1722522586
+ git checkout -b scalability-no-0-32768-100-1722522586
Switched to a new branch 'scalability-no-0-32768-100-1722522586'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 04:30:10 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 04:30:10 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-0-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-0-32768-100-1722522586 32768 no 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-0-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-1-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-1-32768-100
+ env
++ date
+ echo Thu Aug 1 04:46:45 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Thu Aug 1 04:46:45 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-32768-100-1722523606
+ git checkout -b scalability-no-1-32768-100-1722523606
Switched to a new branch 'scalability-no-1-32768-100-1722523606'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/1/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-32768-100-1722523606 3b67c4b609] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 04:47:10 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 04:47:10 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-1-32768-100-1722523606 32768 no 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1024-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-1024-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1024-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-1024-32768-100
+ env
++ date
+ echo Thu Aug 1 05:03:50 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Thu Aug 1 05:03:50 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 3b67c4b609 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-32768-100-1722524631
+ git checkout -b scalability-no-1024-32768-100-1722524631
Switched to a new branch 'scalability-no-1024-32768-100-1722524631'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/1024/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-32768-100-1722524631 63c8bf30d5] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 05:04:15 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 05:04:15 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1024-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-1024-32768-100-1722524631 32768 no 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1024-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-8-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-8-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-8-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-8-32768-100
+ env
++ date
+ echo Thu Aug 1 05:21:06 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Thu Aug 1 05:21:06 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 63c8bf30d5 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-32768-100-1722525667
+ git checkout -b scalability-no-8-32768-100-1722525667
Switched to a new branch 'scalability-no-8-32768-100-1722525667'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-32768-100-1722525667 8ceae2b9af] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 05:21:32 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 05:21:32 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-8-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-8-32768-100-1722525667 32768 no 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-8-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-512-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-512-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-512-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-512-32768-100
+ env
++ date
+ echo Thu Aug 1 05:38:05 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Thu Aug 1 05:38:05 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 8ceae2b9af fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-32768-100-1722526685
+ git checkout -b scalability-no-512-32768-100-1722526685
Switched to a new branch 'scalability-no-512-32768-100-1722526685'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-32768-100-1722526685 42334382ac] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 05:38:30 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 05:38:30 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-512-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-512-32768-100-1722526685 32768 no 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-512-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-128-32768-100
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-128-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-128-32768-100
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-128-32768-100
+ env
++ date
+ echo Thu Aug 1 05:55:19 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Thu Aug 1 05:55:19 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 42334382ac fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-32768-100-1722527720
+ git checkout -b scalability-no-128-32768-100-1722527720
Switched to a new branch 'scalability-no-128-32768-100-1722527720'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-32768-100-1722527720 fea042893b] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-32768-100 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 05:55:44 PM CEST 2024 'RUN   files: 32768  partitions: 100'
Thu Aug 1 05:55:44 PM CEST 2024 RUN   files: 32768  partitions: 100
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-32768-100/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-128-32768-100/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-128-32768-100-1722527720 32768 no 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-128-32768-100 1 10 '1 4 16' 100
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for p in $PARTITIONS
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-32-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-32-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-32-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-32-32768-10
+ env
++ date
+ echo Thu Aug 1 06:12:15 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Thu Aug 1 06:12:15 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at fea042893b fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-32768-10-1722528736
+ git checkout -b scalability-yes-32-32768-10-1722528736
Switched to a new branch 'scalability-yes-32-32768-10-1722528736'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-32768-10-1722528736 7f68181bb1] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-32768-10-1722528736 91ad4e7399] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 06:12:59 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 06:12:59 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-32-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-32-32768-10-1722528736 32768 yes 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-32-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-0-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-0-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-0-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-0-32768-10
+ env
++ date
+ echo Thu Aug 1 06:14:14 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Thu Aug 1 06:14:14 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 91ad4e7399 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-32768-10-1722528854
+ git checkout -b scalability-yes-0-32768-10-1722528854
Switched to a new branch 'scalability-yes-0-32768-10-1722528854'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-32768-10-1722528854 e1c141cdd2] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 06:14:57 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 06:14:57 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-0-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-0-32768-10-1722528854 32768 yes 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-0-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-1-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-1-32768-10
+ env
++ date
+ echo Thu Aug 1 06:16:11 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Thu Aug 1 06:16:11 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e1c141cdd2 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-32768-10-1722528971
+ git checkout -b scalability-yes-1-32768-10-1722528971
Switched to a new branch 'scalability-yes-1-32768-10-1722528971'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-32768-10-1722528971 403fbe1401] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-32768-10-1722528971 3f0a138050] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 06:16:53 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 06:16:53 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-1-32768-10-1722528971 32768 yes 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1024-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-1024-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1024-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-1024-32768-10
+ env
++ date
+ echo Thu Aug 1 06:18:07 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Thu Aug 1 06:18:07 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 3f0a138050 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-32768-10-1722529088
+ git checkout -b scalability-yes-1024-32768-10-1722529088
Switched to a new branch 'scalability-yes-1024-32768-10-1722529088'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-32768-10-1722529088 d7c11ffd80] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-32768-10-1722529088 516c88209b] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 06:18:50 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 06:18:50 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1024-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-1024-32768-10-1722529088 32768 yes 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1024-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-8-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-8-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-8-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-8-32768-10
+ env
++ date
+ echo Thu Aug 1 06:20:04 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Thu Aug 1 06:20:04 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 516c88209b fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-32768-10-1722529204
+ git checkout -b scalability-yes-8-32768-10-1722529204
Switched to a new branch 'scalability-yes-8-32768-10-1722529204'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-32768-10-1722529204 9723665fce] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-32768-10-1722529204 d09f8ddaf0] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 06:20:47 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 06:20:47 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-8-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-8-32768-10-1722529204 32768 yes 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-8-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-512-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-512-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-512-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-512-32768-10
+ env
++ date
+ echo Thu Aug 1 06:22:01 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Thu Aug 1 06:22:01 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d09f8ddaf0 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-32768-10-1722529321
+ git checkout -b scalability-yes-512-32768-10-1722529321
Switched to a new branch 'scalability-yes-512-32768-10-1722529321'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-32768-10-1722529321 7708927293] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-32768-10-1722529321 4f30b21099] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 06:22:43 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 06:22:43 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-512-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-512-32768-10-1722529321 32768 yes 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-512-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-128-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-128-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-128-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-128-32768-10
+ env
++ date
+ echo Thu Aug 1 06:23:57 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Thu Aug 1 06:23:57 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 4f30b21099 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-32768-10-1722529438
+ git checkout -b scalability-yes-128-32768-10-1722529438
Switched to a new branch 'scalability-yes-128-32768-10-1722529438'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-32768-10-1722529438 608dade89d] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-32768-10-1722529438 3f332af38a] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 06:24:40 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 06:24:40 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-128-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-128-32768-10-1722529438 32768 yes 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-128-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-32-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-32-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-32-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-32-32768-10
+ env
++ date
+ echo Thu Aug 1 06:25:54 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Thu Aug 1 06:25:54 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 3f332af38a fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-32768-10-1722529554
+ git checkout -b scalability-no-32-32768-10-1722529554
Switched to a new branch 'scalability-no-32-32768-10-1722529554'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/32/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-32768-10-1722529554 03955db542] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 06:26:37 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 06:26:37 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-32-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-32-32768-10-1722529554 32768 no 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-32-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-0-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-0-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-0-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-0-32768-10
+ env
++ date
+ echo Thu Aug 1 06:27:51 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Thu Aug 1 06:27:51 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 03955db542 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-32768-10-1722529671
+ git checkout -b scalability-no-0-32768-10-1722529671
Switched to a new branch 'scalability-no-0-32768-10-1722529671'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 06:28:33 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 06:28:33 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-0-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-0-32768-10-1722529671 32768 no 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-0-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-1-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-1-32768-10
+ env
++ date
+ echo Thu Aug 1 06:29:48 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Thu Aug 1 06:29:48 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-32768-10-1722529788
+ git checkout -b scalability-no-1-32768-10-1722529788
Switched to a new branch 'scalability-no-1-32768-10-1722529788'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-32768-10-1722529788 31d361983e] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 06:30:30 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 06:30:30 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-1-32768-10-1722529788 32768 no 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1024-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-1024-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1024-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-1024-32768-10
+ env
++ date
+ echo Thu Aug 1 06:31:44 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Thu Aug 1 06:31:44 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 31d361983e fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-32768-10-1722529904
+ git checkout -b scalability-no-1024-32768-10-1722529904
Switched to a new branch 'scalability-no-1024-32768-10-1722529904'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/1024/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-32768-10-1722529904 23268b5666] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 06:32:27 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 06:32:27 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1024-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-1024-32768-10-1722529904 32768 no 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1024-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-8-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-8-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-8-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-8-32768-10
+ env
++ date
+ echo Thu Aug 1 06:33:41 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Thu Aug 1 06:33:41 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 23268b5666 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-32768-10-1722530021
+ git checkout -b scalability-no-8-32768-10-1722530021
Switched to a new branch 'scalability-no-8-32768-10-1722530021'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-32768-10-1722530021 3a1624ad3a] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 06:34:23 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 06:34:23 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-8-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-8-32768-10-1722530021 32768 no 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-8-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-512-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-512-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-512-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-512-32768-10
+ env
++ date
+ echo Thu Aug 1 06:35:37 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Thu Aug 1 06:35:37 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 3a1624ad3a fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-32768-10-1722530137
+ git checkout -b scalability-no-512-32768-10-1722530137
Switched to a new branch 'scalability-no-512-32768-10-1722530137'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-32768-10-1722530137 9a4678f728] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 06:36:20 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 06:36:20 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-512-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-512-32768-10-1722530137 32768 no 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-512-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-128-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-128-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-128-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-128-32768-10
+ env
++ date
+ echo Thu Aug 1 06:37:34 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Thu Aug 1 06:37:34 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 9a4678f728 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-32768-10-1722530254
+ git checkout -b scalability-no-128-32768-10-1722530254
Switched to a new branch 'scalability-no-128-32768-10-1722530254'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/128/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-32768-10-1722530254 f49f47410f] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 06:38:17 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 06:38:17 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-128-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-128-32768-10-1722530254 32768 no 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-128-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-32-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-32-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-32-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-32-32768-10
+ env
++ date
+ echo Thu Aug 1 06:39:31 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Thu Aug 1 06:39:31 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at f49f47410f fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-32768-10-1722530371
+ git checkout -b scalability-yes-32-32768-10-1722530371
Switched to a new branch 'scalability-yes-32-32768-10-1722530371'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-32768-10-1722530371 c8a1aad885] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-32768-10-1722530371 176cc5ef6b] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 06:39:54 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 06:39:54 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-32-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-32-32768-10-1722530371 32768 yes 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-32-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-0-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-0-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-0-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-0-32768-10
+ env
++ date
+ echo Thu Aug 1 06:41:09 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Thu Aug 1 06:41:09 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 176cc5ef6b fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-32768-10-1722530469
+ git checkout -b scalability-yes-0-32768-10-1722530469
Switched to a new branch 'scalability-yes-0-32768-10-1722530469'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-32768-10-1722530469 5f5769f286] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 06:41:33 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 06:41:33 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-0-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-0-32768-10-1722530469 32768 yes 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-0-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-1-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-1-32768-10
+ env
++ date
+ echo Thu Aug 1 06:42:47 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Thu Aug 1 06:42:47 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 5f5769f286 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-32768-10-1722530568
+ git checkout -b scalability-yes-1-32768-10-1722530568
Switched to a new branch 'scalability-yes-1-32768-10-1722530568'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-32768-10-1722530568 2ca8c5825d] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-32768-10-1722530568 4f3b04b2f2] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 06:43:11 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 06:43:11 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-1-32768-10-1722530568 32768 yes 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1024-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-1024-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1024-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-1024-32768-10
+ env
++ date
+ echo Thu Aug 1 06:44:26 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Thu Aug 1 06:44:26 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 4f3b04b2f2 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-32768-10-1722530666
+ git checkout -b scalability-yes-1024-32768-10-1722530666
Switched to a new branch 'scalability-yes-1024-32768-10-1722530666'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-32768-10-1722530666 bf068f5fab] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-32768-10-1722530666 fbfcc9c6e7] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 06:44:49 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 06:44:49 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1024-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-1024-32768-10-1722530666 32768 yes 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1024-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-8-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-8-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-8-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-8-32768-10
+ env
++ date
+ echo Thu Aug 1 06:46:04 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Thu Aug 1 06:46:04 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at fbfcc9c6e7 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-32768-10-1722530764
+ git checkout -b scalability-yes-8-32768-10-1722530764
Switched to a new branch 'scalability-yes-8-32768-10-1722530764'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-32768-10-1722530764 de58ca70fa] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-32768-10-1722530764 d48faa0201] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 06:46:27 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 06:46:27 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-8-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-8-32768-10-1722530764 32768 yes 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-8-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-512-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-512-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-512-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-512-32768-10
+ env
++ date
+ echo Thu Aug 1 06:47:42 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Thu Aug 1 06:47:42 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d48faa0201 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-32768-10-1722530862
+ git checkout -b scalability-yes-512-32768-10-1722530862
Switched to a new branch 'scalability-yes-512-32768-10-1722530862'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-32768-10-1722530862 7a43c6b33b] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-32768-10-1722530862 193fcdc3a7] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 06:48:06 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 06:48:06 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-512-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-512-32768-10-1722530862 32768 yes 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-512-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-128-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-128-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-128-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-128-32768-10
+ env
++ date
+ echo Thu Aug 1 06:49:20 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Thu Aug 1 06:49:20 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 193fcdc3a7 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-32768-10-1722530961
+ git checkout -b scalability-yes-128-32768-10-1722530961
Switched to a new branch 'scalability-yes-128-32768-10-1722530961'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-32768-10-1722530961 12511f5390] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-32768-10-1722530961 2e85390304] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 06:49:44 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 06:49:44 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-128-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-128-32768-10-1722530961 32768 yes 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-128-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-32-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-32-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-32-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-32-32768-10
+ env
++ date
+ echo Thu Aug 1 06:50:59 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Thu Aug 1 06:50:59 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 2e85390304 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-32768-10-1722531059
+ git checkout -b scalability-no-32-32768-10-1722531059
Switched to a new branch 'scalability-no-32-32768-10-1722531059'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/32/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-32768-10-1722531059 b2f8a4e8ed] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 06:51:22 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 06:51:22 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-32-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-32-32768-10-1722531059 32768 no 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-32-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-0-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-0-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-0-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-0-32768-10
+ env
++ date
+ echo Thu Aug 1 06:52:37 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Thu Aug 1 06:52:37 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b2f8a4e8ed fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-32768-10-1722531157
+ git checkout -b scalability-no-0-32768-10-1722531157
Switched to a new branch 'scalability-no-0-32768-10-1722531157'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 06:53:00 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 06:53:00 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-0-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-0-32768-10-1722531157 32768 no 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-0-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-1-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-1-32768-10
+ env
++ date
+ echo Thu Aug 1 06:54:15 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Thu Aug 1 06:54:15 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-32768-10-1722531255
+ git checkout -b scalability-no-1-32768-10-1722531255
Switched to a new branch 'scalability-no-1-32768-10-1722531255'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/1/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-32768-10-1722531255 036694cee6] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 06:54:38 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 06:54:38 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-1-32768-10-1722531255 32768 no 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1024-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-1024-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1024-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-1024-32768-10
+ env
++ date
+ echo Thu Aug 1 06:55:53 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Thu Aug 1 06:55:53 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 036694cee6 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-32768-10-1722531353
+ git checkout -b scalability-no-1024-32768-10-1722531353
Switched to a new branch 'scalability-no-1024-32768-10-1722531353'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-32768-10-1722531353 5ab645c07e] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 06:56:16 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 06:56:16 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1024-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-1024-32768-10-1722531353 32768 no 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1024-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-8-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-8-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-8-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-8-32768-10
+ env
++ date
+ echo Thu Aug 1 06:57:31 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Thu Aug 1 06:57:31 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 5ab645c07e fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-32768-10-1722531451
+ git checkout -b scalability-no-8-32768-10-1722531451
Switched to a new branch 'scalability-no-8-32768-10-1722531451'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/8/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-32768-10-1722531451 b7df11095e] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 06:57:54 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 06:57:54 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-8-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-8-32768-10-1722531451 32768 no 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-8-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-512-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-512-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-512-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-512-32768-10
+ env
++ date
+ echo Thu Aug 1 06:59:09 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Thu Aug 1 06:59:09 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b7df11095e fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-32768-10-1722531549
+ git checkout -b scalability-no-512-32768-10-1722531549
Switched to a new branch 'scalability-no-512-32768-10-1722531549'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-32768-10-1722531549 18d9cee237] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 06:59:32 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 06:59:32 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-512-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-512-32768-10-1722531549 32768 no 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-512-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-128-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-128-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-128-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-128-32768-10
+ env
++ date
+ echo Thu Aug 1 07:00:47 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Thu Aug 1 07:00:47 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 18d9cee237 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-32768-10-1722531647
+ git checkout -b scalability-no-128-32768-10-1722531647
Switched to a new branch 'scalability-no-128-32768-10-1722531647'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/128/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-32768-10-1722531647 134f86bde1] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:01:11 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 07:01:11 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-128-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-128-32768-10-1722531647 32768 no 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-128-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-32-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-32-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-32-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-32-32768-10
+ env
++ date
+ echo Thu Aug 1 07:02:25 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Thu Aug 1 07:02:25 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 134f86bde1 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-32768-10-1722531745
+ git checkout -b scalability-yes-32-32768-10-1722531745
Switched to a new branch 'scalability-yes-32-32768-10-1722531745'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-32768-10-1722531745 51eb613e62] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-32768-10-1722531745 da43454218] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:02:49 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 07:02:49 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-32-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-32-32768-10-1722531745 32768 yes 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-32-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-0-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-0-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-0-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-0-32768-10
+ env
++ date
+ echo Thu Aug 1 07:04:02 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Thu Aug 1 07:04:02 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at da43454218 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-32768-10-1722531842
+ git checkout -b scalability-yes-0-32768-10-1722531842
Switched to a new branch 'scalability-yes-0-32768-10-1722531842'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-32768-10-1722531842 6b18f7ab83] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:04:26 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 07:04:26 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-0-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-0-32768-10-1722531842 32768 yes 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-0-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-1-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-1-32768-10
+ env
++ date
+ echo Thu Aug 1 07:05:39 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Thu Aug 1 07:05:39 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 6b18f7ab83 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-32768-10-1722531939
+ git checkout -b scalability-yes-1-32768-10-1722531939
Switched to a new branch 'scalability-yes-1-32768-10-1722531939'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-32768-10-1722531939 7bcd6de31e] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-32768-10-1722531939 d5dcea1aba] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:06:02 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 07:06:02 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-1-32768-10-1722531939 32768 yes 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1024-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-1024-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1024-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-1024-32768-10
+ env
++ date
+ echo Thu Aug 1 07:07:16 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Thu Aug 1 07:07:16 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d5dcea1aba fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-32768-10-1722532036
+ git checkout -b scalability-yes-1024-32768-10-1722532036
Switched to a new branch 'scalability-yes-1024-32768-10-1722532036'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-32768-10-1722532036 66d3e9bcb5] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-32768-10-1722532036 e7e3e070dd] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:07:39 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 07:07:39 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1024-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-1024-32768-10-1722532036 32768 yes 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1024-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-8-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-8-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-8-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-8-32768-10
+ env
++ date
+ echo Thu Aug 1 07:08:52 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Thu Aug 1 07:08:52 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e7e3e070dd fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-32768-10-1722532133
+ git checkout -b scalability-yes-8-32768-10-1722532133
Switched to a new branch 'scalability-yes-8-32768-10-1722532133'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-32768-10-1722532133 7afb96317f] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-32768-10-1722532133 31dd5ddbe8] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:09:16 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 07:09:16 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-8-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-8-32768-10-1722532133 32768 yes 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-8-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-512-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-512-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-512-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-512-32768-10
+ env
++ date
+ echo Thu Aug 1 07:10:29 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Thu Aug 1 07:10:29 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 31dd5ddbe8 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-32768-10-1722532229
+ git checkout -b scalability-yes-512-32768-10-1722532229
Switched to a new branch 'scalability-yes-512-32768-10-1722532229'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-32768-10-1722532229 23d6c20e71] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-32768-10-1722532229 08d9b0db54] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:10:53 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 07:10:53 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-512-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-512-32768-10-1722532229 32768 yes 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-512-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-128-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-128-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-128-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-128-32768-10
+ env
++ date
+ echo Thu Aug 1 07:12:06 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Thu Aug 1 07:12:06 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 08d9b0db54 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-32768-10-1722532326
+ git checkout -b scalability-yes-128-32768-10-1722532326
Switched to a new branch 'scalability-yes-128-32768-10-1722532326'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-32768-10-1722532326 4614ac8a35] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-32768-10-1722532326 796a1287ca] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:12:30 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 07:12:30 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-128-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-128-32768-10-1722532326 32768 yes 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-128-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-32-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-32-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-32-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-32-32768-10
+ env
++ date
+ echo Thu Aug 1 07:13:43 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Thu Aug 1 07:13:43 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 796a1287ca fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-32768-10-1722532423
+ git checkout -b scalability-no-32-32768-10-1722532423
Switched to a new branch 'scalability-no-32-32768-10-1722532423'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-32768-10-1722532423 a6f063260d] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:14:06 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 07:14:06 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-32-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-32-32768-10-1722532423 32768 no 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-32-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-0-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-0-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-0-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-0-32768-10
+ env
++ date
+ echo Thu Aug 1 07:15:19 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Thu Aug 1 07:15:19 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a6f063260d fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-32768-10-1722532520
+ git checkout -b scalability-no-0-32768-10-1722532520
Switched to a new branch 'scalability-no-0-32768-10-1722532520'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:15:43 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 07:15:43 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-0-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-0-32768-10-1722532520 32768 no 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-0-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-1-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-1-32768-10
+ env
++ date
+ echo Thu Aug 1 07:16:56 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Thu Aug 1 07:16:56 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-32768-10-1722532616
+ git checkout -b scalability-no-1-32768-10-1722532616
Switched to a new branch 'scalability-no-1-32768-10-1722532616'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-32768-10-1722532616 cddb18d008] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:17:20 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 07:17:20 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-1-32768-10-1722532616 32768 no 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1024-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-1024-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1024-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-1024-32768-10
+ env
++ date
+ echo Thu Aug 1 07:18:33 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Thu Aug 1 07:18:33 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at cddb18d008 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-32768-10-1722532713
+ git checkout -b scalability-no-1024-32768-10-1722532713
Switched to a new branch 'scalability-no-1024-32768-10-1722532713'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/1024/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-32768-10-1722532713 3741387c38] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:18:56 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 07:18:56 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1024-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-1024-32768-10-1722532713 32768 no 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1024-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-8-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-8-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-8-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-8-32768-10
+ env
++ date
+ echo Thu Aug 1 07:20:09 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Thu Aug 1 07:20:09 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 3741387c38 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-32768-10-1722532810
+ git checkout -b scalability-no-8-32768-10-1722532810
Switched to a new branch 'scalability-no-8-32768-10-1722532810'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-32768-10-1722532810 9e8da982f3] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:20:33 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 07:20:33 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-8-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-8-32768-10-1722532810 32768 no 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-8-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-512-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-512-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-512-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-512-32768-10
+ env
++ date
+ echo Thu Aug 1 07:21:46 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Thu Aug 1 07:21:46 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 9e8da982f3 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-32768-10-1722532906
+ git checkout -b scalability-no-512-32768-10-1722532906
Switched to a new branch 'scalability-no-512-32768-10-1722532906'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-32768-10-1722532906 ac0cbf9947] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:22:09 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 07:22:09 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-512-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-512-32768-10-1722532906 32768 no 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-512-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-128-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-128-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-128-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-128-32768-10
+ env
++ date
+ echo Thu Aug 1 07:23:23 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Thu Aug 1 07:23:23 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at ac0cbf9947 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-32768-10-1722533003
+ git checkout -b scalability-no-128-32768-10-1722533003
Switched to a new branch 'scalability-no-128-32768-10-1722533003'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-32768-10-1722533003 fe22594984] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:23:46 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 07:23:46 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-128-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-128-32768-10-1722533003 32768 no 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-128-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-32-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-32-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-32-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-32-32768-10
+ env
++ date
+ echo Thu Aug 1 07:24:59 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Thu Aug 1 07:24:59 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at fe22594984 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-32768-10-1722533099
+ git checkout -b scalability-yes-32-32768-10-1722533099
Switched to a new branch 'scalability-yes-32-32768-10-1722533099'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-32768-10-1722533099 fb33cd382d] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-32768-10-1722533099 51a052aeca] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:25:23 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 07:25:23 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-32-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-32-32768-10-1722533099 32768 yes 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-32-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-0-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-0-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-0-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-0-32768-10
+ env
++ date
+ echo Thu Aug 1 07:26:42 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Thu Aug 1 07:26:42 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 51a052aeca fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-32768-10-1722533202
+ git checkout -b scalability-yes-0-32768-10-1722533202
Switched to a new branch 'scalability-yes-0-32768-10-1722533202'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-32768-10-1722533202 dfe215bf40] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:27:05 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 07:27:05 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-0-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-0-32768-10-1722533202 32768 yes 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-0-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-1-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-1-32768-10
+ env
++ date
+ echo Thu Aug 1 07:28:24 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Thu Aug 1 07:28:24 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at dfe215bf40 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-32768-10-1722533305
+ git checkout -b scalability-yes-1-32768-10-1722533305
Switched to a new branch 'scalability-yes-1-32768-10-1722533305'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-32768-10-1722533305 cc9b4b47d0] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-32768-10-1722533305 f8d4f74cbe] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:28:48 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 07:28:48 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-1-32768-10-1722533305 32768 yes 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1024-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-1024-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1024-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-1024-32768-10
+ env
++ date
+ echo Thu Aug 1 07:30:07 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Thu Aug 1 07:30:07 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at f8d4f74cbe fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-32768-10-1722533407
+ git checkout -b scalability-yes-1024-32768-10-1722533407
Switched to a new branch 'scalability-yes-1024-32768-10-1722533407'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-32768-10-1722533407 4187697064] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-32768-10-1722533407 7fed429746] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:30:30 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 07:30:30 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1024-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-1024-32768-10-1722533407 32768 yes 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1024-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-8-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-8-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-8-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-8-32768-10
+ env
++ date
+ echo Thu Aug 1 07:31:50 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Thu Aug 1 07:31:50 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 7fed429746 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-32768-10-1722533510
+ git checkout -b scalability-yes-8-32768-10-1722533510
Switched to a new branch 'scalability-yes-8-32768-10-1722533510'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-32768-10-1722533510 bd0b3884ce] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-32768-10-1722533510 84396a0810] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:32:13 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 07:32:13 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-8-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-8-32768-10-1722533510 32768 yes 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-8-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-512-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-512-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-512-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-512-32768-10
+ env
++ date
+ echo Thu Aug 1 07:33:32 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Thu Aug 1 07:33:32 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 84396a0810 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-32768-10-1722533612
+ git checkout -b scalability-yes-512-32768-10-1722533612
Switched to a new branch 'scalability-yes-512-32768-10-1722533612'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-32768-10-1722533612 9714ce35ab] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-32768-10-1722533612 b37453fe1d] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:33:56 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 07:33:56 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-512-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-512-32768-10-1722533612 32768 yes 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-512-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-128-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-128-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-128-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-128-32768-10
+ env
++ date
+ echo Thu Aug 1 07:35:15 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Thu Aug 1 07:35:15 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b37453fe1d fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-32768-10-1722533715
+ git checkout -b scalability-yes-128-32768-10-1722533715
Switched to a new branch 'scalability-yes-128-32768-10-1722533715'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-32768-10-1722533715 caee4bbcfe] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-32768-10-1722533715 627e77791b] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:35:38 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 07:35:38 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-128-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-128-32768-10-1722533715 32768 yes 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-128-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-32-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-32-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-32-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-32-32768-10
+ env
++ date
+ echo Thu Aug 1 07:36:58 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Thu Aug 1 07:36:58 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 627e77791b fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-32768-10-1722533818
+ git checkout -b scalability-no-32-32768-10-1722533818
Switched to a new branch 'scalability-no-32-32768-10-1722533818'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-32768-10-1722533818 0b8d22be67] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:37:21 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 07:37:21 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-32-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-32-32768-10-1722533818 32768 no 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-32-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-0-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-0-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-0-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-0-32768-10
+ env
++ date
+ echo Thu Aug 1 07:38:40 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Thu Aug 1 07:38:40 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 0b8d22be67 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-32768-10-1722533920
+ git checkout -b scalability-no-0-32768-10-1722533920
Switched to a new branch 'scalability-no-0-32768-10-1722533920'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:39:04 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 07:39:04 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-0-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-0-32768-10-1722533920 32768 no 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-0-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-1-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-1-32768-10
+ env
++ date
+ echo Thu Aug 1 07:40:23 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Thu Aug 1 07:40:23 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-32768-10-1722534023
+ git checkout -b scalability-no-1-32768-10-1722534023
Switched to a new branch 'scalability-no-1-32768-10-1722534023'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-32768-10-1722534023 a7922cd942] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:40:46 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 07:40:46 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-1-32768-10-1722534023 32768 no 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1024-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-1024-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1024-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-1024-32768-10
+ env
++ date
+ echo Thu Aug 1 07:42:05 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Thu Aug 1 07:42:05 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a7922cd942 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-32768-10-1722534125
+ git checkout -b scalability-no-1024-32768-10-1722534125
Switched to a new branch 'scalability-no-1024-32768-10-1722534125'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-32768-10-1722534125 fab8b2ddb0] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:42:29 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 07:42:29 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1024-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-1024-32768-10-1722534125 32768 no 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1024-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-8-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-8-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-8-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-8-32768-10
+ env
++ date
+ echo Thu Aug 1 07:43:48 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Thu Aug 1 07:43:48 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at fab8b2ddb0 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-32768-10-1722534228
+ git checkout -b scalability-no-8-32768-10-1722534228
Switched to a new branch 'scalability-no-8-32768-10-1722534228'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-32768-10-1722534228 e92edfb2eb] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:44:11 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 07:44:11 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-8-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-8-32768-10-1722534228 32768 no 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-8-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-512-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-512-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-512-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-512-32768-10
+ env
++ date
+ echo Thu Aug 1 07:45:30 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Thu Aug 1 07:45:30 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e92edfb2eb fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-32768-10-1722534330
+ git checkout -b scalability-no-512-32768-10-1722534330
Switched to a new branch 'scalability-no-512-32768-10-1722534330'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-32768-10-1722534330 276c127da6] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:45:54 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 07:45:54 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-512-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-512-32768-10-1722534330 32768 no 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-512-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-128-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-128-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-128-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-128-32768-10
+ env
++ date
+ echo Thu Aug 1 07:47:13 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Thu Aug 1 07:47:13 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 276c127da6 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-32768-10-1722534433
+ git checkout -b scalability-no-128-32768-10-1722534433
Switched to a new branch 'scalability-no-128-32768-10-1722534433'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-32768-10-1722534433 5a0681d314] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:47:36 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 07:47:36 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-128-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-128-32768-10-1722534433 32768 no 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-128-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-32-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-32-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-32-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-32-32768-10
+ env
++ date
+ echo Thu Aug 1 07:48:55 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Thu Aug 1 07:48:55 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 5a0681d314 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-32768-10-1722534535
+ git checkout -b scalability-yes-32-32768-10-1722534535
Switched to a new branch 'scalability-yes-32-32768-10-1722534535'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-32768-10-1722534535 f662b48baf] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-32768-10-1722534535 e02d082745] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:49:19 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 07:49:19 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-32-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-32-32768-10-1722534535 32768 yes 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-32-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-0-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-0-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-0-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-0-32768-10
+ env
++ date
+ echo Thu Aug 1 07:52:14 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Thu Aug 1 07:52:14 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e02d082745 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-32768-10-1722534734
+ git checkout -b scalability-yes-0-32768-10-1722534734
Switched to a new branch 'scalability-yes-0-32768-10-1722534734'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-32768-10-1722534734 452f6d7ab6] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:52:38 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 07:52:38 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-0-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-0-32768-10-1722534734 32768 yes 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-0-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-1-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-1-32768-10
+ env
++ date
+ echo Thu Aug 1 07:55:34 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Thu Aug 1 07:55:34 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 452f6d7ab6 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-32768-10-1722534934
+ git checkout -b scalability-yes-1-32768-10-1722534934
Switched to a new branch 'scalability-yes-1-32768-10-1722534934'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-32768-10-1722534934 050d2456ab] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-32768-10-1722534934 91dd55e487] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:55:58 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 07:55:58 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-1-32768-10-1722534934 32768 yes 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1024-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-1024-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1024-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-1024-32768-10
+ env
++ date
+ echo Thu Aug 1 07:58:53 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Thu Aug 1 07:58:53 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 91dd55e487 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-32768-10-1722535134
+ git checkout -b scalability-yes-1024-32768-10-1722535134
Switched to a new branch 'scalability-yes-1024-32768-10-1722535134'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-32768-10-1722535134 914173d182] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-32768-10-1722535134 4ef1bdfe6a] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 07:59:17 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 07:59:17 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1024-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-1024-32768-10-1722535134 32768 yes 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1024-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-8-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-8-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-8-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-8-32768-10
+ env
++ date
+ echo Thu Aug 1 08:02:14 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Thu Aug 1 08:02:14 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 4ef1bdfe6a fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-32768-10-1722535334
+ git checkout -b scalability-yes-8-32768-10-1722535334
Switched to a new branch 'scalability-yes-8-32768-10-1722535334'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-32768-10-1722535334 e228a57955] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-32768-10-1722535334 c80698b339] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:02:37 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 08:02:37 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-8-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-8-32768-10-1722535334 32768 yes 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-8-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-512-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-512-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-512-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-512-32768-10
+ env
++ date
+ echo Thu Aug 1 08:05:33 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Thu Aug 1 08:05:33 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at c80698b339 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-32768-10-1722535533
+ git checkout -b scalability-yes-512-32768-10-1722535533
Switched to a new branch 'scalability-yes-512-32768-10-1722535533'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-32768-10-1722535533 857454916e] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-32768-10-1722535533 879a406e82] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:05:56 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 08:05:56 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-512-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-512-32768-10-1722535533 32768 yes 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-512-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-128-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-128-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-128-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-128-32768-10
+ env
++ date
+ echo Thu Aug 1 08:08:53 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Thu Aug 1 08:08:53 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 879a406e82 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-32768-10-1722535733
+ git checkout -b scalability-yes-128-32768-10-1722535733
Switched to a new branch 'scalability-yes-128-32768-10-1722535733'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-32768-10-1722535733 ef570528b5] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-32768-10-1722535733 f299154324] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:09:16 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 08:09:16 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-128-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-128-32768-10-1722535733 32768 yes 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-128-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-32-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-32-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-32-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-32-32768-10
+ env
++ date
+ echo Thu Aug 1 08:12:12 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Thu Aug 1 08:12:12 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at f299154324 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-32768-10-1722535932
+ git checkout -b scalability-no-32-32768-10-1722535932
Switched to a new branch 'scalability-no-32-32768-10-1722535932'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/32/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-32768-10-1722535932 f01f6633bc] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:12:36 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 08:12:36 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-32-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-32-32768-10-1722535932 32768 no 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-32-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-0-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-0-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-0-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-0-32768-10
+ env
++ date
+ echo Thu Aug 1 08:15:32 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Thu Aug 1 08:15:32 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at f01f6633bc fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-32768-10-1722536132
+ git checkout -b scalability-no-0-32768-10-1722536132
Switched to a new branch 'scalability-no-0-32768-10-1722536132'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:15:55 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 08:15:55 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-0-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-0-32768-10-1722536132 32768 no 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-0-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-1-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-1-32768-10
+ env
++ date
+ echo Thu Aug 1 08:18:52 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Thu Aug 1 08:18:52 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-32768-10-1722536332
+ git checkout -b scalability-no-1-32768-10-1722536332
Switched to a new branch 'scalability-no-1-32768-10-1722536332'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-32768-10-1722536332 f817bcb16c] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:19:15 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 08:19:15 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-1-32768-10-1722536332 32768 no 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1024-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-1024-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1024-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-1024-32768-10
+ env
++ date
+ echo Thu Aug 1 08:22:12 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Thu Aug 1 08:22:12 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at f817bcb16c fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-32768-10-1722536532
+ git checkout -b scalability-no-1024-32768-10-1722536532
Switched to a new branch 'scalability-no-1024-32768-10-1722536532'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-32768-10-1722536532 75544b22e7] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:22:35 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 08:22:35 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1024-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-1024-32768-10-1722536532 32768 no 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1024-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-8-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-8-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-8-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-8-32768-10
+ env
++ date
+ echo Thu Aug 1 08:25:32 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Thu Aug 1 08:25:32 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 75544b22e7 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-32768-10-1722536732
+ git checkout -b scalability-no-8-32768-10-1722536732
Switched to a new branch 'scalability-no-8-32768-10-1722536732'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-32768-10-1722536732 1cc986f39a] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:25:55 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 08:25:55 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-8-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-8-32768-10-1722536732 32768 no 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-8-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-512-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-512-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-512-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-512-32768-10
+ env
++ date
+ echo Thu Aug 1 08:28:49 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Thu Aug 1 08:28:49 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 1cc986f39a fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-32768-10-1722536929
+ git checkout -b scalability-no-512-32768-10-1722536929
Switched to a new branch 'scalability-no-512-32768-10-1722536929'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-32768-10-1722536929 13a524f240] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:29:13 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 08:29:13 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-512-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-512-32768-10-1722536929 32768 no 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-512-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-128-32768-10
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-128-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-128-32768-10
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-128-32768-10
+ env
++ date
+ echo Thu Aug 1 08:32:09 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Thu Aug 1 08:32:09 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 13a524f240 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-32768-10-1722537129
+ git checkout -b scalability-no-128-32768-10-1722537129
Switched to a new branch 'scalability-no-128-32768-10-1722537129'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-32768-10-1722537129 9860d58684] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-32768-10 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:32:32 PM CEST 2024 'RUN   files: 32768  partitions: 10'
Thu Aug 1 08:32:32 PM CEST 2024 RUN   files: 32768  partitions: 10
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-32768-10/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-128-32768-10/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-128-32768-10-1722537129 32768 no 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-128-32768-10 1 10 '1 4 16' 10
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for p in $PARTITIONS
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-32-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-32-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-32-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-32-32768-1
+ env
++ date
+ echo Thu Aug 1 08:35:27 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Thu Aug 1 08:35:27 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 9860d58684 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-32768-1-1722537327
+ git checkout -b scalability-yes-32-32768-1-1722537327
Switched to a new branch 'scalability-yes-32-32768-1-1722537327'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-32768-1-1722537327 637143d3fc] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-32768-1-1722537327 a3e1089055] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:36:09 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 08:36:09 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-32-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-32-32768-1-1722537327 32768 yes 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-32-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-0-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-0-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-0-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-0-32768-1
+ env
++ date
+ echo Thu Aug 1 08:37:23 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Thu Aug 1 08:37:23 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a3e1089055 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-32768-1-1722537444
+ git checkout -b scalability-yes-0-32768-1-1722537444
Switched to a new branch 'scalability-yes-0-32768-1-1722537444'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-32768-1-1722537444 4be682d8c5] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:38:06 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 08:38:06 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-0-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-0-32768-1-1722537444 32768 yes 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-0-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-1-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-1-32768-1
+ env
++ date
+ echo Thu Aug 1 08:39:20 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Thu Aug 1 08:39:20 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 4be682d8c5 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-32768-1-1722537560
+ git checkout -b scalability-yes-1-32768-1-1722537560
Switched to a new branch 'scalability-yes-1-32768-1-1722537560'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-32768-1-1722537560 951cba1c84] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-32768-1-1722537560 4d92e595cd] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:40:03 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 08:40:03 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-1-32768-1-1722537560 32768 yes 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1024-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-1024-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1024-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-1024-32768-1
+ env
++ date
+ echo Thu Aug 1 08:41:17 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Thu Aug 1 08:41:17 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 4d92e595cd fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-32768-1-1722537677
+ git checkout -b scalability-yes-1024-32768-1-1722537677
Switched to a new branch 'scalability-yes-1024-32768-1-1722537677'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-32768-1-1722537677 0f7bf95bda] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-32768-1-1722537677 1135c8f495] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:42:00 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 08:42:00 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1024-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-1024-32768-1-1722537677 32768 yes 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1024-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-8-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-8-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-8-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-8-32768-1
+ env
++ date
+ echo Thu Aug 1 08:43:14 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Thu Aug 1 08:43:14 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 1135c8f495 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-32768-1-1722537794
+ git checkout -b scalability-yes-8-32768-1-1722537794
Switched to a new branch 'scalability-yes-8-32768-1-1722537794'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-32768-1-1722537794 0dfb8bc420] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-32768-1-1722537794 f37c9c777e] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:43:56 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 08:43:56 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-8-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-8-32768-1-1722537794 32768 yes 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-8-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-512-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-512-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-512-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-512-32768-1
+ env
++ date
+ echo Thu Aug 1 08:45:10 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Thu Aug 1 08:45:10 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at f37c9c777e fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-32768-1-1722537910
+ git checkout -b scalability-yes-512-32768-1-1722537910
Switched to a new branch 'scalability-yes-512-32768-1-1722537910'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-32768-1-1722537910 6dc17416f7] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-32768-1-1722537910 d048b524bd] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:45:53 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 08:45:53 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-512-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-512-32768-1-1722537910 32768 yes 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-512-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-128-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-128-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-128-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-128-32768-1
+ env
++ date
+ echo Thu Aug 1 08:47:07 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Thu Aug 1 08:47:07 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d048b524bd fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-32768-1-1722538027
+ git checkout -b scalability-yes-128-32768-1-1722538027
Switched to a new branch 'scalability-yes-128-32768-1-1722538027'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-32768-1-1722538027 231908b275] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-32768-1-1722538027 38c4894dfb] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:47:49 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 08:47:49 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-128-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-128-32768-1-1722538027 32768 yes 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-128-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-32-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-32-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-32-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-32-32768-1
+ env
++ date
+ echo Thu Aug 1 08:49:03 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Thu Aug 1 08:49:03 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 38c4894dfb fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-32768-1-1722538143
+ git checkout -b scalability-no-32-32768-1-1722538143
Switched to a new branch 'scalability-no-32-32768-1-1722538143'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-32768-1-1722538143 f4b8f46aea] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:49:46 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 08:49:46 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-32-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-32-32768-1-1722538143 32768 no 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-32-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-0-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-0-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-0-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-0-32768-1
+ env
++ date
+ echo Thu Aug 1 08:51:00 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Thu Aug 1 08:51:00 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at f4b8f46aea fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-32768-1-1722538260
+ git checkout -b scalability-no-0-32768-1-1722538260
Switched to a new branch 'scalability-no-0-32768-1-1722538260'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:51:42 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 08:51:42 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-0-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-0-32768-1-1722538260 32768 no 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-0-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-1-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-1-32768-1
+ env
++ date
+ echo Thu Aug 1 08:52:56 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Thu Aug 1 08:52:56 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-32768-1-1722538376
+ git checkout -b scalability-no-1-32768-1-1722538376
Switched to a new branch 'scalability-no-1-32768-1-1722538376'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/1/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-32768-1-1722538376 4feefa5219] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:53:39 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 08:53:39 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-1-32768-1-1722538376 32768 no 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1024-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-1024-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1024-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-1024-32768-1
+ env
++ date
+ echo Thu Aug 1 08:54:53 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Thu Aug 1 08:54:53 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 4feefa5219 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-32768-1-1722538493
+ git checkout -b scalability-no-1024-32768-1-1722538493
Switched to a new branch 'scalability-no-1024-32768-1-1722538493'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/1024/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-32768-1-1722538493 facc84c2a3] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:55:35 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 08:55:35 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1024-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-1024-32768-1-1722538493 32768 no 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1024-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-8-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-8-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-8-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-8-32768-1
+ env
++ date
+ echo Thu Aug 1 08:56:49 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Thu Aug 1 08:56:49 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at facc84c2a3 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-32768-1-1722538610
+ git checkout -b scalability-no-8-32768-1-1722538610
Switched to a new branch 'scalability-no-8-32768-1-1722538610'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-32768-1-1722538610 0db90c5287] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:57:32 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 08:57:32 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-8-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-8-32768-1-1722538610 32768 no 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-8-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-512-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-512-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-512-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-512-32768-1
+ env
++ date
+ echo Thu Aug 1 08:58:46 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Thu Aug 1 08:58:46 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 0db90c5287 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-32768-1-1722538726
+ git checkout -b scalability-no-512-32768-1-1722538726
Switched to a new branch 'scalability-no-512-32768-1-1722538726'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-32768-1-1722538726 9edc2e804a] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 08:59:29 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 08:59:29 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-512-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-512-32768-1-1722538726 32768 no 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-512-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-128-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-128-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-128-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-128-32768-1
+ env
++ date
+ echo Thu Aug 1 09:00:43 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Thu Aug 1 09:00:43 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 9edc2e804a fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-32768-1-1722538843
+ git checkout -b scalability-no-128-32768-1-1722538843
Switched to a new branch 'scalability-no-128-32768-1-1722538843'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-32768-1-1722538843 5893087274] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:01:25 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 09:01:25 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-128-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-128-32768-1-1722538843 32768 no 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-128-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-32-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-32-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-32-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-32-32768-1
+ env
++ date
+ echo Thu Aug 1 09:02:39 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Thu Aug 1 09:02:39 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 5893087274 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-32768-1-1722538959
+ git checkout -b scalability-yes-32-32768-1-1722538959
Switched to a new branch 'scalability-yes-32-32768-1-1722538959'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-32768-1-1722538959 7f0d053267] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-32768-1-1722538959 3d7b173683] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:03:02 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 09:03:02 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-32-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-32-32768-1-1722538959 32768 yes 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-32-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-0-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-0-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-0-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-0-32768-1
+ env
++ date
+ echo Thu Aug 1 09:04:17 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Thu Aug 1 09:04:17 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 3d7b173683 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-32768-1-1722539057
+ git checkout -b scalability-yes-0-32768-1-1722539057
Switched to a new branch 'scalability-yes-0-32768-1-1722539057'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-32768-1-1722539057 d8ab4a89ca] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:04:40 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 09:04:40 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-0-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-0-32768-1-1722539057 32768 yes 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-0-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-1-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-1-32768-1
+ env
++ date
+ echo Thu Aug 1 09:05:55 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Thu Aug 1 09:05:55 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d8ab4a89ca NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-32768-1-1722539155
+ git checkout -b scalability-yes-1-32768-1-1722539155
Switched to a new branch 'scalability-yes-1-32768-1-1722539155'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-32768-1-1722539155 4c720a639d] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-32768-1-1722539155 e15fa8d21f] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:06:18 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 09:06:18 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-1-32768-1-1722539155 32768 yes 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1024-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-1024-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1024-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-1024-32768-1
+ env
++ date
+ echo Thu Aug 1 09:07:33 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Thu Aug 1 09:07:33 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e15fa8d21f fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-32768-1-1722539253
+ git checkout -b scalability-yes-1024-32768-1-1722539253
Switched to a new branch 'scalability-yes-1024-32768-1-1722539253'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-32768-1-1722539253 0eba362185] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-32768-1-1722539253 4855c67567] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:07:56 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 09:07:56 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1024-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-1024-32768-1-1722539253 32768 yes 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1024-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-8-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-8-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-8-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-8-32768-1
+ env
++ date
+ echo Thu Aug 1 09:09:10 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Thu Aug 1 09:09:10 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 4855c67567 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-32768-1-1722539351
+ git checkout -b scalability-yes-8-32768-1-1722539351
Switched to a new branch 'scalability-yes-8-32768-1-1722539351'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-32768-1-1722539351 1659d2373c] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-32768-1-1722539351 d88c47edf6] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:09:34 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 09:09:34 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-8-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-8-32768-1-1722539351 32768 yes 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-8-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-512-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-512-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-512-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-512-32768-1
+ env
++ date
+ echo Thu Aug 1 09:10:48 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Thu Aug 1 09:10:48 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d88c47edf6 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-32768-1-1722539448
+ git checkout -b scalability-yes-512-32768-1-1722539448
Switched to a new branch 'scalability-yes-512-32768-1-1722539448'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-32768-1-1722539448 3029616170] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-32768-1-1722539448 3227751fc0] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:11:12 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 09:11:12 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-512-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-512-32768-1-1722539448 32768 yes 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-512-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-128-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-128-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-128-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-128-32768-1
+ env
++ date
+ echo Thu Aug 1 09:12:26 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Thu Aug 1 09:12:26 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 3227751fc0 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-32768-1-1722539546
+ git checkout -b scalability-yes-128-32768-1-1722539546
Switched to a new branch 'scalability-yes-128-32768-1-1722539546'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-32768-1-1722539546 51c8839bcf] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-32768-1-1722539546 6940ce0175] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:12:50 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 09:12:50 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-128-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-128-32768-1-1722539546 32768 yes 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-128-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-32-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-32-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-32-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-32-32768-1
+ env
++ date
+ echo Thu Aug 1 09:14:04 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Thu Aug 1 09:14:04 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 6940ce0175 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-32768-1-1722539644
+ git checkout -b scalability-no-32-32768-1-1722539644
Switched to a new branch 'scalability-no-32-32768-1-1722539644'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/32/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-32768-1-1722539644 225b0d8de3] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:14:28 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 09:14:28 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-32-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-32-32768-1-1722539644 32768 no 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-32-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-0-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-0-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-0-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-0-32768-1
+ env
++ date
+ echo Thu Aug 1 09:15:42 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Thu Aug 1 09:15:42 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 225b0d8de3 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-32768-1-1722539742
+ git checkout -b scalability-no-0-32768-1-1722539742
Switched to a new branch 'scalability-no-0-32768-1-1722539742'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:16:05 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 09:16:05 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-0-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-0-32768-1-1722539742 32768 no 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-0-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-1-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-1-32768-1
+ env
++ date
+ echo Thu Aug 1 09:17:20 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Thu Aug 1 09:17:20 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-32768-1-1722539840
+ git checkout -b scalability-no-1-32768-1-1722539840
Switched to a new branch 'scalability-no-1-32768-1-1722539840'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/1/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-32768-1-1722539840 36d93c45ef] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:17:43 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 09:17:43 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-1-32768-1-1722539840 32768 no 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1024-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-1024-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1024-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-1024-32768-1
+ env
++ date
+ echo Thu Aug 1 09:18:58 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Thu Aug 1 09:18:58 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 36d93c45ef fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-32768-1-1722539938
+ git checkout -b scalability-no-1024-32768-1-1722539938
Switched to a new branch 'scalability-no-1024-32768-1-1722539938'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-32768-1-1722539938 a289877777] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:19:21 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 09:19:21 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1024-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-1024-32768-1-1722539938 32768 no 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1024-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-8-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-8-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-8-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-8-32768-1
+ env
++ date
+ echo Thu Aug 1 09:20:36 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Thu Aug 1 09:20:36 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a289877777 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-32768-1-1722540036
+ git checkout -b scalability-no-8-32768-1-1722540036
Switched to a new branch 'scalability-no-8-32768-1-1722540036'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-32768-1-1722540036 f5beec9517] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:20:59 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 09:20:59 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-8-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-8-32768-1-1722540036 32768 no 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-8-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-512-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-512-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-512-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-512-32768-1
+ env
++ date
+ echo Thu Aug 1 09:22:13 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Thu Aug 1 09:22:13 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at f5beec9517 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-32768-1-1722540134
+ git checkout -b scalability-no-512-32768-1-1722540134
Switched to a new branch 'scalability-no-512-32768-1-1722540134'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/512/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-32768-1-1722540134 e5b3570d66] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:22:37 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 09:22:37 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-512-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-512-32768-1-1722540134 32768 no 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-512-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-128-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-128-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-128-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-128-32768-1
+ env
++ date
+ echo Thu Aug 1 09:23:51 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Thu Aug 1 09:23:51 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e5b3570d66 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-32768-1-1722540231
+ git checkout -b scalability-no-128-32768-1-1722540231
Switched to a new branch 'scalability-no-128-32768-1-1722540231'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-32768-1-1722540231 540b0b9d26] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:24:15 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 09:24:15 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-128-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-128-32768-1-1722540231 32768 no 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-128-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-32-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-32-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-32-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-32-32768-1
+ env
++ date
+ echo Thu Aug 1 09:25:29 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Thu Aug 1 09:25:29 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 540b0b9d26 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-32768-1-1722540329
+ git checkout -b scalability-yes-32-32768-1-1722540329
Switched to a new branch 'scalability-yes-32-32768-1-1722540329'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-32768-1-1722540329 28cb7c5aa3] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-32768-1-1722540329 d0ae7fae57] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:25:53 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 09:25:53 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-32-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-32-32768-1-1722540329 32768 yes 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-32-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-0-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-0-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-0-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-0-32768-1
+ env
++ date
+ echo Thu Aug 1 09:27:06 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Thu Aug 1 09:27:06 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d0ae7fae57 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-32768-1-1722540426
+ git checkout -b scalability-yes-0-32768-1-1722540426
Switched to a new branch 'scalability-yes-0-32768-1-1722540426'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-32768-1-1722540426 b146a796a3] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:27:29 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 09:27:29 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-0-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-0-32768-1-1722540426 32768 yes 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-0-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-1-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-1-32768-1
+ env
++ date
+ echo Thu Aug 1 09:28:43 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Thu Aug 1 09:28:43 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b146a796a3 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-32768-1-1722540523
+ git checkout -b scalability-yes-1-32768-1-1722540523
Switched to a new branch 'scalability-yes-1-32768-1-1722540523'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-32768-1-1722540523 f1202a7118] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-32768-1-1722540523 2df0defa6f] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:29:06 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 09:29:06 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-1-32768-1-1722540523 32768 yes 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1024-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-1024-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1024-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-1024-32768-1
+ env
++ date
+ echo Thu Aug 1 09:30:19 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Thu Aug 1 09:30:19 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 2df0defa6f fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-32768-1-1722540619
+ git checkout -b scalability-yes-1024-32768-1-1722540619
Switched to a new branch 'scalability-yes-1024-32768-1-1722540619'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-32768-1-1722540619 0f91fd6fbb] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-32768-1-1722540619 69af95aea5] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:30:43 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 09:30:43 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1024-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-1024-32768-1-1722540619 32768 yes 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1024-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-8-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-8-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-8-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-8-32768-1
+ env
++ date
+ echo Thu Aug 1 09:31:56 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Thu Aug 1 09:31:56 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 69af95aea5 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-32768-1-1722540716
+ git checkout -b scalability-yes-8-32768-1-1722540716
Switched to a new branch 'scalability-yes-8-32768-1-1722540716'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-32768-1-1722540716 f12c5a75c4] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-32768-1-1722540716 93ef2ed410] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:32:20 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 09:32:20 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-8-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-8-32768-1-1722540716 32768 yes 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-8-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-512-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-512-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-512-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-512-32768-1
+ env
++ date
+ echo Thu Aug 1 09:33:33 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Thu Aug 1 09:33:33 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 93ef2ed410 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-32768-1-1722540813
+ git checkout -b scalability-yes-512-32768-1-1722540813
Switched to a new branch 'scalability-yes-512-32768-1-1722540813'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-32768-1-1722540813 e7542a831c] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-32768-1-1722540813 f76c16be39] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:33:56 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 09:33:56 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-512-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-512-32768-1-1722540813 32768 yes 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-512-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-128-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-128-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-128-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-128-32768-1
+ env
++ date
+ echo Thu Aug 1 09:35:10 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Thu Aug 1 09:35:10 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at f76c16be39 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-32768-1-1722540910
+ git checkout -b scalability-yes-128-32768-1-1722540910
Switched to a new branch 'scalability-yes-128-32768-1-1722540910'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-32768-1-1722540910 8e3b6ed76d] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-32768-1-1722540910 88d7f62dcf] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:35:33 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 09:35:33 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-128-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-128-32768-1-1722540910 32768 yes 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-128-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-32-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-32-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-32-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-32-32768-1
+ env
++ date
+ echo Thu Aug 1 09:36:46 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Thu Aug 1 09:36:46 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 88d7f62dcf fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-32768-1-1722541006
+ git checkout -b scalability-no-32-32768-1-1722541006
Switched to a new branch 'scalability-no-32-32768-1-1722541006'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/32/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-32768-1-1722541006 01de4e79f2] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:37:10 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 09:37:10 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-32-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-32-32768-1-1722541006 32768 no 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-32-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-0-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-0-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-0-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-0-32768-1
+ env
++ date
+ echo Thu Aug 1 09:38:23 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Thu Aug 1 09:38:23 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 01de4e79f2 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-32768-1-1722541103
+ git checkout -b scalability-no-0-32768-1-1722541103
Switched to a new branch 'scalability-no-0-32768-1-1722541103'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:38:46 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 09:38:46 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-0-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-0-32768-1-1722541103 32768 no 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-0-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-1-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-1-32768-1
+ env
++ date
+ echo Thu Aug 1 09:39:59 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Thu Aug 1 09:39:59 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-32768-1-1722541199
+ git checkout -b scalability-no-1-32768-1-1722541199
Switched to a new branch 'scalability-no-1-32768-1-1722541199'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-32768-1-1722541199 e6d05ba069] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:40:23 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 09:40:23 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-1-32768-1-1722541199 32768 no 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1024-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-1024-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1024-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-1024-32768-1
+ env
++ date
+ echo Thu Aug 1 09:41:36 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Thu Aug 1 09:41:36 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e6d05ba069 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-32768-1-1722541296
+ git checkout -b scalability-no-1024-32768-1-1722541296
Switched to a new branch 'scalability-no-1024-32768-1-1722541296'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-32768-1-1722541296 115596c7a1] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:41:59 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 09:41:59 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1024-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-1024-32768-1-1722541296 32768 no 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1024-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-8-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-8-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-8-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-8-32768-1
+ env
++ date
+ echo Thu Aug 1 09:43:13 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Thu Aug 1 09:43:13 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 115596c7a1 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-32768-1-1722541393
+ git checkout -b scalability-no-8-32768-1-1722541393
Switched to a new branch 'scalability-no-8-32768-1-1722541393'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/8/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-32768-1-1722541393 9d4ca0e0d1] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:43:36 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 09:43:36 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-8-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-8-32768-1-1722541393 32768 no 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-8-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-512-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-512-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-512-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-512-32768-1
+ env
++ date
+ echo Thu Aug 1 09:44:49 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Thu Aug 1 09:44:49 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 9d4ca0e0d1 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-32768-1-1722541489
+ git checkout -b scalability-no-512-32768-1-1722541489
Switched to a new branch 'scalability-no-512-32768-1-1722541489'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/512/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-32768-1-1722541489 ce0a5393ea] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:45:13 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 09:45:13 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-512-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-512-32768-1-1722541489 32768 no 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-512-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-128-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-128-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-128-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-128-32768-1
+ env
++ date
+ echo Thu Aug 1 09:46:26 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Thu Aug 1 09:46:26 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at ce0a5393ea fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-32768-1-1722541586
+ git checkout -b scalability-no-128-32768-1-1722541586
Switched to a new branch 'scalability-no-128-32768-1-1722541586'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/128/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-32768-1-1722541586 1ac9fc8901] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:46:49 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 09:46:49 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-128-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-128-32768-1-1722541586 32768 no 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-128-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-32-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-32-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-32-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-32-32768-1
+ env
++ date
+ echo Thu Aug 1 09:48:03 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Thu Aug 1 09:48:03 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 1ac9fc8901 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-32768-1-1722541683
+ git checkout -b scalability-yes-32-32768-1-1722541683
Switched to a new branch 'scalability-yes-32-32768-1-1722541683'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-32768-1-1722541683 c80ae56812] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-32768-1-1722541683 be1e62e14b] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:48:26 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 09:48:26 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-32-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-32-32768-1-1722541683 32768 yes 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-32-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-0-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-0-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-0-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-0-32768-1
+ env
++ date
+ echo Thu Aug 1 09:49:45 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Thu Aug 1 09:49:45 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at be1e62e14b fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-32768-1-1722541785
+ git checkout -b scalability-yes-0-32768-1-1722541785
Switched to a new branch 'scalability-yes-0-32768-1-1722541785'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-32768-1-1722541785 ca28d927d0] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:50:08 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 09:50:08 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-0-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-0-32768-1-1722541785 32768 yes 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-0-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-1-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-1-32768-1
+ env
++ date
+ echo Thu Aug 1 09:51:27 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Thu Aug 1 09:51:27 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at ca28d927d0 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-32768-1-1722541887
+ git checkout -b scalability-yes-1-32768-1-1722541887
Switched to a new branch 'scalability-yes-1-32768-1-1722541887'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-32768-1-1722541887 55730d0a05] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-32768-1-1722541887 a1f2217608] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:51:51 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 09:51:51 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-1-32768-1-1722541887 32768 yes 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1024-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-1024-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1024-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-1024-32768-1
+ env
++ date
+ echo Thu Aug 1 09:53:09 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Thu Aug 1 09:53:09 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a1f2217608 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-32768-1-1722541989
+ git checkout -b scalability-yes-1024-32768-1-1722541989
Switched to a new branch 'scalability-yes-1024-32768-1-1722541989'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-32768-1-1722541989 9fe44d2b03] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-32768-1-1722541989 1dc8f5b8c6] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:53:33 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 09:53:33 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1024-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-1024-32768-1-1722541989 32768 yes 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1024-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-8-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-8-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-8-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-8-32768-1
+ env
++ date
+ echo Thu Aug 1 09:54:51 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Thu Aug 1 09:54:51 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 1dc8f5b8c6 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-32768-1-1722542092
+ git checkout -b scalability-yes-8-32768-1-1722542092
Switched to a new branch 'scalability-yes-8-32768-1-1722542092'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-32768-1-1722542092 c6b530e81a] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-32768-1-1722542092 8170f62a8b] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:55:15 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 09:55:15 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-8-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-8-32768-1-1722542092 32768 yes 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-8-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-512-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-512-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-512-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-512-32768-1
+ env
++ date
+ echo Thu Aug 1 09:56:34 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Thu Aug 1 09:56:34 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 8170f62a8b fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-32768-1-1722542194
+ git checkout -b scalability-yes-512-32768-1-1722542194
Switched to a new branch 'scalability-yes-512-32768-1-1722542194'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-32768-1-1722542194 f0f5ac3721] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-32768-1-1722542194 6ce0cec75c] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:56:57 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 09:56:57 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-512-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-512-32768-1-1722542194 32768 yes 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-512-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-128-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-128-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-128-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-128-32768-1
+ env
++ date
+ echo Thu Aug 1 09:58:16 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Thu Aug 1 09:58:16 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 6ce0cec75c fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-32768-1-1722542296
+ git checkout -b scalability-yes-128-32768-1-1722542296
Switched to a new branch 'scalability-yes-128-32768-1-1722542296'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-32768-1-1722542296 ce2e97e160] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-32768-1-1722542296 255a1f3bd1] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 09:58:39 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 09:58:39 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-128-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-128-32768-1-1722542296 32768 yes 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-128-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-32-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-32-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-32-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-32-32768-1
+ env
++ date
+ echo Thu Aug 1 09:59:58 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Thu Aug 1 09:59:58 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 255a1f3bd1 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-32768-1-1722542398
+ git checkout -b scalability-no-32-32768-1-1722542398
Switched to a new branch 'scalability-no-32-32768-1-1722542398'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-32768-1-1722542398 a6101a93b7] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:00:21 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 10:00:21 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-32-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-32-32768-1-1722542398 32768 no 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-32-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-0-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-0-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-0-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-0-32768-1
+ env
++ date
+ echo Thu Aug 1 10:01:40 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Thu Aug 1 10:01:40 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a6101a93b7 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-32768-1-1722542500
+ git checkout -b scalability-no-0-32768-1-1722542500
Switched to a new branch 'scalability-no-0-32768-1-1722542500'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:02:03 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 10:02:03 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-0-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-0-32768-1-1722542500 32768 no 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-0-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-1-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-1-32768-1
+ env
++ date
+ echo Thu Aug 1 10:03:22 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Thu Aug 1 10:03:22 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-32768-1-1722542602
+ git checkout -b scalability-no-1-32768-1-1722542602
Switched to a new branch 'scalability-no-1-32768-1-1722542602'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/1/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-32768-1-1722542602 eb2e235ca1] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:03:45 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 10:03:45 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-1-32768-1-1722542602 32768 no 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1024-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-1024-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1024-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-1024-32768-1
+ env
++ date
+ echo Thu Aug 1 10:05:04 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Thu Aug 1 10:05:04 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at eb2e235ca1 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-32768-1-1722542704
+ git checkout -b scalability-no-1024-32768-1-1722542704
Switched to a new branch 'scalability-no-1024-32768-1-1722542704'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/1024/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-32768-1-1722542704 62f6e43913] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:05:27 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 10:05:27 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1024-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-1024-32768-1-1722542704 32768 no 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1024-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-8-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-8-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-8-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-8-32768-1
+ env
++ date
+ echo Thu Aug 1 10:06:46 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Thu Aug 1 10:06:46 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 62f6e43913 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-32768-1-1722542806
+ git checkout -b scalability-no-8-32768-1-1722542806
Switched to a new branch 'scalability-no-8-32768-1-1722542806'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-32768-1-1722542806 99d646300e] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:07:10 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 10:07:10 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-8-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-8-32768-1-1722542806 32768 no 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-8-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-512-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-512-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-512-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-512-32768-1
+ env
++ date
+ echo Thu Aug 1 10:08:28 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Thu Aug 1 10:08:28 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 99d646300e fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-32768-1-1722542908
+ git checkout -b scalability-no-512-32768-1-1722542908
Switched to a new branch 'scalability-no-512-32768-1-1722542908'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-32768-1-1722542908 9926436329] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:08:52 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 10:08:52 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-512-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-512-32768-1-1722542908 32768 no 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-512-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-128-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-128-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-128-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-128-32768-1
+ env
++ date
+ echo Thu Aug 1 10:10:10 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Thu Aug 1 10:10:10 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 9926436329 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-32768-1-1722543011
+ git checkout -b scalability-no-128-32768-1-1722543011
Switched to a new branch 'scalability-no-128-32768-1-1722543011'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-32768-1-1722543011 dd53ddd713] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:10:34 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 10:10:34 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-128-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-128-32768-1-1722543011 32768 no 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-128-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-32-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-32-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-32-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-32-32768-1
+ env
++ date
+ echo Thu Aug 1 10:11:53 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Thu Aug 1 10:11:53 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at dd53ddd713 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-32768-1-1722543113
+ git checkout -b scalability-yes-32-32768-1-1722543113
Switched to a new branch 'scalability-yes-32-32768-1-1722543113'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-32768-1-1722543113 d3374794f9] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-32768-1-1722543113 adfc653ef8] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:12:16 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 10:12:16 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-32-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-32-32768-1-1722543113 32768 yes 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-32-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-0-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-0-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-0-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-0-32768-1
+ env
++ date
+ echo Thu Aug 1 10:14:07 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Thu Aug 1 10:14:07 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at adfc653ef8 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-32768-1-1722543247
+ git checkout -b scalability-yes-0-32768-1-1722543247
Switched to a new branch 'scalability-yes-0-32768-1-1722543247'
+ '[' yes == yes ']'
+ patch -p1
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-32768-1-1722543247 bddb0d1a67] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:14:30 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 10:14:30 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-0-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-0-32768-1-1722543247 32768 yes 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-0-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-1-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-1-32768-1
+ env
++ date
+ echo Thu Aug 1 10:16:22 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Thu Aug 1 10:16:22 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at bddb0d1a67 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-32768-1-1722543382
+ git checkout -b scalability-yes-1-32768-1-1722543382
Switched to a new branch 'scalability-yes-1-32768-1-1722543382'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-32768-1-1722543382 94a50cffa4] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-32768-1-1722543382 b787d514c3] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:16:45 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 10:16:45 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-1-32768-1-1722543382 32768 yes 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1024-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-1024-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1024-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-1024-32768-1
+ env
++ date
+ echo Thu Aug 1 10:18:36 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Thu Aug 1 10:18:36 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b787d514c3 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-32768-1-1722543516
+ git checkout -b scalability-yes-1024-32768-1-1722543516
Switched to a new branch 'scalability-yes-1024-32768-1-1722543516'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-32768-1-1722543516 6b8752ef7f] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-32768-1-1722543516 5ce743ddc1] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:19:00 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 10:19:00 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1024-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-1024-32768-1-1722543516 32768 yes 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1024-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-8-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-8-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-8-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-8-32768-1
+ env
++ date
+ echo Thu Aug 1 10:20:50 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Thu Aug 1 10:20:50 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 5ce743ddc1 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-32768-1-1722543650
+ git checkout -b scalability-yes-8-32768-1-1722543650
Switched to a new branch 'scalability-yes-8-32768-1-1722543650'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-32768-1-1722543650 836c199f2c] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-32768-1-1722543650 b2ca4c47e1] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:21:13 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 10:21:13 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-8-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-8-32768-1-1722543650 32768 yes 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-8-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-512-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-512-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-512-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-512-32768-1
+ env
++ date
+ echo Thu Aug 1 10:23:03 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Thu Aug 1 10:23:03 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b2ca4c47e1 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-32768-1-1722543783
+ git checkout -b scalability-yes-512-32768-1-1722543783
Switched to a new branch 'scalability-yes-512-32768-1-1722543783'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-32768-1-1722543783 be8064a33b] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-32768-1-1722543783 aea8e789a3] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:23:27 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 10:23:27 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-512-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-512-32768-1-1722543783 32768 yes 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-512-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-128-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-128-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-128-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-128-32768-1
+ env
++ date
+ echo Thu Aug 1 10:25:17 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Thu Aug 1 10:25:17 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at aea8e789a3 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-32768-1-1722543917
+ git checkout -b scalability-yes-128-32768-1-1722543917
Switched to a new branch 'scalability-yes-128-32768-1-1722543917'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-32768-1-1722543917 cf2cd77eb2] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-32768-1-1722543917 699e5738c1] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:25:40 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 10:25:40 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-128-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-128-32768-1-1722543917 32768 yes 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-128-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-32-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-32-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-32-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-32-32768-1
+ env
++ date
+ echo Thu Aug 1 10:27:30 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Thu Aug 1 10:27:30 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 699e5738c1 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-32768-1-1722544051
+ git checkout -b scalability-no-32-32768-1-1722544051
Switched to a new branch 'scalability-no-32-32768-1-1722544051'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-32768-1-1722544051 24f9d15bc3] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:27:54 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 10:27:54 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-32-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-32-32768-1-1722544051 32768 no 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-32-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-0-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-0-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-0-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-0-32768-1
+ env
++ date
+ echo Thu Aug 1 10:29:44 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Thu Aug 1 10:29:44 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 24f9d15bc3 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-32768-1-1722544184
+ git checkout -b scalability-no-0-32768-1-1722544184
Switched to a new branch 'scalability-no-0-32768-1-1722544184'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:30:07 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 10:30:07 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-0-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-0-32768-1-1722544184 32768 no 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-0-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-1-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-1-32768-1
+ env
++ date
+ echo Thu Aug 1 10:31:58 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Thu Aug 1 10:31:58 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-32768-1-1722544318
+ git checkout -b scalability-no-1-32768-1-1722544318
Switched to a new branch 'scalability-no-1-32768-1-1722544318'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/1/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-32768-1-1722544318 10991b1a77] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:32:22 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 10:32:22 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-1-32768-1-1722544318 32768 no 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1024-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-1024-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1024-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-1024-32768-1
+ env
++ date
+ echo Thu Aug 1 10:34:13 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Thu Aug 1 10:34:13 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 10991b1a77 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-32768-1-1722544454
+ git checkout -b scalability-no-1024-32768-1-1722544454
Switched to a new branch 'scalability-no-1024-32768-1-1722544454'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/1024/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-32768-1-1722544454 d2d60d16dc] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:34:37 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 10:34:37 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1024-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-1024-32768-1-1722544454 32768 no 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1024-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-8-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-8-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-8-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-8-32768-1
+ env
++ date
+ echo Thu Aug 1 10:36:28 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Thu Aug 1 10:36:28 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d2d60d16dc fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-32768-1-1722544588
+ git checkout -b scalability-no-8-32768-1-1722544588
Switched to a new branch 'scalability-no-8-32768-1-1722544588'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-32768-1-1722544588 8445c85247] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:36:51 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 10:36:51 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-8-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-8-32768-1-1722544588 32768 no 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-8-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-512-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-512-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-512-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-512-32768-1
+ env
++ date
+ echo Thu Aug 1 10:38:41 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Thu Aug 1 10:38:41 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 8445c85247 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-32768-1-1722544721
+ git checkout -b scalability-no-512-32768-1-1722544721
Switched to a new branch 'scalability-no-512-32768-1-1722544721'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-32768-1-1722544721 d01a0f3d5b] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:39:04 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 10:39:04 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-512-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-512-32768-1-1722544721 32768 no 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-512-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-128-32768-1
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-128-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-128-32768-1
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-128-32768-1
+ env
++ date
+ echo Thu Aug 1 10:40:54 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Thu Aug 1 10:40:54 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at d01a0f3d5b fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-32768-1-1722544854
+ git checkout -b scalability-no-128-32768-1-1722544854
Switched to a new branch 'scalability-no-128-32768-1-1722544854'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-32768-1-1722544854 1db772e99f] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-32768-1 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:41:18 PM CEST 2024 'RUN   files: 32768  partitions: 1'
Thu Aug 1 10:41:18 PM CEST 2024 RUN   files: 32768  partitions: 1
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-32768-1/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-128-32768-1/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-128-32768-1-1722544854 32768 no 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-128-32768-1 1 10 '1 4 16' 1
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for p in $PARTITIONS
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-32-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-32-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-32-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-32-32768-0
+ env
++ date
+ echo Thu Aug 1 10:43:08 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Thu Aug 1 10:43:08 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 1db772e99f fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-32768-0-1722544988
+ git checkout -b scalability-yes-32-32768-0-1722544988
Switched to a new branch 'scalability-yes-32-32768-0-1722544988'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-32768-0-1722544988 3029c611af] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-32768-0-1722544988 68ff2b3fe8] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:43:50 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Thu Aug 1 10:43:50 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-32-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-32-32768-0-1722544988 32768 yes 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-32-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-0-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-0-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-0-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-0-32768-0
+ env
++ date
+ echo Thu Aug 1 10:45:04 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Thu Aug 1 10:45:04 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 68ff2b3fe8 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-32768-0-1722545105
+ git checkout -b scalability-yes-0-32768-0-1722545105
Switched to a new branch 'scalability-yes-0-32768-0-1722545105'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-32768-0-1722545105 9c32dac2dd] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:45:47 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Thu Aug 1 10:45:47 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-0-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-0-32768-0-1722545105 32768 yes 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-0-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-1-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-1-32768-0
+ env
++ date
+ echo Thu Aug 1 10:47:01 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Thu Aug 1 10:47:01 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 9c32dac2dd NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-32768-0-1722545221
+ git checkout -b scalability-yes-1-32768-0-1722545221
Switched to a new branch 'scalability-yes-1-32768-0-1722545221'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-32768-0-1722545221 e8432eaddd] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-32768-0-1722545221 1745e9b75d] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:47:43 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Thu Aug 1 10:47:43 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-1-32768-0-1722545221 32768 yes 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1024-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-1024-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1024-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-1024-32768-0
+ env
++ date
+ echo Thu Aug 1 10:48:57 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Thu Aug 1 10:48:57 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 1745e9b75d fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-32768-0-1722545337
+ git checkout -b scalability-yes-1024-32768-0-1722545337
Switched to a new branch 'scalability-yes-1024-32768-0-1722545337'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-32768-0-1722545337 ff06656d77] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-32768-0-1722545337 b841835283] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:49:40 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Thu Aug 1 10:49:40 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1024-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-1024-32768-0-1722545337 32768 yes 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-1024-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-8-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-8-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-8-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-8-32768-0
+ env
++ date
+ echo Thu Aug 1 10:50:54 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Thu Aug 1 10:50:54 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b841835283 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-32768-0-1722545454
+ git checkout -b scalability-yes-8-32768-0-1722545454
Switched to a new branch 'scalability-yes-8-32768-0-1722545454'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-32768-0-1722545454 4a52ced7f0] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-32768-0-1722545454 f2ff8f2af5] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:51:36 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Thu Aug 1 10:51:36 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-8-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-8-32768-0-1722545454 32768 yes 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-8-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-512-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-512-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-512-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-512-32768-0
+ env
++ date
+ echo Thu Aug 1 10:52:50 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Thu Aug 1 10:52:50 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at f2ff8f2af5 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-32768-0-1722545570
+ git checkout -b scalability-yes-512-32768-0-1722545570
Switched to a new branch 'scalability-yes-512-32768-0-1722545570'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-32768-0-1722545570 fed0fdc782] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-32768-0-1722545570 a32ab643a8] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:53:33 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Thu Aug 1 10:53:33 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-512-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-512-32768-0-1722545570 32768 yes 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-512-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-128-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-128-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-128-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-yes-128-32768-0
+ env
++ date
+ echo Thu Aug 1 10:54:46 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Thu Aug 1 10:54:46 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a32ab643a8 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-32768-0-1722545687
+ git checkout -b scalability-yes-128-32768-0-1722545687
Switched to a new branch 'scalability-yes-128-32768-0-1722545687'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-32768-0-1722545687 3fa1541522] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-32768-0-1722545687 f0fd452161] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:55:29 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Thu Aug 1 10:55:29 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-128-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-yes-128-32768-0-1722545687 32768 yes 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-yes-128-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-32-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-32-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-32-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-32-32768-0
+ env
++ date
+ echo Thu Aug 1 10:56:43 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Thu Aug 1 10:56:43 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at f0fd452161 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-32768-0-1722545803
+ git checkout -b scalability-no-32-32768-0-1722545803
Switched to a new branch 'scalability-no-32-32768-0-1722545803'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-32768-0-1722545803 dbb673c29b] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:57:26 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Thu Aug 1 10:57:26 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-32-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-32-32768-0-1722545803 32768 no 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-32-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-0-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-0-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-0-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-0-32768-0
+ env
++ date
+ echo Thu Aug 1 10:58:39 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Thu Aug 1 10:58:39 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at dbb673c29b fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-32768-0-1722545920
+ git checkout -b scalability-no-0-32768-0-1722545920
Switched to a new branch 'scalability-no-0-32768-0-1722545920'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 10:59:22 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Thu Aug 1 10:59:22 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-0-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-0-32768-0-1722545920 32768 no 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-0-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-1-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-1-32768-0
+ env
++ date
+ echo Thu Aug 1 11:00:36 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Thu Aug 1 11:00:36 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-32768-0-1722546036
+ git checkout -b scalability-no-1-32768-0-1722546036
Switched to a new branch 'scalability-no-1-32768-0-1722546036'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-32768-0-1722546036 b9e253a430] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:01:18 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Thu Aug 1 11:01:18 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-1-32768-0-1722546036 32768 no 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1024-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-1024-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1024-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-1024-32768-0
+ env
++ date
+ echo Thu Aug 1 11:02:32 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Thu Aug 1 11:02:32 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b9e253a430 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-32768-0-1722546152
+ git checkout -b scalability-no-1024-32768-0-1722546152
Switched to a new branch 'scalability-no-1024-32768-0-1722546152'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/1024/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-32768-0-1722546152 066cceea09] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:03:15 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Thu Aug 1 11:03:15 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1024-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-1024-32768-0-1722546152 32768 no 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-1024-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-8-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-8-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-8-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-8-32768-0
+ env
++ date
+ echo Thu Aug 1 11:04:28 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Thu Aug 1 11:04:28 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 066cceea09 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-32768-0-1722546269
+ git checkout -b scalability-no-8-32768-0-1722546269
Switched to a new branch 'scalability-no-8-32768-0-1722546269'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/8/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-32768-0-1722546269 040f59184f] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:05:11 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Thu Aug 1 11:05:11 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-8-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-8-32768-0-1722546269 32768 no 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-8-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-512-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-512-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-512-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-512-32768-0
+ env
++ date
+ echo Thu Aug 1 11:06:25 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Thu Aug 1 11:06:25 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 040f59184f fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-32768-0-1722546385
+ git checkout -b scalability-no-512-32768-0-1722546385
Switched to a new branch 'scalability-no-512-32768-0-1722546385'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/512/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-32768-0-1722546385 f85cdcfb64] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:07:07 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Thu Aug 1 11:07:07 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-512-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-512-32768-0-1722546385 32768 no 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-512-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-128-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-128-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-128-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/pgbench-no-128-32768-0
+ env
++ date
+ echo Thu Aug 1 11:08:21 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Thu Aug 1 11:08:21 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at f85cdcfb64 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-32768-0-1722546501
+ git checkout -b scalability-no-128-32768-0-1722546501
Switched to a new branch 'scalability-no-128-32768-0-1722546501'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-32768-0-1722546501 3ede5ef1b2] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:09:04 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Thu Aug 1 11:09:04 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-128-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-pgbench.sh i5 scalability-no-128-32768-0-1722546501 32768 no 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/pgbench-no-128-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-32-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-32-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-32-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-32-32768-0
+ env
++ date
+ echo Thu Aug 1 11:10:17 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Thu Aug 1 11:10:17 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 3ede5ef1b2 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-32768-0-1722546618
+ git checkout -b scalability-yes-32-32768-0-1722546618
Switched to a new branch 'scalability-yes-32-32768-0-1722546618'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-32768-0-1722546618 7640bdb85e] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-32768-0-1722546618 3380f3c669] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:10:41 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Thu Aug 1 11:10:41 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-32-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-32-32768-0-1722546618 32768 yes 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-32-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-0-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-0-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-0-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-0-32768-0
+ env
++ date
+ echo Thu Aug 1 11:11:55 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Thu Aug 1 11:11:55 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 3380f3c669 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-32768-0-1722546715
+ git checkout -b scalability-yes-0-32768-0-1722546715
Switched to a new branch 'scalability-yes-0-32768-0-1722546715'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-32768-0-1722546715 1a269d3d45] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:12:19 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Thu Aug 1 11:12:19 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-0-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-0-32768-0-1722546715 32768 yes 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-0-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-1-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-1-32768-0
+ env
++ date
+ echo Thu Aug 1 11:13:33 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Thu Aug 1 11:13:33 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 1a269d3d45 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-32768-0-1722546813
+ git checkout -b scalability-yes-1-32768-0-1722546813
Switched to a new branch 'scalability-yes-1-32768-0-1722546813'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-32768-0-1722546813 84fa63b05e] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-32768-0-1722546813 964d915d16] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:13:57 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Thu Aug 1 11:13:57 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-1-32768-0-1722546813 32768 yes 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1024-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-1024-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1024-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-1024-32768-0
+ env
++ date
+ echo Thu Aug 1 11:15:11 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Thu Aug 1 11:15:11 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 964d915d16 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-32768-0-1722546911
+ git checkout -b scalability-yes-1024-32768-0-1722546911
Switched to a new branch 'scalability-yes-1024-32768-0-1722546911'
+ '[' yes == yes ']'
+ patch -p1
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-32768-0-1722546911 b5402f051a] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-32768-0-1722546911 527005254f] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:15:34 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Thu Aug 1 11:15:34 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1024-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-1024-32768-0-1722546911 32768 yes 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-1024-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-8-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-8-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-8-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-8-32768-0
+ env
++ date
+ echo Thu Aug 1 11:16:49 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Thu Aug 1 11:16:49 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 527005254f fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-32768-0-1722547009
+ git checkout -b scalability-yes-8-32768-0-1722547009
Switched to a new branch 'scalability-yes-8-32768-0-1722547009'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-32768-0-1722547009 783a1c3982] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-32768-0-1722547009 86db64069a] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:17:12 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Thu Aug 1 11:17:12 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-8-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-8-32768-0-1722547009 32768 yes 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-8-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-512-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-512-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-512-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-512-32768-0
+ env
++ date
+ echo Thu Aug 1 11:18:26 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Thu Aug 1 11:18:26 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 86db64069a fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-32768-0-1722547107
+ git checkout -b scalability-yes-512-32768-0-1722547107
Switched to a new branch 'scalability-yes-512-32768-0-1722547107'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-32768-0-1722547107 5d55f0b681] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-32768-0-1722547107 ab17c2b475] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:18:50 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Thu Aug 1 11:18:50 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-512-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-512-32768-0-1722547107 32768 yes 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-512-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-128-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-128-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-128-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-yes-128-32768-0
+ env
++ date
+ echo Thu Aug 1 11:20:04 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Thu Aug 1 11:20:04 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at ab17c2b475 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-32768-0-1722547204
+ git checkout -b scalability-yes-128-32768-0-1722547204
Switched to a new branch 'scalability-yes-128-32768-0-1722547204'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-32768-0-1722547204 b8aadfd456] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-32768-0-1722547204 ad19f88bc9] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:20:28 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Thu Aug 1 11:20:28 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-128-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-yes-128-32768-0-1722547204 32768 yes 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-yes-128-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-32-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-32-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-32-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-32-32768-0
+ env
++ date
+ echo Thu Aug 1 11:21:42 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Thu Aug 1 11:21:42 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at ad19f88bc9 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-32768-0-1722547302
+ git checkout -b scalability-no-32-32768-0-1722547302
Switched to a new branch 'scalability-no-32-32768-0-1722547302'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-32768-0-1722547302 76f4d77537] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:22:06 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Thu Aug 1 11:22:06 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-32-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-32-32768-0-1722547302 32768 no 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-32-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-0-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-0-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-0-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-0-32768-0
+ env
++ date
+ echo Thu Aug 1 11:23:20 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Thu Aug 1 11:23:20 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 76f4d77537 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-32768-0-1722547400
+ git checkout -b scalability-no-0-32768-0-1722547400
Switched to a new branch 'scalability-no-0-32768-0-1722547400'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:23:44 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Thu Aug 1 11:23:44 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-0-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-0-32768-0-1722547400 32768 no 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-0-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-1-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-1-32768-0
+ env
++ date
+ echo Thu Aug 1 11:24:58 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Thu Aug 1 11:24:58 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-32768-0-1722547498
+ git checkout -b scalability-no-1-32768-0-1722547498
Switched to a new branch 'scalability-no-1-32768-0-1722547498'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-32768-0-1722547498 09f88b562e] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:25:21 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Thu Aug 1 11:25:21 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-1-32768-0-1722547498 32768 no 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1024-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-1024-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1024-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-1024-32768-0
+ env
++ date
+ echo Thu Aug 1 11:26:36 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Thu Aug 1 11:26:36 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 09f88b562e fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-32768-0-1722547596
+ git checkout -b scalability-no-1024-32768-0-1722547596
Switched to a new branch 'scalability-no-1024-32768-0-1722547596'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-32768-0-1722547596 294b72dcd3] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:26:59 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Thu Aug 1 11:26:59 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1024-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-1024-32768-0-1722547596 32768 no 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-1024-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-8-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-8-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-8-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-8-32768-0
+ env
++ date
+ echo Thu Aug 1 11:28:13 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Thu Aug 1 11:28:13 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 294b72dcd3 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-32768-0-1722547694
+ git checkout -b scalability-no-8-32768-0-1722547694
Switched to a new branch 'scalability-no-8-32768-0-1722547694'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-32768-0-1722547694 78035bbb26] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:28:37 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Thu Aug 1 11:28:37 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-8-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-8-32768-0-1722547694 32768 no 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-8-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-512-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-512-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-512-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-512-32768-0
+ env
++ date
+ echo Thu Aug 1 11:29:51 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Thu Aug 1 11:29:51 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 78035bbb26 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-32768-0-1722547791
+ git checkout -b scalability-no-512-32768-0-1722547791
Switched to a new branch 'scalability-no-512-32768-0-1722547791'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-32768-0-1722547791 83017127eb] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:30:15 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Thu Aug 1 11:30:15 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-512-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-512-32768-0-1722547791 32768 no 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-512-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-128-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-128-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-128-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/index-no-128-32768-0
+ env
++ date
+ echo Thu Aug 1 11:31:29 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Thu Aug 1 11:31:29 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 83017127eb fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-32768-0-1722547889
+ git checkout -b scalability-no-128-32768-0-1722547889
Switched to a new branch 'scalability-no-128-32768-0-1722547889'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-32768-0-1722547889 f7d33e60b6] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:31:52 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Thu Aug 1 11:31:52 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-128-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-index.sh i5 scalability-no-128-32768-0-1722547889 32768 no 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/index-no-128-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-32-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-32-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-32-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-32-32768-0
+ env
++ date
+ echo Thu Aug 1 11:33:07 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Thu Aug 1 11:33:07 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at f7d33e60b6 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-32768-0-1722547987
+ git checkout -b scalability-yes-32-32768-0-1722547987
Switched to a new branch 'scalability-yes-32-32768-0-1722547987'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-32768-0-1722547987 ff6d9fc305] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-32768-0-1722547987 33f2aa7512] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:33:30 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Thu Aug 1 11:33:30 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-32-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-32-32768-0-1722547987 32768 yes 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-32-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-0-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-0-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-0-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-0-32768-0
+ env
++ date
+ echo Thu Aug 1 11:34:43 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Thu Aug 1 11:34:43 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 33f2aa7512 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-32768-0-1722548084
+ git checkout -b scalability-yes-0-32768-0-1722548084
Switched to a new branch 'scalability-yes-0-32768-0-1722548084'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-32768-0-1722548084 4d607e769e] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:35:07 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Thu Aug 1 11:35:07 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-0-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-0-32768-0-1722548084 32768 yes 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-0-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-1-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-1-32768-0
+ env
++ date
+ echo Thu Aug 1 11:36:20 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Thu Aug 1 11:36:20 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 4d607e769e NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-32768-0-1722548180
+ git checkout -b scalability-yes-1-32768-0-1722548180
Switched to a new branch 'scalability-yes-1-32768-0-1722548180'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-32768-0-1722548180 a85146068b] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-32768-0-1722548180 e036866dd2] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:36:44 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Thu Aug 1 11:36:44 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-1-32768-0-1722548180 32768 yes 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1024-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-1024-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1024-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-1024-32768-0
+ env
++ date
+ echo Thu Aug 1 11:37:57 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Thu Aug 1 11:37:57 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e036866dd2 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-32768-0-1722548277
+ git checkout -b scalability-yes-1024-32768-0-1722548277
Switched to a new branch 'scalability-yes-1024-32768-0-1722548277'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-32768-0-1722548277 e5f663c24b] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-32768-0-1722548277 2d75e8edc5] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:38:20 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Thu Aug 1 11:38:20 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1024-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-1024-32768-0-1722548277 32768 yes 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-1024-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-8-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-8-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-8-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-8-32768-0
+ env
++ date
+ echo Thu Aug 1 11:39:33 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Thu Aug 1 11:39:33 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 2d75e8edc5 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-32768-0-1722548374
+ git checkout -b scalability-yes-8-32768-0-1722548374
Switched to a new branch 'scalability-yes-8-32768-0-1722548374'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-32768-0-1722548374 d533fda8a2] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-32768-0-1722548374 942772294c] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:39:57 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Thu Aug 1 11:39:57 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-8-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-8-32768-0-1722548374 32768 yes 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-8-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-512-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-512-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-512-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-512-32768-0
+ env
++ date
+ echo Thu Aug 1 11:41:10 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Thu Aug 1 11:41:10 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 942772294c fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-32768-0-1722548470
+ git checkout -b scalability-yes-512-32768-0-1722548470
Switched to a new branch 'scalability-yes-512-32768-0-1722548470'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-32768-0-1722548470 00083218c4] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/512/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-32768-0-1722548470 e058260643] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:41:34 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Thu Aug 1 11:41:34 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-512-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-512-32768-0-1722548470 32768 yes 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-512-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-128-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-128-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-128-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-yes-128-32768-0
+ env
++ date
+ echo Thu Aug 1 11:42:47 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Thu Aug 1 11:42:47 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e058260643 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-32768-0-1722548567
+ git checkout -b scalability-yes-128-32768-0-1722548567
Switched to a new branch 'scalability-yes-128-32768-0-1722548567'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-32768-0-1722548567 1b0aa629b1] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-32768-0-1722548567 3e8b104171] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:43:10 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Thu Aug 1 11:43:10 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-128-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-yes-128-32768-0-1722548567 32768 yes 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-yes-128-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-32-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-32-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-32-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-32-32768-0
+ env
++ date
+ echo Thu Aug 1 11:44:24 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Thu Aug 1 11:44:24 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 3e8b104171 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-32768-0-1722548664
+ git checkout -b scalability-no-32-32768-0-1722548664
Switched to a new branch 'scalability-no-32-32768-0-1722548664'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-32768-0-1722548664 91a72f9ea3] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:44:47 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Thu Aug 1 11:44:47 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-32-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-32-32768-0-1722548664 32768 no 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-32-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-0-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-0-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-0-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-0-32768-0
+ env
++ date
+ echo Thu Aug 1 11:46:00 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Thu Aug 1 11:46:00 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 91a72f9ea3 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-32768-0-1722548760
+ git checkout -b scalability-no-0-32768-0-1722548760
Switched to a new branch 'scalability-no-0-32768-0-1722548760'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:46:24 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Thu Aug 1 11:46:24 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-0-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-0-32768-0-1722548760 32768 no 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-0-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-1-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-1-32768-0
+ env
++ date
+ echo Thu Aug 1 11:47:37 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Thu Aug 1 11:47:37 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-32768-0-1722548857
+ git checkout -b scalability-no-1-32768-0-1722548857
Switched to a new branch 'scalability-no-1-32768-0-1722548857'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-32768-0-1722548857 ef58bd23df] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:48:00 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Thu Aug 1 11:48:00 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-1-32768-0-1722548857 32768 no 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1024-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-1024-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1024-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-1024-32768-0
+ env
++ date
+ echo Thu Aug 1 11:49:14 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Thu Aug 1 11:49:14 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at ef58bd23df fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-32768-0-1722548954
+ git checkout -b scalability-no-1024-32768-0-1722548954
Switched to a new branch 'scalability-no-1024-32768-0-1722548954'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/1024/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-32768-0-1722548954 13864004fd] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:49:37 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Thu Aug 1 11:49:37 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1024-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-1024-32768-0-1722548954 32768 no 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-1024-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-8-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-8-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-8-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-8-32768-0
+ env
++ date
+ echo Thu Aug 1 11:50:50 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Thu Aug 1 11:50:50 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 13864004fd fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-32768-0-1722549050
+ git checkout -b scalability-no-8-32768-0-1722549050
Switched to a new branch 'scalability-no-8-32768-0-1722549050'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-32768-0-1722549050 e75c0ec535] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:51:14 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Thu Aug 1 11:51:14 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-8-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-8-32768-0-1722549050 32768 no 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-8-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-512-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-512-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-512-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-512-32768-0
+ env
++ date
+ echo Thu Aug 1 11:52:27 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Thu Aug 1 11:52:27 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e75c0ec535 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-32768-0-1722549147
+ git checkout -b scalability-no-512-32768-0-1722549147
Switched to a new branch 'scalability-no-512-32768-0-1722549147'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/512/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-32768-0-1722549147 9ca51ff932] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:52:51 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Thu Aug 1 11:52:51 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-512-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-512-32768-0-1722549147 32768 no 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-512-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-128-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-128-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-128-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/count-no-128-32768-0
+ env
++ date
+ echo Thu Aug 1 11:54:04 PM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Thu Aug 1 11:54:04 PM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 9ca51ff932 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-32768-0-1722549244
+ git checkout -b scalability-no-128-32768-0-1722549244
Switched to a new branch 'scalability-no-128-32768-0-1722549244'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-32768-0-1722549244 7643a7ddf7] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:54:27 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Thu Aug 1 11:54:27 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-128-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-count.sh i5 scalability-no-128-32768-0-1722549244 32768 no 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/count-no-128-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-32-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-32-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-32-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-32-32768-0
+ env
++ date
+ echo Thu Aug 1 11:55:40 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Thu Aug 1 11:55:40 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 7643a7ddf7 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-32768-0-1722549341
+ git checkout -b scalability-yes-32-32768-0-1722549341
Switched to a new branch 'scalability-yes-32-32768-0-1722549341'
+ '[' yes == yes ']'
+ patch -p1
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-32768-0-1722549341 44d23a6104] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-32768-0-1722549341 9f215b0d2e] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:56:04 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Thu Aug 1 11:56:04 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-32-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-32-32768-0-1722549341 32768 yes 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-32-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-0-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-0-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-0-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-0-32768-0
+ env
++ date
+ echo Thu Aug 1 11:57:23 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Thu Aug 1 11:57:23 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 9f215b0d2e fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-32768-0-1722549443
+ git checkout -b scalability-yes-0-32768-0-1722549443
Switched to a new branch 'scalability-yes-0-32768-0-1722549443'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-32768-0-1722549443 ac7d55cc15] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:57:46 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Thu Aug 1 11:57:46 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-0-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-0-32768-0-1722549443 32768 yes 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-0-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-1-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-1-32768-0
+ env
++ date
+ echo Thu Aug 1 11:59:05 PM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Thu Aug 1 11:59:05 PM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at ac7d55cc15 NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-32768-0-1722549545
+ git checkout -b scalability-yes-1-32768-0-1722549545
Switched to a new branch 'scalability-yes-1-32768-0-1722549545'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-32768-0-1722549545 90af638d73] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-32768-0-1722549545 14b3e4fd05] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Thu Aug 1 11:59:28 PM CEST 2024 'RUN   files: 32768  partitions: 0'
Thu Aug 1 11:59:28 PM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-1-32768-0-1722549545 32768 yes 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1024-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-1024-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1024-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-1024-32768-0
+ env
++ date
+ echo Fri Aug 2 12:00:46 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Fri Aug 2 12:00:46 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 14b3e4fd05 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-32768-0-1722549647
+ git checkout -b scalability-yes-1024-32768-0-1722549647
Switched to a new branch 'scalability-yes-1024-32768-0-1722549647'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-32768-0-1722549647 c5b6d7972e] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-32768-0-1722549647 a4f12deba1] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Fri Aug 2 12:01:10 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Fri Aug 2 12:01:10 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1024-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-1024-32768-0-1722549647 32768 yes 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-1024-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-8-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-8-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-8-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-8-32768-0
+ env
++ date
+ echo Fri Aug 2 12:02:28 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Fri Aug 2 12:02:28 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at a4f12deba1 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-32768-0-1722549748
+ git checkout -b scalability-yes-8-32768-0-1722549748
Switched to a new branch 'scalability-yes-8-32768-0-1722549748'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-32768-0-1722549748 5c0b0e704b] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-32768-0-1722549748 43d845092c] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Fri Aug 2 12:02:52 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Fri Aug 2 12:02:52 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-8-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-8-32768-0-1722549748 32768 yes 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-8-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-512-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-512-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-512-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-512-32768-0
+ env
++ date
+ echo Fri Aug 2 12:04:10 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Fri Aug 2 12:04:10 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 43d845092c fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-32768-0-1722549851
+ git checkout -b scalability-yes-512-32768-0-1722549851
Switched to a new branch 'scalability-yes-512-32768-0-1722549851'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-32768-0-1722549851 e6673df5c1] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-32768-0-1722549851 b00ded5bfd] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Fri Aug 2 12:04:34 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Fri Aug 2 12:04:34 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-512-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-512-32768-0-1722549851 32768 yes 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-512-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-128-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-128-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-128-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-yes-128-32768-0
+ env
++ date
+ echo Fri Aug 2 12:05:52 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Fri Aug 2 12:05:52 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b00ded5bfd fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-32768-0-1722549952
+ git checkout -b scalability-yes-128-32768-0-1722549952
Switched to a new branch 'scalability-yes-128-32768-0-1722549952'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-32768-0-1722549952 b8d62732df] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-32768-0-1722549952 e0e4073419] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Fri Aug 2 12:06:16 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Fri Aug 2 12:06:16 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-128-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-yes-128-32768-0-1722549952 32768 yes 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-yes-128-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-32-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-32-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-32-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-32-32768-0
+ env
++ date
+ echo Fri Aug 2 12:07:34 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Fri Aug 2 12:07:34 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e0e4073419 fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-32768-0-1722550055
+ git checkout -b scalability-no-32-32768-0-1722550055
Switched to a new branch 'scalability-no-32-32768-0-1722550055'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/32/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-32768-0-1722550055 e49cd748ad] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Fri Aug 2 12:07:58 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Fri Aug 2 12:07:58 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-32-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-32-32768-0-1722550055 32768 no 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-32-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-0-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-0-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-0-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-0-32768-0
+ env
++ date
+ echo Fri Aug 2 12:09:16 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Fri Aug 2 12:09:16 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at e49cd748ad fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-32768-0-1722550156
+ git checkout -b scalability-no-0-32768-0-1722550156
Switched to a new branch 'scalability-no-0-32768-0-1722550156'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Fri Aug 2 12:09:40 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Fri Aug 2 12:09:40 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-0-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-0-32768-0-1722550156 32768 no 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-0-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-1-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-1-32768-0
+ env
++ date
+ echo Fri Aug 2 12:10:58 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Fri Aug 2 12:10:58 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-32768-0-1722550258
+ git checkout -b scalability-no-1-32768-0-1722550258
Switched to a new branch 'scalability-no-1-32768-0-1722550258'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/1/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-32768-0-1722550258 5af38bc882] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Fri Aug 2 12:11:22 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Fri Aug 2 12:11:22 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-1-32768-0-1722550258 32768 no 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1024-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-1024-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1024-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-1024-32768-0
+ env
++ date
+ echo Fri Aug 2 12:12:40 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Fri Aug 2 12:12:40 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 5af38bc882 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-32768-0-1722550360
+ git checkout -b scalability-no-1024-32768-0-1722550360
Switched to a new branch 'scalability-no-1024-32768-0-1722550360'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-32768-0-1722550360 b854b85e6b] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Fri Aug 2 12:13:03 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Fri Aug 2 12:13:03 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1024-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-1024-32768-0-1722550360 32768 no 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-1024-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-8-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-8-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-8-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-8-32768-0
+ env
++ date
+ echo Fri Aug 2 12:14:22 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Fri Aug 2 12:14:22 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b854b85e6b fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-32768-0-1722550462
+ git checkout -b scalability-no-8-32768-0-1722550462
Switched to a new branch 'scalability-no-8-32768-0-1722550462'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-32768-0-1722550462 09a20abf65] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Fri Aug 2 12:14:45 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Fri Aug 2 12:14:45 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-8-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-8-32768-0-1722550462 32768 no 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-8-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-512-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-512-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-512-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-512-32768-0
+ env
++ date
+ echo Fri Aug 2 12:16:04 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Fri Aug 2 12:16:04 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 09a20abf65 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-32768-0-1722550564
+ git checkout -b scalability-no-512-32768-0-1722550564
Switched to a new branch 'scalability-no-512-32768-0-1722550564'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/512/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-32768-0-1722550564 eab3b02136] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Fri Aug 2 12:16:27 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Fri Aug 2 12:16:27 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-512-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-512-32768-0-1722550564 32768 no 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-512-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-128-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-128-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-128-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/join-no-128-32768-0
+ env
++ date
+ echo Fri Aug 2 12:17:46 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Fri Aug 2 12:17:46 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at eab3b02136 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-32768-0-1722550666
+ git checkout -b scalability-no-128-32768-0-1722550666
Switched to a new branch 'scalability-no-128-32768-0-1722550666'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-32768-0-1722550666 92b37c583b] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Fri Aug 2 12:18:10 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Fri Aug 2 12:18:10 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-128-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-join.sh i5 scalability-no-128-32768-0-1722550666 32768 no 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/join-no-128-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for t in pgbench index count join star
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-32-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-32-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-32-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-32-32768-0
+ env
++ date
+ echo Fri Aug 2 12:19:28 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 32'
Fri Aug 2 12:19:28 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 92b37c583b fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-32-32768-0-1722550768
+ git checkout -b scalability-yes-32-32768-0-1722550768
Switched to a new branch 'scalability-yes-32-32768-0-1722550768'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-32-32768-0-1722550768 c4b3e90d91] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-yes-32-32768-0-1722550768 8f84389a8a] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-32-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Fri Aug 2 12:19:51 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Fri Aug 2 12:19:51 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-32-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-32-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-32-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-32-32768-0-1722550768 32768 yes 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-32-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-0-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-0-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-0-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-0-32768-0
+ env
++ date
+ echo Fri Aug 2 12:19:54 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 0'
Fri Aug 2 12:19:54 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 8f84389a8a fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-0-32768-0-1722550794
+ git checkout -b scalability-yes-0-32768-0-1722550794
Switched to a new branch 'scalability-yes-0-32768-0-1722550794'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-0-32768-0-1722550794 7736b133ab] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-0-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Fri Aug 2 12:20:18 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Fri Aug 2 12:20:18 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-0-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-0-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-0-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-0-32768-0-1722550794 32768 yes 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-0-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-1-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-1-32768-0
+ env
++ date
+ echo Fri Aug 2 12:20:20 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1'
Fri Aug 2 12:20:20 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 7736b133ab NUM_LOCK_PARTITIONS
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1-32768-0-1722550821
+ git checkout -b scalability-yes-1-32768-0-1722550821
Switched to a new branch 'scalability-yes-1-32768-0-1722550821'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1-32768-0-1722550821 cc23e0fdcb] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-yes-1-32768-0-1722550821 00f2f40602] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Fri Aug 2 12:20:44 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Fri Aug 2 12:20:44 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-1-32768-0-1722550821 32768 yes 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1024-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-1024-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1024-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-1024-32768-0
+ env
++ date
+ echo Fri Aug 2 12:20:47 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 1024'
Fri Aug 2 12:20:47 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 00f2f40602 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-1024-32768-0-1722550847
+ git checkout -b scalability-yes-1024-32768-0-1722550847
Switched to a new branch 'scalability-yes-1024-32768-0-1722550847'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-1024-32768-0-1722550847 831fbd86f4] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-yes-1024-32768-0-1722550847 57b9e8327c] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-1024-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Fri Aug 2 12:21:10 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Fri Aug 2 12:21:10 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-1024-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-1024-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1024-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-1024-32768-0-1722550847 32768 yes 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-1024-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-8-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-8-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-8-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-8-32768-0
+ env
++ date
+ echo Fri Aug 2 12:21:13 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 8'
Fri Aug 2 12:21:13 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 57b9e8327c fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-8-32768-0-1722550873
+ git checkout -b scalability-yes-8-32768-0-1722550873
Switched to a new branch 'scalability-yes-8-32768-0-1722550873'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-8-32768-0-1722550873 4ed557c5cd] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/8/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-yes-8-32768-0-1722550873 bab724324b] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-8-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Fri Aug 2 12:21:37 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Fri Aug 2 12:21:37 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-8-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-8-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-8-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-8-32768-0-1722550873 32768 yes 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-8-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-512-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-512-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-512-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-512-32768-0
+ env
++ date
+ echo Fri Aug 2 12:21:40 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 512'
Fri Aug 2 12:21:40 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at bab724324b fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-512-32768-0-1722550900
+ git checkout -b scalability-yes-512-32768-0-1722550900
Switched to a new branch 'scalability-yes-512-32768-0-1722550900'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-512-32768-0-1722550900 6eca024c9b] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-yes-512-32768-0-1722550900 b30ff57db8] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-512-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Fri Aug 2 12:22:03 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Fri Aug 2 12:22:03 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-512-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-512-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-512-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-512-32768-0-1722550900 32768 yes 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-512-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-128-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-128-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-128-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-yes-128-32768-0
+ env
++ date
+ echo Fri Aug 2 12:22:06 AM CEST 2024 'BUILD lock partitions: yes  fastpath groups: 128'
Fri Aug 2 12:22:06 AM CEST 2024 BUILD lock partitions: yes  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at b30ff57db8 fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-yes-128-32768-0-1722550926
+ git checkout -b scalability-yes-128-32768-0-1722550926
Switched to a new branch 'scalability-yes-128-32768-0-1722550926'
+ '[' yes == yes ']'
+ cat /mnt/data/lock-scalability-test/patches/0001-Increase-NUM_LOCK_PARTITIONS-to-64.patch
+ patch -p1
patching file src/include/storage/lwlock.h
+ git commit src -m NUM_LOCK_PARTITIONS
[scalability-yes-128-32768-0-1722550926 1e802769ab] NUM_LOCK_PARTITIONS
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-yes-128-32768-0-1722550926 9e8de563cd] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/yes-128-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Fri Aug 2 12:22:29 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Fri Aug 2 12:22:29 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/yes-128-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/yes-128-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-128-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-yes-128-32768-0-1722550926 32768 yes 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-yes-128-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for partitions in yes no
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-32-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-32-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-32-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-32-32768-0
+ env
++ date
+ echo Fri Aug 2 12:22:32 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 32'
Fri Aug 2 12:22:32 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 32
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 9e8de563cd fastpath lock groups 128
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-32-32768-0-1722550952
+ git checkout -b scalability-no-32-32768-0-1722550952
Switched to a new branch 'scalability-no-32-32768-0-1722550952'
+ '[' no == yes ']'
+ '[' 32 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/32/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 32'
[scalability-no-32-32768-0-1722550952 95f97f6ac9] fastpath lock groups 32
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-32-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Fri Aug 2 12:22:56 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Fri Aug 2 12:22:56 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-32-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-32-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-32-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-32-32768-0-1722550952 32768 no 32 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-32-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-0-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-0-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-0-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-0-32768-0
+ env
++ date
+ echo Fri Aug 2 12:22:59 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 0'
Fri Aug 2 12:22:59 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 0
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 95f97f6ac9 fastpath lock groups 32
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-0-32768-0-1722550979
+ git checkout -b scalability-no-0-32768-0-1722550979
Switched to a new branch 'scalability-no-0-32768-0-1722550979'
+ '[' no == yes ']'
+ '[' 0 '!=' 0 ']'
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-0-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Fri Aug 2 12:23:22 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Fri Aug 2 12:23:22 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-0-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-0-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-0-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-0-32768-0-1722550979 32768 no 0 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-0-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-1-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-1-32768-0
+ env
++ date
+ echo Fri Aug 2 12:23:25 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1'
Fri Aug 2 12:23:25 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 05faf06e9c pg_createsubscriber: Message improvements
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1-32768-0-1722551005
+ git checkout -b scalability-no-1-32768-0-1722551005
Switched to a new branch 'scalability-no-1-32768-0-1722551005'
+ '[' no == yes ']'
+ '[' 1 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1'
[scalability-no-1-32768-0-1722551005 6dc8e21a60] fastpath lock groups 1
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
lock.c: In function ‘LockAcquireExtended’:
lock.c:926:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
  926 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘LockRelease’:
lock.c:2081:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2081 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGrantRelationLock’:
lock.c:2669:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2669 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathUnGrantRelationLock’:
lock.c:2721:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2721 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘FastPathGetRelationLockEntry’:
lock.c:2866:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2866 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
lock.c: In function ‘GetLockConflicts’:
lock.c:2989:17: warning: ‘memset’ used with length equal to number of elements without multiplication by element size [-Wmemset-elt-size]
 2989 |                 memset(FastPathLocalUseCounts, 0, sizeof(FastPathLocalUseInitialized));
      |                 ^~~~~~
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Fri Aug 2 12:23:48 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Fri Aug 2 12:23:48 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-1-32768-0-1722551005 32768 no 1 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1024-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-1024-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1024-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-1024-32768-0
+ env
++ date
+ echo Fri Aug 2 12:23:51 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 1024'
Fri Aug 2 12:23:51 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 1024
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 6dc8e21a60 fastpath lock groups 1
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-1024-32768-0-1722551031
+ git checkout -b scalability-no-1024-32768-0-1722551031
Switched to a new branch 'scalability-no-1024-32768-0-1722551031'
+ '[' no == yes ']'
+ '[' 1024 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/1024/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 1024'
[scalability-no-1024-32768-0-1722551031 44b501f9c0] fastpath lock groups 1024
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-1024-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Fri Aug 2 12:24:15 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Fri Aug 2 12:24:15 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-1024-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-1024-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1024-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-1024-32768-0-1722551031 32768 no 1024 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-1024-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-8-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-8-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-8-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-8-32768-0
+ env
++ date
+ echo Fri Aug 2 12:24:18 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 8'
Fri Aug 2 12:24:18 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 8
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 44b501f9c0 fastpath lock groups 1024
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-8-32768-0-1722551058
+ git checkout -b scalability-no-8-32768-0-1722551058
Switched to a new branch 'scalability-no-8-32768-0-1722551058'
+ '[' no == yes ']'
+ '[' 8 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ patch -p1
+ sed s/MY_PLACEHOLDER/8/
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 8'
[scalability-no-8-32768-0-1722551058 276aa1ae44] fastpath lock groups 8
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-8-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Fri Aug 2 12:24:41 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Fri Aug 2 12:24:41 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-8-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-8-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-8-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-8-32768-0-1722551058 32768 no 8 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-8-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-512-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-512-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-512-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-512-32768-0
+ env
++ date
+ echo Fri Aug 2 12:24:44 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 512'
Fri Aug 2 12:24:44 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 512
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 276aa1ae44 fastpath lock groups 8
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-512-32768-0-1722551084
+ git checkout -b scalability-no-512-32768-0-1722551084
Switched to a new branch 'scalability-no-512-32768-0-1722551084'
+ '[' no == yes ']'
+ '[' 512 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/512/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 512'
[scalability-no-512-32768-0-1722551084 06b3c879ae] fastpath lock groups 512
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-512-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Fri Aug 2 12:25:08 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Fri Aug 2 12:25:08 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-512-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-512-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-512-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-512-32768-0-1722551084 32768 no 512 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-512-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
+ for groups in 32 0 1 1024 8 512 128
+ LOGDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-128-32768-0
+ RESULTDIR=/mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-128-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-128-32768-0
+ mkdir -p /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/results/star-no-128-32768-0
+ env
++ date
+ echo Fri Aug 2 12:25:10 AM CEST 2024 'BUILD lock partitions: no  fastpath groups: 128'
Fri Aug 2 12:25:10 AM CEST 2024 BUILD lock partitions: no  fastpath groups: 128
+ pushd /mnt/data/postgres
/mnt/data/postgres /mnt/data/lock-scalability-test
+ git reset --hard
HEAD is now at 06b3c879ae fastpath lock groups 512
+ git checkout master
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
+ git clean -f -d -x
++ date +%s
+ BRANCH=scalability-no-128-32768-0-1722551111
+ git checkout -b scalability-no-128-32768-0-1722551111
Switched to a new branch 'scalability-no-128-32768-0-1722551111'
+ '[' no == yes ']'
+ '[' 128 '!=' 0 ']'
+ cat /mnt/data/lock-scalability-test/patches/0002-Increase-the-number-of-fastpath-locks.patch
+ sed s/MY_PLACEHOLDER/128/
+ patch -p1
patching file src/backend/storage/lmgr/lock.c
patching file src/include/storage/proc.h
+ git commit src -m 'fastpath lock groups 128'
[scalability-no-128-32768-0-1722551111 896bbd3e82] fastpath lock groups 128
 Committer: tomas <tomas@i5>
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly. Run the
following command and follow the instructions in your editor to edit
your configuration file:

    git config --global --edit

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 2 files changed, 116 insertions(+), 27 deletions(-)
+ git log
+ head -n 1000
+ CC='ccache gcc'
+ ./configure --prefix=/mnt/data/builds/no-128-32768-0 --enable-debug --enable-depend
+ make -s clean
+ make -s -j4 install
+ cd contrib
+ make -s clean
+ make -s -j4 install
+ cd ..
+ popd
/mnt/data/lock-scalability-test
++ date
+ echo Fri Aug 2 12:25:34 AM CEST 2024 'RUN   files: 32768  partitions: 0'
Fri Aug 2 12:25:34 AM CEST 2024 RUN   files: 32768  partitions: 0
+ ulimit -a
+ export PATH=/mnt/data/builds/no-128-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ PATH=/mnt/data/builds/no-128-32768-0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
+ pg_config
+ killall -9 postgres
postgres: no process found
+ true
+ sleep 1
+ rm -Rf /mnt/pgdata/data-test
+ pg_ctl -D /mnt/pgdata/data-test init
+ echo 'max_connections = 1000'
+ echo 'shared_buffers = 2GB'
+ echo 'max_locks_per_transaction = 8192'
+ echo 'max_parallel_workers_per_gather = 0'
+ echo 'random_page_cost = 1.5'
+ echo 'max_files_per_process = 32768'
+ pg_ctl -D /mnt/pgdata/data-test -l /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-128-32768-0/pg.log start
+ psql postgres -c 'select * from pg_settings'
+ ./run-star.sh i5 scalability-no-128-32768-0-1722551111 32768 no 128 /mnt/data/lock-scalability-test/20240731-2049-glibc-tuned/logs/star-no-128-32768-0 1 10 '1 4 16' 0
+ pg_ctl -D /mnt/pgdata/data-test stop
